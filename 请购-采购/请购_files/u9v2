function MSOLayout_MakeInvisibleIfEmpty(){for(var t=document.getElementsByName("_invisibleIfEmpty"),i=navigator.userAgent.toLowerCase(),r=i.indexOf("mozilla")!=-1&&i.indexOf("spoofer")==-1&&i.indexOf("compatible")==-1,u=i.indexOf("msie")!=-1,n=0;n<t.length;n++)(u&&t[n].childNodes.length==0||r&&t[n].childNodes.length<=1)&&(t[n].style.display="none")}function MSOLayout_MakeInvisibleIfHidden(){for(var u=document.getElementsByName("_invisibleIfHidden"),e=navigator.userAgent.toLowerCase(),t,r,i,f,n=0;n<u.length;n++){for(t=u[n],r=!0,i=0;i<t.children.length;i++)f=t.children[i],f.style.display!="none"&&(r=!1);r&&(t.style.display="none")}}function ValidateForm(){alert("ok")}function Fix40Decode(n){return n.replace(/&#39;/g,"'")}function HideZone(n){var t=document.getElementById(n);t!=null&&(t.style.display="none"),typeof MSOLayout_MakeInvisibleIfHidden=="function"&&MSOLayout_MakeInvisibleIfHidden()}function ToggleDisplay(n){return n!=null&&(n.style.display=n.style.display==""?"none":""),!1}function RegisterShowQueryCase(n,t,i){var r=window.document.all(n+"_button");r||(r=window.document.all(n)),r&&r.length&&r.length>0&&(r=btn[1]),r.onclick=BtnLookCase_onClick,r.onclick_url=i}function BtnLookCase_onClick(){ShowQueryCaseModalDialog(this.onclick_url)}function ShowQueryCaseModalDialog(n){var i="900",r="470",t=ShowModalDialog(n,"",r,i,"False","False");return}function showQuery(){var n="simple.aspx?lnk=d3b07634-12e7-4a10-8cdf-a9a0d2c98f2f&chromeType=4&ShowType=ShowModal&ParentTaskID=3c83b0a6-ae4b-487b-ab9b-ed4383ea1ddb&PFID=f8bf81f5-29dd-4e15-95ae-ec1d74b457ba",t="dialogHeight:159px; dialogWidth: 370px; edge: Raised; center: Yes; help: No; resizable:No; status: No;scrollBars:No;";window.showModalDialog(n,window,t)}function GetUniqueID(n){n=n.replace("_","$");var t=n.lastIndexOf("$"),i="";return t>-1&&(i=n.substring(0,t)),i}function ShowModalDialog(n,t,i,r,u,f){var h,o,s,e;if(_ClientPostBackManager.Runing=!1,n=AppendPopupUrl(n,t),n=n.replace(/\%2501/g,"%25_@U9URLEncodeForNull@_01"),u=ToBoolean(u),f=ToBoolean(f),h=parseInt(i,10),isNaN(h)&&(h=418),o=parseInt(r,10),isNaN(o)?o=590:o+=5,o+=12,s="dialogHeight:"+h+"px; dialogWidth: "+o+"px; edge: Raised; center: Yes; help: No; resizable:No; status: No;scrollBars:No;",window.ufTitle=t,window.hideStatusBar=u,t&&(window.ufTitle=t),n.indexOf("lnk=ccfac9a4-841b-4686-b340-8e1e2ffeb569")>=0)window.setTimeout(function(){window.showModalDialog(n,window,s)},1500);else if(n.indexOf("lnk=d3b07634-12e7-4a10-8cdf-a9a0d2c98f2f")>=0||n.indexOf("lnk=5a381f50-eb2b-4332-a1b4-0841bcaca313")>=0||n.indexOf("lnk=ee206f24-1f0a-498d-b31e-74eb8f91586e")>=0)window.showModalDialog(n,window,s);else return f?(s="status:off;dialogWidth:"+o+"px;dialogHeight:"+h+"px",e=_uf$fi$showModelessDialog(n,null,s)):e=_uf$fi$showModalDialog(n,window,s),e=_uf$fi$showModalCallbackFunction(e),window.clearUIState&&(window.$&&$.get(window.clearUIState),window.clearUIState=null),!e||typeof e!="string"||window.Escaped=="true"||(e=unescapeHTML(e)),window.Escaped=null,e}function ShowModalDialog(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var w,p,b,k;_ClientPostBackManager.Runing=!1,n=AppendPopupUrl(n,t),n=n.replace(/\%2501/g,"%25_@U9URLEncodeForNull@_01"),u=ToBoolean(u),f=ToBoolean(f),w=parseInt(i,10),isNaN(w)&&(w=418),p=parseInt(r,10),isNaN(p)?p=590:p+=5,p+=12,b="dialogHeight:"+w+"px; dialogWidth: "+p+"px; edge: Raised; center: Yes; help: No; resizable:No; status: No;scrollBars:No;",window.ufTitle=t,window.hideStatusBar=u,t&&(window.ufTitle=t),n.indexOf("lnk=ccfac9a4-841b-4686-b340-8e1e2ffeb569")>=0?window.setTimeout(function(){window.showModalDialog(n,window,b,obj)},1500):n.indexOf("lnk=d3b07634-12e7-4a10-8cdf-a9a0d2c98f2f")>=0||n.indexOf("lnk=5a381f50-eb2b-4332-a1b4-0841bcaca313")>=0||n.indexOf("lnk=ee206f24-1f0a-498d-b31e-74eb8f91586e")>=0?window.showModalDialog(n,window,b,obj):zlayer.open({title:t,area:[p+"px",w+"px"],argument:window,content:n,endHandle:function(n){if(n=_uf$fi$showModalCallbackFunction(n),window.clearUIState&&(window.$&&$.get(window.clearUIState),window.clearUIState=null),!n||typeof n!="string"||window.Escaped=="true"||(n=unescapeHTML(n)),window.Escaped=null,e&&e._showDialogCallback)o?e._showDialogCallback(n,o):e._showDialogCallback(n,s,h,c,l,a,v,y);else if(e)if(e.indexOf("Find")>-1&&o){var t=GetRecordId(n);if(t=="")return;t!=""&&(window.document.getElementById(o).value=t),__doPostBack(e,"")}else{if(n==""||n==undefined)return;__doPostBack(e,"")}}})}function ShowModalDialogForAll(n,t,i,r,u,f,e,o,s,h,c,l,a){var y,v,p;_ClientPostBackManager.Runing=!1,n=AppendPopupUrl(n,t),n=n.replace(/\%2501/g,"%25_@U9URLEncodeForNull@_01"),u=ToBoolean(u),f=ToBoolean(f),y=parseInt(i,10),isNaN(y)&&(y=418),v=parseInt(r,10),isNaN(v)?v=590:v+=5,v+=12,p="dialogHeight:"+y+"px; dialogWidth: "+v+"px; edge: Raised; center: Yes; help: No; resizable:No; status: No;scrollBars:No;",window.ufTitle=t,window.hideStatusBar=u,t&&(window.ufTitle=t),n.indexOf("lnk=ccfac9a4-841b-4686-b340-8e1e2ffeb569")>=0?window.setTimeout(function(){window.showModalDialog(n,window,p,e)},1500):n.indexOf("lnk=d3b07634-12e7-4a10-8cdf-a9a0d2c98f2f")>=0||n.indexOf("lnk=5a381f50-eb2b-4332-a1b4-0841bcaca313")>=0||n.indexOf("lnk=ee206f24-1f0a-498d-b31e-74eb8f91586e")>=0?window.showModalDialog(n,window,p,e):zlayer.open({title:t,area:[r+"px",i+"px"],argument:window,content:n,endHandle:function(n){for(n=_uf$fi$showModalCallbackFunction(n),window.clearUIState&&(window.$&&$.get(window.clearUIState),window.clearUIState=null),!n||typeof n!="string"||window.Escaped=="true"||(n=unescapeHTML(n)),window.Escaped=null,e&&e.showDialogCallback?o?e.showDialogCallback(n,o):e.showDialogCallback(n,s,h,c,l,a):typeof e=="function"&&e(n);window.ZlayerCallBackArray.length>0;){var t=window.ZlayerCallBackArray.pop();typeof t=="function"?t(n):t.showDialogCallback(n)}}})}function BeforeShowModalDialog(n,t,i,r){var f,u,e;return _ClientPostBackManager.Runing=!1,n=AppendPopupUrl(n,t),n=n.replace(/\%2501/g,"%25_@U9URLEncodeForNull@_01"),f=parseInt(i,10),isNaN(f)&&(f=418),u=parseInt(r,10),isNaN(u)?u=590:u+=5,u+=12,e="dialogHeight:"+f+"px; dialogWidth: "+u+"px; edge: Raised; center: Yes; help: No; resizable:No; status: No;scrollBars:No;",window.ufTitle=t,t&&(window.ufTitle=t),n}function AfterCloseDialog(n){_ret=n,window.Sys&&Sys.WebForms?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(RunParseFormReturnValue):ParseFormReturnValue(n)}function RunParseFormReturnValue(){window.setTimeout(function(){try{ParseFormReturnValue(_ret)}catch(n){}},0)}function ParseFormReturnValue(refInfoXml){var results,dom,returnNodes,i,j,assNode,itemNodes,k,item,columnID,rowIndex,strID,ids,refreshNodes,refreshNode,ctrl;if(Sys&&Sys.WebForms&&Sys.WebForms.PageRequestManager.getInstance().remove_pageLoaded(RunParseFormReturnValue),results=new ReferenceData,refInfoXml==null||refInfoXml=="")return results;if(dom=PopupFormHelper.StringToXMLDom(refInfoXml),returnNodes=dom.getElementsByTagName("FormReturn"),returnNodes.length!=0){for(i=0;i<returnNodes.length;i++){var returnNode=returnNodes[i],assNodes=returnNode.getElementsByTagName("AssociationControl"),assScript="";for(j=0;j<assNodes.length;j++)for(assNode=assNodes[j],itemNodes=assNode.getElementsByTagName("AssociationItem"),k=0;k<itemNodes.length;k++)if(item=itemNodes[k],columnID=item.getAttribute("columnId"),columnID)rowIndex=item.getAttribute("rowIndex"),assScript+="if($find('"+item.getAttribute("controlId")+"')){$find('"+item.getAttribute("controlId")+"').SetReferenceCellValue("+rowIndex+","+columnID+",",assScript+="'"+item.getAttribute("value")+"',",assScript+="'"+item.getAttribute("value")+"',",assScript+="'"+item.getAttribute("value")+"');}";else if(strID=item.getAttribute("controlId"),strID.indexOf("_&_")==-1)assScript+="$find('"+item.getAttribute("controlId")+"').set_"+item.getAttribute("property")+"( ",assScript+="'"+item.getAttribute("value")+"');";else{if(ids=strID.split("_&_"),ids.length!=2)continue;item.getAttribute("property").toString()=="Enabled"?assScript+="if($find('"+ids[0]+"')){$find('"+ids[0]+"').SetMenuItemEnableByItemID('"+ids[1]+"','"+item.getAttribute("value")+"');}":item.getAttribute("property").toString()=="Visible"&&(assScript+="if($find('"+ids[0]+"')){$find('"+ids[0]+"').SetMenuItemVisibleByItemID('"+ids[1]+"','"+item.getAttribute("value")+"');}")}eval(assScript),refreshNodes=returnNode.getElementsByTagName("RefreshWindow"),refreshNodes.lenght>0&&(refreshNode=refreshNodes[0],ctrl=refreshNode.getAttribute.eventControl,__doPostBack(ctrl.id))}_ret=null;return}}function ShowQueryRptDialog(n,t,i,r){t.showModalDialog(n,t,i,r)}function AddtoFavorites(){var n=GetRealUrl4Fav(),t;return n.split("/display.aspx?").length>1&&(n="display.aspx?"+n.split("/display.aspx?")[1]),t=showModalDialog("../ufsoft/AddQuickMenu.aspx?title="+encodeURIComponent(window.document.title)+"&url="+encodeURIComponent(n),window,"dialogWidth:305px;dialogHeight:100px;edge: Raised; center: Yes; help: No; resizable:No; status: No;scrollBars:No;"),t&&t=="true"&&this.theForm.submit(),!1}function replaceValue(n,t,i,r){var u="",e=n.substr(0,t+i),f=n.substr(t+i,n.length),o=f.indexOf("&"),s="";return o>0?(s=f.substr(o,f.length),u=e+r+s):u=e+r,u}function IsContainKey(n,t){return re=new RegExp(t,"g"),r=n.search(re)}function ToggleSettings(){var n=window.frames[0].window.frames.__split_area,t=n.document.getElementById("navSettings");return ToggleDisplay(t),!1}function ChangePWD(){ShowModalDialog("../erp/simple.aspx?lnk=f2e0a1fe-2c65-495b-8e18-518387b3e596","","116","270","no","no")}function openHelp(){var n=getCultureName();window.open("../help/"+n+"/U9help-"+n+".htm")}function openContextHelp(){var r,n,t,i;if(window.event.keyCode==118)return r="",r=window.url2HelpID_Custom!=undefined?url2HelpID_Custom():url2HelpID(),FMCOpenHelp(r,null,null,null),window.event.keyCode=0,$Event(event).preventDefault(),$Event(event).stopPropagation(),!1;if(window.event.keyCode!=116||window.event.ctrlKey){if(window.event.keyCode==8&&((n=window.event.relatedTarget||window.event.srcElement||window.event.target||window.event.currentTarget,t=n.nodeName,t!="INPUT"&&t!="TEXTAREA")||(i=n.type.toUpperCase(),t=="INPUT"&&i!="TEXT"&&i!="TEXTAREA"&&i!="PASSWORD"&&i!="FILE")||t=="INPUT"&&(n.readOnly==!0||n.disabled==!0)))return $Event(event).preventDefault(),$Event(event).stopPropagation(),!1}else window.top.DocumentManager&&window.top.DocumentManager.liceseKeyDown(window)}function url2HelpID(){var r,n,t,i;return r=/\./g,t=getPageUri(),n=window.top.menuManager?getPageFristPara(t):getPageFristPara(),i=t.replace(r,"__"),n!=null&&(i+="__"+n),i}function getPageUri(){var n;return n=document.getElementById("CurrentPage").value}function getPageFristPara(){var t,u=document.getElementById("RawUrl").value,i=u.split("&"),r,n;return i.length>1&&(r=i[1],n=r.split("="),n[0]!="sId"&&(t=n[1])),t}function getPageFristPara(n){var t;if(window.top.menuManager){var i=window.top.menuManager,r=i.urlCompare.getParameters(document.getElementById("RawUrl").value),u=i.urlApplicationNodeList[n];return t=r[u[0]]}return t}function collapseFunc(n,t){document.all(n.id).style.display=="block"?(document.all(n.id).style.display="none",document.all(t.id).src="../images/plus.gif"):(document.all(n.id).style.display="block",document.all(t.id).src="../images/minus.gif")}function changeWidth(){var n=document.all.minMaxIcon,t=n.src.substring(n.src.lastIndexOf("/")+1,n.src.length);t=="tpmax.gif"?(document.all("webpartTd").style.width="70%",n.src="../images/tpmin.gif"):(document.all("webpartTd").style.width="75%",n.src="../images/tpmax.gif")}function setCurrent(n){var i,t;if(n!=current&&(current&&(current.className="window"),current=n,current.className="current window"),i=event.x-parseInt(n.currentStyle.left),t=event.y-parseInt(n.currentStyle.top),t<80)dragging=!0,dragEffect=function(){n.style.pixelLeft=event.x-i,n.style.pixelTop=event.y-t};else{var r=parseInt(n.currentStyle.width),u=i>r-10,f=parseInt(n.currentStyle.height),e=t>f-10;(u||e)&&(dragging=!0,i=event.x-r,t=event.y-f,dragEffect=function(){u&&(n.style.pixelWidth=event.x-i),e&&(n.style.pixelHeight=event.y-t)})}}function calcResize(n){var r=event.x-parseInt(n.currentStyle.left),u=event.y-parseInt(n.currentStyle.top),f=parseInt(n.currentStyle.width),t=r>f-10,e=parseInt(n.currentStyle.height),i=u>e-10;n.style.cursor=t||i?(i?"S":"")+(t?"E":"")+"-resize":"default"}function moveCurrent(){if(dragging&&current){if(event.button==0){releaseCurrent();return}startedDragging||(current.className="dragging current window",startedDragging=!0),dragEffect()}}function releaseCurrent(){current&&(current.className="current window",dragging=!1,startedDragging=!1)}function makeUnselectable(n){if(n.unselectable=!0,n.className!="content")for(var t=n.firstChild;t;t=t.nextSibling)t.nodeType==1&&makeUnselectable(t)}function onClickEvent(){setCurContainer()}function setCurContainer(){PD_textBox_HiddenContainer==null&&(PD_textBox_HiddenContainer=document.all(strPD_textBox_HiddenContainer));for(var n=event.srcElement.id,i=0,t=event.srcElement;n=="";){if(i>10)break;n=t.parentElement.id,t.tagName!="IMG"&&(PD_textBox_HiddenContainer.value=n),t=t.parentElement,i++}return n}function setEnabledByContainer(n,t){var r=n.childNodes,i;if(r)for(i=0;i<r.length;i++){try{r[i].Enabled=t}catch(u){}setEnabledByContainer(r[i],t)}else try{n.Enabled=t}catch(u){}}function setValuedByContainer(n,t){var r=n.childNodes,i;if(r)for(i=0;i<r.length;i++){try{r[i].Value=t}catch(u){}setEnabledByContainer(r[i],t)}else try{n.Value=t}catch(u){}}function isNumber(n){var t=!1;try{parseFloat(n),t=!0}catch(i){}return t}function GetSelectedNodes(treeID,toGrid){for(var grid=eval(toGrid).control,tree=eval(treeID),selectedNodes=[],text,value,i=0;i<tree.AllNodes.length;i++)tree.AllNodes[i].Checked&&selectedNodes.push(tree.AllNodes[i]);if(text="",value="",selectedNodes!=0)for(i=0;i<selectedNodes.length;i++)text=selectedNodes[i].Text,value=selectedNodes[i].Value,grid.ContainOf("Item",value)||(grid.AddNewRow(),grid.SelectRow(grid.get_Rows()-1,!0),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("Item"),value),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("FieldDisplayName"),text),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("FieldTitle"),text))}function GetSelectedNodes(treeID,toGrid,PTflag){var tree=document.getElementById(treeID),text,value,i;if(tree){var grid=eval(toGrid).control,tree=eval(treeID),selectedNodes=[];for(i=0;i<tree.AllNodes.length;i++)tree.AllNodes[i].Checked&&selectedNodes.push(tree.AllNodes[i]);if(text="",value="",selectedNodes.Count!=0)for(i=0;i<selectedNodes.length;i++)text=selectedNodes[i].Text,value=selectedNodes[i].Value,!grid.ContainOf("Item",value)&&value.lastIndexOf(PTflag)<0&&(text=GetParentNode(selectedNodes[i]),grid.AddNewRow(),grid.SelectRow(grid.get_Rows()-1,!0),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("Item"),value),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("FieldDisplayName"),text),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("FieldTitle"),text))}}function GetParentNode(n){var t=n.Text;return n.Parent!=null?GetParentNode(n.Parent)+"."+n.Text:t=n.Text}function DeleteRow(toGrid){var grid=eval(toGrid).control,rowIndex=grid.get_CurrentRowIndex(),columnIndex=grid.GetColumnIndex("IsFixed");(grid.GetCellValue(rowIndex,columnIndex)==null||grid.GetCellValue(rowIndex,columnIndex).Value!="true")&&grid.DeleteRowAlways()}function GetReportSelectedNodes(treeID,toGrid){for(var grid=eval(toGrid).control,tree=eval(treeID),selectedNodes=[],text,value,values,i=0;i<tree.AllNodes.length;i++)tree.AllNodes[i].Checked&&selectedNodes.push(tree.AllNodes[i]);if(text="",value="",selectedNodes!=0)for(i=0;i<selectedNodes.length;i++)(text=selectedNodes[i].Text,value=selectedNodes[i].Value,values=value.split("^^"),values.length>1&&values[1]=="catalog")||grid.ContainOf("Item",value)||(grid.AddNewRow(),grid.SelectRow(grid.get_Rows()-1,!0),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("Item"),value),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("FieldDisplayName"),text),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("FieldTitle"),text))}function ReportTreeAfterClientCheck(n){var i=!0,t;if(n.Checked==!1?(n.UnCheck(),i=!1):(n.Check(),i=!0),n.Nodes!=null)for(t=0;t<n.Nodes.length;t++)i==!0?n.Nodes[t].Checked==!1&&n.Nodes[t].Check():n.Nodes[t].Checked==!0&&n.Nodes[t].UnCheck(),n.Nodes[t].Nodes!=null&&ReportTreeAfterClientCheck(n.Nodes[t]);return}function GetRealUrl4Fav(n){var t=null,e,r,o,f,u,i;if(t=n?n:window.Location.href,e=document.getElementById("keyValues4Favorite"),e&&(r=document.getElementById("keyValues4Favorite").value,r))for(o=r.substr(0,r.length-1),f=o.split(";"),u=0;u<f.length;u++)favoriteKeyValue=f[u].split("="),i=IsContainKey(t,"\\?"+favoriteKeyValue[0]+"="),i<0&&(i=IsContainKey(t,"&"+favoriteKeyValue[0]+"=")),i>0?(i+=1,t=replaceValue(t,i,favoriteKeyValue[0].length+1,favoriteKeyValue[1])):t+="&"+favoriteKeyValue[0]+"="+favoriteKeyValue[1];return t}function RedirectToMe(n){window.location.href=n}function Redirect(n){window.setTimeout("RedirectToMe('"+n+"')",0)}function EndPage(){}function ShowAssociationDesigner(n,t){lockElement(!0);var i="dialogHeight:546px; dialogWidth: 984px; edge: Raised; center: Yes; help: No; resizable:Yes; status: No;scrollBars:Yes;";return t&&(window.btnRelatedControlID=t.name),n=AppendPopupUrl(n),ShowModalDialogForAll(n,"","500","984",!0,!1,window,undefined),!1}function openAbout(){ShowModalDialog("../ufsoft/About.aspx","",310,497,!0,!1)}function InitPage(func){var func=document.getElementById("BehaviorExcute").value,othersFunc=null,ele=document.getElementById("NeedInitControls"),funcs,j;if(ele&&(othersFunc=ele.value),func)for(funcs=func.split(":"),j=0;j<funcs.length;j++)if(funcs[j])try{eval(funcs[j]+"()")}catch(ee){}if(othersFunc)for(othersFunc=othersFunc.split(";"),j=0;j<othersFunc.length;j++)if(othersFunc[j])try{eval(othersFunc[j])}catch(ee){}}function SetFindBtnConfirm(n,t,i,r){var u=window.document.all(n+"_button");u||(u=window.document.all(n)),u&&u.length&&u.length>0&&(u=u[1]),u.onclick=onFindBtnClick,u.onclick_url=i,u.onclick_findBtnClientName=t,u.onclick_returnId=r}function onFindBtnClick(){FindButton_Confirm(this.onclick_url,this.onclick_findBtnClientName,this.onclick_returnId)}function FindButton_Confirm(url,findBtnName,returnId){window.ZlayerCallBackArray.push(function(n){var t=GetRecordId(n);t!=""&&(t!=""&&(window.document.getElementById(returnId).value=t),__doPostBack(findBtnName,""))}),eval(url)}function SetButtonConfirm(n,t,i){var r=window.document.all(n+"_button");r||(r=window.document.all(n)),r&&r.length&&r.length>0&&(r=r[1]),r.onclick=onToolbarButtonClick,r.onclick_url=i,r.onclick_btnClientName=t}function onToolbarButtonClick(){Button_Confirm(this.onclick_url,this.onclick_btnClientName)}function Button_Confirm(url,btnName){function checkValue(n){if(n!=""&&n!=undefined&&n!=""){if(caCheck(btnName)===!1)return!1;__doPostBack(btnName,"")}}var Ie=navigator.userAgent,ret=eval(url);ret==undefined?window.ZlayerCallBackArray.push(checkValue):checkValue(ret)}function SetDDBtn_PopUpMenu(n,t,i,r){var u=window.document.all(i);setTimeout(function(){SetDDBtn_PopUpMenuBind(n,u,i,r)},0)}function SetDDBtn_PopUpMenuBind(n,t,i,r){if(!t.control){setTimeout(function(){SetDDBtn_PopUpMenuBind(n,t,i,r)},0);return}t.control.add_BeforeMenuItemClick(function(){SetDDBtn_PopUpMenuConfirm(n,t,i,r)})}function SetDDBtn_PopUpMenuConfirm(url,popUpMenuID,menuClientID,index){var eventSource=popUpMenuID.control.eventSource,indexSource=eventSource.cusAttr("index"),Ie,ConfirmValue;(eventSource.cusAttr("index")&&eventSource.cusAttr("index").split(".").length>1&&(indexSource=eventSource.cusAttr("index").split(".")[1]),indexSource==index)&&(Ie=navigator.userAgent,ConfirmValue="",window.ZlayerCallBackArray.push(function(n){if(n==""||n==undefined){popUpMenuID.control.set_DeleteFlag(!1);return}if(n!=""){popUpMenuID.control.set_DeleteFlag(!0);return}}),eval(url))}function GetRecordId(n){var f,e="",r,t,o,u,i,s;try{for(f=XMLHelper.createXMLDocument(n),r=f.getElementsByTagName("ReferenceReturn"),t=0;t<r.length;t++){for(o=r[t],u=o.getElementsByTagName("ReturnField"),i=0;i<u.length;i++){s=u[i],e=s.getAttribute("value");break}break}}catch(h){}return e}function ResetLayout(n){document.getElementById("layoutInfor").value=n}function ResetArea(n){var r,t,i,u;if(document.getElementById("hiddenArea").value=n,n)for(r=n.split(";"),t=0;t<r.length;t++)i=r[t].split(":"),i.length==2&&i[0]&&(u=document.getElementById(i[0]),u&&(u.style.display="none"))}function ResetHiddenArea(n,t){var i=document.getElementById("hiddenArea").value;i+=n+":"+t+";",document.getElementById("hiddenArea").value=i}function layoutThis(n,t){n==0?t.style.backgroundColor="#eeeeee":n==1?t.style.backgroundColor="":n==2&&event.ctrlKey&&(ResetHiddenArea(t.id,t.style.pixelHeight),t.style.display="none",__doPostBack("","HideArea"))}function DoLayout(){var t=document.getElementById("layoutInfor").value,n;t&&(n=t.split("*"),n.length>=4&&n[0].trim()&&n[3]=="close"&&(n[0]=="outer"?outerLayout.close(n[1]):innerLayout.close(n[1])))}function initLayout(){outerLayout=$("body").layout({center__paneSelector:".outer-center",west__paneSelector:".outer-west",east__paneSelector:".outer-east",west__size:125,east__size:125,spacing_open:0,spacing_closed:0,center__onresize:"innerLayout.resizeAll"}),innerLayout=$("div.toppanel").layout({center__paneSelector:".inner-center",west__paneSelector:".inner-west",east__paneSelector:".inner-east",west__size:75,east__size:75,spacing_open:0,spacing_closed:0,west__spacing_closed:0,east__spacing_closed:0})}function EndRequestAction(){initLayout(),DoLayout()}function getSize(){return window.screen.width+":"+window.screen.height}function caCheck(n){var i=$("#_CAVerifyBtnClientIds_").val(),e;if(i){var t=0,r=0,u=0;if(!top.CA&&window.dialogArguments?(t=window.dialogArguments.top.CA,r=window.dialogArguments.top.CATip,u=window.dialogArguments.top.Math.uuid()):(t=top.CA,r=top.CATip,u=top.Math.uuid()),t&&(e=n.substring(14,n.length-5).replace(/\$/g,"_"),i&&i.indexOf(e)>-1)){if(t.enableCA(!0)===!1)return!1;if(t.status==1){var o=!1,s=u,f=t.sign(s),h=0;if(f.indexOf("signCode:")!=-1)h=f.replace("signCode:","");else return r.setText(f),!1;if($.ajax({type:"POST",url:"../mvc/Login/SignVerifyData?certSN="+t.getCertSN(),async:!1,data:{signId:s,caSignCode:h},success:function(n){o=n}}),o==="False")return t.tipMsg("USB Key签名校验失败！"),!1;$("#_CertSNField_").val(t.getCertSN())}else if(t.status==0)return!1}}}function _showCalendar(n){var i=n.parentElement.parentElement.getElementsByTagName("input")[0];i.disabled||(i.setAttribute("dropDown_mode","calendar"),_dropdown_btn_onmousedown(i),$Event(event).stopPropagation(),$Event(event).preventDefault())}function _showCalculator(n,t){var i=document.getElementById(t);i.setAttribute("dropDown_mode","calculator"),_dropdown_btn_onmousedown(i)}function _dropdown_btn_onmousedown(n){isDropdownBoxVisible()?hideDropDownBox():n&&showDropDownBox(n)}function isChild(n,t){var i=n,r=!1;if(t)while(i){if(i==t){r=!0;break}i=i.parentElement}return r}function onPropertyChanged(){var t=_dropdown_box,n,i;if(typeof t=="undefined"||t==null||(n=document.activeElement,typeof n=="undefined"||n==null))return 1;i=isChild(n,t),i||n==t.editor||hideDropDownBox()}function isDropdownBoxVisible(){return typeof _dropdown_box!="undefined"&&_dropdown_box?_dropdown_box.style.visibility=="visible":!1}function showDropDownBox(_editor){var dropDown_mode,i;try{if(!isDropdownBoxVisible()){getDropDownBox(_editor);with(_dropdown_box){if(style.overflowY="hidden",setAttribute("editor",_editor),filters.blendTrans.status!=2&&(getIEVersion()<"5.5"||filters.blendTrans.apply(),style.visibility="visible"),_dropdown_box.cached){if(getIEVersion()<"5.5")for(i=0;i<_dropdown_box.children.length;i++)_dropdown_box.children[i].style.visibility="visible"}else{dropDown_mode=_editor.getAttribute("dropDown_mode");switch(dropDown_mode){case"calendar":createCalendar(_dropdown_box),_dropdown_box.onkeydown=_calendar_onkeydown;break;case"calculator":createCalculator(_dropdown_box);break;case"combox":createCombox(_dropdown_box)}}initDropDownBox()}}}catch(n){processException(n)}}function dropDownLocate(){var i=_dropdown_parentbox.editor,n=i.value,t;n=disFormatDate(n),t=new Date(n),isNaN(t)||setCalendarDate(t)}function getDropDownBox(){_dropdown_box=_date_dropdown_box,_dropdown_box||(_dropdown_box=document.createElement('<DIV style=" background-color: white; padding: 0px; overflow-X: hidden; position: absolute; visibility: hidden; filter: blendTrans(duration=0.3); z-index: 10000"><\/DIV>'),document.body.appendChild(_dropdown_box))}function initDropDownBox(){var editor,dropDown_mode,temp,i,tmp,a,b;_dropdown_parentwindow=window,_dropdown_parentbox=_dropdown_parentwindow._dropdown_box,_dropdown_parentwindow._dropdown_window=window,sizeDropDownBox(),getIEVersion()>="5.5"&&_dropdown_parentbox.filters.blendTrans.status!=2&&_dropdown_parentbox.filters.blendTrans.play(),editor=_dropdown_parentbox.editor,editor.focus(),dropDown_mode=editor.getAttribute("dropDown_mode");switch(dropDown_mode){case"calendar":_calender_year.focus(),editor&&dropDownLocate();break;case"calculator":calculator_display.focus(),temp=getValidStr(editor.value),temp==""&&(temp=0),_calculator_setDisplay(temp);break;case"combox":var cmb=_dropdown_parentbox.firstChild,cmbid=cmb.id.substring(0,cmb.id.indexOf("table")-1),para=eval(cmbid+"_para"),h=document.all(para[9]),t=cmb,sels=para[6],len1=sels.length;for(i=0;i<len1;i++)tmp=sels[i];h.value.length>0?para[2]!=null?(a=para[2].parentElement.rowIndex,b=para[2].cellIndex,para[2]=t.rows[a].cells[1],para[2].focus(),para[0]!=null&&(para[0]=t.rows[para[0].rowIndex]),para[1]!=null&&(para[1]=t.rows[para[1].rowIndex])):(sels[0].cells[1].focus(),selectcmbfirst(sels[0].cells[1],cmb,para,cmbid)):(para[0]=t.rows[0],para[1]=t.rows[0],t.rows.length>0&&(para[2]=t.rows[0].cells[1],t.rows[0].cells[1].focus(),selectcmbfirst(t.rows[0].cells[1],cmb,para,cmbid)))}}function getAbsPosition(n){var i=0,r=0;do i+=n.offsetTop||0,r+=n.offsetLeft||0,n=n.offsetParent;while(n);return[r,i]}function getStyle(n,t){var i=n.style[t],r;return i||(document.defaultView&&document.defaultView.getComputedStyle?(r=document.defaultView.getComputedStyle(n,null),i=r?r.getPropertyValue(t):null):n.currentStyle&&(i=n.currentStyle[t])),window.opera&&["left","top","right","bottom"].include(t)&&getStyle(n,"position")=="static"&&(i="auto"),i=="auto"?null:i}function sizeDropDownBox(){function r(new_width,new_height){var editor,maxHeight,document_width,document_height;with(_dropdown_box){editor=_dropdown_box.editor,maxHeight=parseInt(editor.getAttribute("dropdown_height")),(isNaN(maxHeight)||maxHeight<20)&&(maxHeight=220);var pos=getAbsPosition(editor,document.body),_posLeft=pos[0],_posTop=pos[1]+editor.offsetHeight+1;document.body.offsetHeight>0&&_posTop+new_height>document.body.offsetHeight&&(_posTop=document.body.offsetHeight-new_height-editor.offsetHeight-2),new_height>maxHeight?(new_height=maxHeight,new_width+=16,style.overflowY=getIEVersion()<"5.5"?"visible":"scroll"):style.overflowY="hidden",document_width=document.body.clientWidth+document.body.scrollLeft,document_height=document.body.clientHeight+document.body.scrollTop,_posLeft+new_width>document_width&&document_width>new_width&&(_posLeft=document_width-new_width-10),_posTop+new_height>document_height&&pos[1]>new_height&&(_posTop=pos[1]-new_height-1),style.posLeft=_posLeft,style.posTop=_posTop,style.posHeight=new_height+4,new_width>style.posWidth&&(style.posWidth=new_width),style.borderWidth="2px"}}try{var n,t,i=_dropdown_box.firstChild;switch(_dropdown_box.getAttribute("dropDown_mode")){case"calendar":n=CalendarTable.offsetWidth,t=CalendarTable.offsetHeight;break;case"calculator":n=CalculatorTable.offsetWidth,t=CalculatorTable.offsetHeight;break;default:n=i.offsetWidth,t=i.offsetHeight}r(n,t)}catch(u){}}function hideDropDown(){var n=_dropdown_parentbox.editor;_dropdown_parentwindow.hideDropDownBox(),n.focus()}function hideDropDownBox(){var n,t;if(_dropdown_box&&isDropdownBoxVisible()){if(_skip_activeChanged=!0,n=_dropdown_box.editor,_dropdown_box.editor=null,n.cached_dropdownbox=null,_dropdown_window=null,getIEVersion()<"5.5")for(t=0;t<_dropdown_box.children.length;t++)_dropdown_box.children[t].style.visibility="hidden";_dropdown_box.style.visibility="hidden",_dropdown_box.removeNode(!0),_dropdown_box=null,n.dropDown_visible=!1,typeof _dropdown_btn!="undefined"&&(_dropdown_btn.value="6"),n.focus()}}function dropDownSelected(){var n=_dropdown_parentbox.editor,t,u=n.getAttribute("dropDown_mode"),i,r;switch(u){case"calendar":i=n.getAttribute("dateType"),t=formatDateTime(new Date(_calendarControl.year,_calendarControl.month,_calendarControl.day),i);break;case"calculator":t=_calculator_getResult()}n.value=t,r=n.getAttribute("autopostback")=="True",r&&__doPostBack(n.id,""),hideDropDownBox()}function getIEVersion(){var n=window.clientInformation.userAgent.indexOf("MSIE");return n<0?"":window.clientInformation.userAgent.substring(n+5,n+8)}function processException(n){switch(typeof n){case"string":n!="abort"&&(n?alert(n):alert(constErrUnknown));break;case"object":alert(n.description+"\n"+constErrType+":"+(n.number&65535))}}function compareText(n,t){return(n=getValidStr(n),t=getValidStr(t),n==t)?!0:n==""||t==""?!1:n.toLowerCase()==t.toLowerCase()}function isTrue(n){return n==!0||typeof n=="number"&&n!=0||compareText(n,"true")||compareText(n,"T")||compareText(n,"yes")||compareText(n,"on")}function getValidStr(n){return n+="",n=="undefined"||n=="null"?"":n}function getInt(n){var t=parseInt(n);return isNaN(t)&&(t=0),t}function InitPage(func){var func,tempInput,funcAssHandler,ele,funcs,othersFunc,funcAssHandlers,j,_onRowChanged;if($("[ICK]").each(function(n,t){var i="UF.UI."+t.getAttribute("ICK"),r=t.getAttribute("id"),u=new Function("return "+i)();Init(r,u)}),tempInput=document.getElementById("BehaviorExcute"),tempInput!=null&&(func=tempInput.value),funcAssHandler="",document.getElementById("FixupEventHandler")!=null&&(funcAssHandler=document.getElementById("FixupEventHandler").value),othersFunc=null,ele=document.getElementById("NeedInitControls"),ele&&(othersFunc=ele.value),func)for(funcs=func.split(":"),j=0;j<funcs.length;j++)if(funcs[j])try{eval(funcs[j]+"()")}catch(ee){}if(othersFunc)for(othersFunc=othersFunc.split(";"),j=0;j<othersFunc.length;j++)if(othersFunc[j])try{eval(othersFunc[j])}catch(ee){}if(funcAssHandler)for(funcAssHandlers=funcAssHandler.split(":"),j=0;j<funcAssHandlers.length;j++)if(funcAssHandlers[j])try{eval(funcAssHandlers[j]+"()")}catch(ee){}_onRowChanged=document.getElementById("_onRowChanged"),_onRowChanged&&eval(_onRowChanged.value)}function GetTablesCells(n){for(var i,r=[],t=0;t<n.rows.length;t++)for(i=0;i<n.rows[t].cells.length;i++)r.push(n.rows[t].cells[i]);return r}function CallbackEventLauncher(ClientId){var reParam="",eSource=getCallbackObject(ClientId,"launcher"),id=eSource.Id,clientId=eSource.ClientId,dataStr,ex,ret;reParam=reParam+id+ColDivstring,reParam=reParam+clientId+ColDivstring,reParam=reParam+eSource.Type+ColDivstring,reParam=reParam+eSource.eleNum+ColDivstring,reParam=reParam+eSource.DataRow+ColDivstring+RowDivstring;var srcControl=getCallbackObject(ClientId,"sourcer"),srcIds=srcControl.SrcIds,srcClientIds=srcControl.SrcClientIds,srcTypes=srcControl.SrcTypes;reParam=reParam+getArrayContact(srcIds,ColDivstring)+RowDivstring,reParam=reParam+getArrayContact(srcClientIds,ColDivstring)+RowDivstring,reParam=reParam+getArrayContact(srcTypes,ColDivstring)+RowDivstring,dataStr=getControlsValue(srcClientIds,srcTypes,ColDivstring,RowDivstring),reParam=reParam+dataStr,ex=srcControl.Methods[0],ret=eval(ex),CallbackHandler(reParam,ClientId)}function getXXXXX(n){var t=new Array(2);return t[0]=n,t[1]="ssswwww",t}function CallbackResponseProcess(n,t){for(var f=getCallbackObject(t,"targeteer"),y=f.SrcIds,e=f.SrcClientIds,o=f.SrcTypes,i=n,a=ColDivstring.length,v=RowDivstring.length,u,s,h,c,l,r=0;r<4;r++)i=i.substr(i.indexOf(RowDivstring)+v);if(i=i.substr(0,i.indexOf(RowDivstring)),u=e.length,!(u<=0)){for(r=0;r<u-1;r++)s=document.getElementById(e[r]),h=i.substr(0,i.indexOf(ColDivstring)),i=i.substr(i.indexOf(ColDivstring)+a),o[r]=="TextBox"&&(s.value=h);c=document.getElementById(e[u-1]),l=i.substr(0,i.indexOf(ColDivstring)),o[u-1]=="TextBox"&&(c.value=l)}}function getCallbackObject(n,t){var u=null,r,i;if(t=="launcher"){if(r=CallbackLaunchArray.length,r==0)return u;for(i=0;i<r;i++)if(CallbackLaunchArray[i].ClientId==n){u=CallbackLaunchArray[i];break}}else if(t=="sourcer"){if(r=CallbackSourceArray.length,r==0)return u;for(i=0;i<r;i++)if(CallbackSourceArray[i].ClientId==n){u=CallbackSourceArray[i];break}}else{if(r=CallbackTargetArray.length,r==0)return u;for(i=0;i<r;i++)if(CallbackTargetArray[i].ClientId==n){u=CallbackTargetArray[i];break}}return u}function getArrayContact(n,t){for(var r="",u=n.length,i=0;i<u;i++)r=r+n[i]+t;return r}function getControlsValue(n,t,i,r){for(var u="",o=n.length,e,f=0;f<o;f++)e=document.getElementById(n[f]),t[f]=="TextBox"&&(u=u+e.value+i);return u=u+r}function LaunchRegister(n,t,i,r,u){this.Id=n,this.ClientId=t,this.Type=i,this.eleNum=r,this.DataRow=u}function SourceRegister(n,t){this.Id=n,this.ClientId=t,this.SrcIds=[],this.SrcClientIds=[],this.SrcTypes=[],this.Methods=[]}function TargetRegister(n,t){this.Id=n,this.ClientId=t,this.SrcIds=[],this.SrcClientIds=[],this.SrcTypes=[],this.Methods=[]}function AddLaunchRegister(n,t,i,r,u){CallbackLaunchArray[CallbackLaunchArray.length]=new LaunchRegister(n,t,i,r,u)}function ParseString(n,t){var f=ColDivstring.length,i=n,u=new Array(t),r;if(n==null||t<=0)return null;for(r=0;r<t-1;r++)u[r]=i.substr(0,i.indexOf(ColDivstring)),i=i.substr(i.indexOf(ColDivstring)+f);return u[t-1]=i.substr(0,i.indexOf(ColDivstring)),u}function AddControlsRegister(n,t,i,r,u,f){var s=RowDivstring.length,v=ColDivstring.length,e=i,h,c,l,a,o;r=="sourcer"?CallbackSourceArray[CallbackSourceArray.length]=new SourceRegister(n,t):CallbackTargetArray[CallbackTargetArray.length]=new TargetRegister(n,t),o=getCallbackObject(t,r),h=ParseString(e.substr(0,e.indexOf(RowDivstring)),f),e=e.substr(e.indexOf(RowDivstring)+s),o.SrcIds=h,c=ParseString(e.substr(0,e.indexOf(RowDivstring)),f),e=e.substr(e.indexOf(RowDivstring)+s),o.SrcClientIds=c,l=ParseString(e.substr(0,e.indexOf(RowDivstring)),f),o.SrcTypes=l,a=ParseString(u,f),o.Methods=a}function $OpenCalAlert(n){isCalAlert=n}function PDCallBackHandler_Light(customerOper){if(_xmlhttpRequest&&_xmlhttpRequest.readyState==4&&(_xmlhttpRequest.statusText=="OK"||_xmlhttpRequest.status==200)){var result=_xmlhttpRequest.responseText;EvalFunction(result),customerOper&&customerOper.length>0&&eval(customerOper)}}function PDCallBackHandler_Normal(result,context){EvalFunction(result),context&&context.length>1&&eval(context)}function CallPDServerCallBack(n,t,i,r,u,f,e,o){if(_ClientCallBackManager.StartCallBack()){var c=$get("__EVENTTARGET"),l="";c&&(l=c.value,c.value=""),WebForm_InitCallback&&(__theFormPostData&&__theFormPostData!=""||WebForm_InitCallback()),WebForm_DoCallback(o,n,PDCallBackHandler_Normal,f,null,!0),c&&(c.value=l)}}function getStatusString(n,t,i,r,u,f,e){for(var c=n.split(","),l={},v=e.lastIndexOf("$"),y=e.substring(0,v),p=/\$/g,w=y.replace(p,"_"),o,h,a,s=0;s<c.length;++s)try{if(o=c[s],o.indexOf("_ALL_GRIDDATA")<0&&$find(o)==null)continue;if(o.indexOf("_ALL_GRIDDATA")>0&&$find(o.substring(0,o.indexOf("_ALL_GRIDDATA")))==null)continue;o.indexOf("_ALL_GRIDDATA")>=0&&(h=o.substring(0,o.indexOf("_ALL_GRIDDATA")),a=$find(h),l[h]=a.getFocusInfo())}catch(b){}return l}function createQueryString(n,t,i,r,u,f,e,o,s,h){for(var v="__&URS3&_",g=n.split(","),c="SrcColIndex="+t+v+"SrcRowIndex="+i+v,it=e.lastIndexOf("$"),rt=e.substring(0,it),ut=/\$/g,nt=rt.replace(ut,"_"),a,l,i,tt,y,d,w,k=0;k<g.length;++k)try{if(a=g[k],a.indexOf("_ALL_TOTALPAGE")>0){c="TotalPage";continue}if(a.indexOf("_ALL_GRIDDATA")<0&&$find(a)==null)continue;if(a.indexOf("_ALL_GRIDDATA")>0&&$find(a.substring(0,a.indexOf("_ALL_GRIDDATA")))==null)continue;if(c+=a,c+="=",a.indexOf("_ALL_GRIDDATA")>=0){var y=a.substring(0,a.indexOf("_ALL_GRIDDATA")),p=$find(y),ft=p.getFocusInfo();h!==undefined&&h[y]!==undefined&&p.setFocusInfo(h[y]),c+=f?p.get_SelectedData():p.get_AllData(),p.setFocusInfo(ft)}else{if(l=$find(a),l==null)continue;if(a==nt||l.get_element().cusAttr("GridCltID4P")==null||l.get_element().cusAttr("ColFldID4P")==null)r.indexOf(a+",")>=0?(c+=l.get_Key(),c+=v+a+"_Value="+l.get_Value(),c+=v+a+"_Text="+l.get_Text()):c+=l.get_Type()==ControlType.DateTime?l.get_TextFromInput():l.get_Type()==ControlType.DropDownButton?l.get_SelectedMenuItemText():l.get_Value(),a==nt&&l.get_element().cusAttr("GridCltID4P")!=null&&l.get_element().cusAttr("ColFldID4P")!=""&&(y=l.get_element().cusAttr("GridCltID4P"),$find(y)&&(c+=v+y+"_ALL_GRIDDATA="+$find(y).get_AllData(),i=$find(y).get_CurrentRowIndex(),c.indexOf("SrcRowIndex=undefined")>=0&&(c=c.replace("SrcRowIndex=undefined","SrcRowIndex="+i)),c.indexOf("SrcColIndex=undefined")>=0&&(tt=$find(y).GetPersonelColumnIndexById(a),c=c.replace("SrcColIndex=undefined","SrcColIndex="+tt)),Set_GridCurrentRowIndex4PIsValid(!0),Set_GridCurrentRowIndex4P(i)));else if(y=l.get_element().cusAttr("GridCltID4P"),d=l.get_element().cusAttr("ColFldID4P"),y!=null&&d!=null)if(w=$find(y),w==null)r.indexOf(a+",")>=0?(c+=l.get_Key(),c+=v+a+"_Value="+l.get_Value(),c+=v+a+"_Text="+l.get_Text()):c+=l.get_Type()==ControlType.DateTime?l.get_TextFromInput():l.get_Type()==ControlType.DropDownButton?l.get_SelectedMenuItemText():l.get_Value();else if(l.get_element().parentElement.className=="tbc")r.indexOf(a+",")>=0?(c+=l.get_Key(),c+=v+a+"_Value="+l.get_Value(),c+=v+a+"_Text="+l.get_Text()):c+=l.get_Type()==ControlType.DateTime?l.get_TextFromInput():l.get_Type()==ControlType.DropDownButton?l.get_SelectedMenuItemText():l.get_Value();else{var i=w.get_CurrentRowIndex(),t=w.GetColumnIndex(d),b=w.GetCellValue(i,t);b&&(r.indexOf(a+",")>=0?(c+=b.Value,c+=v+a+"_Value="+b.Code,c+=v+a+"_Text="+b.Text):c+=b.Value)}}c+=v}catch(et){}return c}function GetSysParameters(){var t="EffectiveLanguageCount="+$get("EffectiveLanguageCount").value;return t+="&CustomerID="+$get("CustomerID").value,t+="&All_Languages="+$get("All_Languages").value,t+="&__curOId="+$get("__curOId").value,t+="&PAGETOKEN="+$get("PAGETOKEN").value,t+="&SessionID="+$get("SessionID").value,t+="&CultureName="+$get("CultureName").value,t+="&OperatingOrg_ID="+$get("OperatingOrg_ID").value,t+="&OrgCode="+$get("OrgCode").value,t+="&EnterpriseID="+$get("EnterpriseID").value,t+="&OrgID="+$get("OrgID").value,t+="&UserName="+$get("UserName").value,t+="&CurrentPage="+$get("CurrentPage").value,t+="&_Key4Protal="+$get("_Key4Protal").value,t+="&SupplierID="+$get("SupplierID").value,t+="&PortalID="+$get("PortalID").value,t+="&UserID="+$get("UserID").value,t+="&OrgName="+$get("OrgName").value,t+="&UserCode="+$get("UserCode").value,t+="&_SearchSessionID="+$get("_SearchSessionID").value,t+="&EnterpriseName="+$get("EnterpriseName").value,t+="&LoginOrg_ID="+$get("LoginOrg_ID").value,t+="&__WPPS="+$get("__WPPS").value}function CallServerPage(arg,CallbackComplete,ctx,srcId,taskIdHF,isAsync){var eventSourveClientID=null,splitter="__&URS3&_",ids,baseUrl,url,taskIns;(arg!=null&&arg.split(splitter).length>=3&&(ids=arg.split(splitter),eventSourveClientID=ids[2].indexOf("_ALL_GRIDDATA")>0?ids[2].substring(0,ids[2].indexOf("_ALL_GRIDDATA")):ids[2].substring(0,ids[2].indexOf("="))),baseUrl=window.location.href,url="ClientCallBack=Y",eventSourveClientID!=null)&&(url+="&EventSourceClientID="+srcId,url+="&UBF_ClientParams="+encodeURIComponent(arg),taskIns=$get(taskIdHF),taskIns&&(url+="&"+taskIdHF+"="+encodeURIComponent(taskIns.value)),baseUrl.indexOf("&__sk=")<0&&(url+="&__sk="+encodeURIComponent($get("__sk").value)),isAsync=isAsync?!0:!1,_xmlhttpRequest||InitXmlHttpRequest(),_xmlhttpRequest&&(url.length>2e3?(_xmlhttpRequest.open("POST",baseUrl,isAsync),_xmlhttpRequest.onreadystatechange=eval(CallbackComplete),_xmlhttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),url+="&"+GetSysParameters(taskIdHF),_xmlhttpRequest.send(url)):(url=baseUrl+"&"+url,_xmlhttpRequest.open("GET",url,isAsync),_xmlhttpRequest.onreadystatechange=eval(CallbackComplete),_xmlhttpRequest.send(null))))}function InitXmlHttpRequest(){this._xmlhttpRequest||(window.XMLHttpRequest?this._xmlhttpRequest=new XMLHttpRequest:this.get_element().document.all&&(this._xmlhttpRequest=new ActiveXObject("Msxml2.XMLHTTP")))}function $SetControlAttribute(n){var t,i;if(n&&n.length>0)for(t=0;t<n.length;t++)i=n[t],$find(i[0])&&$find(i[0]).SetControlAttribute(i[1])}function $ExeScripts4Personalized(assertControls,callBackSrcControl,scripts){var needPost=!1,cArr,i;if(assertControls)for(cArr=assertControls.split(","),i=0;i<cArr.length;i++)if(!$find(cArr[i])){needPost=!0;break}scripts&&(scripts.indexOf("\r\n")>-1&&(scripts=scripts.replace(/\r\n/g,"")),needPost?(Global_JSQueueEvalAfterPageLoadedManager.Add(scripts,!0),Global_JSQueueEvalAfterPageLoadedManager.Add('$alert("请确保'+callBackSrcControl+"的AssocRelatedControls集合中包含以下控件："+assertControls+'");',!0),__doPostBack(Get_BtnRePostBackWithDoNothingID(),callBackSrcControl)):eval(scripts))}function ClientJSExecQueueManager(){this.Count=0,this.Running=!1,this.Handlers=[],this.FirstHandlers=[],this.RunAfterPageLoad=!1,ClientJSExecQueueManager.prototype.Push=function(n,t){var i={};i.js=n,i.name=t,this.Handlers.push(i),this.Count++,this.RunAfterPageLoad=!0},ClientJSExecQueueManager.prototype.Unshift=function(n,t){var i={};i.js=n,i.name=t,this.Handlers.unshift(i),this.Count++,this.RunAfterPageLoad=!0},ClientJSExecQueueManager.prototype.AddToFirstQuery=function(n,t){var i={};i.js=n,i.name=t,this.FirstHandlers.push(i),this.Count++,this.RunAfterPageLoad=!0},ClientJSExecQueueManager.prototype.Add=function(n,t){var i={};i.js=n,i.name=t,this.Handlers.push(i),this.Count++,this.Start()},ClientJSExecQueueManager.prototype.Start=function(){if((!(this.Handlers.length<=0)||!(this.FirstHandlers.length<=0))&&!this.Running&&(!_ClientPostBackManager||!_ClientPostBackManager.Runing)&&(!_ClientCallBackManager||!_ClientCallBackManager.Runing)&&!window.AfterZlayerJsQueue){var t=this.FirstHandlers.length>0?this.FirstHandlers.shift():this.Handlers.shift(),n=t.js;this.Count--,this.Running=!0,n+=';_ClientJSExecQueueManager.Running=false;window.setTimeout("if(_ClientJSExecQueueManager)_ClientJSExecQueueManager.Start();",0);',window.setTimeout(n,0)}},ClientJSExecQueueManager.prototype.Clear=function(n){var i,t;if(this.Count=0,this.FirstHandlers=[],n)for(i=this.Handlers.length,t=i-1;t>=0;t--)Array.removeAt(this.Handlers,t);else if(this.Handlers.length>0)for(t=0;t<this.Handlers.length;t++)this.Handlers.shift()},ClientJSExecQueueManager.prototype.ClearAll=function(){this.Count=0,this.FirstHandlers=[],this.Handlers=[]}}function ClientPostBackManager(){this.Runing=!1,this.SrcElement=[],this.SrcElementArgument=[],this.MenuIndex=[],this.LastPostElement,this.prm,this.Count=0,this.FirstIsActionButton=!1,this.BtnActionAlreadyFire=!1,this.IsAbortPostBack=!1,this.BtnElement=null,this.MemoryAction=[],this.MemoryActionArgs=[];var n=this;this.DirtyDataDelayEventArray=[],this.RedictURLAfterAllPostBack=undefined,this.CallAfterAllPostBack=undefined,this.PopMenuHiddenValues=[],this.PersonalProcessQueue=[],this.DoPostBackcompleted=null,ClientPostBackManager.prototype.onInitRequest=function(n,t){var r,u,f,i;if(_ClientCallBackManager.Runing==!0){_ClientCallBackManager.StopPost==!1&&(_ClientCallBackManager.StopPost=!0),r=_ClientPostBackManager.SrcElement.length,_ClientPostBackManager.SrcElement[r]=theForm.__EVENTTARGET.value,_ClientPostBackManager.SrcElementArgument[r]=theForm.__EVENTARGUMENT.value,u=$find(theForm.__EVENTTARGET.value),u&&u.get_Type()==ControlType.Menu&&(_ClientPostBackManager.MenuIndex==null&&(_ClientPostBackManager.MenuIndex=[]),_ClientPostBackManager.MenuIndex[r]=$find(theForm.__EVENTTARGET.value)._hidden.value),$(t.get_postBackElement()).hasClass("main_Span")&&(i=$find(t.get_postBackElement().id),i!=null&&(i.IsThisGirdPosting=!1,i._isDataCollected=!1)),t.set_cancel(!0);return}if(_ClientPostBackManager.Runing)Array.add(_ClientPostBackManager.MemoryAction,t.get_postBackElement().id),Array.add(_ClientPostBackManager.MemoryActionArgs,theForm.__EVENTARGUMENT.value),_ClientPostBackManager.IsAbortPostBack=!0,$(t.get_postBackElement()).hasClass("main_Span")&&($find(t.get_postBackElement().id).IsThisGirdPosting=!1),t.set_cancel(!0),lockElement(!1);else if(f=Get_BtnRePostBackWithDoNothingID().replace(/\$/g,"_"),_ClientPostBackManager.LastPostElement!=t.get_postBackElement().id||$(t.get_postBackElement()).hasClass("main_Span")){if((t.get_postBackElement().className=="TBI"||t.get_postBackElement().className=="DDBO"||t.get_postBackElement().tagName=="SPAN"||t.get_postBackElement().className.containsCssClass("TC tPn"))&&window._GridWillPostBack==!0){window._GridWillPostBack=!1,Array.add(_ClientPostBackManager.MemoryAction,t.get_postBackElement().id),Array.add(_ClientPostBackManager.MemoryActionArgs,t.get_postBackElement().id),_ClientPostBackManager.IsAbortPostBack=!0,t.set_cancel(!0),lockElement(!1),_ClientPostBackManager.BtnActionAlreadyFire=!0,_ClientPostBackManager.BtnElement=t.get_postBackElement().id;return}$(t.get_postBackElement()).hasClass("main_Span")&&(window._GridWillPostBack=!1),_ClientPostBackManager.Runing=!0,Set_Global_WillDoPostBack(!1),_ClientPostBackManager.LastPostElement=t.get_postBackElement().id}else $(t.get_postBackElement()).hasClass("main_Span")&&(i=$find(t.get_postBackElement().id),i!=null&&(i.IsThisGirdPosting=!1,i._isDataCollected=!1)),t.set_cancel(!0),_ClientPostBackManager.LastPostElement=null,lockElement(!1)},ClientPostBackManager.prototype.onBeginRequest=function(){window._TextBoxFirePostBack==!0?(window._CancelWaitSpanSetTimeOutHandler=!1,window.setTimeout(function(){window._CancelWaitSpanSetTimeOutHandler||lockElement(!0)},50),window._TextBoxFirePostBack=!1):lockElement(!0)},ClientPostBackManager.prototype.onEndRequest=function(n,t){var i=!1,r,u,f;_ClientPostBackManager.Runing=!1,_ClientPostBackManager.IsAbortPostBack?(r=/_/g,_ClientPostBackManager.MemoryAction.length>0?(u=_ClientPostBackManager.MemoryAction[0],f=_ClientPostBackManager.MemoryActionArgs[0],Array.removeAt(_ClientPostBackManager.MemoryAction,0),Array.removeAt(_ClientPostBackManager.MemoryActionArgs,0),Global_JSQueueEvalAfterPageLoadedManager.Eval__doPostBack="__doPostBack('"+u.replace(r,"$")+"','"+f+"');"):(_ClientPostBackManager.IsAbortPostBack=!1,_ClientPostBackManager.LastPostElement==_ClientPostBackManager.BtnElement&&(_ClientPostBackManager.BtnActionAlreadyFire=!1,lockElement(!1),i=!0),_ClientPostBackManager.LastPostElement=null,_ClientPostBackManager.BtnActionAlreadyFire==!0&&(_ClientPostBackManager.BtnActionAlreadyFire=!1,Global_JSQueueEvalAfterPageLoadedManager.Eval__doPostBack="__doPostBack('"+_ClientPostBackManager.BtnElement.replace(r,"$")+"','');"))):(_ClientPostBackManager.LastPostElement=null,lockElement(!1),i=!0),_ClientPostBackManager.LastPostElement=null,window._CancelWaitSpanSetTimeOutHandler=!0,lockElement(!1),_ClientPostBackManager.afterEndRequest(n,t),Get_Global_NeedResetCheckDirtyTagWhenEnd()&&(Set_Global_IsCheckDirtyData_TheForm(!0),Set_Global_NeedResetCheckDirtyTagWhenEnd(!1)),i&&_ClientPostBackManager.afterAllPostBackFired()},ClientPostBackManager.prototype.afterEndRequest=function(){var u,r,e,f,o;if(Get_Global_DirtyDataSaveSuccessFlag()=="Success"||Get_Global_DirtyDataCancelSuccessFlag()=="Success")if(Get_Global_DirtyDataSaveSuccessFlag()=="Success"&&Set_Global_DirtyDataSaveSuccessFlag(null),Get_Global_DirtyDataCancelSuccessFlag()=="Success"&&Set_Global_DirtyDataCancelSuccessFlag(null),Set_Global_IsDirtyData_TheForm(!1),n.DirtyDataDelayEventArray.length>0){for(u=n.DirtyDataDelayEventArray[0],Array.removeAt(n.DirtyDataDelayEventArray,0),r=0,e=n.PopMenuHiddenValues.length;r<e;r++)if(n.PopMenuHiddenValues[r].id==u&&(f=$ID(n.PopMenuHiddenValues[r].id),f!=null)){$ID(f.HelpId).value=n.PopMenuHiddenValues[r]._hiddenvalue;break}o=/_/g,__doPostBack(u.replace(o,"$"),"")}else _ClientPostBackManager.RedictURLAfterAllPostBack!=undefined?window.location.href=_ClientPostBackManager.RedictURLAfterAllPostBack:_ClientPostBackManager.CallAfterAllPostBack!=undefined&&_ClientPostBackManager.CallAfterAllPostBack();_ClientPostBackManager.RedictURLAfterAllPostBack=undefined},ClientPostBackManager.prototype.get_DoPostBackcompleted=function(){return this.DoPostBackcompleted},ClientPostBackManager.prototype.set_DoPostBackcompleted=function(n){this.DoPostBackcompleted=n==null?null:n.toString().toLowerCase()=="true"?!0:!1},ClientPostBackManager.prototype.Add2PersonalProcessQueue=function(n){if(_ClientPostBackManager.Runing){var t=this.PersonalProcessQueue.length;t>0?this.PersonalProcessQueue[t-1]!=n&&this.PersonalProcessQueue.push(n):this.PersonalProcessQueue.push(n)}},ClientPostBackManager.prototype.EvalPersonalProcessQueue=function(){while(this.PersonalProcessQueue.length>0){var jsEval=this.PersonalProcessQueue.shift();eval(jsEval)}},ClientPostBackManager.prototype.afterAllPostBackFired=function(){this.EvalPersonalProcessQueue(),_ClientJSExecQueueManager.Start()}}function OnBeforeWindowUnload(){var t=document.location.href,n,i;if(t.match(/\/simple.aspx/g)!=null){if(window._dialogUIModelRemoved)return;n=$("input[name*='TASKID_HIDDENFIELD']"),i=n.attr("name"),window&&window.dialogArguments&&(window.dialogArguments.clearUIState=t+"&ClearUIStateByKey="+n.val())}}function DialogUIModelRemoved(){window&&window.dialogArguments&&(window._dialogUIModelRemoved=!0,window.dialogArguments.clearUIState=null)}function ClientCallBackManager(){function n(evalString,args){_ClientCallBackManager.Args=args,eval(evalString)}this.StopPost=!1,this.RunPost=!1,this.Runing=!1,this.Handlers=[],this.Args=null,this.Index=-1,this.PersonalProcessQueue=[],ClientCallBackManager.prototype.StartCallBack=function(){return _ClientPostBackManager.Runing?!1:!0},ClientCallBackManager.prototype.Push=function(handler){var callBack={};callBack.originalHandler=handler,callBack.handler=handler.replace(/CallPDServerCallBack\(/g,"CallPDServerCallBack(_ClientCallBackManager.Args,"),callBack.status=eval(callBack.originalHandler.replace(/CallPDServerCallBack/g,"getStatusString")),this.Handlers.push(callBack),this.CanRun=!0,this.Start()},ClientCallBackManager.prototype.Start=function(isCallBackComplete){var result,tmp,handler,execString,arg,ele,execBody;(Global_Debugger4P,(this.Runing||_ClientPostBackManager.Runing)&&(this.Runing!=!1||this.Handlers.length!=0||isCallBackComplete!=!0))||(result=!1,tmp=this.Handlers.shift(),tmp&&(handler=tmp.handler,this.status=tmp.status?tmp.status:undefined,execString=tmp.originalHandler.replace(/CallPDServerCallBack/g,"createQueryString"),execString=execString.substring(0,execString.length-1),execString+=",_ClientCallBackManager.status)",arg=eval(execString),this.Args=arg,handler&&handler.trim()!=""&&(this.Runing=!0,_LoadingSpan==null&&(_LoadingSpan=document.getElementById("spWait")),ele=_LoadingSpan,ele&&(ele.className="WaitSpanClass4CallBack"),JavaScriptDebugTool.LogCallBackData&&($alert(""),$alert("CallBack Start："),$alert(handler)),execBody=function(){return function(){n(handler,arg)}}(),window.setTimeout(execBody,0))),this.Handlers.length==0&&(this.CanRun=!1,this.Runing==!1&&(Global_Debugger4P,_ClientCallBackManager.afterAllCallBackFired())))},ClientCallBackManager.prototype.ShowMSG=function(){},ClientCallBackManager.prototype.Clear=function(){if(this.Handlers.length>0)for(var n=0;n<this.Handlers.length;n++)this.Handlers.shift()},ClientCallBackManager.prototype.Add2PersonalProcessQueue=function(n,t){if(t!=!0)this.PersonalProcessQueue.push(n);else if(t==!0&&_ClientCallBackManager.Runing){var i=this.PersonalProcessQueue.length;i>0?this.PersonalProcessQueue[i-1]!=n&&this.PersonalProcessQueue.push(n):this.PersonalProcessQueue.push(n)}},ClientCallBackManager.prototype.EvalPersonalProcessQueue=function(){for(var notEvalJS,refData,jsEval,sender,args,i=0,len=this.PersonalProcessQueue.length;i<len;i++){if(i==0&&(this.PersonalProcessQueueEvaling=!0),_ClientPostBackManager.Runing==!0){while(this.PersonalProcessQueue.length>0){if(notEvalJS=this.PersonalProcessQueue.shift(),notEvalJS!=null&&notEvalJS.args!=null&&notEvalJS.args.result!=null&&notEvalJS.args.result.Rows!=null){for(refData=new ReferenceData,i=0,len=notEvalJS.args.result.Rows.length;i<len;i++)refData.Rows[i]=notEvalJS.args.result.Rows[i];notEvalJS.args.result=refData}Global_JSQueueEvalAfterPageLoadedManager.Add(notEvalJS,!0)}break}if(_ClientCallBackManager.Runing==!0)break;jsEval=this.PersonalProcessQueue.shift(),typeof jsEval=="function"?(sender=null,args=null,jsEval.sender!=undefined&&(sender=jsEval.sender),jsEval.args!=undefined&&(args=jsEval.args),_ClientCallBackManager.Runing==!1?jsEval(sender,args):_ClientCallBackManager.Add2PersonalProcessQueue(jsEval)):_ClientCallBackManager.Runing==!1?eval(jsEval):_ClientCallBackManager.Add2PersonalProcessQueue(jsEval),i==len-1&&(this.PersonalProcessQueueEvaling=!1)}},ClientCallBackManager.prototype.afterAllCallBackFired=function(){this.EvalPersonalProcessQueue(),_ClientJSExecQueueManager.Start()}}function ClientEventHandlerManager(){this.IsEventRuning=!1,ClientEventHandlerManager.prototype.get_IsEventRuning=function(){return this.IsEventRuning=_ClientPostBackManager.Runing==!0||_ClientCallBackManager.Runing==!0?!0:!1},ClientEventHandlerManager.prototype.Add2PersonalProcessQueue=function(n){_ClientPostBackManager.Runing==!0?Global_JSQueueEvalAfterPageLoadedManager.Add(n):_ClientCallBackManager.Runing==!0&&_ClientCallBackManager.Add2PersonalProcessQueue(n)}}function ActionManager(){}function DelayBind(n){Sys&&Sys.WebForms?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function(){window.setTimeout(n,0)}):window.setTimeout(n,0)}function showErrorMsg(n){CreateErrorMsg(n,null)}function GetTopPanel(){for(var i=null,t=document.getElementsByTagName("div"),n=0,r=t.length;n<r;n++)if(t[n].className.containsCssClass("toppanel")){i=t[n];break}return i}function RowData(){}function Basic(){}function SetIDFocus(n){var t=document.all(n);if(typeof t!="undefined"&&t!=null)try{t.focus()}catch(i){}}function SetFocus(n){try{n.focus()}catch(t){}}function testXmlhttp(n){return n.status!=200?!1:!0}function load(){var n={style:"position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=20);opacity:0.2;"};this.loading=$E(document).createElement("div",n),this.Image=$E(document).createElement("img",{src:"images/loading.gif"}),this.loading.appendChild(this.Image),this.loading.style.backgroundColor="blue",this.DisplayLoading=function(n){if(typeof n=="undefined")document.body.appendChild(this.loading),this.loading.style.top="0px",this.loading.style.left="0px",this.loading.style.width="100%",this.loading.style.height="100%";else{n.document.body.appendChild(this.loading);var t=n.getBoundingClientRect();this.loading.style.top=t.top+"px",this.loading.style.left=t.left+"px",this.loading.style.width=t.right-t.left+"px",this.loading.style.height=t.bottom-t.top+"px"}},this.HiddenLoading=function(){this.loading.parentElement!=null&&this.loading.parentElement.removeChild(this.loading)}}function numeralsOnly(n,t){var i=n.keyCode,r=t.getAttribute("decimalSeparator"),u=t.getAttribute("negativeSign");i>47&&i<58||i==r.charCodeAt(0)||i==u.charCodeAt(0)||$Event(n).preventDefault()}function numeralsBefore(n){var t=n.getAttribute("decimalSeparator"),i=n.getAttribute("negativeSign");n.value=ConvertToDecimal(n.value,t,i),n.style.color="black",n.select()}function ConvertToDecimal(n,t,i){n=n.toString();var r="[^\\d\\"+t+"\\"+i+"]",u=new RegExp(r,"g");return n=n.replace(u,"")}function numeralsAfter(n){var t=n.getAttribute("maxValue"),i=n.getAttribute("minValue");n.value=handleMaxMinValue(t,i,n.value);var r=n.getAttribute("negativeSign"),u=n.getAttribute("decimalSeparator"),f=n.getAttribute("decimalDigits"),e=n.getAttribute("groupSeparator"),o=n.getAttribute("symbols"),s=n.value.toString();n.value=FormatDecimal(s,r,u,f,e,o)}function handleMaxMinValue(n,t,i){var r,u,f;return i.toString()==""?!1:(r=new Number(i),isNaN(r))?!1:(u=new Number(n),n!=null&&r>u)?!1:(f=new Number(t),t!=null&&r<f)?!1:!0}function FormatDecimal(n,t,i,r,u,f){var s,l,c;n=n.toString();var o=f.split(","),a=new RegExp("\\"+t),v=n.match(a)!=null?!0:!1,y=new RegExp("[^\\d\\"+i+"]","g");n=n.replace(y,"");var p=new RegExp("(\\d*)(\\"+i+"*)(\\d*)"),h=n.match(p),e=h[3];if(e.length>r)for(e=e/Math.pow(10,e.length-r),e=Math.round(e);e.toString().length<r;)e="0"+e;else while(e.toString().length<r)e+="0";for(s=new Number(h[1]),e==Math.pow(10,r)&&(s+=1,e=e.toString().substr(1)),s=s.toString(),l=3,c=s.length-l;c>0;)s=s.substr(0,c)+u+s.substr(c),c-=l;return r==0?(h[2]="",e=""):h[2]=i,typeof o[2]=="undefined"&&(o[2]=""),typeof o[1]=="undefined"&&(o[1]=""),typeof o[3]=="undefined"&&(o[3]=""),typeof o[0]=="undefined"&&(o[0]=""),typeof o[0]=="undefined"&&(o[0]=""),typeof s=="undefined"&&(s=""),v?o[2]+s+h[2]+e+o[3]:o[0]+s+h[2]+e+o[1]}function BindErrorMessageToControl(n){var i,u,r,t;if(n)for(n.style.display="none",i=0,u=n.children.length,r=0;r<u;r++){t=n.children[i],t.cusAttr("msg",$(t).attr("title")),$(t).attr("title","");var e=t.cusAttr("TargetID"),o=t.cusAttr("EntityID"),s=t.cusAttr("EntityFullName"),f=document.getElementById(e);f?BindErrorControl(t,f,o,s):i++}}function ShowDetailMessage(n,t){var i="simple.aspx?lnk=738a5334-da18-494a-b817-3d083ab52c70&chromeType=4&EntityID="+n+"&EntityFullName="+t;ShowModalDialog(i,"",408,630,!0,!1)}function ShowErrorMsg_menter(n,t,i,r){var e=n.cusAttr("IsGridAllMsg"),u=document.getElementById("ErrorMessageDiv"),f;if(u!=null){if(n.cusAttr("msg")!=null&&n.cusAttr("msg").length>0&&(i?(u.innerHTML='<a href="#" onclick=ShowDetailMessage(\''+t+"','"+i+"')>"+n.cusAttr("msg")+"<\/a>",u.onmouseleave=function(){HideErrorMsg_mout(n)}):e?(u.innerHTML=n.cusAttr("msg"),u.onmouseleave=function(){HideErrorMsg_mout(n)}):u.innerHTML=n.cusAttr("msg"),r&&$(".moreMsgBox").length==0&&(u.innerHTML+="<span class='moreMsgBox fa text-primary' title='详情'>&gt;&gt;<\/span>"),GetOffsetTop(n),GetOffsetLeft(n),u.style.top=parseInt(n.cusAttr("oY"),10)+20+parseInt(document.body.scrollTop,10)+"px",u.style.left=parseInt(n.cusAttr("oX"),10)+14+parseInt(document.body.scrollLeft)+"px",u.style.visibility="visible",e&&u.clientHeight>=n.parentElement.clientHeight-20?(u.style.height=n.parentElement.clientHeight-20+"px",u.style.overflowY="auto",n.msgDivHeight=u.style.height+"px"):n.msgDivHeight!=null?u.style.height=n.msgDivHeight+"px":(u.style.height=null,u.style.overflowY="visible")),$(".moreMsgBox").length>0){f=null;$("#ErrorMessageDiv .moreMsgBox").on("click mouseover mouseout",function(){var r={frameId:$(window.frameElement)[0].id,left:$(this).offset().left,top:$(this).offset().top};event.type=="click"?window.top.errorMsgShowBox.checkType(n,t,i,r):event.type=="mouseover"?f=setTimeout(function(){window.top.errorMsgShowBox.checkType(n,t,i,r)},2e3):event.type=="mouseout"&&clearTimeout(f)})}u.onmouseenter=function(n){$(this).hasClass("hover")||$(this).addClass("hover"),n&&n.preventDefault()},u.onmouseleave=function(n){$(this).hasClass("hover")&&$(this).removeClass("hover"),n&&n.preventDefault(),HideErrorMsg_mout()},HideErrorMsg_mout_Inner_Time&&clearTimeout(HideErrorMsg_mout_Inner_Time)}}function HideErrorMsg_mout(){HideErrorMsg_mout_Inner_Time=setTimeout(HideErrorMsg_mout_Inner,500)}function HideErrorMsg_mout_Inner(){var n=document.getElementById("ErrorMessageDiv");n!=null&&($(n).hasClass("hover")||(n.style.visibility="hidden"))}function GetOffsetLeft(n,t){t==null&&(t=n,n.cusAttr("oX",0)),n.cusAttr("oX",parseInt(n.cusAttr("oX"),10)+parseInt(t.offsetLeft,10)-parseInt(t.scrollLeft,10)),t=t.offsetParent,t&&GetOffsetLeft(n,t)}function GetOffsetTop(n,t){t==null&&(t=n,n.cusAttr("oY",0)),n.cusAttr("oY",parseInt(n.cusAttr("oY"),10)+parseInt(t.offsetTop,10)-parseInt(t.scrollTop,10)),t=t.offsetParent,t&&GetOffsetTop(n,t)}function GotoErrorRecord(n,t){var i=document.getElementById(n);i&&i.control.OnGotoErrorRecordClick(t)}function CreateErrorMsg(n,t){var u,r,f,i;if(t==null)for(u=document.getElementsByTagName("div"),r=0;r<u.length;r++)if(u[r].className.containsCssClass("toppanel")&&u[r].id){t=u[r];break}t?(f={style:"display:inline"},i=$E(document).createElement("div",f),i.cusAttr("msg",n),i.cusAttr("recordIndex","0"),i.cusAttr("TargetID",t&&t.id?t.id:GetTopPanel()),i.innerHTML='<IMG src="../images/RefPnlError.gif">',i.setAttribute("className","ErrorToolTip"),BindErrorControl(i,t)):alert(n)}function CreateWarnMsg(n,t,i){var f,u,e,r;if(t==null)for(f=document.getElementsByTagName("div"),u=0;u<f.length;u++)if(f[u].className.containsCssClass("toppanel")&&f[u].id){t=f[u];break}if(t){if(IsCurrentTabPage(t.id))return;if(IsShowingErrorMsg(t.parentElement))return;e={style:"display:inline;"},r=$E(document).createElement("div",e),r.cusAttr("msg",n),r.cusAttr("recordIndex","0"),r.cusAttr("TargetID",t.id?t.id:GetTopPanel()),r.innerHTML='<IMG src="../images/RefPnlWarn.gif">',r.setAttribute("className","WarnToolTip"),i?BindErrorControl(r,i):BindErrorControl(r,t)}else alert(n)}function BindErrorControl(n,t,i,r){var o,h,s,f,e,u,c,l,a;if(n.style.position="absolute",n.style.zIndex="1000",n.style.display="block",o=n.cusAttr("IsGridAllMsg"),n.onmouseenter=function(){var u=window.location.href,n=!0;(getCultureName().toLowerCase()=="zh"||getCultureName().toLowerCase()=="zh-cn")&&(n=!1),u.indexOf("newopen=true")>-1||n||!$(t).hasClass("toppanel")?ShowErrorMsg_menter(this,i,r):ShowErrorMsg_menter(this,i,r,"u9hubShow")},r||o||(n.onmouseleave=function(){HideErrorMsg_mout(this)}),n.ondblclick=function(){var n=this.cusAttr("msg").replace(/<BR\/>/g,"\r\n"),t=document.createElement("span");t.innerHTML=n,n=$(t).text(),Clipboard.setData(n)&&alert(Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_AlreadyCopyToClipBoard)},n.children[0]&&(n.children[0].ondblclick=null),t.tagName=="SPAN"){h=t.getBoundingClientRect(),n.style.left=h.left-15+"px",n.style.left="-10px",parseInt(n.style.left.replace("px",""))<0&&(t.parentElement.style.position="relative");try{s=t.children[0].rows[0].cells[1].className}catch(v){}s&&s=="DropDownBtn_Center"?(t.parentElement.appendChild(n),t.parentElement.style.position="relative",n.style.left="0px",n.style.paddingTop="5px"):t.parentElement.insertBefore(n,t.parentElement.firstChild)}else if($(t).hasClass("main_Span"))if(n.align="right",f=n.cusAttr("recordIndex"),t.control&&t.control.get_SetControlValue()&&(f=t.control.get_SetControlValue().GridControl.rowIndex),parseInt(f,10)>-1){n.style.top="1px",n.style.left="-10px";try{e=t.children[0].rows[0].cells[0].children[0].children[0].tBodies[0].rows[f].cells[0]}catch(v){}e&&(e.style.position="relative",e.insertAdjacentElement("beforeEnd",n))}else o?(n.style.position="absolute",n.style.cursor="hand",n.style.zIndex="1001",n.style.display="block",n.style.top="-1px",n.style.left="-9px",t.insertAdjacentElement("beforeEnd",n)):(n.style.display="none",t.lastChild.className&&t.lastChild.className=="ErrorToolTip"||(u=document.createElement("div"),u.innerHTML=n.innerHTML,u.cusAttr("msg",n.cusAttr("msg")),u.style.position="absolute",u.style.zIndex="1001",u.style.display="block",u.style.top="-1px",u.style.left="-9px",u.className="ErrorToolTip",u.style.cursor="hand",t.insertAdjacentElement("beforeEnd",u)));else t.className.containsCssClass("TP")?(c=t.id,l=c+"_Head",n.align="left",n.style.top="0px",$("#"+l).append(n)):(n.align="right",t.className.containsCssClass("toppanel")&&(n.style.top="22px",t.parentElement&&t.parentElement.parentElement&&t.parentElement.parentElement.parentElement&&t.parentElement.parentElement.parentElement.tagName=="TD"?t.parentElement.parentElement.parentElement.style.position="relative":t.parentElement.style.position="relative"),t.type=="button"?(t.parentElement.appendChild(n),t.parentElement.style.position="relative",n.style.left="0px",n.style.paddingTop="10px"):t.className=="DDB"?(t.parentElement.insertBefore(n,t.parentElement.firstChild),n.style.paddingTop="5px"):t.parentElement.insertBefore(n,t.parentElement.firstChild));n.cusAttr("StrongErrorMessage")&&(a=n.cusAttr("StrongErrorMessage").replace(/<BR\/>/g,"\r\n"),window.setTimeout(function(){alert(a)},0))}function CreateErrorMsgElment(n,t){var i=$E(document).createElement("div"),r,u;i.cusAttr("TargetID",n),r=$E(document).createElement("img",{src:"../images/RefPnlError.gif"}),r.cusAttr("msg",t),i.appendChild(r),u=$ID(n),u&&BindErrorControl(i,u)}function RemoveErrorMsgElment(n,t){for(var u=t.parentElement.getElementsByTagName("div"),i,r=u.length-1;r>=0;r--)i=u[r],i.cusAttr("TargetID")&&i.cusAttr("TargetID")==n&&i.parentElement&&i.parentElement.removeChild(i)}function $ID(n){return window.document.getElementById(n)}function UFEscape(n){var t=escape(n),i=/\x2B/g;return t.replace(i,"%2B")}function MaskChar(){}function G_SplitLongString(n,t){var r=n,i=255;return t&&(i=t==-1?2147483647:t),n.length>i&&(r=n.substring(0,i)),r}function G_Trim(n){return n.replace(/^\s+|\s+$/g,"")}function G_TrimEnd(n){return n.replace(/\s+$/,"")}function G_TrimStart(n){return n.replace(/^\s+/,"")}function TreeReference_TreeDblClick(args){var ID=args.TreeView.ID,clientID=args.TreeView.ClientID,pre=clientID.replace(ID,""),btnConfirmID=pre+"ConfirmButton";return window.eval("btnOk = $ID('"+btnConfirmID+"');if(btnOk){btnOk.children[0].click();}"),!1}function ClearErrorMsgDiv(){var i=document.getElementById("ErrorMessageDiv"),t,n;for(i&&(i.style.visibility="hidden"),t=document.getElementsByTagName("DIV"),n=0;n<t.length;n++)t[n].className=="ErrorToolTip"&&(t[n].style.display="none")}function ControlProxyNodeName(){}function ControlProxyAttribute(){}function ClientInstanceSetUFReferenceProxyValue(n,t,i,r,u){var f={};f.ClientID=n,f.Type=t,f.Key=i,f.Code=r,f.Name=u,SetControlProxyValue(f),f.ClientID=null,f.Type=null,f.Key=null,f.Code=null,f.Name=null,f=null}function ClientInstanceSetUFControlProxyValue(n,t,i){var r={};r.ClientID=n,r.Type=t,r.Value=i,SetControlProxyValue(r),r.ClientID=null,r.Type=null,r.Value=null,r=null}function ClientInstanceSetUFDropDownListProxyValue(n,t,i,r){var u={};u.ClientID=n,u.Type=t,u.KeyAttributeName=i,u.Value=r,SetControlProxyValue(u),u.ClientID=null,u.Type=null,u.KeyAttributeName=null,u.Value=null,u=null}function SetUFControlPropertyNameValue(n,t,i,r){return;var u}function SetControlProxyValue(n){var i,t;if(document.getElementById("controlProxy")){i=document.getElementById("controlProxy").value,controlProxyXmlDom||(controlProxyXmlDom=Basic.GetXmlDom(),controlProxyXmlDom.setProperty("SelectionLanguage","XPath")),controlProxyXmlDom.loadXML(i),controlProxyXmlDom_Root=controlProxyXmlDom.selectSingleNode("//Data"),controlProxyXmlDom.childNodes.length==0&&(controlProxyXmlDom_Root=controlProxyXmlDom.createElement("Data"),controlProxyXmlDom.appendChild(controlProxyXmlDom_Root)),t=controlProxyXmlDom.selectSingleNode("//Data/Control[@ID='"+n.ClientID+"']");switch(n.Type){case"UFReference":SetReferenceProxyValue(t,n);break;case"UFTextBox":SetTextBoxProxyValue(t,n);break;case"UFNumberic":SetNumbericProxyValue(t,n);break;case"UFDateTimePicker":SetDateTimePickerProxyValue(t,n);break;case"UFDropDownList":SetDropDownListProxyValue(t,n);break;case"UFFlexField":SetFlexFieldProxyValue(t,n);break;case"UFGlobalInput":SetGlobalInputProxyValue(t,n);break;default:SetDefaultControlProxyValue(t,n)}document.getElementById("controlProxy").value=XMLHelper.serializeXMLNodeToString(controlProxyXmlDom)}}function SetReferenceProxyValue(n,t){n?t.PropertyName?n.setAttribute(t.PropertyName,t.PropertyValue):(n.setAttribute("Key",t.Key),n.setAttribute("Value",t.Code),n.setAttribute("Text",t.Name)):(n=controlProxyXmlDom.createElement("Control"),n.setAttribute("ID",t.ClientID),n.setAttribute("Type",t.Type),t.PropertyName?n.setAttribute(t.PropertyName,t.PropertyValue):(n.setAttribute("Key",t.Key),n.setAttribute("Value",t.Code),n.setAttribute("Text",t.Name)),controlProxyXmlDom_Root.appendChild(n))}function SetTextBoxProxyValue(n,t){n?n.setAttribute("Value",t.Value):(n=controlProxyXmlDom.createElement("Control"),n.setAttribute("ID",t.ClientID),n.setAttribute("Type",t.Type),n.setAttribute("Value",t.Value),controlProxyXmlDom_Root.appendChild(n))}function SetNumbericProxyValue(n,t){n?t.PropertyName?n.setAttribute(t.PropertyName,t.PropertyValue):n.setAttribute("Value",t.Value):(n=controlProxyXmlDom.createElement("Control"),n.setAttribute("ID",t.ClientID),n.setAttribute("Type",t.Type),t.PropertyName?n.setAttribute(t.PropertyName,t.PropertyValue):n.setAttribute("Value",t.Value),controlProxyXmlDom_Root.appendChild(n))}function SetDateTimePickerProxyValue(n,t){n?n.setAttribute("Value",t.Value):(n=controlProxyXmlDom.createElement("Control"),n.setAttribute("ID",t.ClientID),n.setAttribute("Type",t.Type),n.setAttribute("Value",t.Value),controlProxyXmlDom_Root.appendChild(n))}function SetDropDownListProxyValue(n,t){n?(n.setAttribute("KeyAttributeName",textboxControl.KeyAttributeName),n.setAttribute("Value",textboxControl.Value)):(n=controlProxyXmlDom.createElement("Control"),n.setAttribute("ID",t.ClientID),n.setAttribute("Type",t.Type),n.setAttribute("KeyAttributeName",t.KeyAttributeName),n.setAttribute("Value",t.Value),controlProxyXmlDom_Root.appendChild(n))}function SetFlexFieldProxyValue(n,t){n?n.setAttribute("Value",t.Value):(n=controlProxyXmlDom.createElement("Control"),n.setAttribute("ID",t.ClientID),n.setAttribute("Type",t.Type),n.setAttribute("Value",t.Value),controlProxyXmlDom_Root.appendChild(n))}function SetGlobalInputProxyValue(n,t){n?n.setAttribute("Value",t.Value):(n=controlProxyXmlDom.createElement("Control"),n.setAttribute("ID",t.ClientID),n.setAttribute("Type",t.Type),n.setAttribute("Value",t.Value),controlProxyXmlDom_Root.appendChild(n))}function SetDefaultControlProxyValue(n,t){n?t.PropertyName?n.setAttribute(t.PropertyName,t.PropertyValue):n.setAttribute("Value",t.Value):(n=controlProxyXmlDom.createElement("Control"),n.setAttribute("ID",t.ClientID),t.Type&&n.setAttribute("Type",t.Type),t.PropertyName?n.setAttribute(t.PropertyName,t.PropertyValue):n.setAttribute("Value",t.Value),controlProxyXmlDom_Root.appendChild(n))}function ClearControlProxyValue(){var n=document.getElementById("controlProxy");n&&n.value!=null&&n.value!=""&&(n.value="")}function Set_Global_NeedResetCheckDirtyTagWhenEnd(n){Global_NeedResetCheckDirtyTagWhenEnd=n?!0:!1}function Get_Global_NeedResetCheckDirtyTagWhenEnd(){return Global_NeedResetCheckDirtyTagWhenEnd}function Global_DirtyData_EventType(){}function Get_Global_IsPageLoadComplete(){return Global_IsPageLoadComplete}function Set_Global_IsPageLoadComplete(n){Global_IsPageLoadComplete=n!=null&&n.toString().toLowerCase()=="true"?!0:!1}function Get_Global_IsCheckDirtyData_TheForm(){return Global_IsCheckDirtyData_TheForm}function Set_Global_IsCheckDirtyData_TheForm(n){Global_IsCheckDirtyData_TheForm=n==!0||n!=null&&n.toString().toLowerCase()=="true"?!0:!1}function Get_Global_IsDirtyData_TheForm(){var n=Get_Global_IsCheckDirtyData_TheForm();return n==!0?Global_IsDirtyData_TheForm:!1}function Set_Global_IsDirtyData_TheForm(n){Global_IsDirtyData_TheForm=n==!0||n!=null&&n.toString().toLowerCase()=="true"?!0:!1}function Get_Global_DirtyDataSaveSuccessFlag(){return Global_DirtyDataSaveSuccessFlag}function Set_Global_DirtyDataSaveSuccessFlag(n){n=="Success"?(Global_DirtyDataSaveSuccessFlag="Success",Set_Global_IsDirtyData_TheForm(!1)):Global_DirtyDataSaveSuccessFlag=n=="UnSuccess"?"UnSuccess":null}function Get_Global_DirtyDataCancelSuccessFlag(){return Global_DirtyDataCancelSuccessFlag}function Set_Global_DirtyDataCancelSuccessFlag(n){n=="Success"?(Global_DirtyDataCancelSuccessFlag="Success",Set_Global_IsDirtyData_TheForm(!1)):Global_DirtyDataCancelSuccessFlag=n=="UnSuccess"?"UnSuccess":null}function IsShowConfirmSaveDialog(n){var t={},r=n.split("$"),u=r[r.length-1],i;return Global_CheckDirtyDataIDs.indexOf(u)>=0?(t.Value=GetBtnSaveID()!=null&&IsBtnSaveEnabled()==!0?Get_Global_IsDirtyData_TheForm():!1,t.EventType=Global_DirtyData_EventType.Toolbar,t):$find(n)!=null&&($find(n).tagName=="PopMenu"||$find(n).get_element().tagName=="PopUpMenu")?$find(n).get_element().parentElement!=null&&GetBtnSaveID()!=null&&IsBtnSaveEnabled()==!0?(i=$find(n).get_element().parentElement,i.id.indexOf("DDBtnTaskLink")>-1||i.cusAttr("NeedConfirmSave")=="true"?(t.Value=Get_Global_IsDirtyData_TheForm(),t.EventType=Global_DirtyData_EventType.DropDownButtonMenu,t):(t.Value=!1,t.EventType=Global_DirtyData_EventType.DropDownButtonMenu,t)):(t.Value=!1,t.EventType=Global_DirtyData_EventType.DropDownButtonMenu,t):(t.Value=!1,t.EventType=Global_DirtyData_EventType.Empty,t)}function ShowConfirmSaveModalDialog(n){var t="../ufsoft/saveconfirm.aspx?chromeType=4&ShowType=ShowModal";return ShowModalDialogForAll(t,"","145","365","true","false",n)}function OnBeforeDropDownMenuRedirect(n,t){var i=!0,r;return t.indexOf("OrgPicker")>-1&&Get_Global_IsDirtyData_TheForm()==!0&&GetBtnSaveID()!=null&&IsBtnSaveEnabled()==!0&&(i=ShowConfirmSaveModalDialog(),i==!0?(n&&(_ClientPostBackManager.CallAfterAllPostBack=function(){$(n).click()}),r=GetBtnSaveID().replace(/_/g,"$"),__doPostBack(r,""),i=!1):i==!1?(Set_Global_IsDirtyData_TheForm(!1),i=!0):i=!1),i}function OnBeforeQuickMenuRedirect(n){var t=!0,i;Get_Global_IsDirtyData_TheForm()==!0&&GetBtnSaveID()!=null&&IsBtnSaveEnabled()==!0&&(t=ShowConfirmSaveModalDialog(),t==!0?(n&&(_ClientPostBackManager.CallAfterAllPostBack=function(){$(n).click()}),i=GetBtnSaveID().replace(/_/g,"$"),__doPostBack(i,""),t=!1):t==!1?(Set_Global_IsDirtyData_TheForm(!1),t=!0):t=!1),t&&n&&(document.location.href=n.h)}function OnBeforeMenuLinkRedirect(n,t){var r,u,i;if(Get_Global_IsDirtyData_TheForm()==!0&&GetBtnSaveID()!=null&&IsBtnSaveEnabled()==!0){if(r=ShowConfirmSaveModalDialog(),r==!0)return _ClientPostBackManager.RedictURLAfterAllPostBack=n,u=GetBtnSaveID().replace(/_/g,"$"),__doPostBack(u,""),!0;if(r==!1)return Set_Global_IsDirtyData_TheForm(!1),undefined;if(r==undefined){if(t!=null&&(i=t.parentElement,i!=null&&(i.ConfirmSaveDialog_Cancel=!0,i.style.visibility!="hidden"&&(i.style.visibility="hidden"))),top.__UFCurrentFocusControl&&$get(top.__UFCurrentFocusControl))try{$get(top.__UFCurrentFocusControl).focus()}catch(f){}return!1}}}function GetToolbar(){var r=null,i=document.getElementsByTagName("div"),t,u,n;if(i==null)return null;for(t=0,u=i.length;t<u;t++)if(n=i[t],(n.className.indexOf("TB")>0||n.id.indexOf("Toolbar")>0)&&n.style.display!="none"){r=n;break}return r}function GetBtnSaveID(){var i,n,t,r;if(Global_BtnSaveID!=null)return Global_BtnSaveID;if((i=GetToolbar(),i==null)||(n=i.getElementsByTagName("input"),n==null))return null;for(t=0,r=n.length;t<r;t++)if(n[t].id.indexOf("BtnSave")>-1&&(n[t].accessKey=="S"||n[t].accessKey=="^S")){Global_BtnSaveID=n[t].id;break}return Global_BtnSaveID}function IsBtnSaveEnabled(){var n=GetBtnSaveID();return n!=null&&$ID(n)!=null&&$ID(n).disabled!=!0?!0:!1}function IsBtnCancelDoAction(n){return n.indexOf("$BtnCancel'")>0?!0:!1}function Get_BtnRePostBackWithDoNothingID(){return Global_BtnRePostBackWithDoNothingID}function Set_BtnRePostBackWithDoNothingID(n){Global_BtnRePostBackWithDoNothingID=n}function Get_GridCurrentRowIndex4PIsValid(){return Global_GridCurrentRowIndex4PIsValid}function Set_GridCurrentRowIndex4PIsValid(n){Global_GridCurrentRowIndex4PIsValid=n}function Get_GridCurrentRowIndex4P(){return Global_GridCurrentRowIndex4P}function Set_GridCurrentRowIndex4P(n){Global_GridCurrentRowIndex4P=n}function Get_Global_WillDoPostBack(){return _Global_WillDoPostBack}function Set_Global_WillDoPostBack(n){_Global_WillDoPostBack=n==!0||n!=null&&n.toString().toLowerCase()=="true"?!0:!1}function JSQueueEvalAfterPageLoadedManager(){this.JSEvalQueue=[],this.PersonalEvalQueue=[],this.LastEvalQueue=[],JSQueueEvalAfterPageLoadedManager.prototype.Add=function(js,isPersonal){if(isPersonal!=!0)this.JSEvalQueue.push(js);else if(isPersonal==!0)if(!0||_ClientPostBackManager.Runing==!0||Get_Global_WillDoPostBack()==!0){var len=this.PersonalEvalQueue.length;len>0?this.PersonalEvalQueue[len-1]!=js&&this.PersonalEvalQueue.push(js):this.PersonalEvalQueue.push(js)}else typeof js=="function"?js():eval(js)},JSQueueEvalAfterPageLoadedManager.prototype.AddLast=function(n){this.LastEvalQueue.push(n)},JSQueueEvalAfterPageLoadedManager.prototype.Eval=function(){var jsEval,sender,args,tempJS;if(Global_Debugger4P,_ClientPostBackManager.Runing==!1&&Get_Global_WillDoPostBack()==!1){for(Global_CallBackReturnJsQueueIsRunning=this.JSEvalQueue.length>0;this.JSEvalQueue.length>0;)jsEval=this.JSEvalQueue.shift(),typeof jsEval=="function"?(sender=null,args=null,jsEval.sender!=undefined&&(sender=jsEval.sender),jsEval.args!=undefined&&(args=jsEval.args),jsEval(sender,args)):jsEval.indexOf("\r\n")>-1?(tempJS=jsEval.replace(/\r\n/g,""),eval(tempJS)):eval(jsEval);for(Global_CallBackReturnJsQueueIsRunning=!1;_ClientPostBackManager.Runing==!1&&Get_Global_WillDoPostBack()==!1&&this.PersonalEvalQueue.length>0;)jsEval=this.PersonalEvalQueue.shift(),typeof jsEval=="function"?(sender=null,args=null,jsEval.sender!=undefined&&(sender=jsEval.sender),jsEval.args!=undefined&&(args=jsEval.args),jsEval(sender,args)):jsEval.indexOf("\r\n")>-1?(tempJS=jsEval.replace(/\r\n/g,""),eval(tempJS)):eval(jsEval);while(_ClientPostBackManager.Runing==!1&&Get_Global_WillDoPostBack()==!1&&this.LastEvalQueue.length>0)jsEval=this.LastEvalQueue.shift(),typeof jsEval=="function"?(sender=null,args=null,jsEval.sender!=undefined&&(sender=jsEval.sender),jsEval.args!=undefined&&(args=jsEval.args),jsEval(sender,args)):jsEval.indexOf("\r\n")>-1?(tempJS=jsEval.replace(/\r\n/g,""),eval(tempJS)):eval(jsEval)}}}function afterPageLoadComplete(){var debugWin,btnLogout,grid,d;top.PageInitCompleted=!1,Set_Global_IsPageLoadComplete&&Set_Global_IsPageLoadComplete(!0),window.PersonalWarnMsgManager&&window.PersonalWarnMsgManager._WarnMsg.length>0&&window.PersonalWarnMsgManager.ShowMsg(),Global_JSQueueEvalAfterPageLoadedManager.Eval__doPostBack!=null&&(eval(Global_JSQueueEvalAfterPageLoadedManager.Eval__doPostBack),Global_JSQueueEvalAfterPageLoadedManager.Eval__doPostBack=null),Global_JSQueueEvalAfterPageLoadedManager.Eval(),typeof JavaScriptDebugTool!="undefined"&&JavaScriptDebugTool.On&&(debugWin=new JavaScriptDebugTool,debugWin.initialize(),$alert("Init Complete ....")),UFFocus(!0),TPscrollLeftIEHark(),btnLogout=$ID("u_Displaytitle1_ctl00_btnLogout"),btnLogout&&_ClientPostBackManager.Runing==!1&&btnLogout.getAttribute("href1")&&(btnLogout.setAttribute("href",btnLogout.getAttribute("href1")),btnLogout.removeAttribute("href1")),_ClientJSExecQueueManager.RunAfterPageLoad&&_ClientJSExecQueueManager.Start(),grid=$find(window.RefGridID),grid&&(window.RefGridID=null,grid.D_Body.rows.length>0&&grid.D_Body.rows[0].Status==RowStatus.Empty&&(d=document.getElementById(window.RefFocusControl),window.RefFocusControl=null,d&&d.focus())),top.PageInitCompleted=!0,popLayerTableSetWidthtHelper()}function TPscrollLeftIEHark(){var n=$(".TP:not(:hidden)");$(".TP:not(:hidden)").each(function(n,t){var i=$(t),r=i.offset().left;r<0&&(i.css("overflow","auto"),i.scrollLeft(0),i.css("overflow",""))})}function AddToScrollPanelList(n){for(var i=!0,t=0;t<Global_ScrollPanelList.length;t++)if(Global_ScrollPanelList[t]==n){i=!1;break}i==!0&&Global_ScrollPanelList.push(n)}function RestorePanelScrollPosition(){var n;if(FullScreenGridHelper.GetInstance().init(),TdSetHeightHelper.GetInstance().init(),Global_ScrollPanelList.length>0)for(n=0;n<Global_ScrollPanelList.length;n++)if($get(Global_ScrollPanelList[n])){var t=$($get(Global_ScrollPanelList[n])),i=$get(Global_ScrollPanelList[n]+"_ScrollPositionX").value,r=$get(Global_ScrollPanelList[n]+"_ScrollPositionY").value;t.is(":visible")?(FrozenGetInstance(i,r,t),t.scrollLeft(i),t.scrollTop(r)):(window.afterShowCall||(window.afterShowCall=[]),window.afterShowCall.push(function(){FrozenGetInstance(i,r,t),t.scrollLeft(i),t.scrollTop(r)}))}}function FrozenGetInstance(n,t,i){if(n!=0||t!=0){var r=i,f=r.find("table"),u=r.find("thead"),e=u.find(".FixedColumnTitleCell").length;GridFrozenColumnsHelper.GetInstance(r,f,u,e,n,t).init()}}function doD(n,t){window.event.keyCode==13&&(window.RefGridID=t,window.RefFocusControl=window.event.srcElement.id,__doPostBack(n,""))}function doFindD(n,t,i){window.event.keyCode==13&&(window.RefGridID=i,window.RefFocusControl=window.event.srcElement.id,$ID(t).focus(),__doPostBack(n,""))}function RefClientReturn(n){var t=$find(n),r,f,e,o,s,i,u,h,c,l,a;if(t){for(r=Basic.GetXmlDom(),r=Basic._loadXML("<ReferenceReturns/>"),f=r.createElement("ReferenceReturn"),r.documentElement.appendChild(f),e=t.get_CurrentRowIndex(),o=t.GetColumnIndex("MainID"),o>=0&&(s=t.GetCellValue(e,o)),i=1;i<=t.get_Columns();i++)u="",u=t.MainCols[i].cusAttr("FieldID")=="ID"&&s?s:t.GetCellValue(e,i),u&&(t.MainCols[i].cusAttr("ControlType")=="REF"?(h=CreateReturnValueXML(r,t.MainCols[i].cusAttr("FieldID"),u.Key),f.appendChild(h),c=CreateReturnValueXML(r,t.MainCols[i].cusAttr("FieldID")+"_Code",u.Value),f.appendChild(c),l=CreateReturnValueXML(r,t.MainCols[i].cusAttr("FieldID")+"_Name",u.Text),f.appendChild(l)):(a=CreateReturnValueXML(r,t.MainCols[i].cusAttr("FieldID"),u.Value),f.appendChild(a)));window.returnValue=XMLHelper.serializeXMLNodeToString(r),window.dialogArguments.Escaped="true",window.close()}}function CreateReturnValueXML(n,t,i){var r=n.createElement("ReturnField");return r.setAttribute("name",t),r.setAttribute("value",i),r}function SaveDefaultValue(){var n=$(saveDefaultMenu)[0],t;n&&(document.all?n.fireEvent("onclick"):(t=document.createEvent("HTMLEvents"),t.initEvent("click",!0,!0),n.dispatchEvent(t)))}function EvalSaveDefaultValue(){CanEvalSaveDefault()?isLast==0?(isLast=1,window.setTimeout(EvalSaveDefaultValue,0)):isLast==1&&(isLast=0,window.setTimeout(SaveDefaultValue,0)):(isLast=0,window.setTimeout(EvalSaveDefaultValue,0))}function CanEvalSaveDefault(){return Global_CallBackReturnJsQueueIsRunning==!1&&_ClientJSExecQueueManager.Running==!1&&_ClientPostBackManager.Runing==!1&&_ClientCallBackManager.Runing==!1&&Global_JSQueueEvalAfterPageLoadedManager.JSEvalQueue.length==0&&Global_JSQueueEvalAfterPageLoadedManager.PersonalEvalQueue.length==0&&Global_JSQueueEvalAfterPageLoadedManager.LastEvalQueue.length==0&&(ClientJSExecQueueManager.Handlers==undefined||ClientJSExecQueueManager.Handlers!=undefined&&ClientJSExecQueueManager.Handlers.length==0)&&(ClientJSExecQueueManager.FirstHandlers==undefined||ClientJSExecQueueManager.FirstHandlers!=undefined&&ClientJSExecQueueManager.FirstHandlers.length==0)&&_ClientCallBackManager.Handlers.length==0&&_ClientCallBackManager.PersonalProcessQueue.length==0&&_ClientPostBackManager.SrcElement.length==0&&_ClientPostBackManager.PersonalProcessQueue.length==0?!0:!1}function ClientRunAssoCJS4P(n,t,i,r){var u="";return i=!0,r=!1,r?i?(u+="var sender = 'Run4P';",u+="var args = new UF.UI.ChangeEventArgs();",u+="args.EventSrc = 'ClientRunAssoCJS4P';",u+=t+"(sender,args);"):(u+="var rowCount = $find('"+n+"').D_Body.rows.length;",u+="var lastRow = $find('"+n+"').D_Body.rows[rowCount-1];",u+="if(lastRow.Status == RowStatus.Empty )",u+="{",u+="rowCount--;",u+="}",u+="var curRowIndex = $find('"+n+"').m_currentRowIndex;",u+="for(var i=0; i<rowCount; i++)",u+="{",u+="var sender = $find('"+n+"');",u+="var args = new UF.UI.ChangeEventArgs();",u+="args.EventSrc = 'RunJS4P';",u+="$find('"+n+"').m_currentRowIndex = i;",u+=t+"(sender,args);",u+="}",u+="$find('"+n+"').m_currentRowIndex = curRowIndex"):(u+="var sender = null;",u+="var args = new UF.UI.ChangeEventArgs();",u+="if(_ClientPostBackManager.get_DoPostBackcompleted() == false)",u+="{_ClientPostBackManager.set_DoPostBackcompleted(true);sender = $find('"+n+"');args.EventSrc = 'ClientRunAssoCJS4P';}",u+="else{sender = 'Run4P';args.EventSrc = 'ClientRunAssoCJS4P';}",u+=t+"(sender,args);"),u}function JSCalculatorEval(str){var preResult="Nan";try{preResult=eval(str)}catch(e){IsJSCalculatorEvalAlert&&alert("语法错误！关联计算过程有误，请检查计算公式"+str+"的正确性！该提示仅在测试阶段出现。正式发盘将无此提示！")}return preResult.toString()}function CanEvalPersonalJS(n,t,i){var f,u,e;if(_ClientPostBackManager.Runing||Get_Global_WillDoPostBack()==!0){if(n.sender=t,n.args=i,i.result!=null&&i.result.Rows!=null){for(f=new ReferenceData,u=0,e=i.result.Rows.length;u<e;u++)f.Rows[u]=i.result.Rows[u];n.args.result=f}return Global_JSQueueEvalAfterPageLoadedManager.Add(n,!0),!1}if(_ClientCallBackManager.Runing){if(n.sender=t,n.args=i,i.result!=null&&i.result.Rows!=null){for(f=new ReferenceData,u=0,e=i.result.Rows.length;u<e;u++)f.Rows[u]=i.result.Rows[u];n.args.result=f}return _ClientCallBackManager.Add2PersonalProcessQueue(n,!0),!1}return!0}function PersonalWarnMsgManager(){this._WarnMsg=[],this._keyValue="",PersonalWarnMsgManager.prototype.Add=function(n,t){var r={},i;r.control=n,i=null,t&&(i={},i.IsSetControlValue=t.IsSetControlValue,i.ValueSource=t.ValueSource,i.GridControl=t.GridControl),r.SetControlValue=i,this._WarnMsg.push(r)},PersonalWarnMsgManager.prototype.Queue=function(){return this._WarnMsg},PersonalWarnMsgManager.prototype.ShowMsg=function(){var t,r;if(this._WarnMsg.length>0){if($ID("keyValues4Favorite")&&$ID("keyValues4Favorite").value!=this._keyValue){this.Clear();return}for(CreateWarnMsg("",null),t=0,r=this._WarnMsg.length;t<r;t++){var n=this._WarnMsg[t],u=-1,i=null;n.SetControlValue&&(u=n.SetControlValue.ValueSource,n.SetControlValue.GridControl&&(i=$ID(n.SetControlValue.GridControl.id),i&&i.control.set_SetControlValue(n.SetControlValue))),$ID(n.control)&&CreateWarnMsg(GetPersonWarnMsg(u),$ID(n.control),i)}}},PersonalWarnMsgManager.prototype.Clear=function(){if(this._WarnMsg.length>0)for(var n=0,t=this._WarnMsg.length;n<t;n++)this._WarnMsg.shift()},PersonalWarnMsgManager.prototype.SetKeyValue=function(n){this._keyValue=n}}function GetCurrentTabPage(n){if($ID(n))for(var t=$ID(n);;){if(t.className&&t.className==ControlClass.TabPage)return t;if(t.className&&t.className==ControlClass.toppanel)return null;if(t.parentElement)t=t.parentElement;else return null}}function IsCurrentTabPage(n){var i=!1,t,r;return $ID(n)&&(t=$ID(n),t.className&&t.className==ControlClass.TabPage&&(r=t.control.get_parent().tabGroup.TabCollection[t.control.get_parent().get_TabIndex()],r.Page.id==t.id&&(i=!0))),i}function IsShowingErrorMsg(n){var i=!1,t,r;if(n&&n.children&&n.children.length>0)for(t=0,r=n.children.length;t<r;t++)if(n.children[t].className=="ErrorToolTip"){i=!0;break}return i}function GetPersonWarnMsg(n){var t="";return n==0?t=Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_SetValueError0:n==1?t=Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_SetValueError1:n==2&&(t=Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_SetValueError2),t}function GetParentGrid(n){if($ID(n))for(var t=$ID(n);;){if(t.className&&$(t).hasClass(ControlClass.Grid))return t;if(t.className&&t.className==ControlClass.toppanel)return null;if(t.parentElement)t=t.parentElement;else return null}}function ProcessRequest(n,t,i){if(t.length>2e3){alert(Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_ReferenceUrlOverLength);try{this._textbox.focus(),this._textbox.select()}catch(f){}return;var r,u}else n.open("GET",t,!1),n.onreadystatechange=i,n.send("")}function GetPostUrl(n,t){for(var o=GetUrlAttributeList(n),i=GetUrlAttributeList(t),u,f,r,e=0;e<o.length;e++)for(u=0;u<i.length;u++)if(o[e].key==i[u].key){i[u].del=!0;break}for(f="",r=0;r<i.length;r++)i[r].del||(f!=""&&(f+="&"),f+=i[r].key+"="+i[r].value);return f}function GetUrlAttributeList(n){var i=[],u=n.split("?"),r,t;if(u.length==2&&(r=u[1]),!r)return i;for(pl=r.split("&"),t=0;t<pl.length;t++)i[t]={},i[t].key=pl[t].split("=")[0],i[t].value=pl[t].substring(pl[t].split("=")[0].length+1);return i}function GetXmlHttpRequest(){return document.all?new ActiveXObject("Msxml2.XMLHTTP"):XMLHttpRequest?new XMLHttpRequest:void 0}function Print_CheckSaveConfirm(){var i=IsShowConfirmSaveDialog(theForm.__EVENTTARGET.value),n,t;return i.Value?(n=ShowConfirmSaveModalDialog(),n==!0&&(t=GetBtnSaveID().replace(/_/g,"$"),__doPostBack(t,"")),!1):!0}function getAttribute(n,t){var r=$find(n),i;return r?r.get_element().getAttribute(t):(i=$get(n),i)?i.getAttribute(t):void 0}function CheckValid(n){this.defaultPrec=5,this.defaultMask="",this.defaultMin=0,this.defaultMax=9999999999,this.defaultLen=10,this.mainObjectID=n.id,this.m_pressedKey,this.theValue,this.spliter,this.isInitialized,typeof n.DataType!="undefined"&&(this.dataType=n.DataType),typeof n.dataType!="undefined"&&(this.dataType=n.dataType),this.dataLeng=typeof n.DataLength!="undefined"?n.DataLength:typeof n.dataLeng!="undefined"?n.dataLeng:this.defaultLen,this.dataPrec=typeof n.dataPrec!="undefined"?n.dataPrec:this.defaultPrec,this.maskChar=typeof n.maskChar!="undefined"?n.maskChar:this.defaultMask,this.expdChar=n.ExpdChar,this.minValue=typeof n.maskChar!="undefined"?n.minValue:this.defaultMin,this.maxValue=typeof n.maxValue!="undefined"?n.maxValue:this.defaultMax,this.allowEmpt=n.allowEmpt,n.KeyPressSender=this,n.onkeypress=inputObjectOnKeyPress}function inputObjectOnKeyPress(){this.KeyPressSender.onKeyPressed()}function getPressedChar(n){var t=0;return document.layers?t=unescape("%"+new Number(n).toString(16)):document.all&&(n>57&&(n=n-48),t=String.fromCharCode(n)),t}function checkLength(n,t){var r=0,i,u;if(n==undefined)return"";for(i=0;i<n.length;i++)u=n.charCodeAt(i),r+=u>=0&&u<=255?1:2;return r>t?Sys.CultureInfo[getCultureName().toLowerCase()].Resources.Judage_StringOverLength.replace(/\$Length\$/g,t):""}function getComplexValue(n){return this.theValue+getPressedChar(n)}function TriggerRegister(n,t,i){this.ClientId=n,this.Type=t,this.TargetNum=i,this.Target=[],this.Types=[],this.Actions=[]}function EvaluatorRegister(n,t,i,r){this.ClientId=n,this.Type=t,this.TargetNum=i,this.Expression=r,this.Target=[],this.Types=[]}function AddTriggerRegister(n,t,i,r,u,f){TriggerArray[TriggerArray.length]=new TriggerRegister(n,t,i);var e=getRelationObject(n,"trigger"),o=ParseString(r,i),s=ParseString(u,i),h=ParseString(f,i);e.Target=o,e.Types=s,e.Actions=h}function AddEvaluatorRegister(n,t,i,r,u,f){EvaluatorArray[EvaluatorArray.length]=new EvaluatorRegister(n,t,i,f);var e=getRelationObject(n,"evaluator"),o=ParseString(r,i),s=ParseString(u,i);e.Target=o,e.Types=s}function TriggerInteraction(n){var r=getRelationObject(n,"trigger"),i,t,o;if(r==null)return!1;var u=r.Target,s=r.Types,f=r.Actions,e=u.length;for(i=0;i<e;i++)if(t=document.getElementById(u[i]),t!=null){o=t.type;switch(f[i]){case"Enable":SetDisable(t,!1);break;case"Disable":SetDisable(t,!0);break;case"ClearDefault":ClearDefault(t);break;case"Diseditable":SetReadOnly(t,!0);break;case"Editable":SetReadOnly(t,!1)}}}function SetDisable(n,t){var r,i;for(n.disabled=t,r=0;r<n.children.length;r++)i=n.children[r],i.tagName=="INPUT"||i.tagName=="IMG"?i.disabled=t:SetDisable(i,t)}function SetReadOnly(n,t){var r,i;for(n.readOnly=t,r=0;r<n.children.length;r++)i=n.children[r],i.tagName=="INPUT"||i.tagName=="IMG"?i.readOnly=t:SetDisable(i,t)}function ToggleEditable(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.tagName=="INPUT"?t.readOnly=t.readOnly?!1:!0:ToggleEditable(t)}function ClearDefault(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.tagName=="INPUT"?t.value=t.defaultValue:ClearDefault(t)}function ToggleEnable(n){var i,t;for(n.disabled=n.disabled?!1:!0,i=0;i<n.children.length;i++)t=n.children[i],t.tagName=="INPUT"||t.tagName=="IMG"?t.disabled=t.disabled?!1:!0:ToggleEnable(t)}function onEvaluatorInteraction(){var r=event.srcElement.id,u=r.replace("_textbox",""),f=document.getElementById(u),i=f.getAttribute("calculator"),n,t;if(i&&(n=i.split(","),n.length!=0))for(t=0;t<n.length;t++)EvaluatorInteraction(n[t])}function EvaluatorInteraction(clientId){var i;try{var eleEvaluator=getRelationObject(clientId,"evaluator"),beans=eleEvaluator.Target,types=eleEvaluator.Types,express=eleEvaluator.Expression,length=beans.length,evaluator=document.getElementById(clientId),isNumber=!1;for(evaluator==null&&(evaluator=document.getElementById(clientId+"_textbox_curNum"),isNumber=!0),i=0;i<length;i++){var obj=document.getElementById(beans[i]),operator="@"+beans[i]+"@",value=getRealElement(obj);value.substring(0,1)==="-"&&(value=" "+value),express=express.replace(operator,value)}evaluator.control.set_Value(eval(express)),evaluator.onblur&&numeralsAfter(evaluator)}catch(e){}}function getRealValue(n,t,i){i=i==undefined||i==null?"0":i.toString();var u="[^\\d\\"+n+"\\"+t+"]",f=new RegExp(u,"g");return i=i.replace(f,"")}function getRealElement(n){var t,i;if(n.tagName=="INPUT")return getRealValue(".","-",n.parentElement.control.get_Value());for(t=0;t<n.children.length;t++)return i=n.children[t],getRealElement(i)}function getRelationObject(n,t){var u=null,r,i;if(t=="trigger"){if(r=TriggerArray.length,r==0)return u;for(i=0;i<r;i++)if(TriggerArray[i].ClientId==n){u=TriggerArray[i];break}}else{if(r=EvaluatorArray.length,r==0)return u;for(i=0;i<r;i++)if(EvaluatorArray[i].ClientId==n){u=EvaluatorArray[i];break}}return u}function ParseString(n,t){var i=n,u=new Array(t),r;if(n==null||t<=0)return null;for(r=0;r<t-1;r++)u[r]=i.substr(0,i.indexOf(",")),i=i.substr(i.indexOf(",")+1);return u[t-1]=i.substr(0,i.indexOf(",")),u}function GetSelectedSortDefines(treeID,fromGrid,toGrid,chkAllSortDefines,PTflag){var chk=document.getElementById(chkAllSortDefines),r,pos;if(chk)if(chk=eval(chkAllSortDefines).control,chk.get_Checked()==!0)AddSortSelectedNodes(treeID,fromGrid,toGrid,PTflag);else{var grid=eval(toGrid).control,gridFrom=eval(fromGrid).control,colEntityFullName=gridFrom.GetColumnIndex("EntityFullName");for(r=0;r<gridFrom.get_Rows();r++)if(gridFrom.RowChecked(gridFrom.D_Body.rows[r])){gridFrom.set_CurrentRowIndex(r);var value=gridFrom.GetCellValue(gridFrom.get_CurrentRowIndex(),gridFrom.GetColumnIndex("Item")),text=gridFrom.GetCellValue(gridFrom.get_CurrentRowIndex(),gridFrom.GetColumnIndex("FieldDisplayName")),entityFullName=gridFrom.GetCellValue(gridFrom.get_CurrentRowIndex(),colEntityFullName);if(value==null||text==null||entityFullName==null)continue;value=value.Text.trim(),text=text.Text.trim(),grid.ContainOf("Item",value)||(grid.AddNewRow(),pos=grid.get_Rows()-1,grid.SelectRow(pos,!1),grid.SetCellValue(pos,grid.GetColumnIndex("Item"),value),grid.SetCellValue(pos,grid.GetColumnIndex("FieldDisplayName"),text),grid.SetCellValue(pos,grid.GetColumnIndex("FieldTitle"),text))}}}function AddSortSelectedNodes(treeID,fromSortGrid,toGrid,PTflag){var tree=document.getElementById(treeID),j,errMsg,text,value,i;if(tree){var grid=eval(toGrid).control,tree=eval(treeID),strDescartesTag,treeItem,gridItem,gridFrom=eval(fromSortGrid).control,colItem=gridFrom.GetColumnIndex("Item"),blnItemExistInSortDefineGrid=!1,selectedNodes=[],Query_SortDescartesConflictMessage;for(tree.AllNodes.length>0&&(Query_SortDescartesConflictMessage=tree.AllNodes[0].Attributes.Query_SortDescartesConflictMessage),i=0;i<tree.AllNodes.length;i++)if(tree.AllNodes[i].Checked)if(strDescartesTag=tree.AllNodes[i].Attributes.Query_DescartesTag,strDescartesTag&&strDescartesTag!=""){for(blnItemExistInSortDefineGrid=!1,treeItem=tree.AllNodes[i].Value,j=0;j<gridFrom.get_Rows();j++)if(gridItem=gridFrom.GetCellValue(j,colItem).Text.trim(),treeItem==gridItem){blnItemExistInSortDefineGrid=!0;break}blnItemExistInSortDefineGrid?selectedNodes.push(tree.AllNodes[i]):(errMsg="["+tree.AllNodes[i].Text+"]"+Query_SortDescartesConflictMessage,alert(errMsg))}else selectedNodes.push(tree.AllNodes[i]);if(text="",value="",selectedNodes.Count!=0)for(i=0;i<selectedNodes.length;i++)text=selectedNodes[i].Text,value=selectedNodes[i].Value,!grid.ContainOf("Item",value)&&value.lastIndexOf(PTflag)<0&&(text=GetParentNodeWithoutGroupName(selectedNodes[i]),grid.AddNewRow(),grid.SelectRow(grid.get_Rows()-1,!0),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("Item"),value),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("FieldDisplayName"),text),grid.SetCellValue(grid.get_Rows()-1,grid.GetColumnIndex("FieldTitle"),text))}}function AddSelectedNodesToGrids(treeID,toGrid,toGridSort,PTflag){var tree=document.getElementById(treeID),selectedNodes,i,d,errMsg,pos;if(tree){for(tree=eval(treeID),selectedNodes=[],i=0;i<tree.AllNodes.length;i++)tree.AllNodes[i].Checked&&selectedNodes.push(tree.AllNodes[i]);if(selectedNodes.Count!=0){var text="",value="",grid=eval(toGrid).control;if(grid){var colIndexFieldDisplayName=grid.GetColumnIndex("FieldDisplayName"),colIndexItem=grid.GetColumnIndex("Item"),colIndexFieldTitle=grid.GetColumnIndex("FieldTitle"),colIndexDataType=grid.GetColumnIndex("DataType"),strDataType="",colDescartes=grid.GetColumnIndex("DescartesTag"),strDescartesTag="",strDescartesTag2="",text2="",isDescartesConflict=!1,Query_ColumnDescartesConflictMessage;for(tree.AllNodes.length>0&&(Query_ColumnDescartesConflictMessage=tree.AllNodes[0].Attributes.Query_ColumnDescartesConflictMessage),i=0;i<selectedNodes.length;i++)if(text=GetParentNodeWithoutGroupName(selectedNodes[i]),value=selectedNodes[i].Value,strDescartesTag=selectedNodes[i].Attributes.Query_DescartesTag,strDataType=selectedNodes[i].Attributes.DataType,strDescartesTag&&(strDescartesTag=strDescartesTag.trim()),!grid.ContainOf("Item",value)&&value.lastIndexOf(PTflag)<0){if(isDescartesConflict=!1,colDescartes>0&&strDescartesTag&&strDescartesTag!="")for(d=0;d<grid.get_Rows();d++)if(strDescartesTag2=grid.GetCellValue(d,colDescartes).Text.trim(),strDescartesTag2&&strDescartesTag2!=""&&!(strDescartesTag==strDescartesTag2||strDescartesTag.indexOf(strDescartesTag2+".")==0||strDescartesTag2.indexOf(strDescartesTag+".")==0)){text2=grid.GetCellValue(d,colIndexFieldDisplayName).Text.trim(),isDescartesConflict=!0;break}isDescartesConflict?(errMsg="["+text+"] & ["+text2+"]"+Query_ColumnDescartesConflictMessage,alert(errMsg)):(grid.AddNewRow(),pos=grid.get_Rows()-1,grid.SelectRow(pos,!1),grid.SetCellValue(pos,colIndexItem,value),grid.SetCellValue(pos,colIndexFieldDisplayName,text),grid.SetCellValue(pos,colIndexFieldTitle,text),colIndexDataType!="-1"&&grid.SetCellValue(pos,colIndexDataType,strDataType),colDescartes>0&&grid.SetCellValue(pos,colDescartes,strDescartesTag))}}}}}function GetParentNodeWithoutGroupName(n){if(n.Attributes.Query_BEGroup=="1")return n.Parent==null?"":GetParentNodeWithoutGroupName(n.Parent);if(n.Parent==null)return n.Text;var t=GetParentNodeWithoutGroupName(n.Parent);return t==""?n.Text:t+"."+n.Text}function DeleteRowFromGrids(fromGrid1,fromGrid2){var hasGrid2=document.getElementById(fromGrid2),grid2,minLeftCount,grid,r;if(hasGrid2&&(grid2=eval(fromGrid2).control),minLeftCount=1,fromGrid2.indexOf("GridSortDefine")==-1&&(minLeftCount=0),grid=eval(fromGrid1).control,!(grid.get_Rows()<=minLeftCount))if(grid.get_element().cusAttr("SelectModel")!="mulitline")DeleteRowsFromGrids(grid,grid2,hasGrid2);else for(r=grid.get_Rows()-1;r>=0;r--)grid.RowChecked(grid.D_Body.rows[r])&&grid.m_rows>minLeftCount&&(grid.set_CurrentRowIndex(r),DeleteRowsFromGrids(grid,grid2,hasGrid2))}function DeleteSelectedRows(grid){var hasGrid=document.getElementById(grid),gridObj,r;for(hasGrid&&(gridObj=eval(grid).control),r=gridObj.get_Rows()-1;r>=0;r--)gridObj.RowChecked(gridObj.D_Body.rows[r])&&gridObj.m_rows>0&&(gridObj.set_CurrentRowIndex(r),gridObj.DeleteRowAlways())}function DeleteRowsFromGrids(n,t,i){var u=n.get_CurrentRowIndex(),f=n.GetColumnIndex("IsFixed"),s=n.GetCellValue(u,n.GetColumnIndex("Item")),e,r,o;if(n.GetCellValue(u,f)==null||n.GetCellValue(u,f).Value!="true"){if(n.DeleteRowAlways(),i==null)return;for(e=t.GetColumnIndex("Item"),r=0;r<t.get_Rows();r++)if(o=t.GetCellValue(r,e),s.Value==o.Value){t.set_CurrentRowIndex(r),t.DeleteRowAlways();break}}}function QueryMovePreviousRow(gridID){var currentRowIndex;if(grid=eval(gridID).control,currentRowIndex=grid.get_CurrentRowIndex(),currentRowIndex!=0){var columnIndex=grid.GetColumnIndex("IsFrozen"),currentRowIsFrozen=grid.GetCellValue(currentRowIndex,columnIndex),previousRowIsFrozen=grid.GetCellValue(currentRowIndex-1,columnIndex);currentRowIsFrozen.Value=="false"&&previousRowIsFrozen.Value=="true"&&grid.SetCellValue(currentRowIndex,columnIndex,"true"),grid.MovePreviousRow("Sequence")}}function QueryMoveNextRow(gridID){var rowCount,currentRowIndex;if(grid=eval(gridID).control,rowCount=grid.get_Rows(),currentRowIndex=grid.get_CurrentRowIndex(),currentRowIndex!=rowCount-1){var columnIndex=grid.GetColumnIndex("IsFrozen"),currentRowIsFrozen=grid.GetCellValue(currentRowIndex,columnIndex),nextRowIsFrozen=grid.GetCellValue(currentRowIndex+1,columnIndex);currentRowIsFrozen.Value=="true"&&nextRowIsFrozen.Value=="false"&&grid.SetCellValue(currentRowIndex,columnIndex,"false"),grid.MoveNextRow("Sequence")}}function QueryMoveFirstRow(gridID){var currentRowIndex;if(grid=eval(gridID).control,currentRowIndex=grid.get_CurrentRowIndex(),currentRowIndex!=0){var columnIndex=grid.GetColumnIndex("IsFrozen"),currentRowIsFrozen=grid.GetCellValue(currentRowIndex,columnIndex),topRowIsFrozen=grid.GetCellValue(0,columnIndex);currentRowIsFrozen.Value=="false"&&topRowIsFrozen.Value=="true"&&grid.SetCellValue(currentRowIndex,columnIndex,"true"),grid.MoveFirstRow("Sequence")}}function QueryMoveLastRow(gridID){var rowCount,currentRowIndex;if(grid=eval(gridID).control,rowCount=grid.get_Rows(),currentRowIndex=grid.get_CurrentRowIndex(),currentRowIndex!=rowCount-1){var columnIndex=grid.GetColumnIndex("IsFrozen"),currentRowIsFrozen=grid.GetCellValue(currentRowIndex,columnIndex),lastIsFrozen=grid.GetCellValue(rowCount-1,columnIndex);currentRowIsFrozen.Value=="true"&&lastIsFrozen.Value=="false"&&grid.SetCellValue(currentRowIndex,columnIndex,"false"),grid.MoveLastRow("Sequence")}}function QueryOnCellDataChanged(gridID){var currentRowIsSum,currentRowDataType,currentRowIsFrozen,r;grid=eval(gridID).control;var rowCount=grid.get_Rows(),currentRowIndex=grid.get_CurrentRowIndex(),currentColumnIndex=grid.get_CurrentColumnIndex()+1,columnIsFrozen=grid.GetColumnIndex("IsFrozen"),columnIsSum=grid.GetColumnIndex("IsSum"),columnDataType=grid.GetColumnIndex("DataType");if(currentColumnIndex==columnIsSum)currentRowIsSum=grid.GetCellValue(currentRowIndex,columnIsSum).Value,currentRowDataType=grid.GetCellValue(currentRowIndex,columnDataType).Value,currentRowIsSum=="true"&&currentRowDataType!="System.Int64"&&currentRowDataType!="System.Int32"&&currentRowDataType!="System.Int16"&&currentRowDataType!="System.Decimal"&&currentRowDataType!="System.Double"&&grid.SetCellValue(currentRowIndex,columnIsSum,"false");else{if(currentRowIsFrozen=grid.GetCellValue(currentRowIndex,columnIsFrozen).Value,currentRowIsFrozen=="true")for(r=0;r<currentRowIndex;r++)grid.set_CurrentRowIndex(r),grid.SetCellValue(r,columnIsFrozen,"true");else for(r=currentRowIndex+1;r<rowCount;r++){if(grid.set_CurrentRowIndex(r),grid.GetCellValue(r,columnIsFrozen).Value=="false")break;grid.SetCellValue(r,columnIsFrozen,"false","false","false")}grid.set_CurrentRowIndex(currentRowIndex)}}function OnRowClicked4LineDisplayType(gridID){grid=eval(gridID).control;var rowCount=grid.get_Rows(),currentRowIndex=grid.get_CurrentRowIndex(),columnLineDisplayType=grid.GetColumnIndex("LineDisplayType"),columnDataType=grid.GetColumnIndex("DataType"),colDescartes=grid.GetColumnIndex("DescartesTag"),currentRowDataType=grid.GetCellValue(currentRowIndex,columnDataType).Value,currentDescartes=grid.GetCellValue(currentRowIndex,colDescartes).Value,enumLineDisplayType=grid.GetColumnControlByColumnName("LineDisplayType").control;enumLineDisplayType.DisplayAllItems(),currentDescartes==null||currentDescartes==""?grid.SetCellEnabledByFieldId(currentRowIndex,"LineDisplayType",!1):(grid.SetCellEnabledByFieldId(currentRowIndex,"LineDisplayType",!0),enumLineDisplayType._allItem[0].Text="",currentRowDataType=="System.String"?enumLineDisplayType.AddRemoveItem(!0,"3,4,5,6"):currentRowDataType=="System.Boolean"?enumLineDisplayType.AddRemoveItem(!0,"1,3,4,5,6"):currentRowDataType=="System.DateTime"||currentRowDataType=="System.Date"?enumLineDisplayType.AddRemoveItem(!0,"1,3,6"):currentRowDataType=="System.Int64"||currentRowDataType=="System.Int32"||currentRowDataType=="System.Int16"||currentRowDataType=="System.Decimal"||currentRowDataType=="Decimal"||currentRowDataType=="System.Single"?enumLineDisplayType.AddRemoveItem(!0,"1"):enumLineDisplayType.AddRemoveItem(!0,"1,3,4,5,6")),enumLineDisplayType.clear_Popup()}function BeforeCheckHandler(n){var t=n.Attributes.isFixed;if(t=="true")return!1}function BeforeColumnTreeNodeCheck(n){var r,u,o,i;if(!n||(r=n.TreeView,!r))return!1;if(u=n.Attributes.Query_DescartesTag,!(u&&u!=""))return!0;var l=GetParentNodeWithoutGroupName(n),y=n.Value,h=!1,a="",p="",w="",f="",s="",c="",e="",v="";if(r.AllNodes.length>0&&(c=r.AllNodes[0].Attributes.Query_ColumnDescartesConflictMessage,v=r.AllNodes[0].Attributes.Query_CaseDescartesConflictWith,e=r.AllNodes[0].Attributes.Query_CaseDescartesPath),e&&e!=""&&!(e==u||e.indexOf(u+".")==0||u.indexOf(e+".")==0))return s="["+l+"] & ["+v+"]"+c,alert(s),!1;for(o=[],i=0;i<r.AllNodes.length;i++)r.AllNodes[i].Checked&&(f=r.AllNodes[i].Attributes.Query_DescartesTag,f&&f!=""&&o.push(r.AllNodes[i]));if(o.length==0)return!0;for(h=!1,i=0;i<o.length;i++)if(f=o[i].Attributes.Query_DescartesTag,!(f==u||f.indexOf(u+".")==0||u.indexOf(f+".")==0)){a=GetParentNodeWithoutGroupName(o[i]),h=!0;break}return h?(s="["+a+"] & ["+l+"]\r\n"+c,alert(s),!1):!0}function Query$OpenDocMainForm(n,t,i,r,u){var f=n,h=f.get_CurrentRowIndex(),c=f.GetColumnIndex(t.arg.ColField),l=f.GetColumnIndex(i),e;if(c==l){if(e=f.GetColumnIndex("MainID"),e<0&&(e=f.GetColumnIndex("ID"),e<0)){alert("没有ID列？？ID列索引为 "+e);return}var a=f.GetCellValue(h,e).Value,o="",v=Query$BuildDocCardFormURL(a,r,o,u),s=AppendPopupUrl(v,o);window.top.TabPanelManager?window.top.TabPanelManager.addUrlTab("../"+s,o):window.open(s)}}function Query$BuildDocCardFormURL(n,t,i,r){var s=window.location.href,h=s.indexOf("ParentForm="),l,f,c,e,o,a;if(h<0){if(l=t.indexOf("ParentForm="),l<0)return"";for(f=t.split("&"),c="",j=0,len=f.length;j<len;j++)f[j].indexOf("ParentForm=")<0?c+=f[j]+"&":s+="&"+f[j];t=c.trim("&")}if((h=s.indexOf("ParentForm="),h<0)||(e=s.substring(h),o="",o=e.indexOf("&")>0?e.substring(0,e.indexOf("&")):e,o.indexOf("=")<=0))return"";var v=o.split("="),y=v[1],u="../ufsoft/simple.aspx?lnk="+y;return r!=null&&r!=""&&r!=undefined&&(u="../erp/display.aspx?lnk="+r),u+="&PDPageStatus=Browse",u+="&ID="+n,u+="&ShowType=NavigatePage",t!=null&&t!=""&&(u+="&"+t),a=AppendPopupUrl(u,i)}function U$Q$Log(n){var t=$get("qryLogBorad");t==null&&(t=document.createElement("div"),t.id="qryLogBorad",document.body.appendChild(t),btnClr=document.createElement("input"),btnClr.id="btnQryLogBorad",btnClr.type="button",btnClr.value="Clear All",$(btnClr).bind("click",U$Q$ClearLog),document.body.appendChild(btnClr)),t.innerHTML+=n}function U$Q$ClearLog(){$get("qryLogBorad").innerHTML=""}function RdoClick(n){var p=document.getElementById(parentID+"_filterHiddenField"),v=document.getElementById(parentID+"_rdoBasic"),y=document.getElementById(parentID+"_rdoAdvance"),t=window.document.getElementById(parentID+"_basicFrame"),i=window.document.getElementById(parentID+"_advanceFrame"),r=document.getElementById(parentID+"_imgOpen"),u=document.getElementById(parentID+"_imgConfig"),f=document.getElementById(parentID+"_imgOpen_button"),e=document.getElementById(parentID+"_imgConfig_button"),o=document.getElementById(parentID+"_basicDiv"),s=document.getElementById(parentID+"_advDiv"),h=document.getElementById(parentID+"_lblQuickLocate"),c=document.getElementById(parentID+"_txtQuickLocate"),l=document.getElementById(parentID+"_btnQuickLocate"),a=document.getElementById(parentID+"_cbQuickLocate");n?(p.value="basic",v.checked=!0,v.focus(),y.checked=!1,r&&(r.style.display=""),f&&(f.style.display=""),e&&(e.style.display=""),u&&(u.style.display=""),t&&(t.style.display="block"),i&&(i.style.display="none"),o&&(o.style.display="block"),s&&(s.style.display="none"),h&&(h.style.display="block"),c&&(c.style.display="block"),l&&(l.style.display="block"),a&&(a.style.display="none")):(p.value="adv",y.checked=!0,y.focus(),v.checked=!1,r&&(r.style.display="none"),f&&(f.style.display="none"),e&&(e.style.display="none"),u&&(u.style.display="none"),t&&(t.style.display="none"),i&&(i.style.display="block"),o&&(o.style.display="none"),s&&(s.style.display="block"),h&&(h.style.display="none"),c&&(c.style.display="none"),l&&(l.style.display="none"),a&&(a.style.display="none"))}function QuickLocationClick(n){if(window.event.keyCode==KeyCode.enter){var t=document.getElementById(n);$Event(window.event).stopPropagation(),$Event(window.event).preventDefault()}}function BasicKeyDown(){switch(window.event.keyCode){case KeyCode.enter:case KeyCode.tab:SetFocus(0)}}function BasicFocus(){var n=document.getElementById(parentID+"_rdoBasic"),t=document.getElementById(parentID+"_rdoAdvance");n.checked==!1&&t.focus()}function AdvKeyDown(){switch(window.event.keyCode){case KeyCode.enter:case KeyCode.tab:SetFocus(1)}}function SetFocus(n){var r=[],u=[],i,f,t;for(u=$F(document.frames[n]).getFrameDocument().getElementsByTagName("input"),i=0,f=u.length;i<f;i++)t=u[i],t.style.display=="none"||t.type=="hidden"||t.type=="button"||t.disabled||t.type!="image"&&r.push(t);r.length>0&&(t=r[0],t.focus())}function FilterSubmit(){var n=document.frames[parentID+"_basicFrame"],t=document.frames[parentID+"_advanceFrame"];n&&$F(n).getFrameDocument().forms[0]&&n.document.forms[0].submit(),t&&$F(t).getFrameDocument().forms[0]&&t.document.forms[0].submit()}function ShowBasicFilterTree(n){var t="dialogHeight:635px;dialogWidth:410px;scroll:no;status:no;help:no;";n+="&rad="+Math.random(),zlayer.open({title:"",area:["410px","500px"],argument:"",content:n,endHandle:function(n){var t=document.getElementById(parentID+"_rdoBasic");t.focus(),n&&doPostBackBasic()}})}function ShowAdvancedFilterTree(n){var t="dialogHeight:635px;dialogWidth:410px;scroll:no;status:no;help:no;";n+="&rad="+Math.random(),window.showModalDialog(n,"",t,function(n){n&&doPostBackAdv()})}function RefreshAdvFilterCtrl(){doPostBackAdv()}function OnAdvDeleteRow(){}function ShowFilterValue(n){var i="dialogHeight:455px;dialogWidth:693px;scroll:no;status:no;help:no;";window.showModalDialog(n,"",i,function(t){if(t!=null){var i=GetIsRefresh(t);i&&(n.indexOf("type=basic")>0?doPostBackBasic():n.indexOf("type=adv")>0&&doPostBackAdv())}})}function doPostBackBasic(){__doPostBack("u$M$639f9280954f4506b96f470ffba84ab3$Filter0$filterCtrl$basicDiv","")}function doPostBackAdv(){__doPostBack("u$M$639f9280954f4506b96f470ffba84ab3$Filter0$filterCtrl$advDiv","")}function GetIsRefresh(n){var t=GetXmlDoc(n),i=t.getElementsByTagName("Item");return i.item(0).getAttribute("isRefresh")}function GetFilterValueStr(n){var t=GetXmlDoc(n),i=t.getElementsByTagName("Item");return i.item(0).getAttribute("filtervalue")}function GetXmlDoc(n){var t=XMLHelper.createXMLDocument(n),i=XMLHelper.serializeXMLNodeToString(t);if(i.indexOf("errors")>-1)alert("createXMLDocument");else return t}function CloseWindow(n){zlayer.setReturnValue(n),zlayer.closeCurrentWindow()}function ReceiveServerData(){}function BeforeCheckHandler(n){var t=n.Attributes.isFixed;if(t=="true")return!1}function AfterCheckHandler(n){CallServer(n)}function CallServer(node){var nodeValue=node.Value,callServer=node.Attributes.CallServer;callServer!=null&&(nodeValue=node.Checked?nodeValue+",true":nodeValue+",false",callServer+="(nodeValue);",eval(callServer))}function CallParent(n){window.OnFilterItemChanged(n)}function Query$ShowQuickFindAttrProfile(){var n="2f539155-cc09-43f2-8818-941d47cf0515",f="dialogHeight:590px;dialogWidth:410px;scroll:no;status:no;help:no;",t=this.GetUrl(n,"TitleLink"),i=400,r=464,e=!1,u={showDialogCallback:function(n){var t=document.getElementById(parentID+"_rdoBasic");t.focus(),n&&doPostBackBasic()}};window.ShowModalDialogForAll(t,title,i,r,!0,!1,u)}function UF_WebForm_FindFirstFocusableChild(n){var u,t,i,r;if(!n||!n.tagName||(u=n.tagName.toLowerCase(),u=="undefined"))return null;if(t=n.childNodes,t)for(i=0;i<t.length;i++)try{if(UF_WebForm_CanFocus(t[i]))return t[i];if(r=UF_WebForm_FindFirstFocusableChild(t[i]),UF_WebForm_CanFocus(r))return r}catch(f){}return null}function UF_WebForm_AutoFocus(n){var t,i;if(t=__nonMSDOMBrowser?document.getElementById(n):document.childNodes[n],i=t,t&&!UF_WebForm_CanFocus(t)&&(i=UF_WebForm_FindFirstFocusableChild(t)),i)try{i.focus(),__nonMSDOMBrowser&&i.scrollIntoView(!1),window.__smartNav&&(window.__smartNav.ae=i.id)}catch(r){}}function UF_WebForm_CanFocus(n){if(!n||!n.tagName)return!1;var t=n.tagName.toLowerCase();return!n.disabled&&(!n.type||n.type.toLowerCase()!="hidden")&&UF_WebForm_IsFocusableTag(t)&&UF_WebForm_IsInVisibleContainer(n)}function UF_WebForm_IsFocusableTag(n){return n=="input"||n=="textarea"||n=="select"||n=="button"||n=="a"||n=="div"}function UF_WebForm_IsInVisibleContainer(n){for(var t=n;typeof t!="undefined"&&t!=null;){if(t.disabled||typeof t.style!="undefined"&&(typeof t.style.display!="undefined"&&t.style.display=="none"||typeof t.style.visibility!="undefined"&&t.style.visibility=="hidden"))return!1;if(typeof t.parentNode!="undefined"&&t.parentNode!=null&&t.parentNode!=t&&t.parentNode.tagName.toLowerCase()!="body")t=t.parentNode;else return!0}return!0}function addEvent(n,t,i){n.addEventListener&&!window.opera?n.addEventListener(t,i,!0):n["on"+t]=i}function removeEvent(n,t,i){n.removeEventListener&&!window.opera?n.removeEventListener(t,i,!0):n["on"+t]=null}function stopEvent(n){return n=n||window.event,n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),typeof n.cancelBubble!="undefined"&&(n.cancelBubble=!0,n.returnValue=!1),!1}function getTargetElement(n){return n=n||window.event,n.srcElement||n.target}function setCaret(n,t){try{n.focus()}catch(i){return}n.setSelectionRange?n.setSelectionRange(t,t):n.createTextRange&&(m=n.createTextRange(),m.moveStart("character",t),m.collapse(),m.select())}function curTop(n){for(var t=0;n;)t+=n.offsetTop,n=n.offsetParent;return t}function curLeft(n){for(var t=0;n;)t+=n.offsetLeft,n=n.offsetParent;return t}function replaceHTML(n,t){for(var i=n.childNodes[0];i;)n.removeChild(i),i=n.childNodes[0];n.appendChild(t)}function findtextboxtypecontrol(n){var i,t,r;if(n==null)return null;for(i=0;i<n.children.length;i++){if(t=n.children[i],t.control!=null&&t.control.get_Type()==ControlType.TextBox)return t;if(t.control!=null&&t.control.get_Enabled()==!1)continue;else{if(r=findtextboxtypecontrol(t),r==null)continue;return r}}return null}function getParamfromCustomInParamsControl(n){var s="UBF_CFControl=",h=n.substr(s.length),e=h.split("$"),t,c,r,o,u,f;for(i=0;i<e.length;i++)(t=e[i],t!=null&&t!="")&&((u=t.indexOf("="),u<0)||(c=t.substr(0,u),t=t.substr(u+1),f=t.indexOf("?"),f>0?(r=t.substr(0,f),o=t.substr(f+1)):r=t,n=$find(r)!=null?n.replace(t,$find(r).get_Value()):n.replace(t,"@"+o)));return n}function InputControlTemplate(){}function NumberTemplate(){}function DATATYPE_DECIMAL_Template(){}function DATATYPE_INT16_Template(){}function DATATYPE_INT_Template(){}function DATATYPE_INT64_Template(){}function DropDownListTemplate(){}function ReferenceTemplate(){}function RefInputCallback(n){this._input=n}function RefInputCallback$onDisplay(){return!0}function RefInputCallback$onDisconnect(){}function RefInputCallback$onSelectItem(n){$(this._input).val(n)}function RefInputCallback$onConfirmItem(n){n&&$(this._input).val(n.Code)}function PreButton_OnClick(){this.clickSender.Tab.OnNavButtonClick(0)}function NextButton_OnClick(){this.clickSender.Tab.OnNavButtonClick(1)}function PreButton_OnMouseOver(){this.className="TabPageNavButton_Previous_Hover"}function PreButton_OnMouseOut(){this.className="TabPageNavButton_Previous_Normal"}function NextButton_OnMouseOver(){this.className="TabPageNavButton_Next_Hover"}function NextButton_OnMouseOut(){this.className="TabPageNavButton_Next_Normal"}function Tab_OnMouseOver(){}function Tab_OnMouseOut(){}function inputHeadOnClick(){this.clickSender.Onclick()}function SetNextCurrentContainerValue(){if(BaseTop.NextCurrentContainer&&BaseTop.NextCurrentContainer.id){var n=window.document.getElementById("NextCurrentContainer");n&&(n.value=BaseTop.NextCurrentContainer.id+"|"+BaseTop.NextCurrentContainerDirection)}}function GlobalInputTemplate(){}function CheckBoxTemplate(){}function DateTimePickerTemplate(){}function TextBoxTemplate(){}function ControlClass(){}function FlexFieldTemplate(){}function EventCodeDef(){}function CreatePopup(n){if(n<0)return null;if(Pops[n]!=null)return Pops[n];n==0?Pops[0]=window.document.createElement("div"):(Pops[n-1]==null&&(Pops[n-1]=CreatePopup(n-1)),Pops[n]=window.document.createElement("div")),document.body.appendChild(Pops[n]),Pops[n].setAttribute("degree",n)}function ExpressionTemplate(){}function DataGridEvent(){}function GridSortMenu_Click(n,t){var i=$find(t);i!=null&&(i.attachDisplayControl.cusAttr("cmSort",n),i.attachDisplayControl.click())}function parseDate(n){if(typeof n=="string"){var t=n.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) *$/);if(t&&t.length>3)return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]));if(t=n.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2}) *$/),t&&t.length>6)return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]),parseInt(t[4]),parseInt(t[5]),parseInt(t[6]));if(t=n.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2})\.(\d{1,9}) *$/),t&&t.length>7)return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]),parseInt(t[4]),parseInt(t[5]),parseInt(t[6]),parseInt(t[7]))}return null}function funRetunFalse(){return!1}function Event(){}function RowStatus(){}function Col(){}function Sort(){}function DisplayStyle(){}function DefaultSymbol(){}function InsertedRowNoType(){}function BeforeResort(){var n="ddddd"}function AfterSort(){var n="ddddd"}function Compare(n,t,i){var r=0;return r=n>t?i?1:-1:n<t?i?-1:1:0}function CompareAtomy(n){return function(t,i){var r=0;switch(n){case Sort.StringUp:r=Compare(t.Text,i.Text,!0);break;case Sort.StringDown:r=Compare(t.Text,i.Text,!1);break;case Sort.IntUp:try{r=Compare(parseFloat(t.Text),parseFloat(i.Text),!0)}catch(u){}break;case Sort.IntDown:try{r=Compare(parseFloat(t.Text),parseFloat(i.Text),!1)}catch(u){}}return r}}function SortFormulas(n){for(var i,r,t=0;t<n.length;t++)SetFormulaRefDeep(t,n,0);for(t=0;t<n.length;t++)if(n[t].deep>0)for(i=t+1;i<n.length;i++)n[t].deep<n[i].deep&&(r=n[t],n[t]=n[i],n[i]=r)}function SetFormulaRefDeep(n,t,i){var r,u,f;if(t[n].deep==0&&!t[n].checked&&(r=t[n].indexs,t[n].deep=i,t[n].checked=!0,r.length>0))for(u=0;u<r.length;u++)f=GetSubFormulaIndex(r[u],t),f>=0&&SetFormulaRefDeep(f,t,i+1)}function GetSubFormulaIndex(n,t){for(var i=0;i<t.length;i++)if(t[i].columnIndex==n)return i;return-1}function IsOperationColumn(n,t){for(var i=0;i<t.length;i++)if(t[i]==n)return!0;return!1}var ZlayerCallBackItem=function(n,t){this.key=n,this.showDialogCallback=t,this.index=ZlayerCallBackArray.length},escapeHTML=_uf$escapeHTML,unescapeHTML=_uf$unescapeHTML,_ret,dragEffect,PD_textBox_HiddenContainer,outerLayout,middleLayout,innerLayout,mouseOverTime,calendarObj,startCalendarX,endCalendarX,startCalendarY,endCalendarY,calDivID,_isShow,Global_Debugger4P,_debugger,_ClientJSExecQueueManager,_ClientPostBackManager,_ClientCallBackManager,Global_ClientEventHandlerManager,ValidateFunction,HideErrorMsg_mout_Inner_Time,_Global_WillDoPostBack,Global_CallBackReturnJsQueueIsRunning,Global_JSQueueEvalAfterPageLoadedManager,Global_ScrollPanelList,isLast,IsJSCalculatorEvalAlert,FloatCalFun,TriggerArray,EvaluatorArray,suggesturl,image,displayData,ParmaArr,_isEnterOverTime,ContainerTag,ContainerAsControlTag,Pops,_SortObject;showModalDialogForAll=ShowModalDialogForAll;var current=null,dragging=!1,startedDragging=!1;PD_textBox_HiddenContainer=null;var _dropdown_box=null,_date_dropdown_box=null,_calendarControl=null,constErrType="",constErrDescription="",constErrUnknown="";document.onpropertychange=onPropertyChanged,mouseOverTime=0,_isShow=1,Calendar=function(n,t,i,r,u,f){function e(){var n=new Date,t,i;n.setTime(f.serverDateTime.getTime()),t=new Date,i=t-f.initDateTime,n.setMilliseconds(n.getMilliseconds()+i),this.todayDay=n.getDate(),this.todayMonth=n.getMonth(),this.todayYear=n.getFullYear(),this.today=n,this.activeCellIndex=0}n||(n=f.serverDateTime),this._date=n,calDivID=u+"calDiv",this._onSelected=i,this._onClose=r,this.dateClicked=!1,this.show=!1,this._ele=f,this._calendarDate=new e,this._date=this._calendarDate.today,this._culture=t,this._dtf=Sys.CultureInfo[t].DateTimeFormat,this._resx=Sys.CultureInfo[t].Resources;var o=document.createElement("OBJECT");this._popup=document.createElement("div"),this._popup.id=calDivID,this._popup.className="calendar_container",this._popup.style.wordWrap="break-word",this._popup.innerHTML=this.get_innerHtml(),this._popup.style.display="none",this._calendarTable=this.getElementById("CalendarTable"),this._calenderYear=this.getElementById("CalenderYear"),this._calenderMonth=this.getElementById("CalenderMonth"),this._calendarData=this.getElementById("calendarData"),this._calendarData.cells||(this._calendarData.cells=GetTablesCells(this._calendarData)),this.IsFullDate()&&(this._calenderTime=this.getElementById("CalenderTime"),this._calenderTime&&(this._calenderTime.value=Date$toFormattedStringEx(this._date,"T",this._culture),this._calendarDate.time=this._calenderTime.value,$(this._calenderTime).bind("change",this._calendar_time_onchange),$(this._calenderTime).bind("keydown",this._calendar_time_onkeydown))),$(this._popup).bind("keydown",this._calendar_onkeydown),$(this._calenderYear).bind("change",function(){}),this._calenderYear&&$(this._calenderYear).bind("change",this._calendar_year_onchange),this._calenderMonth&&$(this._calenderMonth).bind("change",this._calendar_month_onchange),this._calendarData&&$(this._calendarData).bind("mousedown",this._cell_onclick),this._calendarData&&$(this._calendarData).bind("dblclick",this._cell_ondoubleclick),this._btnLastYear=this.getElementById("btnLastYear"),this._btnLastYear&&$(this._btnLastYear).bind("click",this._btnLastYear_click),this._btnNextYear=this.getElementById("btnNextYear"),this._btnNextYear&&$(this._btnNextYear).bind("click",this._btnNextYear_click),this._btnLastMonth=this.getElementById("btnLastMonth"),this._btnLastMonth&&$(this._btnLastMonth).bind("click",this._btnLastMonth_click),this._btnNextMonth=this.getElementById("btnNextMonth"),this._btnNextMonth&&$(this._btnNextMonth).bind("click",this._btnNextMonth_click),this._btnToday=this.getElementById("btnToday"),this._btnToday&&($(this._btnToday).bind("click",this._btnToday_click),$(this._btnToday).bind("keydown",this._btnToday_onkeydown)),this.IsFullDate()&&(this._btnTime=this.getElementById("btnTime"),this._btnTime&&($(this._btnTime).bind("click",this._btnTime_click),$(this._btnTime).bind("keydown",this._btnTime_onkeydown),$(this._btnTime).bind("dblclick",this._btnTime_ondblclick))),this.setCalendarDate(this._date),document.body.appendChild(this._popup),window._dynarch_popupCalendar!=null?(window._dynarch_popupCalendar._popup.style.display="none",document.body.removeChild(document.getElementById(window._dynarch_popupCalendar._popup.id)),window._dynarch_popupCalendar=this):window._dynarch_popupCalendar=this},Calendar.get_current=function(){return window._dynarch_popupCalendar==null,window._dynarch_popupCalendar},Calendar.prototype.IsFullDate=function(){return this._ele.get_FormatString()=="G"},Calendar.prototype.getElementById=function(n){return this._popup?$(this._popup).find("#"+n)[0]:null},Calendar.prototype.get_innerHtml=function(){var i=1,n="",u,t,r,f,e;for(n+='<TABLE tabIndex="1"  id="CalendarTable" rule="all" width="220px"  cellspacing="0" cellpadding="0"  class="calendar_maintable">',n+='<TR class="calendar_title" valign="top"><TD>',n+='<TABLE WIDTH="100%" HEIGHT="100%" CELLSPACING="1" CELLPADDING="0" border="0"  class="calendar_ymtable">',n+='<TR><TD align="right"  class="calendar_ytd0">',n+='<i  id="btnLastYear" title="'+this._resx.Calendar_LastYear+"\" class='fa fa-chevron-left calendar-chevron'><\/i>",n+='<\/TD><TD width="1"  class="calendar_ytd1">',n+='<INPUT id="CalenderYear" type="text" class="calendar_textbox" size="4" maxlength="4" tabIndex="'+i+++'">',n+='<\/TD><TD align="left" width="20px"  class="calendar_ytd2">',n+='<i id="btnNextYear" title="'+this._resx.Calendar_NextYear+"\" class='fa fa-chevron-right calendar-chevron'><\/i>",n+="<\/TD>",n+='<TD align="right" width="55px"  class="calendar_mtd0">',n+='<i id="btnLastMonth" title="'+this._resx.Calendar_LastMonth+"\" class='fa fa-chevron-left calendar-chevron'><\/i>",n+="<\/TD><TD width=1  class='calendar_mtd1'>",n+='<INPUT id="CalenderMonth" type=text class=calendar_textbox size=2 maxlength=2 tabIndex="'+i+++'">',n+="<\/TD><TD align=left  class='calendar_mtd2'>",n+='<i id="btnNextMonth" title="'+this._resx.Calendar_NextMonth+"\" class='fa fa-chevron-right calendar-chevron'><\/i>",n+="<\/TD><\/TR>",n+="<\/TABLE><\/TD><\/TR>",n+="<TR class=calendar_data><TD>",n+="<TABLE border=0 bordercolor=silver id=\"calendarData\" HEIGHT=100% WIDTH=100% CELLSPACING=0 CELLPADDING=0 class='calendar_daytable'>",n+="<TR height=20px >",i++,u=this._dtf.AbbreviatedDayNames,t=0;t<=6;t++)n+="<TD align=center  class='calendar_weektd'>"+u[t]+"<\/TD>";for(n+="<\/TR>",t=0;t<=5;t++){for(n+="<TR height=18px>",r=0;r<=6;r++)n+="<TD align=center  class='calendar_daytd' ><\/TD>";n+="<\/TR>"}return n+="<\/TABLE><\/TD><\/TR>",this.IsFullDate()?(n+="<TR class=calendar_footer ><Td>",n+="<TABLE width='100%' height='100%'border='0'>",n+="<TR ><TD align=left>"):n+="<TR ><TD class=calendar_footer align=right>",f=this._calendarDate.today.toFormattedStringEx("D",this._culture),n+="<label id=\"btnToday\"   class='calendar_todaybutton' tabIndex='"+i+++"'>"+this._resx.Calendar_Today+" "+f+"<\/label><\/TD>",this.IsFullDate()&&(e=Date$toFormattedStringEx(this._calendarDate.today,"T",this._culture),n+="<TD align=right>",n+="<label id=\"btnTime\"   class='calendar_todaybutton' tabIndex='"+i+++"'>"+e+"<\/label><\/TD>",n+="<\/TABLE><\/TD>"),n+="<\/TR>",this.IsFullDate()&&(n+="<TR class=calendar_footer ><Td>",n+="<TABLE width='100%' height='100%'border='0'>",n+="<TR ><TD align=left>",n+="<label>"+this._resx.Calendar_Time+"<\/label><\/TD>",n+="<TD align=left>",n+="<input width='100%'class='textbox' id='CalenderTime' type='text' tabIndex='"+i+++"'/><\/TD><\/TR>",n+="<\/TABLE><\/TD><\/TR>"),n+="<\/TABLE>",n+='<iframe src="about:blank" scrolling="no" frameborder="0" style="z-index:-1;position:absolute; top:0px; left:0px;width:100%;height:100%">',n+="<\/iframe>"},Calendar.prototype.showAt=function(n,t){var i=this._popup.style;i.left=n+"px",i.top=t+"px",$(this._popup).find(".calendar_daytable td").each(function(){$(this).attr("classname")=="calendar_activeday"&&$(this).removeClass().addClass("calendar_activeday")}),i.display="",$("#CalendarTable").focus();$("#CalendarTable").on("mouseout",function(){_isShow=1}).on("mouseover",function(){_isShow=0}).on("focusout",function(){if(_isShow){var n=Calendar.get_current();n.cancelPopup(),$(this).hide()}});$(this._popup).mouseover(this.popupMouseOver),$(this._popup).mouseout(this.popupMouseOut),this.show=!0},Calendar.prototype.popupMouseOver=function(){var n=Calendar.get_current();n.clickInRect()&&(event.srcElement.tagName=="TD"&&event.srcElement.className=="calendar_curday"&&(event.srcElement.className="calendar_daytd_mo"),event.srcElement.tagName=="LABEL"&&event.srcElement.className=="calendar_todaybutton"&&(event.srcElement.className="calendar_todaybutton_MO")),n._ele.get_element()||n.cancelPopup()},Calendar.prototype.popupMouseOut=function(){var n=Calendar.get_current();n.clickInRect()&&(event.srcElement.tagName=="TD"&&event.srcElement.className=="calendar_daytd_mo"&&(event.srcElement.className="calendar_curday"),event.srcElement.tagName=="LABEL"&&event.srcElement.className=="calendar_todaybutton_MO"&&(event.srcElement.className="calendar_todaybutton"))},Calendar.prototype.cancelPopup=function(){this.clickInRect()?event.srcElement.tagName=="TD"&&this._cell_onclick():document.getElementById(calDivID)!=null&&(document.body.removeChild(document.getElementById(calDivID)),document.getElementById(this._buttonID)&&(document.getElementById(this._buttonID).className="btn DateBtn"),window._dynarch_popupCalendar=null,this.show=!1)},Calendar.prototype.clickInRect=function(){var n=document.getElementById(calDivID);if(n!=null){var t=n.getBoundingClientRect(),i=t.top+2,r=t.top+n.offsetHeight-2,u=t.left+5,f=t.left+n.offsetWidth-5;return event.clientX>u&&event.clientX<f&&event.clientY>i&&event.clientY<r?!0:!1}},Calendar.prototype.setCalendarDate=function(n){this.changeCalendarDate(n.getFullYear(),n.getMonth(),n.getDate())},Calendar.prototype.changeCalendarDate=function(n,t,i){var o,f,r,u,c,e;if(!isNaN(n)&&!isNaN(t)&&(this.IsFullDate()&&this._calenderTime&&(o=this._calenderTime.value,this._calendarDate.time=o),this._calendarDate.year!=n||this._calendarDate.month!=t||i&&this._calendarDate.day!=i)){if(this._calendarDate.year!=n||this._calendarDate.month!=t){this._calendarDate.year=n,this._calendarDate.month=t,t==0?(this._calendarDate.preMonth=11,this._calendarDate.preYear=this._calendarDate.year-1):(this._calendarDate.preMonth=this._calendarDate.month-1,this._calendarDate.preYear=this._calendarDate.year),t==11?(this._calendarDate.nextMonth=0,this._calendarDate.nextYear=this._calendarDate.year+1):(this._calendarDate.nextMonth=this._calendarDate.month+1,this._calendarDate.nextYear=this._calendarDate.year),this._calendarDate.startday=new Date(n,t,1).getDay(),this._calendarDate.startday==0&&(this._calendarDate.startday=7);var s=this.getNumberOfDays(this._calendarDate.month,this._calendarDate.year),h=this.getNumberOfDays(this._calendarDate.preMonth,this._calendarDate.preYear),v=this.getNumberOfDays(this._calendarDate.nextMonth,this._calendarDate.nextYear),l=h-this._calendarDate.startday+1,a=42-s-this._calendarDate.startday;for(this._calenderMonth&&(this._calenderMonth.value=this._calendarDate.month+1),this._calenderYear&&(this._calenderYear.value=this._calendarDate.year),f=0,r=l;r<=h;r++)u=this._calendarData.cells[f+7],u.setAttribute("monthAttribute","pre"),u.setAttribute("className","calendar_preday"),u.innerText=r,f++;for(r=1;r<=s;r++)u=this._calendarData.cells[f+7],u.setAttribute("monthAttribute","cur"),f!=this._calendarDate.activeCellIndex&&u.setAttribute("className","calendar_curday"),u.innerText=r,f++;for(r=1;r<=a;r++)u=this._calendarData.cells[f+7],u.setAttribute("className","calendar_nextday"),u.setAttribute("monthAttribute","next"),u.innerText=r,f++}i&&(this._calendarDate.day=i),c=this._calendarData.cells[this._calendarDate.day+this._calendarDate.startday- -6].innerHTML,e=parseInt(c),this._calendarDate.day>e?this.setCalendarActiveCell(this._calendarData.cells[this._calendarDate.day+this._calendarDate.startday- -6-e]):this.setCalendarActiveCell(this._calendarData.cells[this._calendarDate.day+this._calendarDate.startday- -6])}},Calendar.prototype.setCalendarActiveCell=function(cell){var _activeCellIndex,monthAttribute;if(cell&&cell.tagName.toLowerCase()=="td"){_activeCellIndex=cell.parentElement.rowIndex*7+cell.cellIndex-7;with(this._calendarDate){if(activeCellIndex==_activeCellIndex)return;monthAttribute=cell.getAttribute("monthAttribute");switch(monthAttribute){case"pre":this.changeCalendarDate(preYear,preMonth,this.getNumberOfDays(preMonth,preYear)-startday+_activeCellIndex+1),this.setActiveCell(startday+day-1);break;case"cur":this.changeCalendarDate(year,month,_activeCellIndex-startday+1),this.setActiveCell(_activeCellIndex);break;case"next":this.changeCalendarDate(nextYear,nextMonth,_activeCellIndex-this.getNumberOfDays(month,year)-startday+1),this.setActiveCell(startday+day-1)}}}},Calendar.prototype.setActiveCell=function(n){var t=this._calendarData.cells[this._calendarDate.activeCellIndex+7],r=t.getAttribute("monthAttribute"),i;r=="cur"?t.setAttribute("className","calendar_curday"):r=="pre"?t.setAttribute("className","calendar_preday"):r=="next"&&t.setAttribute("className","calendar_nextday"),i=t.getAttribute("tabIndex"),i?t.setAttribute("tabIndex",""):i=this._calenderMonth.getAttribute("tabIndex")*1+1,t=this._calendarData.cells[n+7],t.setAttribute("className","calendar_activeday"),t.setAttribute("tabIndex",i),this.show==!0&&this.getFocusedArea()==CalendarArea.Day&&t.focus(),this._calendarDate.activeCellIndex=n},Calendar.prototype.getActiveCell=function(){return this._calendarData.cells[this._calendarDate.activeCellIndex+7]},Calendar.prototype.getNumberOfDays=function(t,i){var r=[31,28,31,30,31,30,31,31,30,31,30,31];return n=r[t],t==1&&(i%4==0&&i%100!=0||i%400==0)&&n++,n},Calendar.prototype.callCloseHandler=function(){this._onClose&&(this.show=!1,this._onClose(this))},Calendar.prototype.hide=function(){this._popup&&(this._popup.style.display="none",document.getElementById(this._popup.id)!=null&&document.body.removeChild(document.getElementById(this._popup.id))),window._dynarch_popupCalendar=null,this.show=!1},Calendar.prototype.hideShowCovered=function(){this._popup&&(this._popup.style.display=this._popup.style.display==""?"none":""),window._dynarch_popupCalendar=null},Calendar.prototype.getFocusedArea=function(){var n=document.activeElement;if(n){if(n==this._calenderYear)return CalendarArea.Year;if(n==this._calenderMonth)return CalendarArea.Month;if(n.getAttribute("monthAttribute"))return CalendarArea.Day;if(n==this._btnToday)return CalendarArea.Today}return CalendarArea.Empty},Calendar.prototype.unload=function(){var n=Calendar.get_current();n.hide()},Calendar.prototype.load=function(){var n=Calendar.get_current();n._popup.style.display=""},Calendar.prototype._cell_onclick=function(){$alert("onclick");var n=Calendar.get_current(),t=event.srcElement;n.setCalendarActiveCell(t),n.dateClicked=!0,n.IsFullDate()||n.callHandler()},Calendar.prototype._cell_ondoubleclick=function(){$alert("ondoubleclick");var n=Calendar.get_current();n.dateClicked=!0,n.callHandler()},Calendar.prototype.callHandler=function(){this._onSelected&&this._onSelected(this)},Calendar.prototype._btnLastYear_click=function(){var n=Calendar.get_current(),t=n._calendarDate.year-1,i;parseInt(t)<1753||(i=n._calendarDate.month,n.changeCalendarDate(t,i))},Calendar.prototype._btnNextYear_click=function(){var n=Calendar.get_current(),t=n._calendarDate.year+1,i;parseInt(t)>9999||(i=n._calendarDate.month,n.changeCalendarDate(t,i))},Calendar.prototype._btnLastMonth_click=function(){var n=Calendar.get_current(),t=n._calendarDate.preYear,i;parseInt(t)<1753||(i=n._calendarDate.preMonth,n.changeCalendarDate(t,i))},Calendar.prototype._btnNextMonth_click=function(){var n=Calendar.get_current(),t=n._calendarDate.nextYear,i;parseInt(t)>9999||(i=n._calendarDate.nextMonth,n.changeCalendarDate(t,i))},Calendar.prototype._btnToday_click=function(){var n=Calendar.get_current(),i=n._calendarDate.todayYear,r=n._calendarDate.todayMonth,u=n._calendarDate.todayDay,t;n.changeCalendarDate(i,r,u),t=n._calendarDate.todayDay+n._calendarDate.startday-1,n.setCalendarActiveCell(n._calendarData.cells[t+7]),n.dateClicked=!0,n.callHandler()},Calendar.prototype._btnToday_onkeydown=function(){if(window.event.keyCode=KeyCode.tab){var n=Calendar.get_current();n.IsFullDate()||(n._calenderYear.focus(),$Event(event).stopPropagation(),$Event(event).preventDefault())}},Calendar.prototype._btnTime_click=function(){var n=Calendar.get_current();n._calenderTime.value=n._btnTime.innerHTML},Calendar.prototype._btnTime_onkeydown=function(){window.event.keyCode=KeyCode.tab},Calendar.prototype._btnTime_ondblclick=function(){var n=Calendar.get_current(),t=n._calendarDate.todayYear,i=n._calendarDate.todayMonth,r=n._calendarDate.todayDay;n.changeCalendarDate(t,i,r),n.dateClicked=!0,n.callHandler()},Calendar.prototype.SetInputYearMonth=function(){var n=document.getElementById("CalenderMonth"),t=document.getElementById("CalenderYear"),i=parseInt(t.value,10),r=parseInt(n.value,10);this.changeCalendarDate(i,r-1)},Calendar.prototype._calendar_onkeydown=function(){var n=Calendar.get_current(),r,u,s,i,f,t;_calendarControl=n._calendarDate;switch(event.keyCode){case 18:n.callHandler();case 13:r=document.getElementById("CalenderYear"),u=parseInt(r.value),(r.value.length!=4||u<1753||u>9999)&&(r.value=n._calendarDate.year,event.cancelBubble=!1,$Event(event).preventDefault());var r=document.getElementById("CalenderYear"),u=parseInt(r.value),e=document.getElementById("CalenderMonth"),o=parseInt(e.value);(r.value.length!=4||u<1753||u>9999)&&(r.value=n._calendarDate.year,event.cancelBubble=!1,$Event(event).preventDefault()),u==1753&&o<1&&(e.value=n._calendarDate.month+1,event.cancelBubble=!1,$Event(event).preventDefault()),u==9999&&o>12&&(e.value=n._calendarDate.month+1,event.cancelBubble=!1,$Event(event).preventDefault()),n=Calendar.get_current(),t=_calendarControl.activeCellIndex,t<0&&(t=0),s=calendarData.cells[t+7],n.setCalendarActiveCell(s),n.SetInputYearMonth(),n.dateClicked=!0,n.callHandler(),$Event(event).stopPropagation(),$Event(event).preventDefault();break;case 27:hideDropDownBox(),n.callCloseHandler();break;case 33:event.ctrlKey?n.changeCalendarDate(_calendarControl.year-1,_calendarControl.month):n.changeCalendarDate(_calendarControl.preYear,_calendarControl.preMonth);break;case 34:event.ctrlKey?n.changeCalendarDate(_calendarControl.year+1,_calendarControl.month):n.changeCalendarDate(_calendarControl.nextYear,_calendarControl.nextMonth);break;case 37:n.getFocusedArea()==CalendarArea.Day&&(t=_calendarControl.activeCellIndex-1,t<0&&(t=0),n.setCalendarActiveCell(calendarData.cells[t+7]),$Event(event).stopPropagation(),$Event(event).preventDefault());break;case 38:i=n.getFocusedArea(),i==CalendarArea.Day?_calendarControl.activeCellIndex<14?(f=n.getNumberOfDays(_calendarControl.preMonth,_calendarControl.preYear)+_calendarControl.day-7,n.setCalendarDate(new Date(_calendarControl.preYear,_calendarControl.preMonth,f))):(t=_calendarControl.activeCellIndex-7,n.setCalendarActiveCell(calendarData.cells[t+7])):i==CalendarArea.Month?n.changeCalendarDate(_calendarControl.preYear,_calendarControl.preMonth):i==CalendarArea.Year&&n.changeCalendarDate(_calendarControl.year-1,_calendarControl.month),$Event(event).stopPropagation(),$Event(event).preventDefault();break;case 39:n.getFocusedArea()==CalendarArea.Day&&(t=_calendarControl.activeCellIndex+1,t>=calendarData.cells.length-7&&(t=calendarData.cells.length-8),n.setCalendarActiveCell(calendarData.cells[t+7]),$Event(event).stopPropagation(),$Event(event).preventDefault());break;case 40:i=n.getFocusedArea(),i==CalendarArea.Day?_calendarControl.activeCellIndex>34?(f=7-(n.getNumberOfDays(_calendarControl.month,_calendarControl.year)-_calendarControl.day),n.setCalendarDate(new Date(_calendarControl.nextYear,_calendarControl.nextMonth,f))):(t=_calendarControl.activeCellIndex+7,n.setCalendarActiveCell(calendarData.cells[t+7])):i==CalendarArea.Month?n.changeCalendarDate(_calendarControl.nextYear,_calendarControl.nextMonth):i==CalendarArea.Year&&n.changeCalendarDate(_calendarControl.year+1,_calendarControl.month),$Event(event).stopPropagation(),$Event(event).preventDefault()}},Calendar.prototype._calendar_time_onchange=function(){var n=Calendar.get_current(),t=document.getElementById("CalenderTime");n._calendarDate.time=t.value},Calendar.prototype._calendar_time_onkeydown=function(){if(window.event.keyCode===KeyCode.tab){var n=Calendar.get_current();n._calenderYear.focus(),$Event(event).stopPropagation(),$Event(event).preventDefault()}},Calendar.prototype.validateInputTime=function(n){if(n){var i=new Date,t=n.split(":");return t.length!=3?!1:(i.setHours(t[0]*1),t[0]==""||i.getHours()!=t[0]*1)?!1:(i.setMinutes(t[1]*1),t[1]==""||i.getMinutes()!=t[1]*1)?!1:(i.setSeconds(t[2]*1),t[2]==""||i.getSeconds()!=t[2]*1)?!1:!0}return!1},Calendar.prototype._calendar_year_onchange=function(){var t=Calendar.get_current(),i=document.getElementById("CalenderYear"),n=parseInt(i.value),r;if(i.value.length!=4||n<1753||n>9999){i.value=t._calendarDate.year;return}isNaN(n)&&(n=t._calendarDate.year),r=t._calendarDate.month,t.changeCalendarDate(n,r)},Calendar.prototype._calendar_month_onchange=function(){var t=Calendar.get_current(),i=document.getElementById("CalenderMonth"),r,n;if(!(i.value.length==1||i.value.length==2)){i.value=t._calendarDate.month+1;return}if(r=t._calendarDate.year,n=parseInt(i.value,10),isNaN(n)&&(n=t._calendarDate.month),n--,n<0||n>11){i.value=t._calendarDate.month+1;return}t.changeCalendarDate(r,n)};var CalendarArea={Empty:-1,Year:0,Month:1,Day:2,Today:3},CallbackLaunchArray=[],CallbackSourceArray=[],CallbackTargetArray=[],SetDivstring="^@~&*_",RowDivstring="^@$&*_",ColDivstring="^*$&@_";Global_Debugger4P=!1,$(function(){window.location.href.indexOf("simple.aspx?")!=-1&&$(document).bind("keydown",{},function(n){n.keyCode==27&&window.close()})});var autoRecover={recoverState:function(n,t,i){n&&zlayer.open({title:"自动恢复",area:["850px","360px"],argument:window,content:"../mvc/tempstorage/ShowRecover?formID="+n+"&sessionID="+t+"&operateSymbol="+i+"",endHandle:function(t){if(t.id){var r=document.createElement("input");r.type="hidden",r.id="fileid",r.name="fileid",r.value=t.id,$("form").append(r),__doPostBack("","")}t.checked||$.post("../mvc/tempstorage/ClearTempStroage",{fromID:n,OperateSymbol:i,mt:window.top.Math.uuid()},function(n){console.log(n)})}})}},_Sys_Busy=null,GridIsInFocus=!1,_xmlhttpRequest=null,curPopMenu,_LoadingSpan=null;EvalFunction=function(func){var tempJS,willRunPost,len,cT,gT,suc,i,ele;Global_Debugger4P,_debugger;try{JavaScriptDebugTool.LogCallBackReturnJS&&($alert(""),$alert("CallBack ReturnValue : "),$alert(func)),Global_CallBackReturnJsQueueIsRunning=!0,tempJS=func,tempJS.indexOf("\r\n")>-1&&(tempJS=tempJS.replace(/\r\n/g,"")),tempJS.indexOf("\n")>-1&&(tempJS=tempJS.replace(/\n/g,"")),tempJS.indexOf("\r")>-1&&(tempJS=tempJS.replace(/\r/g,"")),eval(tempJS),Global_CallBackReturnJsQueueIsRunning=!1}catch(e){$alert&&($alert("※ CallBack Script Run Error : [ "+e.message+"], Source Script:"),$alert(func),$alert("--------------------------------------"))}Global_Debugger4P,willRunPost=!1;try{if(_ClientCallBackManager.Handlers.length==0&&(_ClientCallBackManager.Runing=!1,_ClientPostBackManager.SrcElement.length>0&&_ClientCallBackManager.StopPost)){for(_ClientCallBackManager.StopPost=!1,len=_ClientPostBackManager.SrcElement.length,i=0;i<len;i++)cT=$find(_ClientPostBackManager.SrcElement[i]),cT&&cT.get_Type()==ControlType.Menu&&($find(_ClientPostBackManager.SrcElement[i])._hidden.value=_ClientPostBackManager.MenuIndex[i]),willRunPost=!0,_ClientPostBackManager.SrcElementArgument!=null&&_ClientPostBackManager.SrcElementArgument[i]!=null?(gT=$find(_ClientPostBackManager.SrcElement[i].replace(/\$/g,"_")),gT&&gT.get_Type()==ControlType.DataGrid&&(suc=gT.RecoveryEventNode(_ClientPostBackManager.SrcElementArgument[i]),suc==!0&&(_ClientPostBackManager.SrcElementArgument[i]="")),__doPostBack(_ClientPostBackManager.SrcElement[i],_ClientPostBackManager.SrcElementArgument[i])):__doPostBack(_ClientPostBackManager.SrcElement[i],"");for(i=0;i<len;i++)_ClientPostBackManager.SrcElement.shift(),_ClientPostBackManager.SrcElementArgument.shift(),_ClientPostBackManager.MenuIndex.shift()}_ClientCallBackManager.Runing==!1&&_ClientPostBackManager.Runing==!1&&Get_Global_WillDoPostBack()==!1&&Global_JSQueueEvalAfterPageLoadedManager.Eval()}catch(ee){}_ClientCallBackManager.Runing=!1,willRunPost||(_LoadingSpan==null&&(_LoadingSpan=document.getElementById("spWait")),ele=_LoadingSpan,ele&&(ele.className="WaitSpanHideClass1")),Global_Debugger4P,_ClientCallBackManager.Start(!0)},_debugger=!1,_ClientJSExecQueueManager=new ClientJSExecQueueManager,_ClientPostBackManager=new ClientPostBackManager,afterOnLoad=function(){var f,u,i,e,r;if(TdSetHeightHelper.Tools.OnResize(),Sys&&(_LoadingSpan==null&&(_LoadingSpan=document.getElementById("spWait")),f=_LoadingSpan,f&&(f.className="WaitSpanHideClass1"),lockElement(!1),Sys.WebForms&&Sys.WebForms.PageRequestManager.getInstance().remove_pageLoaded(afterOnLoad)),ClearControlProxyValue(),document&&document.body)for(u=document.getElementsByTagName("SPAN"),i=0,e=u.length;i<e;i++)u[i].className=="MenuItemSpan"&&(r=u[i].children[0],r.h=r.href,r.removeAttribute("href"),r.onclick=function(){return OnBeforeQuickMenuRedirect(this)});window.$&&$(function(){document.body.onbeforeunload=OnBeforeWindowUnload})},_ClientCallBackManager=new ClientCallBackManager,Global_ClientEventHandlerManager=new ClientEventHandlerManager,ValidateFunction=[],addValidater=function(n){var i=!0,t;if(n)for(t=0;t<ValidateFunction.length;t++)if(n==ValidateFunction[t]){i=!1;break}i&&ValidateFunction.push(n)},lockElement=function(n){function o(n){if(n==null)return!1;if(n.className.containsCssClass("TC tPn"))return!0;if(n.id){if(n.id.replace(/_BtnOK$/g,"").length<n.id.length||n.id.replace(/_BtnPopCancel$/g,"").length<n.id.length||n.id.replace(/_ConfirmButton$/g,"").length<n.id.length||n.id.replace(/_CancelButton$/g,"").length<n.id.length)return!0;var t=$find(n.id);if(t&&t.IsHiddeLoading)return t.IsHiddeLoading()}return!1}var t,r,i;n||_ClientPostBackManager.Runing!=!0||(window._CancelWaitSpanSetTimeOutHandler=!0),_LoadingSpan==null&&(_LoadingSpan=document.getElementById("spWait")),t=_LoadingSpan;try{window.event&&(window.event.srcElement?window.event.srcElement.type=="button"&&(window.event.srcElement.disabled=n,t&&(t.src=window.event.srcElement)):n||t&&t.src&&(t.src.disabled=n,t.src=null))}catch(s){}var u="WaitSpanHideClass1",f="WaitSpanHideClass1",e="WaitSpanHideClass1";n?(r=null,theForm&&theForm.__EVENTTARGET&&theForm.__EVENTTARGET.value&&$ID(theForm.__EVENTTARGET.value.replace(/\$/g,"_"))&&(r=$ID(theForm.__EVENTTARGET.value.replace(/\$/g,"_"))),o(r)&&(u=e),t&&(t.className=u),i=$ID("u_Displaytitle1_ctl00_btnLogout"),i&&!i.getAttribute("href1")&&(i.setAttribute("href1",i.getAttribute("href")),i.setAttribute("href","javascript:void(0);"))):t&&(t.className=f)},afterOnLoad4RemoveWaitSpan=function(){if(Sys&&_ClientPostBackManager&&_ClientPostBackManager.Runing){_LoadingSpan==null&&(_LoadingSpan=document.getElementById("spWait"));var n=_LoadingSpan;n&&(n.className="WaitSpanHideClass1"),lockElement(!1)}},ActionManager.prototype.showDialogCallback=function(ret,args){var a,obj,saveid,script;if(ret==!0){Array.add(_ClientPostBackManager.DirtyDataDelayEventArray,args.srcElementID),args.EventType==Global_DirtyData_EventType.DropDownButtonMenu&&$find(args.srcElementID)._hidden.value!=""&&$find(args.srcElementID)._hidden.value!=$find(args.srcElementID)._hidden.oldvalue&&(a=$find(args.srcElementID),obj={},obj.id=args.srcElementID,obj._hiddenvalue=$find(args.srcElementID)._hidden.value,Array.add(_this.PopMenuHiddenValues,obj),$find(args.srcElementID)._hidden.value=""),saveid=GetBtnSaveID().replace(/_/g,"$"),__doPostBack(saveid,""),lockElement(!1);return}if(ret==!1)Set_Global_IsDirtyData_TheForm(!1),Set_Global_IsCheckDirtyData_TheForm(!1),Set_Global_NeedResetCheckDirtyTagWhenEnd(!0),script=args.script,eval(script);else if(ret==undefined){if(lockElement(!1),top.__UFCurrentFocusControl&&$get(top.__UFCurrentFocusControl))try{$get(top.__UFCurrentFocusControl).focus()}catch(e){}return}},DoAction=function(script){var postEventTarget,actionManager,retValue,args,url,ret;if(caCheck(script)===!1||window.location.href.indexOf("41b0fca9-103e-40b9-8629-b5ec283c1fb8")>-1&&window.event.target.id=="u_S_S1_OnFind_button"&&window.isLayering)return!1;postEventTarget=script.replace("__doPostBack",""),postEventTarget=postEventTarget.replace("(",""),postEventTarget=postEventTarget.replace(")",""),postEventTarget=postEventTarget.replaceAll("'",""),postEventTarget=postEventTarget.replace(",",""),actionManager=new ActionManager,Global_Debugger4P,postEventTarget&&(retValue=IsShowConfirmSaveDialog(postEventTarget),args={EventType:retValue.EventType,srcElementID:window.event.srcElement.id,script:script},retValue.Value?(url="../ufsoft/saveconfirm.aspx?chromeType=4&ShowType=ShowModal",ret=ShowModalDialogForAll(url,"","120","365","true","false",actionManager,args)):eval(script))},beforeSubmit=function(){if(window._NotFirePostBackControl&&theForm.__EVENTTARGET.value&&window._NotFirePostBackControl==theForm.__EVENTTARGET.value)return!1;var n=!0;return window._TextBoxFirePostBack==!0?(window._CancelWaitSpanSetTimeOutHandler=!1,window.setTimeout(function(){window._CancelWaitSpanSetTimeOutHandler||lockElement(!0)},100)):lockElement(!0),DataCollect(),ClearErrorMsgDiv(),n},DataCollect=function(){for(var startIndex=0,g,m,i=0;i<ValidateFunction.length;i++)if(m=ValidateFunction[i].match(/\$find\(['"]([_a-zA-Z0-9]+)['"]\)\.BeforeSubmit\(\);/),m&&(g=$find(m[1]),g&&g.m_gridBodyEventsHandler&&g.m_gridBodyEventsHandler.GridEditHelper&&g.m_gridBodyEventsHandler.GridEditHelper.CellEditActive==!0)){startIndex=i;break}for(res=eval(ValidateFunction[startIndex]),i=0;i<ValidateFunction.length;i++)i!=startIndex&&(res=eval(ValidateFunction[i]))},ValidateMe=function(){for(var res=!0,res=_ClientCallBackManager.Runing?!1:!0,i=0;i<ValidateFunction.length;i++)if(res=eval(ValidateFunction[i]),res==!1)break;return _ClientCallBackManager.Runing&&(res=!1),Sys&&(res,Sys.WebForms&&Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(afterOnLoad)),res&&(_ClientPostBackManager.Runing=!0,Set_Global_WillDoPostBack(!1),_ClientCallBackManager.Clear()),res},RowData.RowFlag="Items",RowData.CellFlag="Item",RowData.CellID="FieldID",RowData.CellValue="Value",Basic.NameSpace="W:",Basic.TimeFocusEvent=!1,Basic.GridEditSetFocus=function(n){try{n&&(n.value==""?n.focus():(n.focus(),window.event.type=="keydown"&&$Event(event).preventDefault()))}catch(t){}},Basic.SetFocus=function(n){Basic.TimeFocusEvent=!0,n.id!=""?setTimeout(" SetIDFocus('"+n.id+"')",100):setTimeout(n.focus,100),setTimeout(Basic.ResetFlag,101)},Basic.ResetFlag=function(){Basic.TimeFocusEvent=!1},Basic._loadXML=function(n){return XMLHelper.createXMLDocument(n)},Basic.GetXmlDom=function(){return XMLHelper.createXMLDocument("")},Basic.loadXML=function(n,t){return XMLHelper.createXMLDocument(t)},Basic.SendXmlData=function(n,t){var i,r,u;return(t==null||t=="")&&(t=""),i=RequestHelper.getXHR(),r=t,i.open("post",r,!1),i.send(n),testXmlhttp(i)?i.responseText:u=""},HideErrorMsg_mout_Inner_Time=null,$SetControlValue=function(n,t,i,r,u,f,e,o){var l,c,a,s,v,y,h,p,w;if(f!="Run4P")if(l=e,l!=0&&l!=2&&(l=1),$find(n)){if($find(n).get_Enabled()==!1||$find(n).get_ReadOnly()==!0)return;c={},c.IsSetControlValue=!0,c.ValueSource=l,c.GridControl=o,o?($find(n).set_SetControlValue(c),$find(o.id).set_SetControlValue(c)):$find(n).set_SetControlValue(c),t?r=="-1"?$find(n).get_Key()!="-1"&&($find(n)._textbox.value="",$find(n).onInputReturn()):$find(n).get_Key()!=r&&(a=UF.UI.Reference.DisableShowForm,UF.UI.Reference.DisableShowForm=!0,s=$find(n),s._oldKey=s.get_Key(),s._oldValue=s.get_Value(),s._oldText=s.get_Text(),v=s._isNeedValidate,y=s.get_IsRaiseEvent(),s._isNeedValidate=!1,s.set_IsRaiseEvent(!1),s.set_Key(r),s.set_Value(i),s.set_Text(u),s.set_IsRaiseEvent(y),s._isNeedValidate=v,s._key4Simulator=r.toString(),s.ForceFireContentChange(),UF.UI.Reference.DisableShowForm=a):($find(n).get_Type()==ControlType.CheckBox?$find(n).get_Value()!=i&&($find(n).set_Value(i),$find(n).changePD(),$find(n)._checkbox.onclick&&$find(n)._checkbox.onclick()):$find(n).get_Type()==ControlType.DateTime?$find(n).get_Value()!=i&&($find(n)._textbox.value=i,$find(n).inputChange()):$find(n).get_Type()==ControlType.DropDownList?i!=null?$find(n).get_Value().toString()!=i.toString()&&($find(n).set_Value(i),$find(n).ControlBlur(),$find(n).raiseonchange(Sys.EventArgs.Empty),$find(n).raiseOnValueChanged(Sys.EventArgs.Empty)):u!=null&&$find(n).get_Text()!=u&&($find(n).set_Text(u),$find(n).ControlBlur(),$find(n).raiseonchange(Sys.EventArgs.Empty),$find(n).raiseOnValueChanged(Sys.EventArgs.Empty)):$find(n).get_Type()==ControlType.Numberic?$find(n).get_Value()!=i&&($find(n)._textbox.value=i,$find(n)._textbox.fireEvent("onchange"),$find(n)._textbox.fireEvent("onblur")):$find(n).get_Type()==ControlType.FlexField?$find(n).get_Value()!=i&&($find(n)._textbox.value=i,$find(n)._textbox.fireEvent("onchange")):$find(n).get_Type()==ControlType.TextBox?$find(n).get_Value()!=i&&($find(n).set_Value(i),$find(n)._textbox.fireEvent("onchange"),$find(n)._textbox.fireEvent("onblur")):$find(n).get_Value()!=i&&($find(n).set_Value(i),$find(n)._textbox.fireEvent("onchange")),h=!0,$find(n).get_Value().toString().toLowerCase()!=i.toString().toLowerCase()&&($find(n).get_Type()==ControlType.DateTime?(p=$find(n)._date.format("yyyy-MM-dd hh:mm:ss"),w=(new Date).ufString2DateTime(i).format("yyyy-MM-dd hh:mm:ss"),p.toString()!=w.toString()&&(h=$find(n).get_FormatString()=="d"?$find(n)._date.getDate()==(new Date).ufString2DateTime(i).getDate()?!0:!1:!1)):$find(n).get_Type()==ControlType.Numberic&&($find(n).get_Value()==""?isNaN(i)||(h=!1):i==""?isNaN($find(n).get_Value())||(h=!1):isNaN($find(n).get_Value())||isNaN(i)?h=isNaN($find(n).get_Value())&&isNaN(i)?!0:!1:Math.abs(parseFloat($find(n).get_Value())-parseFloat(i))>1&&(h=!1))),h?$find(n).RemoveSetControlValueErrorMsg():$find(n).ShowSetControlValueErrorMsg())}else t?_ClientJSExecQueueManager.Push("window.setTimeout(\"$SetControlValue('"+n+"',true,'"+i+"','"+r+"','"+u+"');\",100);"):_ClientJSExecQueueManager.Push("window.setTimeout(\"$SetControlValue('"+n+"',false,'"+i+"');\",100);")},$SetSndLoadControlValue=function(n){var f,e,u;if(n!=undefined&&n!=null)for(f=0,e=n.length;f<e;f++){var r=n[f],t=r.ValueFieldID,o=r.IsRef,c=r.IsFromCard,s=r.CodeField,i=r.ValueField,h=r.NameField;c?$find(t)&&(o?i=="-1"?$find(t).get_Key()!="-1"&&($find(t)._textbox.value=""):$find(t).get_Key()!=i&&($find(t).set_Key(i),$find(t).set_Value(s),$find(t).set_Text(h)):$find(t).get_Value()!=i&&$find(t).set_Value(i)):(u=$find(n.gridID),u&&(o?u.SetReferenceCellValue(n.rowIndex,u.GetColumnIndex(t),i,s,h):u.SetCellValue(n.rowIndex,u.GetColumnIndex(t),i)))}},MaskChar.Default="'";var ATTRIBUTE_ID="ID",ATTRIBUTE_KEYATTRIBUTE="KeyAttribute",ATTRIBUTE_TYPE="Type",ATTRIBUTE_VALUE="Value",ATTRIBUTE_KEY="Key",ATTRIBUTE_CODE="Code",ATTRIBUTE_NAME="Name",ATTRIBUTE_SELECTEDINDEX="SelectedIndex",ATTRIBUTE_SELECTEDVALUE="SelectedValue";ControlProxyNodeName.Data="Data",ControlProxyNodeName.Control="Control",ControlProxyAttribute.ID="ID",ControlProxyAttribute.Value="Value",ControlProxyAttribute.Code="Code",ControlProxyAttribute.Name="Name",ControlProxyAttribute.Type="Type";var Global_IsCheckDirtyData_TheForm=!0,Global_IsDirtyData_TheForm=!1,Global_CheckDirtyDataIDs="BtnCancel,BtnAdd,BtnCopy,BtnFirstPage,BtnPrevPage,BtnNextPage,BtnLastPage,BtnList,BtnFind,BtnPrint",Global_DirtyDataSaveSuccessFlag=null,Global_DirtyDataCancelSuccessFlag=null,Global_BtnSaveID=null,Global_IsPageLoadComplete=!1,Global_NeedResetCheckDirtyTagWhenEnd=!1;Global_DirtyData_EventType.Empty=-1,Global_DirtyData_EventType.Toolbar=0,Global_DirtyData_EventType.DropDownButtonMenu=1,Global_DirtyData_EventType.NavigatorMenu=2;var Global_BtnRePostBackWithDoNothingID="",Global_GridCurrentRowIndex4PIsValid=!1,Global_GridCurrentRowIndex4P=-1;_Global_WillDoPostBack=!1,Global_CallBackReturnJsQueueIsRunning=!1,Global_JSQueueEvalAfterPageLoadedManager=new JSQueueEvalAfterPageLoadedManager,Global_ScrollPanelList=[],isLast=0,IsJSCalculatorEvalAlert=!1,window.PersonalWarnMsgManager=new PersonalWarnMsgManager,GridCustomFilterToolbarManager=function(n,t,i){var r=this;this._owner=t,this.toolBar=n,this.setFilterHandle=null,this.firstLocateHandle=null,this.lastLocateHandle=null,this.previousLocateHandle=null,this.nextLocateHandle=null,this.checkHandle=null,this.uncheckHandle=null,this.div=null,this._type=i,this.dragHandle=null,this.OnBtnSetFilterClick=function(n,t){var i;if(r&&r._owner&&r._owner.get_element()&&!(r._owner.m_rows<2)){if(!t){r._owner.OnCustomFilterClick("BuildFilter");return}var e=r._owner.get_element().cusAttr("TaskID"),o=r._owner.get_element().cusAttr("FormID"),s=r._owner.get_element().cusAttr("ViewName"),u=[],f=0;for(i=1;i<r._owner.MainCols.length;i++)if(window.getComputedStyle(r._owner.MainCols[i]).display!="none"){if(r._owner.MainCols[i].cusAttr("AllowFilter")!=null&&r._owner.MainCols[i].cusAttr("AllowFilter")=="false")continue;u[f]=r._owner.GetColumnType(i)!=ControlType.RefControl||r._owner.MainCols[i].cusAttr("RefID")&&r._owner.MainCols[i].cusAttr("RefID")!="00000000-0000-0000-0000-000000000000"?r._owner.MainCols[i].cusAttr("FieldID"):r._owner.MainCols[i].cusAttr("NameField").replace(/\./g,"_"),f++}var h=u.join(","),c="simple.aspx?lnk=0d75ecdd-46ab-494d-8be0-b4ea8a18a427&chromeType=4&ShowType=ShowModal&ShowAtlasModalDialog=true&ParentTaskID="+e+"&PFID="+o+"&viewname="+s+"&FieldIDs="+h,l=null,a="435",v="670",y=!0,p=!1;ShowModalDialogForAll(c,l,a,v,y,p,r)}},this.showDialogCallback=function(n){n==!0?(top.ShowCustomFilter||(top.ShowCustomFilter={}),top.ShowCustomFilter[r._owner.get_id()]=!0,r._owner.OnCustomFilterClick("SetFilter")):(top.ShowCustomFilter&&(top.ShowCustomFilter[r._owner.get_id()]=null),r.div.style.visibility="hidden")},this.onBtnSetFilterRightClick=function(){if(!top.ShowCustomFilter||!top.ShowCustomFilter[r._owner.get_id()]){r.div.style.visibility="hidden";return}if(event.button!=0)return r.toolBar.CFHasData&&r.toolBar.CFHasData=="true"&&(r.div.style.visibility=r.div.style.visibility=="visible"?"hidden":"visible"),!1},this.GetFieldList=function(){},this.OnCustromFilterFirstReceive=function(){r._owner.get_element().cusAttr("disabled")||r._owner.OnCustomFilterClick("First")},this.OnCustromFilterPreviousReceive=function(){r._owner.get_element().cusAttr("disabled")||r._owner.OnCustomFilterClick("Previous")},this.OnCustromFilterNextReceive=function(){r._owner.get_element().cusAttr("disabled")||r._owner.OnCustomFilterClick("Next")},this.OnCustromFilterLastReceive=function(){r._owner.get_element().cusAttr("disabled")||r._owner.OnCustomFilterClick("Last")},this.OnCustromFilterSelectReceive=function(){r._owner.get_element().cusAttr("disabled")||(r._owner.OnCustomFilterClick("select"),r._owner.SetHeadCheckBoxState(!0))},this.OnCustromFilterUnSelectReceive=function(){r._owner.get_element().cusAttr("disabled")||r._owner.OnCustomFilterClick("unselect")},this.InitDrag=function(n,t){t.onmousedown=function(i){i==null&&(i=window.event);var o=i.screenX,s=i.screenY,h=parseInt(n.currentStyle.left),c=parseInt(n.currentStyle.bottom),r=n.cusAttr("ParentTabID"),u=$ID(r),f=u.style.pixelWidth,e=u.style.pixelHeight;t.setCapture&&(t.setCapture(),document.onmousemove=function(t){var i,a;t==null&&(t=window.event);var v=t.screenX-o,y=t.screenY-s,u=h+v,l=c-y;u<1&&(u=1),u>f-100&&(u=f-100),l>e-45&&(l=e-45),l<1&&(l=1),n.style.left=u+"px",n.style.bottom=l+"px",top.CustomFilterLocation||(top.CustomFilterLocation=[],top.CustomFilterLocation.getLocationItem=function(n){for(var t=0,i=this.length;t<i;t++)if(this[t].TabID==n)return this[t]}),i={},i.TabID=r,i.Left=u,i.Bottom=l,a=top.CustomFilterLocation.getLocationItem(i.TabID),a?(a.Left=i.Left,a.Bottom=i.Bottom):top.CustomFilterLocation.push(i)},document.onmouseup=function(){t.releaseCapture(),document.onmousemove=null,document.onmouseup=null})}}},GridCustomFilterToolbarManager.prototype={dispose:function(){this._owner=null,this.DetachEvents(),this.toolBar=null,this.setFilterHandle=null,this.firstLocateHandle=null,this.lastLocateHandle=null,this.previousLocateHandle=null,this.nextLocateHandle=null,this.checkHandle=null,this.uncheckHandle=null,this.div=null,this._type=null,this.dragHandle=null},Initialize:function(){var n;this.toolBar!=null&&(this._type=="Grid"?(this.div=this.toolBar.children[0].children[this.toolBar.children[0].children.length-1],n=this.div.children[0].rows[0].cells,this.setFilterHandle=this.toolBar.children[0].children[0],this.firstLocateHandle=n[0].firstChild,this.previousLocateHandle=n[2].firstChild,this.nextLocateHandle=n[4].firstChild,this.lastLocateHandle=n[6].firstChild,n.length>10&&(this.checkHandle=n[8].firstChild,this.uncheckHandle=n[10].firstChild)):this._type=="Tab"&&(this.div=this.toolBar,n=this.div.children[0].rows[0].cells,this.dragHandle=n[0].firstChild,this.firstLocateHandle=n[1].firstChild,this.previousLocateHandle=n[3].firstChild,this.nextLocateHandle=n[5].firstChild,this.lastLocateHandle=n[7].firstChild),this.AttachEvents())},AttachEvents:function(){$(this.firstLocateHandle).bind("click",this.OnCustromFilterFirstReceive),$(this.previousLocateHandle).bind("click",this.OnCustromFilterPreviousReceive),$(this.nextLocateHandle).bind("click",this.OnCustromFilterNextReceive),$(this.lastLocateHandle).bind("click",this.OnCustromFilterLastReceive),this._type=="Grid"?($(this.setFilterHandle).bind("click",this.OnBtnSetFilterClick),$(this.setFilterHandle).bind("mousedown",this.onBtnSetFilterRightClick),this.checkHandle&&($(this.checkHandle).bind("click",this.OnCustromFilterSelectReceive),$(this.uncheckHandle).bind("click",this.OnCustromFilterUnSelectReceive))):this._type=="Tab"&&this.InitDrag(this.div,this.dragHandle),this.toolBar.cusAttr("CFHasData")&&this.toolBar.cusAttr("CFHasData")=="false"||(this.div.style.visibility="visible")},DetachEvents:function(){$(this.setFilterHandle).unbind("click",this.OnBtnSetFilterClick),$(this.setFilterHandle).unbind("mousedown",this.onBtnSetFilterRightClick),$(this.firstLocateHandle).unbind("click",this.OnCustromFilterFirstReceive),$(this.previousLocateHandle).unbind("click",this.OnCustromFilterPreviousReceive),$(this.nextLocateHandle).unbind("click",this.OnCustromFilterNextReceive),$(this.lastLocateHandle).unbind("click",this.OnCustromFilterLastReceive),this._type=="Grid"&&this.checkHandle&&($(this.checkHandle).unbind("click",this.OnCustromFilterSelectReceive),$(this.uncheckHandle).unbind("click",this.OnCustromFilterUnSelectReceive))}},GridCustomFilterToolbarManager.GetInstance=function(n,t,i){return new GridCustomFilterToolbarManager(n,t,i)},UF$UI$CacheManager=function(){var n,t;this.Keys={},this.Data=[],this.init(),this.max=5,this.usingLocalStorage=!1,top.window.localStorage&&(this.usingLocalStorage=!0,this.max=5,n=top.window.localStorage.getItem("UF$UI$Cache$Datas"),n&&(this.deserialize(n),this.GCTimer||(t="if(top.__UFClientCacheManager) { top.__UFClientCacheManager.GC4Timeout(); }",this.GCTimer=window.setTimeout(t,1e3)))),this.addingCounter=0,this.timeoutSpan=18e5,this.GCTimer},UF$UI$CacheManager.prototype={getFormatKey:function(n){if(n===undefined||n==null)return"";var t=n+"&";return t=t.replace(/&__sk=[^&]*&/g,"&"),t.lastIndexOf("&")==t.length-1?t.substr(0,t.length-1):t},add:function(n,t){var i,r;if(n=this.getFormatKey(n),i=this.Keys[n],typeof i=="undefined"||i==null)i=this.Data.length,this.Keys[n]=i,this.Data.push(this.buildCacheItem(n,t));else if(i==this.Data.length-1)this.Data[i]=this.buildCacheItem(n,t);else{this.Data.push(this.buildCacheItem(n,t));for(r in this.Keys)this.Keys[r]>i&&(this.Keys[r]=this.Keys[r]-1);this.Keys[n]=this.Data.length-1}this.Data.length>this.max&&this.GC(),this.addingCounter++,this.addingCounter>=3&&(this.Save(),this.addingCounter=0),this.tryStartGCProcess()},Remove:function(n){if(n=this.getFormatKey(n),n!=""){var t=this.Keys[n];typeof t!="undefined"&&t!=null&&t>=0&&(this.Data.splice(t,1),delete this.Keys[n],this.Save())}},RemoveByQueryPara:function(n){var i,f,u,r,t;if(n&&n.length>0&&this.Data.length>0){for(i=[],t=0;t<this.Data.length;t++)i.push(this.Data[t].Key);for(u="",t=0;t<n.length;t++){for(f=n[t],u=f.key+"="+f.value,f.key!="lnk"&&(u="&"+u),r=0;r<i.length;r++)i[r].indexOf(u)<0&&(i.splice(r,1),r--);if(i.length==0)return}if(i.length>0)for(t=0;t<i.length;t++)this.Remove(i[t])}},Save:function(){this.usingLocalStorage&&this.Data.length>0&&top.window.localStorage.setItem("UF$UI$Cache$Datas",this.serialize())},GC:function(){for(var n=0,t,i;this.Data.length>this.max;)t=this.Data.shift(),this.Keys[t.Key]=null,delete this.Keys[t.Key],n++;if(n>0)for(i in this.Keys)this.Keys[i]=this.Keys[i]-n},tryStartGCProcess:function(){if(!this.GCTimer){var n="if(top.__UFClientCacheManager) { top.__UFClientCacheManager.GC4Timeout(); }";this.GCTimer=window.setTimeout(n,this.timeoutSpan)}},GC4Timeout:function(){var r,n,t,i;if(this.Data.length>0){for(r=+new Date,n=0;this.Data.length>0;)if(t=this.Data[0],r-t.Time>this.timeoutSpan)delete this.Keys[t.Key],this.Data.shift(),n++;else break;if(n>0)for(i in this.Keys)this.Keys[i]=this.Keys[i]-n}this.GCTimer=null,this.tryStartGCProcess()},buildCacheItem:function(n,t){var i={};return i.Key=n,i.Value=t,i.Time=+new Date,i},parseItemToString:function(n){var t="";return t+='"Key":"'+n.Key.replace(/\"/g,'\\"')+'"',t+=',"Value":"'+n.Value.replace(/\"/g,'\\"')+'"',t+=',"Time":"'+n.Time+'"',"{"+t+"}"},clear:function(){this.Keys={},this.Data=[],this.usingLocalStorage&&top.window.localStorage.removeItem("UF$UI$Cache$Datas"),this.GCTimer&&(window.clearTimeout(this.GCTimer),this.GCTimer=null)},init:function(){},get:function(n){var t,u,f,i,r;if((n=this.getFormatKey(n),t=this.Keys[n],typeof t=="undefined"||t==null)||this.Data.length<=t||this.Data[t]==null)return null;if(u=this.Data[t],this.tryStartGCProcess(),u.Key==n)return u.Value;for(f=null,this.Keys={},i=0;i<this.Data.length;)r=this.Data[i],typeof this.Keys[r.Key]=="undefined"?(this.Keys[r.Key]=i,r.Key==n&&(f=r.Value),i++):this.Data.splice(i,1);return f},serialize:function(){var n,r,i,t;if(this.Data.length>0){n="";for(r in this.Keys)n.length>0&&(n+=","),n+='"'+r.replace(/\"/g,'\\"')+'"',n+=":"+this.Keys[r];for(i="",t=0;t<this.Data.length;t++)t>0&&(i+=","),i+=this.parseItemToString(this.Data[t]);return"[{"+n+"},["+i+"]]"}return""},deserialize:function(datas){try{eval("var d="+datas),d&&d.length==2&&(this.Keys=d[0],this.Data=d[1])}catch(e){this.Keys={},this.Data=[]}}},$Cache$RemoveByQueryPara=function(n){top.__UFClientCacheManager&&top.__UFClientCacheManager.RemoveByQueryPara(n)},$Cache$Remove=function(n){top.__UFClientCacheManager&&top.__UFClientCacheManager.Remove(n)},$Cache=function(n,t){if(top.__UFClientCacheManager==null&&(top.__UFClientCacheManager=new UF$UI$CacheManager),n===undefined)return null;if(t===undefined)return top.__UFClientCacheManager.get(n);top.__UFClientCacheManager.add(n,t)},FloatCalFun={},FloatCalFun.muldivfloat=function(n,t,i){var f=this.getws(n),e=this.getws(t),c=Math.max(f,e),u,o,s,r,h;return c===0?r=i==="*"?Number(n)*Number(t):Number(n)/Number(t):(o=this.clearpoint(n,"."),s=this.clearpoint(t,"."),i==="*"?(u=f+e,r=this.addwsfront((Number(o)*Number(s)).toString(),u),Number(r.slice(0,-u)+"."+r.slice(-u))):(u=f-e,r=Number(o)/Number(s),u===0)?r:(h=this.getws(r),r=this.clearpoint(r,"."),u=u+h,u>0?(r=this.addwsfront(r,u),Number(r.slice(0,-u)+"."+r.slice(-u))):(u=Math.abs(u),r=this.addwsback(r,u),console.log(u,r),Number(r))))},FloatCalFun.addwsback=function(n,t){for(var i=0;i<t;i++)n=n+"0";return n},FloatCalFun.addwsfront=function(n,t){var i="",e="",o=0,r=0,u="",f;if(n.indexOf("-")!=-1?(i=n.replace("-",""),e="-"):i=n,o=i.length,r=t-o,r<=0)u=n;else{for(f=0;f<r;f++)i="0"+i;u=e+i}return u},FloatCalFun.getws=function(n){var t=0;try{t=n.toString().split(".")[1].length}catch(i){t=0}return t},FloatCalFun.getbq=function(n,t){for(var i=0;i<t;i++)n=n+"0";return n},FloatCalFun.clearpoint=function(n,t){var i=n.toString();return i.indexOf(t)!=-1?i.replace(t,""):i},FloatCalFun._getPrecision=function(n){return n.toString().indexOf(".")==-1?0:n.toString().split(".")[1].length},FloatCalFun._getIntFromFloat=function(n){return n.toString().indexOf(".")==-1?n:Number(n.toString().replace(".",""))},FloatCalFun.floatMulti=function(n,t){return this.muldivfloat(n,t,"*")},FloatCalFun.floatAdd=function(n,t){var r=this._getPrecision(n),u=this._getPrecision(t),i=Math.pow(10,Math.max(r,u));return(this.floatMulti(n,i)+this.floatMulti(t,i))/i},FloatCalFun.floatSubtract=function(n,t){var r=this._getPrecision(n),u=this._getPrecision(t),i=Math.pow(10,Math.max(r,u));return(this.floatMulti(n,i)-this.floatMulti(t,i))/i},FloatCalFun.floatDiv=function(n,t){return this.muldivfloat(n,t,"/")},CheckValid.prototype.initialize=function(){if(!this.isInitialized){this.isInitialized=!0;switch(this.dataType){case"string":case"0":this.expdChar="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",this.spliter="";break;case"DATE":this.expdChar="0123456789-",this.spliter="-",this.dataLeng=10;break;case"DATETIME":this.expdChar="0123456789:",this.spliter=":",this.dataLeng=8;break;case"FLOAT":case"1":case"INT":case"2":default:this.spliter=""}return}},CheckValid.prototype.onKeyPressed=function(){var n=event.keyCode,t=event.srcElement;if(n){this.initialize(),this.m_pressedKey=n,this.theValue=t.value;switch(this.dataType){case"FLOAT":case"1":this.checkDoubleFocus(n)==!1&&(event.returnValue=!1);return;case"INT":case"2":this.checkIntegerFocus(n)==!1&&(event.returnValue=!1);return;case"string":case"0":this.checkStringFocus(n)==!1&&(event.returnValue=!1);return;case"DATE":this.checkDateFocus(n)==!1&&(event.returnValue=!1);return;case"DATETIME":this.checkTimeFocus(n)==!1&&(event.returnValue=!1);return}return!0}},CheckValid.prototype.checkIntegerFocus=function(n){var t=getPressedChar(n),i;return checkLength(this.theValue,this.dataLeng-1).length!=0?!1:this.maskChar&&this.maskChar.indexOf(t)>=0?!1:t>="0"&&t<="9"||t=="-"||t=="+"?(i=getComplexValue(n),parseFloat(i)<parseFloat(this.minValue)||parseFloat(i)>parseFloat(this.maxValue))?!1:i.indexOf("-")>0||i.indexOf("+")>0?!1:!0:!1},CheckValid.prototype.checkStringFocus=function(n){var t=getPressedChar(n);return this.theValue==undefined?!1:checkLength(this.theValue,this.dataLeng-1).length!=0?!1:this.maskChar.indexOf(t)>=0?!1:(this.expdChar.indexOf(t)>=0,!0)},CheckValid.prototype.checkDoubleFocus=function(n){var t=getPressedChar(n),i,u,r;return checkLength(this.theValue,this.dataLeng-1).length!=0?!1:this.maskChar.indexOf(t)>=0?!1:t>="0"&&t<="9"||t=="-"||t=="+"||t=="."?(i=getComplexValue(n),i.split(".").length>2)?!1:(u=this.minValue,parseFloat(i)<parseFloat(u)||parseFloat(i)>parseFloat(this.maxValue))?!1:(r=i.indexOf("."),r!=-1&&i.substring(r+1).length>parseInt(this.dataPrec))?!1:!0:!1},CheckValid.prototype.checkDateFocus=function(n){var u=this.spliter,s=[31,28,31,30,31,30,31,31,30,31,30,31],e,t;if(checkLength(this.theValue,this.dataLeng-1).length!=0||(e=getPressedChar(n),this.expdChar.indexOf(e)==-1))return!1;var i=0,r=0,f=0,o=getComplexValue(n);if(o.indexOf(u)==0||o.indexOf(u+u)!=-1)return!1;if(t=o.split(u),t.length==1){if(i=t[0],parseFloat(i)==0)return!1}else if(t.length==2){if(i=t[0],r=t[1],r.length==2&&(parseFloat(r)<1||parseFloat(r)>12))return!1}else if(t.length==3){if(i=t[0],r=t[1],f=t[2],(i%400==0||i%4==0&&i%100!=0)&&(s[1]=29),f.length==2&&(parseFloat(f)<1||parseFloat(f)>s[r-1]))return!1}else return!1;return i.length>4&&e!=u?!1:r.length>2&&e!=u?!1:f.length>2?!1:!0},CheckValid.prototype.checkTimeFocus=function(n){var u=this.spliter,e,t;if(checkLength(this.theValue,this.dataLeng-1).length!=0||(e=getPressedChar(n),maskChar.indexOf(e)>=0)||this.expdChar.indexOf(e)==-1)return!1;var i=0,r=0,f=0,o=getComplexValue(n);if(o.indexOf(u)==0||o.indexOf(u+u)!=-1)return!1;if(t=o.split(u),t.length==1){if(i=t[0],parseFloat(i)<0||parseFloat(i)>23)return!1}else if(t.length==2){if(i=t[0],r=t[1],r.length==2&&(parseFloat(r)<0||parseFloat(r)>59))return!1}else if(t.length==3){if(i=t[0],r=t[1],f=t[2],f.length==2&&(parseFloat(f)<0||parseFloat(f)>59))return!1}else return!1;return(log("hour-->"+i+":"+r+":"+f+" "+t.length),i.length>2&&e!=u)?!1:r.length>2&&e!=u?!1:f.length>2?!1:!0},TriggerArray=[],EvaluatorArray=[],Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Control=function(n){UF.UI.Control.initializeBase(this,[n]),this._HD=null,this._SetControlValue=null,this._IsHaveKnowledgePoint=!1},UF.UI.Control.prototype={initialize:function(){var n,t;for(UF.UI.Control.callBaseMethod(this,"initialize"),n=this.get_element(),t=n.children.length-1;t>0;t--)if(n.children[t].id==n.id+"_HD"){this._HD=n.children[t];break}$(n).bind("onload",setSelectedItem),n.cusAttr("kp")=="true"&&(this._IsHaveKnowledgePoint=!0),this.InitKnowledgePoint()},InitKnowledgePoint:function(){this._IsHaveKnowledgePoint&&(this._element.cusAttr("lc")&&$find(this._element.cusAttr("lc"))?$find(this._element.cusAttr("lc")).SetKnowledgePoint():this.SetKnowledgePoint())},SetKnowledgePoint:function(){var n,t;this.get_element()&&(n=this,$(this.get_element()).before("<i class='iconfont y-icon-help icon-help'><\/i>"),t=$(this.get_element()).prev(),t.click(function(){window.top.helpTool.show(n.get_displayName(),n._element.id,!0)}))},SetMultiInfo:function(){var n,t,i;if(event.ctrlKey==!0){if(n=event.srcElement,n==null)return;t="",n.tagName=="LABEL"?t=n.innerText+"  "+n.title:n.tagName=="TD"?n.className=="TCss"?t=n.innerText+"  "+n.offsetParent.title:(n.className=="TabPageTitle_Center"||n.className=="TabPageActiveTitle_Center")&&(t=n.innerText+"  "+n.title):n.tagName=="INPUT"?n.type=="button"&&(t=n.value+"  "+n.title):n.tagName=="BUTTON"?t=n.innerText+"  "+n.offsetParent.offsetParent.parentElement.parentElement.title:n.tagName=="NOBR"&&n.parentElement.className=="thc"&&(t=n.parentElement.innerText+"    "+n.parentElement.title),i=window.clipboardData.getData("Text"),Clipboard.setData(i+"\r\n"+t),showStatus(t),window.$Event(event).stopPropagation(),$Event(event).preventDefault()}},dispose:function(){this.curHandler!=null&&(this.curHandler=null),UF.UI.Control.callBaseMethod(this,"dispose")},add_Event:function(n,t){this.get_events().addHandler(n,t)},remove_Event:function(n,t){this.get_events().removeHandler(n,t)},raiseEvent:function(n,t){var i=this.get_events().getHandler(n);i&&(this.curHandler=i,i(this,t))},get_SetControlValue:function(){return this._SetControlValue},set_SetControlValue:function(n){this._SetControlValue=n},RemoveSetControlValueErrorMsg:function(){RemoveErrorMsgElment(this.get_id(),this._element)},ShowSetControlValueErrorMsg:function(){var i=GetPersonWarnMsg(this.get_SetControlValue().ValueSource),n=GetCurrentTabPage(this.get_id()),t;CreateWarnMsg("",null),n&&CreateWarnMsg("",n),t=null,this.get_SetControlValue().GridControl!=null&&(t=$ID(this.get_SetControlValue().GridControl.id)),CreateWarnMsg(i,this._element,t),window.PersonalWarnMsgManager&&($ID("keyValues4Favorite")&&window.PersonalWarnMsgManager.SetKeyValue($ID("keyValues4Favorite").value),n&&window.PersonalWarnMsgManager.Add(n.id,null),window.PersonalWarnMsgManager.Add(this._element.id,this.get_SetControlValue())),this.get_SetControlValue().IsSetControlValue=!1,this.get_SetControlValue().ValueSource=-1},set_HDValue:function(n,t){var r,i,u;this._HD&&(r=this._HD.value,r?(i=PopupFormHelper.StringToXMLDom(r),i.childNodes[0].setAttribute(n,t)):(u=Basic.GetXmlDom(),i=u.createElement("Data"),i.setAttribute(n,t)),this._HD.value=XMLHelper.serializeXMLNodeToString(i))},get_displayName:function(){return this._element.cusAttr("lc")&&$find(this._element.cusAttr("lc"))?$find(this._element.cusAttr("lc")).get_displayName():$(this._element).text()},get_innerId:function(){if(!(this._element.id.indexOf("DDLCase")>-1))return this._element.id.indexOf("_Global_")>-1||this._element.id.indexOf("_Public_")>-1||this._element.id.indexOf("FlexFieldPicker")>-1?void 0:this._element.cusAttr("lc")?this._element.cusAttr("lc"):this._element.id},to_Help:function(n,t){if($(this._element).parent().css("position","relative"),$(this._element).after("<div class='controlBg' forid='"+this._element.id+"' z-index='"+n+"'><\/div>"),t)var i=function(n){$("[forid='"+n._element.id+"']").click(function(i){t(n.get_displayName(),n._element.id),i.preventDefault(),i.stopPropagation()})}(this)},to_Translate:function(n,t){var i=$(this._element).parents(".webpart_div").attr("id"),r;$(this._element).parent().css("position","relative"),$(this._element).after("<div class='translateBg' forid='"+this._element.id+"' z-index='"+n+"'><\/div>"),t&&(r=function(n){$("[forid='"+n._element.id+"']").click(function(r){var u,f,e;r.preventDefault(),r.stopPropagation(),u=n.get_innerId(),u?(f=i.length+1,e=u.substring(f),t(u,e)):alert("暂不支持翻译功能")})}(this))},set_translateName:function(n,t){if(!this._element.cusAttr("lc"))if($(this._element).attr("ick")=="Label")n.attr("title",t),n.text(t);else if($(this._element).attr("ick")=="Button")n.attr("title",t),n.find("input").val(t);else if($(this._element).attr("ick")=="DropDownButton"){var i=n.find("button").text(),r=n.find("button").html().replace(i,t);n.find("button").html(r)}},to_Defualt:function(){$(this._element).parent().css("position","static"),$(this._element).next(".controlBg1").length>0&&$(this._element).next(".controlBg1").remove(),$(this._element).next(".translateBg").length>0&&$(this._element).next(".translateBg").remove(),$("[forid='"+this._element.id+"']").unbind("click"),$("[forid='"+this._element.id+"']").remove()}};var Init=UF.UI.Control.Init=function(n,t){var i=$find(n);i||(i=$get(n),i&&!i.control&&$create(t,null,null,null,i))},treeControlDrag=function(){var i=$("[id$='MoveTreeButton']"),t,n,r;i.length>0&&(t=i.closest("table").closest("td"),$(t).css("cursor"," w-resize"),n=t.get(0),r=$(t).closest("table").children("thead").find("tr td:first"),n.onmousedown=function(i){var u=(i||event).clientX,f=$(t).offset().left;return document.onmousemove=function(n){var n=n||window.event,t=f+(n.clientX-u);return t<0&&(t=0),$(r).width(t),$("#BomMainUI_TreeContro_Width").val(t),!1},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,n.releaseCapture&&n.releaseCapture()},n.setCapture&&n.setCapture(),!1})},UFFocus=UF.UI.Control.UFFocus=function(n){var e,r,u,i,t,f;if((n||!Sys||!Sys.WebForms)&&(!window.$||!($("#editorTd:parent").length>0)||(e=$("#editorTd:parent").html().trim().length,!(e>0))))if(treeControlDrag(),r=$get("UFAutoFocusID"),r&&r.value){if(u=r.value,i=__nonMSDOMBrowser?document.getElementById(u):document.childNodes[u],i&&i.tagName){if(i.tagName=="DIV"&&i.parentElement&&i.parentElement.parentElement&&i.parentElement.parentElement.className=="TreeBorder"){try{i.focus()}catch(o){}return}}else return;if(BaseTop.__UFCurrentFocusControl=u,t=i,i&&!UF_WebForm_CanFocus(i)){t=UF_WebForm_FindFirstFocusableChild(i);try{i.focus()}catch(o){}}if(t)try{if(r.value="",t.className&&$(t).hasClass("main_Span")){t.control.Focus(!0);return}t.focus(),t._events.focus[0].handler(),t.type=="text"&&t.select(),__nonMSDOMBrowser&&t.scrollIntoView(!1),window.__smartNav&&(window.__smartNav.ae=t.id)}catch(o){}}else if(BaseTop.__UFCurrentFocusControl){if(t=null,BaseTop.__UFCurrentFocusControl&&BaseTop.__UFCurrentFocusControl!="Grid"&&(t=$ID(BaseTop.__UFCurrentFocusControl)),t)try{if(t.className&&$(t).hasClass("main_Span")){t.control.Focus(!0);return}if(t.className.indexOf(ControlClass.TabPage)>-1){UF.UI.Panel.prototype.setContainerControlFocus(t,!1);return}t.focus(),t._events.focus[0].handler(),t.type=="text"&&t.select(),__nonMSDOMBrowser&&t.scrollIntoView(!1),window.__smartNav&&(window.__smartNav.ae=t.id)}catch(o){}}else f=GetTopPanel(),f&&f.control&&f.control.SetFocus()};UF.UI.Control.registerClass("UF.UI.Control",Sys.UI.Control),UF.UI.InputControl=function(n){UF.UI.InputControl.initializeBase(this,[n]),this.mouseOverClass,this.mouseOutClass,this.btnmouseOverClass,this.btnmouseOutClass,this.btnClassName,this.btnClassName_Dis,this.tbClassName,this.tbClassName_R,this.tbClassName_D,this.hf="0",this._mouseoverHandler,this._mouseoutHandler,this._mouseenterHandler,this.visibleAuthority,this.enableAuthority,this.IsInitComlete=!1,this.IsChanged=!1,this.IsValueChanged=!1,this.IsPersonalProcess=!0,this.IsRaiseEvent=!0,this.GridCurrentRowIndex4P=-1,this.oldIsPersonalProcess=null,this.isMustPostBack=!1,this._ShowControlBindingInfoTitle=!1},UF.UI.InputControl.prototype={initialize:function(){UF.UI.InputControl.callBaseMethod(this,"initialize"),this.$element=$(this._element),this._element.cusAttr("readonly")&&(this._element.className=UIControlClass.getReadOnlyCss(this._element)),this.visibleAuthority=this._element.cusAttr("VisibleAuthority"),this.enableAuthority=this._element.cusAttr("EnableAuthority"),this._mouseoverHandler=Function.createDelegate(this,this.MouseOver),$addHandler(this._element,"mouseover",this._mouseoverHandler),this._mouseoutHandler=Function.createDelegate(this,this.MouseOut),$addHandler(this._element,"mouseout",this._mouseoutHandler),this._ShowControlBindingInfoTitle||this.ResetTitleInfo(),this.isMustPostBack=this._element.cusAttr("IsPMaster")=="y"},ResetTitleInfo:function(){this.get_element().title="",(this.get_Type()==ControlType.GlobalInput||this.get_Type()==ControlType.Reference||this.get_Type()==ControlType.TextBox||this.get_Type()==ControlType.FlexField||this.get_Type()==ControlType.Numberic||this.get_Type()==ControlType.DateTime||this.get_Type()==ControlType.DropDownList)&&(this._mouseenterHandler=Function.createDelegate(this,this.MouseEnter),$addHandler(this._element,"mouseenter",this._mouseenterHandler))},dispose:function(){this.RemoveMouseHandler(),this.visibleAuthority=null,this.enableAuthority=null,UF.UI.InputControl.callBaseMethod(this,"dispose")},RemoveMouseHandler:function(){this._mouseoverHandler&&($removeHandler(this._element,"mouseover",this._mouseoverHandler),delete this._mouseoverHandler,this._mouseoverHandler=null),this._mouseoutHandler&&($removeHandler(this._element,"mouseout",this._mouseoutHandler),delete this._mouseoutHandler,this._mouseoutHandler=null),this._mouseenterHandler&&($removeHandler(this._element,"mouseenter",this._mouseenterHandler),delete this._mouseenterHandler,this._mouseenterHandler=null)},get_Enabled:function(){if(this.visibleAuthority!=null&&this.visibleAuthority.toString().toLowerCase()=="false"||this.enableAuthority!=null&&this.enableAuthority.toString().toLowerCase()=="false")return!1;var n=this._element.cusAttr("disabled");return!n},set_Enabled:function(n){if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")){n=ToBoolean(n),this._element.className=n?UIControlClass.getNotReadOnlyCss(this._element):UIControlClass.getReadOnlyCss(this._element),this._element.cusAttr("disabled",!n),this.get_Type&&(this.get_Type()=="DateTime"||this.get_Type()=="GlobalInput")&&this._element.cusAttr("enabled")&&this._element.cusAttr("enabled",n);for(var t=0,i=this._element.childNodes.length;t<i;t++)$(this._element.childNodes[t]).attr("disabled",!n),this._element.childNodes[t].type=="text"&&(this._element.childNodes[t].className=InputControlTemplate.TBClassName)}},get_Visible:function(){return this.visibleAuthority!=null&&this.visibleAuthority.toString().toLowerCase()=="false"?!1:this._element.style.visibility!="hidden"},set_Visible:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this._element.style.visibility=n?"visible":"hidden")},MouseOver:function(){},MouseOut:function(){},MouseEnter:function(){this._textbox.type!="password"&&(this._element.title=this._textbox.value)},ControlFocus:function(){this._element.className=UIControlClass.getFocusCss(this._element),this.hf="1"},ControlBlur:function(){this._element.className=UIControlClass.getBlurCss(this._element),this.hf="0"},DisplayRequiredFlag:function(n){if(!(this.get_id().indexOf("Login")>-1)){var t=this.get_element().parentElement.lastChild;if(t&&t.className&&t.className=="requiredFlag"&&t.id!=this.get_id()+"_RequiredFlag"&&(t=$ID(this.get_id()+"_RequiredFlag")),t&&t.className&&t.className=="requiredFlag"){if(t==this._element)return;if(this._element.style.display=="none"){t.style.display="none";return}t.style.display=n?"":"none"}}},RemoveMarkChars:function(text,maskChars){return maskChars=maskChars.replace(/\\/g,"\\\\").replace(/\*/g,"\\*").replace(/\^/g,"\\^").replace(/\?/g,"\\?"),text=eval("text.replace(/"+maskChars+"/g,'')")},get_IsChanged:function(){return this.IsChanged},set_IsChanged:function(n){this.IsChanged=n,this.IsChanged==!0&&Set_Global_IsDirtyData_TheForm(!0)},get_IsValueChanged:function(){return this.IsValueChanged},set_IsValueChanged:function(n){this.IsValueChanged=n,this.get_IsRaiseEvent()&&this.IsValueChanged==!0&&Set_Global_IsDirtyData_TheForm(!0)},get_IsInitComlete:function(){return this.IsInitComlete},set_IsInitComlete:function(n){this.IsInitComlete=n==!0?!0:!1},set_IsPersonalProcess:function(n){n==!0?this.IsPersonalProcess=!0:n==!1&&(this.IsPersonalProcess=!1)},get_IsPersonalProcess:function(){return this.IsPersonalProcess},set_OldIsPersonalProcess:function(n){n==!0?this.oldIsPersonalProcess=!0:n==!1?this.oldIsPersonalProcess=!1:n==null&&(this.oldIsPersonalProcess=null)},get_OldIsPersonalProcess:function(){return this.oldIsPersonalProcess},set_IsRaiseEvent:function(n){n==!0?this.IsRaiseEvent=!0:n==!1&&(this.IsRaiseEvent=!1)},get_IsRaiseEvent:function(){return this.IsRaiseEvent},BeforeRaiseOnValueChanged4Personal:function(){this._element&&(this._element.cusAttr("GridCltID4P")==null||this._element.cusAttr("ColFldID4P")==null)||this.get_IsPersonalProcess()!=!1&&(this.get_OldIsPersonalProcess()!=null&&(this.set_IsPersonalProcess(this.get_OldIsPersonalProcess()),this.set_OldIsPersonalProcess(null)),this.SynchUpdateValue4PersonalColumn())},AfterRaiseOnValueChanged4Personal:function(){this._element&&(this._element.cusAttr("GridCltID4P")==null||this._element.cusAttr("ColFldID4P")==null)||this.get_IsPersonalProcess()!=!1&&(this.get_OldIsPersonalProcess()!=null&&(this.set_IsPersonalProcess(this.get_OldIsPersonalProcess()),this.set_OldIsPersonalProcess(null)),this.ProcessValueChanged4Personal())},ProcessValueChanged4Personal:function(){var n,i,r,t,u,e,f,o;Global_ClientEventHandlerManager.get_IsEventRuning()==!0?(n=-1,i=-1,this.get_element()&&this._element.cusAttr("GridCltID4P")&&this._element.cusAttr("ColFldID4P")&&(Global_CallBackReturnJsQueueIsRunning&&(r=_ClientCallBackManager.Args?_ClientCallBackManager.Args:"",r&&(t=null,u=/SrcRowIndex=([0-9]+)/,t=r.match(u),t!=null&&t.length>1&&(n=t[1],u=/SrcColIndex=([0-9]+)/,t=r.match(u),t!=null&&t.length>1&&(i=t[1]))),Set_GridCurrentRowIndex4PIsValid(!1)),(n=="undefined"||n==null||n==-1||n*1<0)&&(e=this._element.cusAttr("GridCltID4P"),f=$find(e),f&&(n=f.get_CurrentRowIndex()))),Global_CallBackReturnJsQueueIsRunning?(o="$find('"+this.get_id()+"').SynchUpdateValue4PersonalColumn("+n+","+i+");",Global_ClientEventHandlerManager.Add2PersonalProcessQueue(o)):$find(this.get_id()).SynchUpdateValue4PersonalColumn(n,i)):this.SynchUpdateValue4PersonalColumn()},SynchUpdateValue4PersonalColumn:function(n,t){var h,i,r,e,f,u,o,c,s,l;if(this._element&&this._element.cusAttr("GridCltID4P")&&this._element.cusAttr("ColFldID4P")&&(h=this._element.cusAttr("GridCltID4P"),i=$find(h),i)){if(r=-1,n!=null&&n>-1?r=n:Global_CallBackReturnJsQueueIsRunning?(f=_ClientCallBackManager.Args?_ClientCallBackManager.Args:"",f&&(u=null,o=/SrcRowIndex=([0-9]+)/,u=f.match(o),u!=null&&u.length>1&&(r=u[1]))):(r=Get_GridCurrentRowIndex4PIsValid()?Get_GridCurrentRowIndex4P():i.get_CurrentRowIndex(),Set_GridCurrentRowIndex4PIsValid(!1)),e=!1,typeof t=="undefined"||t==null||t<0?Global_CallBackReturnJsQueueIsRunning&&(f=_ClientCallBackManager.Args?_ClientCallBackManager.Args:"",f&&(u=null,o=/SrcColIndex=([0-9]+)/,u=f.match(o),u!=null&&u.length>1&&(t=u[1],e=!0))):e=!0,c=this._element.cusAttr("ColFldID4P"),s=i.GetColumnIndex(c),r<0)return;if(l=e?i.MainCols[t].cusAttr("ColEditCtrlClientID4P"):"",l!=this.get_id()){var a=this.get_Value(),v=i.GetCellValue(r,s).Value,y=this.get_Type();a!=v&&(y!=ControlType.Numberic||a*1!=v*1)&&(Global_CallBackReturnJsQueueIsRunning&&i.m_gridBodyEventsHandler.CanEndEdit(!1),this.get_Type()=="Reference"?i.SetReferenceCellValue(r,s,this.get_Key(),this.get_Value(),this.get_Text(),!0):i.SetReferenceCellValue(r,s,this.get_Value()))}i.ResetRowStates(r)}},AfterSetReadOnly4Personal:function(){this._element.cusAttr("GridCltID4P")!=null&&this._element.cusAttr("ColFldID4P")!=null&&this.get_IsPersonalProcess()!=!1&&this.ProcessSetReadOnly4Personal()},ProcessSetReadOnly4Personal:function(){if(Global_ClientEventHandlerManager.get_IsEventRuning()==!0){var t="$find('"+this.get_id()+"').SynchUpdateReadOnly4PersonalColumn();";Global_ClientEventHandlerManager.Add2PersonalProcessQueue(t)}else this.SynchUpdateReadOnly4PersonalColumn()},SynchUpdateReadOnly4PersonalColumn:function(){var t,n;if(this._element.cusAttr("GridCltID4P")&&this._element.cusAttr("ColFldID4P")&&(t=this._element.cusAttr("GridCltID4P"),n=$find(t),n)){var u=n.get_CurrentRowIndex(),i=this._element.cusAttr("ColFldID4P"),f=this.get_ReadOnly(),e=n.GetColumnIndex(i),r=n.MainCols[e].cusAttr("ColEditCtrlClientID4P");r!=null&&r==this.get_id()&&n.SetCellEnabledByFieldId(u,i,!f)}},IsInGrid:function(){var n=this.get_element(),t;return n&&n.parentNode?(t=n.parentNode.className.split(" ")[0],t=="tbc"||t=="main_Span"):!1},SetControlAttribute:function(n){n&&n.length>0&&(this.set_Enabled(n[0]=="1"||ToBoolean(n[0])),n.length>1&&this.set_ReadOnly&&this.set_ReadOnly(n[1]=="1"||ToBoolean(n[1])))}},UF.UI.InputControl.registerClass("UF.UI.InputControl",UF.UI.Control),UF.UI.PopupForm=function(n){UF.UI.PopupForm.initializeBase(this,[n]),this._dynamicParams},UF.UI.PopupForm.prototype={initialize:function(){UF.UI.PopupForm.callBaseMethod(this,"initialize")},dispose:function(){this._dynamicParams&&(Array.clear(this._dynamicParams),this._dynamicParams=null),UF.UI.PopupForm.callBaseMethod(this,"dispose")},add_BeforeLoadData:function(n){this.get_events().addHandler("BeforeLoadData",n)},remove_BeforeLoadData:function(n){this.get_events().removeHandler("BeforeLoadData",n)},raiseBeforeLoadData:function(n){var t=this.get_events().getHandler("BeforeLoadData");t&&t(this,n)},add_ContentChanged:function(n){this.get_events().addHandler("ContentChanged",n)},remove_ContentChanged:function(n){this.get_events().removeHandler("ContentChanged",n)},raiseContentChanged:function(n){var t=this.get_events().getHandler("ContentChanged");t&&t(this,n)},add_ContentChanged4P:function(n){this.get_events().addHandler("ContentChanged4P",n)},remove_ContentChanged4P:function(n){this.get_events().removeHandler("ContentChanged4P",n)},raiseContentChanged4P:function(n){var t=this.get_events().getHandler("ContentChanged4P");t&&(this.curHandler=t,t(this,n))},GetUrl:function(n,t,i){var u=this.GetQueryString(n,t,i),r="simple.aspx";return r+=r.indexOf("?")==-1?"?"+u:r[r.length-1]=="?"||r[r.length-1]=="&"?u:"&"+u},GetQueryString:function(n,t,i){var v=this._element.cusAttr("CtrlId"),r,s,f,c,b,l,p,k,d,e,u,o;if(v==null&&(v=""),r="lnk="+n+"&CtrlId="+v+"&chromeType=4&ShowType="+t,s="&",i!=!0){if(this._dynamicParams!=null)for(key in this._dynamicParams)typeof this._dynamicParams[key]!="object"&&typeof this._dynamicParams[key]!="function"&&(r+=s+key+"="+encodeURIComponent(this._dynamicParams[key]));f=this._element.cusAttr("CustomInParams"),f!=null&&f!=""&&(r+=f.indexOf("&")==0?encodeURI(f).replace(/\+/g,"%2b"):"&"+encodeURI(f).replace(/\+/g,"%2b"));var a=this._element.cusAttr("AddParams"),y=[],h={};if(a!=null&&a!="")for(y=a.split(ReferenceTemplate.SplitString1),c=0,b=y.length;c<b;c++)l=y[c],p=l.split("="),p.length>=2&&(k=p[0],d=l.substr(l.indexOf("=")+1),h[k]=encodeURIComponent(d).replace(/\+/g,"%2b"));if(h!=null)for(key in h)r+=s+key+"="+h[key]}else{var f=this._element.cusAttr("CustomInParams"),a=this._element.cusAttr("AddParams"),w=this.GetUniqueKeyEncodeParams(this._dynamicParams,f,a);if(w!=null)for(key in w)r+=s+key+"="+w[key]}return e=this._element.cusAttr("CustomInParamsSer"),e!=null&&e!=""&&(r+=e.indexOf("&")==0?encodeURI(e):"&"+encodeURI(e)),u=this._element.cusAttr("CustomInParamsControl"),u!=null&&u!=""&&(u=getParamfromCustomInParamsControl(u),r+=u.indexOf("&")==0?encodeURI(u):"&"+encodeURI(u)),o=this._element.cusAttr("RefCallbackMethod"),o!=null&&o!=""&&(r+=o.indexOf("&")==0?encodeURI(o):"&"+encodeURI(o)),r.replace(/#/g,"%23")},InitMultiOrgParams:function(n,t,i,r){for(var o=new MultiOrgParams,h=n.GetFields(),e,s,u,f=0;f<h.length;f++){for(e=n.GetValues(h[f]),s="",u=0;u<e.length;u++)typeof e[u]!="function"&&(s+=u==e.length-1?e[u]:e[u]+",");o.AllDatas[f]=h[f]+":"+s}return o.OrgID=GetCurrentOrg(),o.EnterpriseID=GetCurrentEnterpriseID(),o.entityFullName=r,o},GetUniqueKeyEncodeParams:function(n,t,i){var e={},c,r,o,u,f,s,h;if(this._dynamicParams!=null)for(key in n)typeof n[key]!="object"&&typeof n[key]!="function"&&(e[key]=encodeURIComponent(n[key]));if(t!=null&&t!="")for(customInParams=t.split("&"),r=0,o=customInParams.length;r<o;r++)u=customInParams[r],f=u.split("="),f.length>=2&&(s=f[0],h=u.substr(u.indexOf("=")+1),e[s]=encodeURIComponent(h));if(i!=null&&i!="")for(c=i.split(ReferenceTemplate.SplitString1),r=0,o=c.length;r<o;r++)u=c[r],f=u.split("="),f.length>=2&&(s=f[0],h=u.substr(u.indexOf("=")+1),e[s]=encodeURIComponent(h));return e},AddParam:function(n,t){this._dynamicParams==null&&(this._dynamicParams=[]),this._dynamicParams[n]=t},GetParam:function(n){return this._dynamicParams==null?null:this._dynamicParams[n]},RemoveParam:function(n){this._dynamicParams[n]=null},RemoveParas:function(){this._dynamicParams=[]},ClearAllParams:function(){this.set_CustomInParams(""),this.set_AddParams(""),this.RemoveParas()}},UF.UI.PopupForm.registerClass("UF.UI.PopupForm",UF.UI.InputControl),PopupFormHelper=function(){},PopupFormHelper.prototype={},PopupFormHelper.TranslateInfor=function(n){var t,r,f,i,u,e;if(n!==null&&n!==undefined&&(n=Fix40Decode(n)),t=new ReferenceData,n==null||n=="")return t;for(r=PopupFormHelper.StringToXMLDom(n),r.documentElement?t.setIsForceChange(r.documentElement.getAttribute("ForceChange")=="1"):t.setIsForceChange(!1),f=r.getElementsByTagName("ReferenceReturn"),i=0;i<f.length;i++){var o=[],h=f[i],s=h.getElementsByTagName("ReturnField");for(u=0;u<s.length;u++)e=s[u],o[e.getAttribute("name")]=e.getAttribute("value");t.Rows[i]=o}return t},PopupFormHelper.StringToXMLDom=function(n){return XMLHelper.createXMLDocument(n,1)},UF.UI.ChangeEventArgs=function(){UF.UI.ChangeEventArgs.initializeBase(this)},UF.UI.ChangeEventArgs.registerClass("UF.UI.ChangeEventArgs",Sys.EventArgs),UF.UI.GridEventArgs=function(){UF.UI.GridEventArgs.initializeBase(this)},UF.UI.GridEventArgs.registerClass("UF.UI.GridEventArgs",Sys.EventArgs),ReferenceData=function(){this.isForceChange=!1,this.Rows=[]},ReferenceData.prototype={dispose:function(){Array.clear(this.Rows),this.Rows=null},Clear:function(){this.Rows=[]},setIsForceChange:function(n){this.isForceChange=n},getIsForceChange:function(){return this.isForceChange},GetValue:function(n){var t="";return this.Rows!=null&&this.Rows.length>0&&(t=this.Rows[0][n],typeof t=="undefined"&&(t="")),t},GetValues:function(n){for(var r=[],i,t=0;t<this.Rows.length;t++)i=this.Rows[t][n],typeof i=="undefined"&&(i=""),r[t]=i;return r},SetValue:function(n,t){this.Rows.length==0&&(this.Rows[0]=[]),this.Rows[0][n]=t},SetValues:function(n,t){for(var i=0;i<this.Rows.length;i++)this.Rows[i][n]="";for(i=0;i<t.length;i++)this.Rows[i]==null&&(this.Rows[i]=[]),this.Rows[i][n]=t[i]},GetFields:function(){var t=[],i,n;if(this.Rows.length>0){i=0;for(n in this.Rows[0])typeof n!="function"&&n!="removeAt"&&n!="insertAt"&&(t[i++]=n)}return t},ToString:function(){for(var u="",t,i,r,n=0;n<this.Rows.length;n++){t=this.Rows[n],i="";for(r in t)i+="["+r+"="+t[r]+"]";u+="["+i+"]"}return u}},suggesturl="",image=[],image[0]=new Image,image[1]=new Image,image[2]=new Image,image[3]=new Image,image[0].src="../App_Themes/Blue/images/ac_arrow_down.gif",image[1].src="../App_Themes/Blue/images/ac_arrow_down_disabled.gif",image[2].src="../App_Themes/Blue/images/ac_arrow_up.gif",image[3].src="../App_Themes/Blue/images/ac_arrow_up_disabled.gif",actb=function(n,t){this.actb_timeOut=-1,this.actb_timeOut_Length=2e3,this.actb_lim=4,this.actb_firstText=!1,this.actb_mouse=!0,this.actb_delimiter=[";",","],this.actb_startcheck=0,this.actb_arColor="#FFFFFF",this.actb_bgColor="#FFFFFF",this.actb_textColor="#000000",this.actb_hColor="#FFE9A6",this.actb_fFamily="verdana,arial,helvetica",this.actb_arrowSize="7px",this.actb_fSize="9pt",this.actb_hStyle="font-family:verdana,arial,helvetica;",this.actb_delimwords=[],this.actb_cdelimword=0,this.actb_delimchar=[],this.actb_display=!1,this.actb_pos=0,this.actb_total=0,this.actb_rangeu=0,this.actb_ranged=0,this.actb_bool=[],this.actb_pre=0,this.actb_toid=0,this.actb_tomake=!1,this.actb_mouse_on_list=1,this.actb_isInit=!0,this.actb_caretmove=!1,this.actb_curr=document.getElementById(n),this.actb_keywords=[],this.actb_keywords_bak=[];for(var i=0,r=t.length;i<r;i++)this.actb_keywords[i]=t[i],this.actb_keywords_bak[i]=t[i];return this.construct()},actb.prototype={callLater:function(n,t){return function(){n.call(t)}},construct:function(){return this.actb_curr.actb=this,this.funcClick=this.actb_mouseclick,this.funcCheck=this.actb_checkkey,this.funcHighlight=this.actb_table_highlight,this.funcClear=this.callLater(this.actb_clear,this),this.funcPress=this.callLater(this.actb_keypress,this),this.funcUp=this.callLater(this.actb_goup,this),this.funcDown=this.callLater(this.actb_godown,this),this.funcFocus=this.callLater(this.actb_table_focus,this),this.funcUnfocus=this.callLater(this.actb_table_unfocus,this),addEvent(this.actb_curr,"focus",this.callLater(this.actb_setup,this)),this.actb_setup(),this},dispose:function(){this.actb_delimiter=null,this.actb_delimwords=null,this.actb_delimchar=null,this.actb_bool=null,this.actb_curr=null,this.actb_keywords=null,this.actb_keywords_bak=null},actb_setup:function(){addEvent(this.actb_curr,"keydown",this.funcCheck),addEvent(this.actb_curr,"blur",this.funcClear),addEvent(document,"keypress",this.funcPress)},actb_clear:function(){removeEvent(this.actb_curr,"keydown",this.funcCheck),removeEvent(this.actb_curr,"blur",this.funcClear),removeEvent(document,"keypress",this.funcPress),this.actb_removedisp()},actb_parse:function(n){var i,r;this.actb_delimiter.length>0?(i=this.actb_delimwords[this.actb_cdelimword].trim().addslashes(),r=this.actb_delimwords[this.actb_cdelimword].trim().length):(i=this.actb_curr.value.addslashes(),r=this.actb_curr.value.length);var t="",f=this.actb_firstText?new RegExp("^"+i,"i"):new RegExp(i,"i"),u=n.search(f);return t=n.substr(0,u),t+="<font style='"+this.actb_hStyle+"'>",t+=n.substring(u,r+u),t+="<\/font>",t+=n.substring(r+u,n.length)},actb_generate:function(){var first,j,counter,i,r,c;if(document.getElementById("tat_table")&&(this.actb_display=!1,document.body.removeChild(document.getElementById("tat_table"))),this.actb_total==0){this.actb_display=!1;return}for(a=document.createElement("table"),a.cellSpacing="1px",a.cellPadding="2px",a.style.position="absolute",a.style.border="#000000 solid 1px",a.style.top=eval(curTop(this.actb_curr)+this.actb_curr.offsetHeight+2)+"px",a.style.left=curLeft(this.actb_curr)+"px",a.style.width=this.actb_curr.parentElement.offsetWidth+"px",a.style.backgroundColor=this.actb_bgColor,a.id="tat_table",document.body.appendChild(a),first=!0,j=1,this.actb_mouse&&(a.onmouseout=this.funcUnfocus,a.onmouseover=this.funcFocus),counter=0,i=0;i<this.actb_keywords.length;i++)this.actb_keywords.length>this.actb_lim&&this.actb_total>this.actb_lim&&!i&&(r=a.insertRow(-1),r.style.backgroundColor=this.actb_arColor,c=r.insertCell(-1),c.style.color=this.actb_textColor,c.style.fontFamily="arial narrow",c.style.fontSize=this.actb_arrowSize,c.style.cursor="default",c.align="center",replaceHTML(c,image[3]),addEvent(c,"click",this.funcUp)),this.actb_bool[i]&&counter<this.actb_lim&&(counter++,r=a.insertRow(-1),first&&!this.actb_tomake?(r.style.backgroundColor=this.actb_hColor,first=!1,this.actb_pos=counter):this.actb_pre==i?(r.style.backgroundColor=this.actb_hColor,first=!1,this.actb_pos=counter):r.style.backgroundColor=this.actb_bgColor,r.id="tat_tr"+j,c=r.insertCell(-1),c.style.color=this.actb_textColor,c.style.fontFamily=this.actb_fFamily,c.style.fontSize=this.actb_fSize,c.innerHTML=this.actb_parse(this.actb_keywords[i]),c.id="tat_td"+j,c.actb=this,c.setAttribute("pos",j),this.actb_mouse&&(c.style.cursor="pointer",addEvent(c,"click",this.funcClick),c.onmouseover=this.funcHighlight),j++);this.actb_total>this.actb_lim&&(r=a.insertRow(-1),r.style.backgroundColor=this.actb_arColor,c=r.insertCell(-1),c.style.color=this.actb_textColor,c.style.fontFamily="arial narrow",c.style.fontSize=this.actb_arrowSize,c.style.cursor="pointer",c.align="center",replaceHTML(c,image[0]),addEvent(c,"click",this.funcDown)),this.actb_rangeu=1,this.actb_ranged=j-1,this.actb_display=!0,this.actb_pos<=0&&(this.actb_pos=1)},actb_remake:function(){var u=document.getElementById("tat_table"),f,r,t,n;this.actb_mouse&&(u.onmouseout=this.funcUnfocus,u.onmouseover=this.funcFocus);var f,e=0,o=!0,i=1;for(this.actb_total>this.actb_lim&&(r=this.actb_rangeu>1,t=u.rows[e++],t.style.backgroundColor=this.actb_arColor,n=t.firstChild,n.style.color=this.actb_textColor,n.style.fontFamily="arial narrow",n.style.fontSize=this.actb_arrowSize,n.style.cursor="default",n.align="center",replaceHTML(n,r?image[2]:image[3]),r?(addEvent(n,"click",this.funcUp),n.style.cursor="pointer"):n.style.cursor="default"),f=0;f<this.actb_keywords.length;f++)if(this.actb_bool[f]&&(i>=this.actb_rangeu&&i<=this.actb_ranged?(t=u.rows[e++],t.style.backgroundColor=this.actb_bgColor,t.id="tat_tr"+i,n=t.firstChild,n.style.color=this.actb_textColor,n.style.fontFamily=this.actb_fFamily,n.style.fontSize=this.actb_fSize,n.innerHTML=this.actb_parse(this.actb_keywords[f]),n.id="tat_td"+i,n.setAttribute("pos",i),i++):i++),i>this.actb_ranged)break;this.actb_keywords.length>this.actb_lim&&(r=i-1<this.actb_total,t=u.rows[e],t.style.backgroundColor=this.actb_arColor,n=t.firstChild,n.style.color=this.actb_textColor,n.style.fontFamily="arial narrow",n.style.fontSize=this.actb_arrowSize,n.style.cursor="default",n.align="center",replaceHTML(n,r?image[0]:image[1]),r?(addEvent(n,"click",this.funcDown),n.style.cursor="pointer"):n.style.cursor="default")},actb_goup:function(){if((this.actb_curr.focus(),this.actb_display)&&this.actb_pos!=1){var n=document.getElementById("tat_tr"+this.actb_pos);n&&n.style&&(n.style.backgroundColor=this.actb_bgColor),this.actb_pos--,this.actb_pos<this.actb_rangeu&&(this.actb_rangeu--,this.actb_ranged--,this.actb_remake()),n=document.getElementById("tat_tr"+this.actb_pos),n&&n.style&&(n.style.backgroundColor=this.actb_hColor),this.actb_toid&&(clearTimeout(this.actb_toid),this.actb_toid=0),this.actb_timeOut>0&&(this.actb_toid=setTimeout(function(){this.actb_mouse_on_list=1,this.actb_removedisp()},this.actb_timeOut)),this.actb_curr.focus()}},actb_godown:function(){if((this.actb_curr.focus(),this.actb_display)&&this.actb_pos!=this.actb_total){var n=document.getElementById("tat_tr"+this.actb_pos);n&&n.style&&(n.style.backgroundColor=this.actb_bgColor),this.actb_pos++,this.actb_pos>this.actb_ranged&&(this.actb_rangeu++,this.actb_ranged++,this.actb_remake()),n=document.getElementById("tat_tr"+this.actb_pos),n&&n.style&&(n.style.backgroundColor=this.actb_hColor),this.actb_toid&&(clearTimeout(this.actb_toid),this.actb_toid=0),this.actb_timeOut>0&&(this.actb_toid=setTimeout(function(){this.actb_mouse_on_list=1,this.actb_removedisp()},this.actb_timeOut)),this.actb_curr.focus()}},actb_mouseclick:function(n){var i=getTargetElement(n),t;(i.id||(i=i.parentNode),t=i.actb,t.actb_curr.focusEventSource="actb",t.actb_display)&&(t.actb_mouse_on_list=0,t.actb_pos=i.getAttribute("pos"),t.actb_penter())},actb_table_focus:function(){this.actb_mouse_on_list=1},actb_table_unfocus:function(){this.actb_mouse_on_list=0,this.actb_toid&&(clearTimeout(this.actb_toid),this.actb_toid=0),this.actb_timeOut>0&&(this.actb_toid=setTimeout(function(){obj.actb_mouse_on_list=0,this.actb_removedisp()},this.actb_timeOut))},actb_table_highlight:function(n){var r=getTargetElement(n),t=r.actb,i;t&&(t.actb_mouse_on_list=1,i=document.getElementById("tat_tr"+t.actb_pos),i&&i.style&&(i.style.backgroundColor=t.actb_bgColor),t.actb_pos=r.getAttribute("pos"),i=document.getElementById("tat_tr"+t.actb_pos),i&&i.style&&(i.style.backgroundColor=t.actb_hColor),t.actb_toid&&(clearTimeout(t.actb_toid),t.actb_toid=0),t.actb_timeOut>0&&(t.actb_toid=setTimeout(function(){t.actb_mouse_on_list=0,t.actb_removedisp()},t.actb_timeOut)))},actb_insertword:function(n){if(this.actb_delimiter.length>0){var t="";for(i=0;i<this.actb_delimwords.length;i++){if(this.actb_cdelimword==i){for(prespace=postspace="",gotbreak=!1,j=0;j<this.actb_delimwords[i].length;++j){if(this.actb_delimwords[i].charAt(j)!=" "){gotbreak=!0;break}prespace+=" "}for(j=this.actb_delimwords[i].length-1;j>=0;--j){if(this.actb_delimwords[i].charAt(j)!=" ")break;postspace+=" "}t+=prespace,t+=n,gotbreak&&(t+=postspace)}else t+=this.actb_delimwords[i];i!=this.actb_delimwords.length-1&&(t+=this.actb_delimchar[i])}this.actb_curr.value=t,setCaret(this.actb_curr,this.actb_curr.value.length)}else this.actb_curr.value=n;this.actb_mouse_on_list=0,this.actb_removedisp()},actb_penter:function(){var t,i,n;if(this.actb_display){for(this.actb_display=!1,t="",i=0,n=0;n<=this.actb_keywords.length;n++)if(this.actb_bool[n]&&i++,i==this.actb_pos){t=this.actb_keywords[n];break}this.actb_insertword(t)}},actb_removedisp:function(){(this.actb_mouse_on_list==0||this.actb_isInit)&&(this.actb_isInit&&(this.actb_isInit=!1),this.actb_display=0,document.getElementById("tat_table")&&document.body.removeChild(document.getElementById("tat_table")),this.actb_toid&&(clearTimeout(this.actb_toid),this.actb_toid=0))},actb_keypress:function(n){return this.actb_caretmove&&stopEvent(n),!this.actb_caretmove},actb_checkkey:function(n){var r,t,i;n=n||window.event,r=n.keyCode,t=getTargetElement(n).actb,t.actb_caretmove=0,i="",t.actb_toid&&(clearTimeout(t.actb_toid),t.actb_toid=0);switch(r){case 38:return t.actb_goup(),t.actb_caretmove=1,t.actb_display&&$Event(window.event).stopPropagation(),!1;case 40:return t.actb_godown(),t.actb_caretmove=1,t.actb_display&&$Event(window.event).stopPropagation(),!1;case 27:i=t.actb_curr.value,t.actb_mouse_on_list=0,t.actb_removedisp();break;case 13:if(t.actb_display)return t.actb_caretmove=1,t.actb_penter(),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault(),!1;break;case 9:if(t.actb_display||t.actb_toid)return t.actb_caretmove=1,t.actb_penter(),setTimeout(function(){t.actb_curr.focus()},25),!1;break;default:t.actb_toid=setTimeout(function(){t.actb_tocomplete_before.call(t,r)},t.actb_timeOut_Length)}return i.length&&setTimeout(function(){t.actb_curr.value=i},25),!0},actb_tocomplete_before:function(){var i,t,r;if(this.actb_curr&&this.actb_curr.parentElement&&document&&document.activeElement&&document.activeElement.id==this.actb_curr.id&&(i=$find(this.actb_curr.parentElement.id),i))switch(i.get_Type()){case"Reference":this.actb_curr.value.length<2?(this.actb_keywords=[],this.actb_tocomplete.call(this,this.actb_curr.value)):i.CallXmlHttp_AutoComplete(this.actb_curr.value);break;case"DropDownList":if(this.actb_curr.value.length<2)this.actb_keywords=[],this.actb_tocomplete.call(this,this.actb_curr.value);else{for(t=0,r=this.actb_keywords_bak.length;t<r;t++)this.actb_keywords[t]=this.actb_keywords_bak[t];this.actb_tocomplete.call(this,this.actb_curr.value)}}},actb_tocomplete:function(n){var c,l,u,r,f,a,e,v,t,o,s,y,p,i,h;if($find(this.actb_curr.parentElement.id)&&$find(this.actb_curr.parentElement.id).raiseOnAutoComplete&&(c=new UF.UI.ChangeEventArgs,c.result=this.actb_curr.value,$find(this.actb_curr.parentElement.id).raiseOnAutoComplete(c)),this.actb_toid)clearTimeout(this.actb_toid),this.actb_toid=0;else return;if(n!=38&&n!=40&&n!=13){if(this.actb_display){for(l=0,u=0,t=0;t<=this.actb_keywords.length;t++)if(this.actb_bool[t]&&u++,u==this.actb_pos){l=t;break}this.actb_pre=l}else this.actb_pre=-1;if(this.actb_curr.value==""&&(this.actb_mouse_on_list=0,this.actb_removedisp()),this.actb_delimiter.length>0){for(a=this.actb_curr.value.length,e="",t=0;t<this.actb_delimiter.length;t++)e+=this.actb_delimiter[t];for(e=e.addslashes(),v=new RegExp("(["+e+"])"),u=0,this.actb_delimwords=[],this.actb_delimwords[0]="",t=0,o=this.actb_curr.value.length;t<this.actb_curr.value.length;t++,o--)this.actb_curr.value.substr(t,o).search(v)==0?(ma=this.actb_curr.value.substr(t,o).match(v),this.actb_delimchar[u]=ma[1],u++,this.actb_delimwords[u]=""):this.actb_delimwords[u]+=this.actb_curr.value.charAt(t);for(s=0,this.actb_cdelimword=-1,t=0;t<this.actb_delimwords.length;t++)a>=s&&a<=s+this.actb_delimwords[t].length&&(this.actb_cdelimword=t),s+=this.actb_delimwords[t].length+1;r=this.actb_delimwords[this.actb_cdelimword].trim(),f=this.actb_delimwords[this.actb_cdelimword].addslashes().trim()}else r=this.actb_curr.value,f=this.actb_curr.value.addslashes();if(r.length==0)this.actb_mouse_on_list=0,this.actb_removedisp();else if(r.length==1||r.length>1&&!this.actb_keywords.length||r.length>1&&this.actb_keywords[0].substr(0,1)!=r.substr(0,1)){if(y=r.length>1?r.substr(0,1):r,p=this.actb_curr.value,suggesturl.length){if(i=null,typeof XMLHttpRequest!="undefined")try{i=new XMLHttpRequest}catch(w){i=null}else try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch(w){try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(w){i=null}}i&&(i.overrideMimeType&&i.overrideMimeType("text/xml"),i.open("GET",suggesturl+"?str="+y,!0),h=this,i.onreadystatechange=function(){if(i.readyState==4&&(i.status==200||i.status==0)){var t=null,r=null;try{t=i.responseXML,r=t.getElementsByTagName("listdata").item(0).firstChild.data}catch(u){try{t=(new DOMParser).parseFromString(i.responseText,"text/xml"),r=t.getElementsByTagName("listdata").item(0).firstChild.data}catch(e){}}h.actb_keywords=r.split("|"),h.done.call(h,y,f)}},i.send(null));return}this.done(r,f)}else this.done(r,f)}},done:function(n,t){var f,u,i,r;if(!(n.length<this.actb_startcheck)){for(f=new RegExp("^"+t,"i"),this.actb_total=0,this.actb_tomake=!1,u=this.actb_keywords.length,i=0;i<u;i++)this.actb_bool[i]=!1,f.test(this.actb_keywords[i])&&(this.actb_total++,this.actb_bool[i]=!0,this.actb_pre==i&&(this.actb_tomake=!0));if(!this.actb_firstText){for(r=[],i=0;i<u;i++)this.actb_bool[i]&&(r[r.length]=this.actb_keywords[i]);for(f=new RegExp(t,"i"),i=0;i<u;i++)f.test(this.actb_keywords[i])&&!this.actb_bool[i]&&(this.actb_total++,this.actb_bool[i]=!0,this.actb_pre==i&&(this.actb_tomake=!0),r[r.length]=this.actb_keywords[i]);for(i=0;i<u;i++)this.actb_bool[i]||(r[r.length]=this.actb_keywords[i]);for(i=0;i<u;i++)this.actb_keywords[i]=r[i];for(i=0;i<u;i++)this.actb_bool[i]=i<this.actb_total?!0:!1}this.actb_timeOut>0&&(this.actb_toid=setTimeout(function(){this.actb_mouse_on_list=0,this.actb_removedisp()},this.actb_timeOut)),this.actb_generate()}}},String.prototype.addslashes=function(){return this.replace(/(["\\\.\|\[\]\^\*\+\?\$\(\)])/g,"\\$1")},String.prototype.trim=function(){return this.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1")},String.prototype.containsCssClass=function(n,t){var r,u,i,f;if(typeof n=="undefined"||n==null)return!1;if(t=!!t,n instanceof Array){for(r=!0,u=0;u<n.length;u++)r=r&&this.containsCssClass(n[u],t);return r}return(i=" ",n=n.replace(/^\s+|\s+$/g,"").replace(/\s+/g,i),n.indexOf(i)>-1)?this.containsCssClass(n.split(i),t):(f=this.replace(/^\s+|\s+$/g,"").replace(/\s+/g,i),n=n.toString(),t&&(n=n.toLowerCase(),f=f.toLowerCase()),f.split(i).contains(n))},InputControlTemplate.Enabled="true",InputControlTemplate.ReadOnly="false",InputControlTemplate.TBClassName="textbox",InputControlTemplate.TBClassName_R="textbox TBReadOnly",InputControlTemplate.TBClassName_D="textbox TBDisabled",Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Toolbar=function(n){UF.UI.Toolbar.initializeBase(this,[n]),this.cells,this.overClass="nav-link active",this.outClass="nav-link",this.controls=[],this._keydownHandler,this._mouseoverHandler,this._mouseoutHandler,this.FullScreen=null},UF.UI.Toolbar.prototype={initialize:function(){UF.UI.Toolbar.callBaseMethod(this,"initialize"),this.cells=$(this.get_element()).find(".nav-header-item"),this._keydownHandler=Function.createDelegate(this,this.onkeyDown),$addHandler(this._element,"keydown",this._keydownHandler),this._mouseoverHandler=Function.createDelegate(this,this.ItemOver),this._mouseoutHandler=Function.createDelegate(this,this.ItemOut),this.SetMenuItem(),this.AppendSidePanel(),this.Maximized()},Maximized:function(){},dispose:function(){var n,t;if(this._keydownHandler&&($removeHandler(this._element,"keydown",this._keydownHandler),this._keydownHandler=null),this._mouseoverHandler||this._mouseoutHandler){for(n=0;n<this.controls.length;n++)t=this.controls[n];this._mouseoverHandler=null,this._mouseoutHandler=null}this.cells=null,this.controls=null,UF.UI.Toolbar.callBaseMethod(this,"dispose")},get_Type:function(){return ControlType.ToolBar},SetFocus:function(){this.controls.length>0&&this.controls[0].focus()},SetMenuItem:function(){for(var n=0;n<this.cells.length;n++)this.cells[n].children.length>0&&this.SetMenuItemStyle(this.cells[n].children[0])},SetMenuItemStyle:function(n){if(n.tagName=="INPUT"||n.tagName=="DIV"){if(n.tagName=="DIV")for(var t=0,i=n.children.length;t<i;t++)if(n.children[t].tagName=="INPUT"){n=n.children[t];break}this.controls.push(n)}},ItemOver:function(){this.JudageIn(event.srcElement)&&(event.srcElement.className=this.overClass)},ItemOut:function(){this.JudageIn(event.srcElement)&&(event.srcElement.className=this.outClass,event.srcElement.setAttribute("outClass",this.outClass))},JudageIn:function(n){for(var t=this.controls.length-1;t>=0;t--)if(n==this.controls[t]||this.controls[t].tagName=="DIV"&&this.controls[t].childNodes.length>0&&this.controls[t].childNodes[0].tagName=="INPUT"&&n==this.controls[t].childNodes[0])return!0;return!1},onkeyDown:function(){if(window.document.readyState=="complete")switch(window.event.keyCode){case KeyCode.tab:this.Jump2Element(event,event.srcElement,window.event.shiftKey);break;case KeyCode.left:this.Jump2Element(event,event.srcElement,!0);break;case KeyCode.right:this.Jump2Element(event,event.srcElement,!1)}},Jump2Element:function(n,t,i){for(var f=this.controls,r=null,u=0,e=f.length;u<e;u++)f[u]==t&&(r=i?u==0?f[e-1]:f[u-1]:u==e-1?f[0]:f[u+1]);if(r!=null&&(r.disabled||r.style.display=="none")){this.Jump2Element(n,r,i);return}r==null||r.disabled||r.style.display=="none"||(r.focus(),$Event(n).stopPropagation(),$Event(n).preventDefault())},AppendSidePanel:function(){var n=$(this._element),t=n.find("Table"),e,i;if(t.length>0)t=t.eq(0);else return;if(e=n.parent().width()-n.width(),i=function(n,t){n.css("background-image","url(../images/"+t+".gif)")},e<0){var r=$("<DIV><\/DIV>"),u=$("<SPAN><\/SPAN>"),f=$("<SPAN><\/SPAN>");r.append(u),r.append(f),n.append(r),r.attr("style","Z-INDEX: 1; POSITION: absolute; PADDING: 4px 0px; WIDTH: 32px;  FLOAT: right; HEIGHT: 25px; TOP: 0px; CURSOR: pointer; RIGHT: 0px; "),r.css("background-color",n.css("background-color")),u.attr("style","BACKGROUND-IMAGE: url(../images/left.gif); WIDTH: 16px; HEIGHT: 16px"),f.attr("style","BACKGROUND-IMAGE: url(../images/right-disable.gif); WIDTH: 16px; HEIGHT: 16px"),n.css("overflow","hidden"),u.click(function(){t.animate({left:0},{complete:function(){i(u,"left"),i(f,"right-disable")}})}),f.click(function(){n.parent().width()<t.width()&&t.animate({left:e-32},{complete:function(){i(u,"left-disable"),i(f,"right")}})})}},to_Help:function(n){$(this._element).attr("ick")=="Toolbar"&&$(this._element).next(".controlBg1").length==0&&$(this._element).after("<div class='controlBg1' z-index='"+n+"'><\/div>")},to_Translate:function(n,t){if($(this._element).attr("ick")=="Toolbar"&&$(this._element).find(".translateBg1").length==0)var i=$(this._element).find(".nav-link"),r=$(this._element).parents(".webpart_div").attr("id"),u=function(){$.each(i,function(i,u){var f=$(u).attr("id");$(u).after("<div class='translateBg' forid='"+f+"' z-index='"+n+"'><\/div>"),t&&$("[forid='"+f+"']").click(function(n){n.preventDefault(),n.stopPropagation();var i=r.length+1,u=f.substring(i);t(f,u)})})}(this)},set_translateName:function(n,t){n.val(t)},to_Defualt:function(){$(this._element).next(".controlBg1").length>0&&$(this._element).next(".controlBg1").remove(),$(this._element).find(".translateBg").length>0&&$(this._element).find(".translateBg").unbind("click").remove(),$("[forid='"+this._element.id+"']").unbind("click"),$("[forid='"+this._element.id+"']").remove()}},UF.UI.Toolbar.registerClass("UF.UI.Toolbar",UF.UI.Control),Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Number=function(n){UF.UI.Number.initializeBase(this,[n]),this._textbox,this._hidden,this._numberic,this._numbericInit,this._cultureName,this._currencySymbol="",this._hiddenSymbolControl,this.sc="&",this._allowIntegerLength,this._sourceMaxLength,this._changeHandler,this._keypressHandler,this._keydownHandler,this._focusHandler,this._blurHandler,this._selectstartHandler,this._pasteHandler,this._showInvalidMessage=null,this._isShowedInvalidMessage=null,this._isAltKeyEnabled=!0,this._isOnChangedFired=!1,this.mschangeFired=!1},UF.UI.Number.prototype={initialize:function(){var n,t;for(UF.UI.Number.callBaseMethod(this,"initialize"),this._textbox=this._element.children[0],n=this._element.children.length;n>0;n--)if(this._element.children[n-1].id==this.get_id()+"_HV"){this._hidden=this._element.children[n-1];break}this.tbClassName=this._element.getAttribute("TBClassName"),this.tbClassName==null&&(this.tbClassName=NumberTemplate.TBClassName),this._changeHandler=Function.createDelegate(this,this.changePD),$addHandler(this._textbox,"change",this._changeHandler),this._keypressHandler=Function.createDelegate(this,this.input_onkeypress),$addHandler(this._textbox,"keypress",this._keypressHandler),this._keydownHandler=Function.createDelegate(this,this.input_onkeydown),$addHandler(this._textbox,"keydown",this._keydownHandler),this._blurHandler=Function.createDelegate(this,this.input_onblur),$addHandler(this._textbox,"blur",this._blurHandler),this._pasteHandler=Function.createDelegate(this,this.input_onpaste),$addHandler(this._textbox,"paste",this._pasteHandler),this.initControl(),t=this._element.cusAttr("R")=="y"?!0:!1,this.DisplayRequiredFlag(t),this.set_IsInitComlete(!0)},dispose:function(){this._changeHandler&&($removeHandler(this._textbox,"change",this._changeHandler),this._changeHandler=null),this._keypressHandler&&($removeHandler(this._textbox,"keypress",this._keypressHandler),this._keypressHandler=null),this._keydownHandler&&($removeHandler(this._textbox,"keydown",this._keydownHandler),this._keydownHandler=null),this._focusHandler&&($removeHandler(this._textbox,"focus",this._focusHandler),this._focusHandler=null),this._blurHandler&&($removeHandler(this._textbox,"blur",this._blurHandler),this._blurHandler=null),this._selectstartHandler&&($removeHandler(this._textbox,"selectstart",this._selectstartHandler),this._selectstartHandler=null),this._pasteHandler&&($removeHandler(this._textbox,"paste",this._pasteHandler),this._pasteHandler=null),this.curHandler!=null&&(this.curHandler=null),this._textbox=null,this._hidden=null,this._numberic=null,this._hiddenSymbolControl=null,this._showInvalidMessage=null,this._isAltKeyEnabled=null,UF.UI.Number.callBaseMethod(this,"dispose")},initControl:function(){this._showInvalidMessage=this._element.cusAttr("ShowInvalidMessage"),this._showInvalidMessage==null&&(this._showInvalidMessage=NumberTemplate.ShowInvalidMessage),this.get_numberic(),this._sourceMaxLength=$(this._textbox).attr("maxLength"),this._allowIntegerLength=$(this._textbox).attr("maxLength")-parseInt(this.get_Scale(),10);var n=this._element.cusAttr("ReadOnly");n||(n=NumberTemplate.ReadOnly=="true"),n&&($(this._textbox).attr("readOnly",!0),this._selectstartHandler=Function.createDelegate(this,this.selectStart),$addHandler(this._textbox,"selectstart",this._selectstartHandler)),this._focusHandler=Function.createDelegate(this,this.input_onfocus),$addHandler(this._textbox,"focus",this._focusHandler),$(this._textbox).attr("onchange")&&$(this._textbox).bind("change",function(){window._TextBoxFirePostBack=!0})},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(n){var t=this.get_events().getHandler("onchange");t&&t(this,n)},add_OnValueChanged:function(n){this.get_events().addHandler("OnValueChanged",n)},remove_OnValueChanged:function(n){this.get_events().removeHandler("OnValueChanged",n)},raiseOnValueChanged:function(n){var t=this.get_events().getHandler("OnValueChanged");t&&t(this,n),this.AfterRaiseOnValueChanged4Personal()},add_OnValueChanged4P:function(n){this.get_events().addHandler("OnValueChanged4P",n)},remove_OnValueChanged4P:function(n){this.get_events().removeHandler("OnValueChanged4P",n)},raiseOnValueChanged4P:function(n){var t=this.get_events().getHandler("OnValueChanged4P");t&&(this.curHandler=t,t(this,n)),this.AfterRaiseOnValueChanged4Personal()},add_onkeypress:function(n){this.get_events().addHandler("onkeypress",n)},remove_onkeypress:function(n){this.get_events().removeHandler("onkeypress",n)},raiseonkeypress:function(){var t=this.get_events().getHandler("onkeypress");t&&t(this.args)},selectStart:function(){event.cancelBubble=!1,$Event(event).preventDefault()},GetHiddenControl:function(){if(this._hiddenSymbolControl==null)for(var n=this._element.children.length;n>0;n--)if(this._element.children[n-1].id==this.get_id()+"_HF"){this._hiddenSymbolControl=this._element.children[n-1];break}return this._hiddenSymbolControl},ReSetHiddenSymbolValue:function(){this.GetHiddenControl().value=this.get_CurrencySymbol()+this.sc+this.get_RoundType()+this.sc+this.get_RoundValue()+this.sc+this.get_Scale()},get_Type:function(){return ControlType.Numberic},get_numberic:function(){if(this._numbericInit)return this._numberic;var n=this._element.cusAttr("V");return n&&n!=""?(this._numberic=Number.parseEx(n),isNaN(this._numberic)&&(this._numberic="")):this._numberic="",this._numbericInit=!0,this._numberic},get_ReadOnly:function(){return this._element.cusAttr("readOnly")},set_ReadOnly:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&this.get_Enabled()&&(n=ToBoolean(n),this._element.cusAttr("readOnly",n),$(this._textbox).attr("ReadOnly",n),n?(this._selectstartHandler||(this._selectstartHandler=Function.createDelegate(this,this.selectStart),$addHandler(this._textbox,"selectstart",this._selectstartHandler)),this._focusHandler&&($removeHandler(this._textbox,"focus",this._focusHandler),this._focusHandler=null),this._textbox.className=this.tbClassName_R,this._element.className=UIControlClass.UFTextBox.ReadOnlyCssClass):(this._selectstartHandler&&($removeHandler(this._textbox,"selectstart",this._selectstartHandler),this._selectstartHandler=null),this._focusHandler||(this._focusHandler=Function.createDelegate(this,this.input_onfocus),$addHandler(this._textbox,"focus",this._focusHandler)),this._textbox.className=this.tbClassName,this._element.className=UIControlClass.UFTextBox.CssClass),this.set_HDValue("ReadOnly",n.toString().toLowerCase()),this.AfterSetReadOnly4Personal())},set_Width:function(n){this._element.style.width=n+"px",this._textbox.style.width=n-2+"px"},FireChange:function(){this.input_onblur()},SetFocus:function(){this._textbox.focus(),Basic.SetFocus(this._textbox)},get_CurrencySymbol:function(){return this._element.cusAttr("CS")?this._element.cusAttr("CS"):""},set_CurrencySymbol:function(n,t){this._element.cusAttr("CS")!=n&&(this._element.cusAttr("CS",n),t||(this.setTextBoxValue(),this.ReSetHiddenSymbolValue()))},get_Scale:function(){var t=2,n=this.get_FormatString();return n!=null&&n.length>1&&(t=n.slice(1)),t},set_Scale:function(n,t){var r=parseInt(n,10),i,u;isNaN(r)&&(r=2),i=this.get_FormatString(),i.length==0?i="D":(i.slice(0,1).toLowerCase()=="p"&&(r=r-2),i=i.slice(0,1)+r.toString()),t||(u=this.JudgeOutOfMaxLength(r),u>0&&this.MoveDot(u)),this.set_FormatString(i,t),this._allowIntegerLength=this._sourceMaxLength-parseInt(n,10)},JudgeOutOfMaxLength:function(n){var r=parseInt(this.get_Scale()),t=this._numberic.split(".")[0],i=0;return i=t.indexOf("-")>-1?t.length+(n-r)-this._allowIntegerLength-1:t.length+(n-r)-this._allowIntegerLength},MoveDot:function(n){var t,i;if(this._numberic.indexOf(".")>-1){var u=this._numberic.indexOf("."),t=this._numberic.substr(0,this._numberic.indexOf(".")),i=this._numberic.substr(this._numberic.indexOf(".")+1),r=t.substr(0,t.length-n)+"."+t.substr(t.length-n,t.length);this._numberic=r+i}else t=this._numberic.substr(0,this._numberic.length-n),i=this._numberic.substr(this._numberic.length-n,this._numberic.length),this._numberic=t+"."+i},get_RoundValue:function(){return this._element.cusAttr("RV")==null?(roundValue=5,this._element.cusAttr("RV",roundValue)):isNaN(this._element.cusAttr("RV"))&&(roundValue=5,this._element.cusAttr("RV",roundValue)),this._element.cusAttr("RV")},set_RoundValue:function(n,t){var i=parseInt(n,10);(isNaN(i)&&(i=5),this._element.cusAttr("RV")!=i)&&(this._element.cusAttr("RV",i),t||(this.setTextBoxValue(),this.ReSetHiddenSymbolValue()))},get_RoundType:function(){return this._element.cusAttr("RT")},set_RoundType:function(n,t){var i=parseInt(n,10);(isNaN(i)&&(i=this.get_RoundType()),this._element.cusAttr("RT")!=i)&&(this._element.cusAttr("RT",i),t||(this.ReSetHiddenSymbolValue(),this.setTextBoxValue()))},get_Value:function(){return this._hidden.value},set_Value:function(n){var r=Number.parseEx(n),u;if(!isNaN(r))if(this.validInputValue(r))this._numberic=r,this._numbericInit=!0,this._isShowedInvalidMessage==!0&&(RemoveErrorMsgElment(this.get_id(),this._element),this._isShowedInvalidMessage=!1);else if(this._showInvalidMessage!=null&&this._showInvalidMessage.toLowerCase()=="true"&&n!==""){var i=new Date,e=i.getMonth()+1,f=i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),t=Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_NumberOverFlow.replace(/\$Time\$/g,f);t=this._element.cusAttr("LC")==null||this._element.cusAttr("LC")==""||$ID(this._element.cusAttr("LC"))==null?t.replace(/\$Title\$/g,""):t.replace(/\$Title\$/g,$ID(this._element.cusAttr("LC")).title),t=t.replace(/\$ID\$/g,this.get_id()),t=t.replace(/\$MaxValue\$/g,this.get_MaxValue().toString()),t=t.replace(/\$MinValue\$/g,this.get_MinValue().toString()),this.ShowWarnMsg(t),this._isShowedInvalidMessage=!0}return u=this.setTextBoxValue(),u==!0?!0:void 0},get_Text:function(){return this._numberic==null||this._numberic.toString()==""?"&":this._element.cusAttr("TP")=="FixedPoint"?parseFloat(this._numberic)<0?this._numberic.toString()+"&"+this._numberic.toString().substr(1):this._numberic.toString()+"&"+this._numberic.toString():Number$toFormattedStringEx(this._numberic,this.get_CurrencySymbol(),this.get_FormatString(),this.get_Culture().toLowerCase(),this.get_RoundType(),this.get_RoundValue())},ShowWarnMsg:function(n){this._element.parentNode.className.split(" ")[0]=="tbc"?showStatus(n):CreateWarnMsg(n,this._element)},GetTextBoxValue:function(){return this._textbox.value},set_Text:function(n){this.set_Value(n)},get_FormatString:function(){return this._element.cusAttr("FS")},set_FormatString:function(n,t){this._element.cusAttr("FS")!=n&&(this._element.cusAttr("FS",n),t||(this.setTextBoxValue(),this.ReSetHiddenSymbolValue()))},get_Culture:function(){return this._cultureName==null&&(this._cultureName="zh-CN"),this._cultureName},set_Culture:function(n){this._cultureName=n},get_NumberFormat:function(){return Sys.CultureInfo[this.get_Culture().toLowerCase()].NumberFormat},get_MaxValue:function(){var t=this._element.cusAttr("MaxV"),n;return t==null&&(n=this._element.cusAttr("DT"),n&&(n.toString()=="8"?t=DATATYPE_DECIMAL_Template.MaxV:n.toString()=="9"?minValue=DATATYPE_INT16_Template.MaxV:n.toString()=="2"?minValue=DATATYPE_INT_Template.MaxV:n.toString()=="7"&&(minValue=DATATYPE_INT64_Template.MaxV))),isNaN(parseFloat(t))?Number.MAX_VALUE:t},set_MaxValue:function(n){isNaN(parseFloat(n))||this._element.cusAttr("MaxV",n)},get_MinValue:function(){var n=this._element.cusAttr("MinV"),t;return n==null&&(t=this._element.cusAttr("DT"),t&&(t.toString()=="8"?n=DATATYPE_DECIMAL_Template.MinV:t.toString()=="9"?n=DATATYPE_INT16_Template.MinV:t.toString()=="2"?n=DATATYPE_INT_Template.MinV:t.toString()=="7"&&(n=DATATYPE_INT64_Template.MinV))),isNaN(parseFloat(n))?-Number.MAX_VALUE:n},set_MinValue:function(n){isNaN(parseInt(n,10))||this._element.cusAttr("MinV",n)},setTextBoxValue:function(){var t=$(this._hidden).val(),n=this.get_Text().split("&");if($(this._textbox).val(this._numberic==0&&this._element.cusAttr("ZN")=="true"?"":n[0]),this._numberic!=null&&parseFloat(this._numberic.toString())<0?(this._numberic="-"+n[1],$(this._hidden).val(this._numberic)):n[1]?(this._numberic=n[1],$(this._hidden).val(this._numberic)):(this._numberic="",$(this._hidden).val(this._numberic)),$(this._hidden).val()!=t)return this.fireValueChangeEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0),this._isOnChangedFired!=!0&&this.fireValueChange4PEvent(),!0;this.get_IsRaiseEvent()&&this.AfterRaiseOnValueChanged4Personal()},formatTextBoxValue:function(){var t=this._hidden.value,n=this.get_Text().split("&");this._textbox.value=this._numberic==0&&this._element.cusAttr("ZN")=="true"?"":n[0],this._numberic!=null&&parseFloat(this._numberic.toString())<0?(this._numberic="-"+n[1],this._hidden.value=this._numberic):n[1]?(this._numberic=n[1],this._hidden.value=this._numberic):(this._numberic="",this._hidden.value="")},fireChangeEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=$(this._textbox).val(),this.raiseonchange(n)}},fireValueChangeEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=$(this._hidden).val(),this.raiseOnValueChanged(n)}},fireValueChange4PEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=$(this._hidden).val(),this.raiseOnValueChanged4P(n)}},changePD:function(){var n,r,t,u,i;this._isOnChangedFired=!0,n=$(this._textbox).val().replace(this.get_CurrencySymbol(),""),r=new RegExp(Sys.CultureInfo[this.get_Culture().toLowerCase()].NumberFormat.NumberGroupSeparator,"g"),n=n.replace(r,""),t=$(this._textbox).val()!=this._numberic&&Number.parseEx(n)*1!=this._numberic*1,($(this._textbox).val()==""||this._numberic=="")&&$(this._textbox).val()!=this._numberic&&(t=!0),t&&(u=this.set_Value($(this._textbox).val()),window._NotFirePostBackControl&&(window._NotFirePostBackControl=null),u?(this.fireChangeEvent(),this.fireValueChange4PEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0)):(i=this._textbox.getAttribute("onchange"),i&&i.toString().indexOf("__doPostBack")>=0&&(window._NotFirePostBackControl=this._textbox.id.replace(/_/g,"$")))),this._isOnChangedFired=!1,this.mschangeFired=!0},fireEvent:function(){var n=new UF.UI.ChangeEventArgs;n.keyCode=event.keyCode,this.raiseonkeypress(n)},input_onkeydown:function(){var n,t;if(this._element.cusAttr("ReadOnly")){$Event(event).preventDefault();return}if(n=event.keyCode,event.altKey){if(this._isAltKeyEnabled)this._isAltKeyEnabled=!1,window.setTimeout(function(){this._isAltKeyEnabled=!0},3e3);else{n!=74&&n!==187&&($Event(event).stopPropagation(),$Event(event).preventDefault());return}this._numberic!=$(this._textbox).val()&&(t=this.set_Value($(this._textbox).val()),t==!0&&(this.fireChangeEvent(),this._textbox.onchange!=null&&this._textbox.fireEvent("onchange"))),this.input_onblur()}},input_onkeypress:function(){var t;if(this._element.cusAttr("ReadOnly")){$Event(event).preventDefault();return}this.fireEvent();var n=event.keyCode,i=this.get_NumberFormat(),r=",",u="-";if(i&&(r=i.NumberDecimalSeparator,u=i.NegativeSign),t=this._element.cusAttr("DT"),!(n>=45&&n<=57&&n!=47||n==37)){$Event(event).preventDefault();return}if(t&&(t==DataType.INT||t==DataType.Int16||t==DataType.Int64)&&!(n>47&&n<58||n==45||n==37)){$Event(event).preventDefault();return}this.getRuntimeMaxLength(),(event.keyCode==45||event.keyCode==46||event.keyCode==37)&&this.ChangeMaxLength(t,event.keyCode),this.IsAllowInput(this._textbox)||$Event(event).preventDefault()},ChangeMaxLength:function(n,t){$(this._textbox).attr("maxLength",this._sourceMaxLength),$(this._textbox).val().indexOf(".")>-1&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1),$(this._textbox).val().indexOf("-")>-1&&(n&&(n==DataType.INT||n==DataType.Int16||n==DataType.Int64)||$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1)),$(this._textbox).val().indexOf("%")>-1&&(n&&(n==DataType.INT||n==DataType.Int16||n==DataType.Int64)||$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1)),t==45&&$(this._textbox).val().indexOf("-")==-1&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1),t==46&&$(this._textbox).val().indexOf(".")==-1&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1),t==37&&$(this._textbox).val().indexOf("%")==-1&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1)},RrevertMaxLength:function(){$(this._textbox).attr("maxLength",this._sourceMaxLength)},GetCursorPosition:function(n){var t=0,i;if(n)return document.selection?(n.focus(),i=document.selection.createRange(),i.moveStart("character",-n.value.length),t=i.text.length):(n.selectionStart||n.selectionStart=="0")&&(t=n.selectionEnd-n.selectionStart),t},IsAllowInput:function(n){var i=this.GetCursorPosition(n),u=this._element.cusAttr("DT"),r=event.keyCode,t;if(r>=45&&r<=57&&r!=47||r==37){if(u&&(u==DataType.INT||u==DataType.Int16||u==DataType.Int64)&&r==46)return $Event(event).preventDefault(),!1;if(this.GetMinValue()>=0&&r==45)return $Event(event).preventDefault(),!1}else return!1;if(t=window.getSelection().toString(),t.length>0)switch(r){case 45:if($(this._textbox).val().indexOf("-")>-1)return t.indexOf("-")>-1?!0:!1;if(t.length==i)return!0;break;case 46:return $(this._textbox).val().indexOf(".")>-1?t.indexOf(".")>-1?!0:!1:!0;case 37:return $(this._textbox).val().indexOf("%")>-1?t.indexOf("%")>-1?!0:!1:i==n.value.length&&i!=0&&t.length!=n.value.length?t.length==n.value.length-1&&n.value.indexOf("-")==0?!1:!0:!1;default:return t.indexOf("0")>-1||t.indexOf("1")>-1||t.indexOf("2")>-1||t.indexOf("3")>-1||t.indexOf("4")>-1||t.indexOf("5")>-1||t.indexOf("6")>-1||t.indexOf("7")>-1||t.indexOf("8")>-1||t.indexOf("9")>-1?!0:this.filtrateChars($(this._textbox).val(),".-").length<this._allowIntegerLength?!0:!1}else switch(r){case 45:return i!=0?!1:$(this._textbox).val().indexOf("-")>-1?!1:!0;case 46:return $(this._textbox).val().indexOf(".")>-1?!1:$(this._textbox).val().indexOf("%")>-1&&i>n.value.indexOf("%")?!1:!0;case 37:return $(this._textbox).val().indexOf("%")<0&&i==n.value.length&&i!=0?!0:!1;default:return $(this._textbox).val().indexOf("%")>-1?$(this._textbox).val().indexOf(".")>-1?i>n.value.indexOf(".")?n.value.indexOf("%")>-1&&i<n.value.indexOf("%")+1?!0:!1:this.filtrateChars($(this._textbox).val().substring(0,$(this._textbox).val().indexOf(".")),"-%").length<this._allowIntegerLength+2?!0:!1:i>n.value.indexOf("%")?!1:this.filtrateChars($(this._textbox).val(),"-%").length<this._allowIntegerLength+2?!0:!1:$(this._textbox).val().indexOf(".")>-1?i>n.value.indexOf(".")?!0:this.filtrateChars($(this._textbox).val().substring(0,$(this._textbox).val().indexOf(".")),".-").length<this._allowIntegerLength?!0:!1:this.filtrateChars($(this._textbox).val(),".-").length<this._allowIntegerLength?!0:!1}},input_onpaste:function(){var i,r,u,o,t,f;if(this.getRuntimeMaxLength(),this._element.cusAttr("ReadOnly")){$Event(event).preventDefault();return}var s=event.srcElement,h=s.cusAttr("maskChars"),n="";if(n=window.clipboardData?window.clipboardData.getData("text"):event.clipboardData.getData("text/plain"),isMasks(n,h)&&$Event(event).preventDefault(),i=window.getSelection().toString(),$(this._textbox).val()==i?(this.RrevertMaxLength(),n.indexOf(".")>0&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1),n.indexOf("-")>0&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1)):(i.indexOf(".")>0&&(n.indexOf(".")>0||$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")-1)),i.indexOf("-")>0&&(n.indexOf("-")>0||$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")-1)),i.indexOf("%")>0&&(n.indexOf("%")>0&&n.indexOf("%")==n.length-1||$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")-1))),r="",n!=null&&n.length!=0){var c="0".charCodeAt(0),l="9".charCodeAt(0),e=!1;for(u=0,o=n.length;u<o;u++){if(t=n.charAt(u),f=n.charCodeAt(u),f>=c&&f<=l){r+=t;continue}if(t=="."&&!e){r+=t,e=!0;continue}if(t=="%"){r+=t;continue}}if(r==="")$Event(event).preventDefault();else return!0}},GetMinValue:function(){var n=this._element.cusAttr("MinV"),t;return(n==null&&(n=this.get_MinValue()),t=parseFloat(n),isNaN(t))?-1:t},input_onfocus:function(){if(this.ControlFocus(),!this.get_ReadOnly()&&this.get_Enabled()){var n=this.get_numberic();n!=null&&$(this._textbox).val(n.toString());try{this._textbox.select()}catch(t){}}},input_onblur:function(){(this.mschangeFired==!0?this.mschangeFired=!1:this.get_ReadOnly()!=!0&&this.changePD(),this.ControlBlur(),this._element.cusAttr("ReadOnly"))||(this.IsInGrid()?this.formatTextBoxValue():this.setTextBoxValue(),$(this._textbox).attr("maxLength",this._sourceMaxLength))},validInputValue:function(n){var t,u,i,r;return isNaN(n)?!1:(t=this._element.cusAttr("DT"),t!=DataType.INT&&t!=DataType.Int16&&t!=DataType.Int64&&n&&(u=n.toString().split(".")[0],this.filtrateChars(u,"-").length>this._allowIntegerLength))?!1:this._element.cusAttr("R")&&this._element.cusAttr("R")=="n"&&!n?!0:n.toString()=="0"&&this._element.cusAttr("ZN")=="true"?!0:(i=this._element.cusAttr("MaxV"),i==null&&(i=this.get_MaxValue()),r=this._element.cusAttr("MinV"),r==null&&(r=this.get_MinValue()),handleMaxMinValue(i,r,n))},setAttribute:function(n,t){this._element&&this._element.setAttribute(n,t)},filtrateChars:function(n,t){for(var r="",i=0,u=n.length;i<u;i++)t.indexOf(n.substr(i,1))==-1&&(r+=n.substr(i,1));return r},getRuntimeMaxLength:function(){$(this._textbox).attr("maxLength",this._sourceMaxLength),$(this._textbox).val().indexOf("-")>-1&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1),$(this._textbox).val().indexOf(".")>-1&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1),$(this._textbox).val().indexOf("%")>-1&&$(this._textbox).attr("maxLength",$(this._textbox).attr("maxLength")+1)}},UF.UI.Number.registerClass("UF.UI.Number",UF.UI.InputControl),NumberTemplate.Enabled=InputControlTemplate.Enabled,NumberTemplate.ReadOnly=InputControlTemplate.ReadOnly,NumberTemplate.TBClassName=InputControlTemplate.TBClassName+" number",NumberTemplate.TBClassName_R=InputControlTemplate.TBClassName_R,NumberTemplate.TBClassName_D=InputControlTemplate.TBClassName_D,NumberTemplate.ShowInvalidMessage="true",DATATYPE_DECIMAL_Template.MinV="0",DATATYPE_DECIMAL_Template.MaxV="999999999999999",DATATYPE_INT16_Template.MinV="-32768",DATATYPE_INT16_Template.MaxV="32767",DATATYPE_INT_Template.MinV="-2147483648",DATATYPE_INT_Template.MaxV="2147483647",DATATYPE_INT64_Template.MinV="-9999999999999998",DATATYPE_INT64_Template.MaxV="9999999999999998",Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.DropDownList=function(n){UF.UI.DropDownList.initializeBase(this,[n]);var t=this;this.$element,this.__isShow=0,this._textbox,this._button,this._hidden,this._dataSource=[],this._popup,this._select1,this._selectedIndex,this._Popup_Rows=5,this._readOnly=!1,this._RefResults=null,this.newItem="",this._allItem=[],this._IsReloadItems=!1,this._IsShow=!1,this._splitter1,this._splitter2,this._HideRequiredFlag=!1,this._itemsHidden,this._xmlReturnHidden,this._datas,this._code="",this._codeHash,this._hasCode=!1,this._itemValueIsntNumber=!1,this._isFiltering=!1,this.filterKeyDownTimeOut,this._elementkeydownHandler,this._buttonclickHandler,this._btnmouseoverHandler,this._btnmouseoutHandler,this._textboxfocusHandler,this._textboxblurHandler,this._textboxonchangeHandler,this._textboxkeydownHandler,this._textboxkeyupHandler,this._textboxpasteHandler,this._textboxdragHandler,this._popupfocusoutHandler,this._popupkeydownHandler,this._selectchangeHandler,this._selectclickHandler,this._girdScrollHandler,this._resizeHandler,this._autoComplete=!1,this._autoCompleteArray=[],this._curactb,this._isCustomerEnumType=!1,this._isShowWithRefForm=!1,this._hasAllItems=!1,this.isGettingAllItems=!1,this._isCustItems=!1,this._CancelShowForm=!1,this._IsDialogOpenning=!1,this._IsShowForm=!0,this._inputValue,this._disableEvent=!1,this._xmlhttpRequest,this.CallbackComplete=function(){var n,i,r;if(t._xmlhttpRequest&&t._xmlhttpRequest.readyState==4){if(n=t._xmlhttpRequest.responseText,n=unescapeHTML(n),i=n.indexOf("<ReferenceReturns>"),r=n.indexOf("<\/ReferenceReturns>")+"<\/ReferenceReturns>".length,i!=-1&&r!=-1)n=n.substring(i,r);else return;if(typeof JavaScriptDebugTool!="undefined"&&JavaScriptDebugTool.LogReferenceReturnValue&&$alert("Return:"+n),n=="<ReferenceReturns>__MultiRows<\/ReferenceReturns>"||n=="<ReferenceReturns><\/ReferenceReturns>"){t._IsShowForm=!0,t.ShowRefForm(t._inputValue);return}if(n=="<ReferenceReturns>true<\/ReferenceReturns>")return;if(n=="<ReferenceReturns>false<\/ReferenceReturns>"){t.get_SetControlValue()&&t.get_SetControlValue().IsSetControlValue==!0&&t.ShowSetControlValueErrorMsg(),t.OnContentChanged(null);return}t.OnContentChanged(n),t._CancelShowForm=!0,t._disableEvent=!1}},this.CallbackComplete4GetItems=function(){var t=this,n,i,r;if(t._xmlhttpRequest&&t._xmlhttpRequest.readyState==4){if(n=t._xmlhttpRequest.responseText,n=unescapeHTML(n),i=n.indexOf("<ReferenceReturns>"),r=n.indexOf("<\/ReferenceReturns>")+"<\/ReferenceReturns>".length,i!=-1&&r!=-1)n=n.substring(i,r);else return;JavaScriptDebugTool.LogReferenceReturnValue&&$alert("Return:"+n),t.LoadItems(n),t.isGettingAllItems&&(t._hasAllItems=!0),t.isGettingAllItems=!1}}},UF.UI.DropDownList.prototype={initialize:function(){var o,n,e,t,i,r,u,f;UF.UI.DropDownList.callBaseMethod(this,"initialize"),this.$element=$(this._element),this._splitter1=this._element.cusAttr("splitter1"),this._splitter2=this._element.cusAttr("splitter2"),this._textbox=this._element.childNodes[0],this._button=this._element.childNodes[1],this.btnmouseOverClass=DropDownListTemplate.BtnClassName_MouseOver,this.btnmouseOutClass=this._button.className,o=this._element.children.length,this._hidden=$get(this.get_id()+"_Hidden"),this._itemsHidden=$get(this.get_id()+"_ItemsHidden"),this._xmlReturnHidden=$get(this.get_id()+"_ReturnHidden"),n=this._element,e=n.cusAttr("Items"),this.set_Items(e),t=n.cusAttr("StartI"),i=n.cusAttr("EndI"),(t!=null&&t!=""||i!=null&&i!="")&&this.ResetItemByInterval(t,i),n.cusAttr("HINs")&&(this.ResetItem(!0,n.cusAttr("HINs")),this._hidden.value=this.get_Value()),n.cusAttr("SINs")&&(this.ClearItems(),this.ResetItem(!1,n.cusAttr("SINs")),this._hidden.value=this.get_Value()),r=n.cusAttr("IsRef"),r&&r=="y"&&(this._isShowWithRefForm=!0),this.btnClassName==null&&(this.btnClassName=this._isShowWithRefForm?DropDownListTemplate.BtnClassName_Ref:DropDownListTemplate.BtnClassName),this.btnClassName_Dis==null&&(this.btnClassName_Dis=this._isShowWithRefForm?DropDownListTemplate.BtnClassName_Ref_Dis:DropDownListTemplate.BtnClassName_Dis),u=n.cusAttr("IsCustItems"),u&&u=="y"&&(this._isCustItems=!0),n.cusAttr("AutoComplete")=="true"&&(this._autoComplete=!0),this._autoComplete=!1,this.get_AutoComplete()==!1,n.cusAttr("HideRequiredFlag")&&n.cusAttr("HideRequiredFlag")=="y"&&(this._HideRequiredFlag=!0),this.DisplayRequiredFlag(!this._HideRequiredFlag),f=n.cusAttr("IsCustomerEnum"),this._isCustomerEnumType=f&&f=="true"?!0:!1,this.initControl(),this._buttonclickHandler=Function.createDelegate(this,this.button_click),$addHandler(this._button,"click",this._buttonclickHandler),this._elementkeydownHandler=Function.createDelegate(this,this.onkeyDown),$addHandler(this.get_element(),"keydown",this._elementkeydownHandler),this._textboxonchangeHandler=Function.createDelegate(this,this.textboxChange),$addHandler(this._textbox,"change",this._textboxonchangeHandler),this._textboxkeydownHandler=Function.createDelegate(this,this.textboxKeydown),$addHandler(this._textbox,"keydown",this._textboxkeydownHandler),this._textboxkeyupHandler=Function.createDelegate(this,this.textboxKeyup),$addHandler(this._textbox,"keyup",this._textboxkeyupHandler),this._textboxpasteHandler=Function.createDelegate(this,this.textboxPaste),$addHandler(this._textbox,"paste",this._textboxpasteHandler),this._textboxdragHandler=Function.createDelegate(this,this.textboxDrag),$addHandler(this._textbox,"drag",this._textboxdragHandler),this._textboxfocusHandler=Function.createDelegate(this,this.textboxFocus),$addHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxblurHandler=Function.createDelegate(this,this.textboxBlur),$addHandler(this._textbox,"blur",this._textboxblurHandler),this._btnmouseoverHandler=Function.createDelegate(this,this.BtnMouseOver),$addHandler(this._button,"mouseover",this._btnmouseoverHandler),this._btnmouseoutHandler=Function.createDelegate(this,this.BtnMouseOut),$addHandler(this._button,"mouseout",this._btnmouseoutHandler),this._textbox.oncontextmenu=this._textboxoncontextmenu,isReadOnly=n.cusAttr("ReadOnly")?!0:DropDownListTemplate.ReadOnly=="true"?!0:!1,this._readOnly=isReadOnly,isReadOnly&&($(this._textbox).attr("readOnly",isReadOnly),$(this._button).attr("disabled",isReadOnly)),this.get_AutoComplete()==!1&&n.cusAttr("R")=="y",this.set_IsInitComlete(!0)},_textboxoncontextmenu:function(){return!1},dispose:function(){this.filterKeyDownTimeOut&&window.clearTimeout(this.filterKeyDownTimeOut),this._elementkeydownHandler&&($removeHandler(this._element,"keydown",this._elementkeydownHandler),this._elementkeydownHandler=null),this._buttonclickHandler&&($removeHandler(this._button,"click",this._buttonclickHandler),this._buttonclickHandler=null),this._btnmouseoverHandler&&($removeHandler(this._button,"mouseover",this._btnmouseoverHandler),this._btnmouseoverHandler=null),this._btnmouseoutHandler&&($removeHandler(this._button,"mouseout",this._btnmouseoutHandler),this._btnmouseoutHandler=null),this._textboxfocusHandler&&($removeHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxfocusHandler=null),this._textboxblurHandler&&($removeHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxblurHandler=null),this._textboxonchangeHandler&&($removeHandler(this._textbox,"change",this._textboxonchangeHandler),this._textboxonchangeHandler=null),this._textboxkeydownHandler&&($removeHandler(this._textbox,"keydown",this._textboxkeydownHandler),this._textboxkeydownHandler=null),this._textboxkeyupHandler&&($removeHandler(this._textbox,"keyup",this._textboxkeyupHandler),this._textboxkeyupHandler=null),this._textboxpasteHandler&&($removeHandler(this._textbox,"paste",this._textboxpasteHandler),this._textboxpasteHandler=null),this._textboxdragHandler&&($removeHandler(this._textbox,"drag",this._textboxdragHandler),this._textboxdragHandler=null),this._button=null,this._hidden=null,this._itemsHidden=null,this._xmlReturnHidden=null,this._dataSource&&(Array.clear(this._dataSource),this._dataSource=null),this.clear_Popup(),this._select1=null,this._RefResults&&(Array.clear(this._RefResults),this._RefResults=null),this.newItem=null,this._allItem&&(Array.clear(this._allItem),this._allItem=null),this._curactb&&(this._curactb.dispose(),this._curactb=null),this._autoCompleteArray&&(Array.clear(this._autoCompleteArray),this._autoCompleteArray=null),this.curHandler!=null&&(this.curHandler=null),this._textboxoncontextmenu!=null&&(this._textboxoncontextmenu=null),this._textbox.oncontextmenu!=null&&(this._textbox.oncontextmenu=null),this._autoComplete=null,this._textbox=null,UF.UI.DropDownList.callBaseMethod(this,"dispose")},initControl:function(){var o,n,i,t,e,r,u,f;if(this._isShowWithRefForm&&(this._textbox.cusAttr("autocomplete","off"),this._datas=new ReferenceData,o=this._element.cusAttr("RefValue"),n=this.StringToList(o,this._splitter1),n.length==3&&(this._code=n[1],i=this.getRefInfo(),t=[],t[i.KeyField]=n[0],t[i.ValueField]=n[1],t[i.TextField]=n[2],this._datas.Rows[0]=t)),this._codeHash={},e=this._element.cusAttr("Codes"),e&&(r=this.StringToList(e,this._splitter1),r.length>0))for(u=0;u<r.length;u++)f=this.StringToList(r[u],this._splitter2),f.length==2&&(this._codeHash[f[0]]=f[1],this._hasCode=!0)},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(args){if(this.get_IsRaiseEvent()!=!1){this._element.cusAttr("AutoPostbackForNew")?__doPostBack(this._element.id,""):this.$element.attr("onchange")&&eval(this.$element.attr("onchange"));var eh=this.get_events().getHandler("onchange");eh&&eh(this,args)}},add_SelectedIndexChanged:function(n){this.get_events().addHandler("SelectedIndexChanged",n)},remove_SelectedIndexChanged:function(n){this.get_events().removeHandler("SelectedIndexChanged",n)},raiseSelectedIndexChanged:function(args){this.$element.attr("SelectedIndexChanged")&&eval(this.$element.attr("SelectedIndexChanged"));var eh=this.get_events().getHandler("SelectedIndexChanged");eh&&eh(this,args)},add_OnValueChanged:function(n){this.get_events().addHandler("OnValueChanged",n)},remove_OnValueChanged:function(n){this.get_events().removeHandler("OnValueChanged",n)},raiseOnValueChanged:function(args){if(this.get_IsRaiseEvent()!=!1){this.$element.attr("OnValueChanged")&&eval(this.$element.attr("OnValueChanged"));var eh=this.get_events().getHandler("OnValueChanged");eh&&eh(this,args),this.AfterRaiseOnValueChanged4Personal()}},add_OnValueChanged4P:function(n){this.get_events().addHandler("OnValueChanged4P",n)},remove_OnValueChanged4P:function(n){this.get_events().removeHandler("OnValueChanged4P",n)},raiseOnValueChanged4P:function(n){var t=this.get_events().getHandler("OnValueChanged4P");t&&(this.curHandler=t,t(this,n)),this.AfterRaiseOnValueChanged4Personal()},get_Type:function(){return ControlType.DropDownList},set_DataSource:function(n){this._RefResults=n,this.ReloadDataSource()},get_DataSource:function(){return this._RefResults},getReturnXml:function(){try{return this._datas}catch(n){}return null},ResetHiddenValue:function(){var t,i,n,r;if(this._hidden.value){if(this.newItem){for(t=this.newItem.split(this.get_Splitter4Item()),n=0,r=t.length;n<r;n++)i=this.get_Splitter4Item()+t[n],this._hidden.value.indexOf(i)<0&&(this._hidden.value+=i);this._hidden.value=this._hidden.value.replace(this.get_Splitter4Item()+this.get_Splitter4Item(),this.get_Splitter4Item())}}else this._hidden.value+=this.newItem},ReloadDataSource:function(){var t,n,u;this.ClearItems(),this.clear_Popup();var r=this._RefResults[0],i=this._RefResults[1],f=this._RefResults[2];if(f){for(t=f.Rows,this._codeHash={},this._hasCode=!1,n=0;n<t.length;n++)u=!1,t[n].Selected&&(u=!0),t[n][i]==""&&(t[n][i]=" "),this.AddItem(t[n][r],t[n][i],u),this.newItem+=this._splitter1+t[n][r]+this._splitter2+t[n][i],this._codeHash[t[n][r]]=t[n].RealityCode,this._hasCode=!0;this.ResetHiddenValue(),this.ResetSelectedItem()}},ResetSelectedItem:function(){for(var n=0,t=this._dataSource.length;n<t;n++)if(this._dataSource[n].Selected){this.set_SelectedValue(this._dataSource[n].Value);break}},AddItem:function(n,t,i){for(var e=!1,f=-1,u,r=0;r<this._dataSource.length;r++)if(this._dataSource[r].Value==n){e=!0,f=r;break}e?(u=new ListItem(t,n,!1),this._dataSource[f]=u,this._dataSource[f].Selected=i):(u=new ListItem(t,n,!1),this._dataSource[this._dataSource.length]=u,this._dataSource[this._dataSource.length-1].Selected=i),this._isCustItems=!0},CloneItems:function(n){for(var t=0;t<n.length;t++)this._allItem[t]=n[t];return this._allItem},Sort:function(){for(var r=[],u=0,i,n,t=0;t<this._allItem.length;t++){for(i=null,n=0;n<this._dataSource.length;n++)if(this._allItem[t].Value==this._dataSource[n].Value){i=this._dataSource[n];break}i&&(r[u]=i,u++)}this._dataSource=r},DisplayAllItems:function(){this._dataSource=this._allItem},AddRemoveItem:function(n,t){var u,e,c,s,h,i,o,f,r;if(this._allItem.length==0)for(i=0;i<this._dataSource.length;i++)this._allItem[i]=this._dataSource[i];if(u=t.indexOf(this._splitter1)>-1?t.split(this._splitter1):t.split(","),n){for(s=0,h=[],i=0,o=this._dataSource.length;i<o;i++){for(f=!0,r=0;r<u.length;r++)if(this._dataSource[i].Value==u[r]){f=!1;break}f&&(h[s]=this._dataSource[i],s++)}this._dataSource=h}else{for(i=0,o=this._allItem.length;i<o;i++){for(f=!1,r=0;r<u.length;r++)if(this._allItem[i].Value==u[r]){f=!0;break}if(f&&(this._dataSource[this._dataSource.length]=this._allItem[i],this._allItem[i].Selected))for(e=0,c=this._dataSource.length-1;e<c;e++)if(this._dataSource[e].Selected==!0){this._dataSource[this._dataSource.length-1].Selected=!1;break}}this.Sort()}this._textbox.value=this.get_Text(),this._textbox.cusAttr("Evalue",this.get_SelectedValue()),this._isCustItems=!0},ResetItem:function(n,t){var u,e,c,s,h,i,o,f,r;if(this._allItem.length==0)for(i=0;i<this._dataSource.length;i++)this._allItem[i]=this._dataSource[i];if(u=t.indexOf(this._splitter1)>-1?t.split(this._splitter1):t.split(","),n){for(s=0,h=[],i=0,o=this._dataSource.length;i<o;i++){for(f=!0,r=0;r<u.length;r++)if(this._dataSource[i].Value==u[r]){f=!1;break}f&&(h[s]=this._dataSource[i],s++)}this._dataSource=h}else{for(this.ClearItems(),i=0,o=this._allItem.length;i<o;i++){for(f=!1,r=0;r<u.length;r++)if(this._allItem[i].Value==u[r]){f=!0;break}if(f&&(this._dataSource[this._dataSource.length]=this._allItem[i],this._allItem[i].Selected))for(e=0,c=this._dataSource.length-1;e<c;e++)if(this._dataSource[e].Selected==!0){this._dataSource[this._dataSource.length-1].Selected=!1;break}}this.Sort()}this._textbox.value=this.get_Text(),this._textbox.cusAttr("Evalue",this.get_SelectedValue())},ResetItemByInterval:function(n,t){var r,i,f,u;for(this.Sort(),n==null&&(n=""),t==null&&(t=""),r=[],i=0,f=this._dataSource.length;i<f;i++)u=this._dataSource[i].Value*1,(n==""||u>=n*1)&&(t==""||u<=t*1)&&r.push(this._dataSource[i]);this._dataSource=r},get_SelectControl:function(){return this._popup.children[0]},get_IsReloadItems:function(){return this._IsReloadItems},set_IsReloadItems:function(n){this._IsReloadItems=n,this._IsReloadItems&&(this.clear_Popup(),this._IsReloadItems=!1)},set_Enabled:function(n){if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")){n=ToBoolean(n),this._element.cusAttr("disabled",!n);for(var t=0,i=this.get_element().children.length;t<i;t++)$(this._element.childNodes[t]).attr("disabled",!n),this._element.children[t].type=="text"&&(n?(this._element.children[t].className=this.tbClassName,this._element.className=UIControlClass.UFTextBox.CssClass):(this._element.children[t].className=this.tbClassName_D,this._element.className=UIControlClass.UFTextBox.ReadOnlyCssClass)),this._element.children[t].type=="button"&&(this._element.children[t].className=n?this.btnClassName:this.btnClassName_Dis);this.DisplayRequiredFlag(n&&!this._HideRequiredFlag)}},get_ReadOnly:function(){return this._readOnly},set_ReadOnly:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&this.get_Enabled()&&(n=ToBoolean(n),this._element.cusAttr("ReadOnly",n),$(this._textbox).attr("ReadOnly",n),this.get_id().indexOf("Login")>-1?$(this._button).attr("disabled",!1):$(this._button).attr("disabled",n),this._readOnly=n,n?(this._button.className=this.btnClassName_Dis,this._element.className=UIControlClass.getReadOnlyCss(this._element)):(this._textbox.className=this.tbClassName,this._button.className=this.btnClassName,this._element.className=UIControlClass.getNotReadOnlyCss(this._element)),this.set_HDValue("ReadOnly",n.toString().toLowerCase()),this.AfterSetReadOnly4Personal())},set_Width:function(n){this._element.style.width=n+"px",this._textbox.style.width=n-18+"px"},SetFocus:function(){Basic.SetFocus(this._textbox)},getTextByValue:function(n){for(var t=0,r=this._dataSource.length;t<r;t++)if(this._dataSource[t].Value==n)return this._dataSource[t].Text;if(typeof n!="undefined"&&n!=null&&n!=""&&n!="-1"&&this.getIsShowWithRefForm()&&!this._hasAllItems){var u=this.getRefInfo(),f=this._element.cusAttr("EntityFullName"),i=this.GetUrl(u.RefType,"ModalRef",!1,!0)+"&CommandType=getitems";if(i+="&UBF_CustomFilter="+encodeURI("EValue="+n),i=AppendPopupUrl(i),this._xmlhttpRequest||this.GetXmlHttpRequest(),this._xmlhttpRequest)for(this.isGettingAllItems=!1,this.ProcessRequest(i,new Function("$find('"+this.get_id()+"').CallbackComplete4GetItems();")),t=0,r=this._dataSource.length;t<r;t++)if(this._dataSource[t].Value==n)return this._dataSource[t].Text}return""},getSelectedValueByValue:function(n){for(var t=0,i=this._dataSource.length;t<i;t++)if(this._dataSource[t].Value==n)return this._dataSource[t].Value;return""},get_Items:function(){if(this.getIsShowWithRefForm()&&!this._hasAllItems){var t=this.getRefInfo(),i=this._element.cusAttr("EntityFullName"),n=this.GetUrl(t.RefType,"ModalRef",!1,!0)+"&CommandType=getitems";n=AppendPopupUrl(n),this._xmlhttpRequest||this.GetXmlHttpRequest(),this._xmlhttpRequest&&(this.isGettingAllItems=!0,this.ProcessRequest(n,new Function("$find('"+this.get_id()+"').CallbackComplete4GetItems();")))}return this._dataSource},LoadItems:function(n){var t=PopupFormHelper.TranslateInfor(n),i,f,u,r;if(t==null&&(t=new ReferenceData),i=this.getRefInfo(),f=this.get_Value(),this.ClearItems(),this._codeHash={},t.Rows&&t.Rows.length>0)for(u=0;u<t.Rows.length;u++)r=t.Rows[u],this.AddItem(r[i.KeyField],r[i.TextField],!1),this._codeHash[r[i.KeyField]]=r[i.ValueField],this._hasCode=!0;this.set_SelectedValue(f)},set_Items:function(n){var t,i;if(n){var r=n.split(this._splitter1),u=new Array(r.length-1),f=!0;for(t=0;t<r.length-1;t++)i=r[t].split(this._splitter2),u[t]=new ListItem(i[0],i[1],i[2]=="true"?!0:!1),this._allItem[t]=u[t],this._itemValueIsntNumber==!1&&isNaN(i[1])&&(this._itemValueIsntNumber=!0),this._itemValueIsntNumber==!1&&f==!0&&i[0]!=i[1]&&(f=!1);f==!0&&r.length>0&&(this._itemValueIsntNumber=!0),this._dataSource=u,this.clear_Popup()}},get_Value:function(){return this.get_SelectedValue()},set_Value:function(n){var i=this.get_SelectedValue(),t;if(this.getIsShowWithRefForm()&&(t=this.FindByValue(n),!t&&n!=null&&n!=""&&n*1>=0)){this.CallXmlHttp(n.toString(),!0);return}this.set_SelectedValue(n),n=this.get_SelectedValue(),n!=null&&i!=n.toString()&&(this.raiseOnValueChanged(Sys.EventArgs.Empty),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0),this.raiseOnValueChanged4P(Sys.EventArgs.Empty))},get_Text:function(){var n=this.get_SelectedIndex();return n>=0?this._dataSource[n].Text:""},set_Text:function(n){if(this._isFiltering=!1,this._dataSource.length!=0){if(this.ClearSelection(),n==null||n.Length==0)return;var t=this.FindByText(n);t!=null&&(t.Selected=!0)}this._hidden.value=this.get_Value(),this.ResetHiddenValue(),this._textbox.value=this.get_Text(),this._textbox.cusAttr("Evalue",this.get_SelectedValue())},get_SelectedIndex:function(){if(this._dataSource&&this._dataSource.length)for(var n=0,t=this._dataSource.length;n<t;n++)if(this._dataSource[n].Selected)return n;return-1},set_SelectedIndex:function(n){this.ClearSelection(),n>=0&&n<this._dataSource.length&&(this._dataSource[n].Selected=!0),this._textbox.value=this.get_Text(),this._textbox.cusAttr("Evalue",this.get_SelectedValue())},get_SelectedValue:function(){var n=this.get_SelectedIndex();return n>=0?this._dataSource[n].Value:""},set_SelectedValue:function(n){var t;if(this._isFiltering=!1,this.setFilterText(""),t=this.FindByValue(n),this.getIsShowWithRefForm()&&!t&&n!=null&&n!=""&&n*1>=0){this._disableEvent=!0,this.CallXmlHttp(n,!0);return}if(this._dataSource.length!=0){if(this.ClearSelection(),n==null||n.Length==0)return;t=this.FindByValue(n),t!=null&&(t.Selected=!0)}this._hidden.value=n,this.ResetHiddenValue(),this._textbox.value=this.get_Text(),this._textbox.cusAttr("Evalue",this.get_SelectedValue()),this._allItem.length==0&&(this._allItem=this.CloneItems(this._dataSource)),this._code=this.get_Code()},get_SelectedText:function(){var n=this.get_SelectedIndex();return n>=0?this._dataSource[n].Text:""},set_SelectedText:function(n){this.set_Text(n)},get_SelectedItem:function(){var n=this.get_SelectedIndex();return n>=0?this._dataSource[n]:null},get_Code:function(){var t,n;return this._hasCode&&(t=this.get_SelectedValue(),t!="")?(n=this._codeHash[t],(typeof n=="undefined"||n==null)&&(n=""),n):""},ClearItems:function(){for(var i=this._dataSource.length,n=0,t=i;n<t;n++)this._dataSource.pop();this.set_Value(""),this.set_Text(""),this._isCustItems=!0},get_popup:function(){var t,u;if(this._popup==null){var i=this,n=[],r=this._dataSource.length;for(this._Popup_Rows=r,this._Popup_Rows=this.calcPopupRows(r),n.push("<select size='"),n.push(this._Popup_Rows),n.push("' id='select1' class='popupSelect' style='width:100%;height:100%;'>"),t=0;t<r;t++)u=this.formatItemText(this._dataSource[t]),n.push("<option class='popupSelectOption' value='"),n.push(this._dataSource[t].Value),n.push("'"),this._dataSource[t].Selected&&n.push(" selected='selected'"),n.push("title='"+u.trimStart()+"'"),n.push(">"),n.push(u.replace(/\s/g,"&nbsp;")),n.push("<\/option>");n.push("<\/select>"),this._popup=document.createElement("div"),this._popup.setAttribute("tabIndex","-1"),this._popup.id=this.get_id()+"_Popup",window.document.body.appendChild(this._popup),this._popup.innerHTML=n.join(""),this._select1=this._popup.children[0],this._popupfocusoutHandler=Function.createDelegate(this,this.PopupFocusOut),this._popupkeydownHandler=Function.createDelegate(this,this.doKeypress),this._selectchangeHandler=Function.createDelegate(this,this.popup_onchange),this._selectclickHandler=Function.createDelegate(this,this.CloseMenu),this._girdScrollHandler=Function.createDelegate(this,this.CloseMenuForScroll),this._resizeHandler=Function.createDelegate(this,this.CloseMenuForScroll),$addHandler(this._popup,"focusout",this._popupfocusoutHandler);$(this._popup).on("mouseover",function(){i.__isShow=1}).on("mouseout",function(){i.__isShow=0});$addHandler(this._popup,"keydown",this._popupkeydownHandler),$addHandler(this._select1,"change",this._selectchangeHandler),$addHandler(this._select1,"click",this._selectclickHandler);$(".dataGridMainBody").on("scroll",this._girdScrollHandler);$(window).resize(function(){i._resizeHandler()})}return this._popup},CloseMenuForScroll:function(){this._popup!=null&&this._popup.style.display!="none"&&this.hide_Popup()},calcPopupRows:function(n){var t,i,u;n==undefined&&(n=this._dataSource.length),t=n,n<2&&(t=2),n>20&&(t=20),i=60,i+=15*(t-2)+2;var r=this.getBoundingClientRect(),f=this.get_element(),e=document.body.clientHeight,o=e-(r.top+f.clientHeight+i);return o<=0&&(u=r.top-i+document.body.scrollTop-document.body.clientTop,u<10&&(t=o>u-10?Math.round((e-r.top-f.clientHeight-30)/15)-1:Math.round((r.top+document.body.scrollTop-document.body.clientTop-40)/15)-1)),t},formatItemText:function(n,t){var r,i,u,f;if(this._dataSource.length!=0)return t||(r=this._codeHash[this._dataSource[this._dataSource.length-1].Value],typeof r!="undefined"&&(t=r.length)),this._itemValueIsntNumber==!1&&t>0&&this._hasCode?(i=this._codeHash[n.Value],(typeof i=="undefined"||i==null)&&(i=""),u=t-i.length,f=0,i+"    "+n.Text):n.Text},removePopupSelectElement:function(){this._select1&&($removeHandler(this._select1,"change",this._selectchangeHandler),$removeHandler(this._select1,"click",this._selectclickHandler),this.get_popup().removeChild(this._select1),this._select1=null)},resetPopupListItems:function(){var i,u,t,n,r;if(this._select1){for(i=this._select1.nextSibling,this.removePopupSelectElement(),this._select1=document.createElement("select"),this._select1.setAttribute("id","select1"),this._select1.setAttribute("className","popupSelect"),this._select1.style.cssText="width:100%;height:100%;",u=this._dataSource.length,t=0;t<u;t++)n=document.createElement("option"),n.className="popupSelectOption",n.value=this._dataSource[t].Value,this._dataSource[t].Selected&&(n.selected="selected"),r=this.formatItemText(this._dataSource[t]),n.title=r.trimStart(),n.innerText=r,this._select1.appendChild(n);this._select1.setAttribute("size",this._Popup_Rows),i?this.get_popup().insertBefore(this._select1,i):this.get_popup().appendChild(this._select1),$addHandler(this._select1,"change",this._selectchangeHandler),$addHandler(this._select1,"click",this._selectclickHandler)}},clear_Popup:function(){this._popup&&(this._popupfocusoutHandler&&(this._popup&&$removeHandler(this._popup,"focusout",this._popupfocusoutHandler),this._popupfocusoutHandler=null),this._popupkeydownHandler&&(this._popup&&$removeHandler(this._popup,"keydown",this._popupkeydownHandler),this._popupkeydownHandler=null),this._selectchangeHandler&&(this._select1&&$removeHandler(this._select1,"change",this._selectchangeHandler),this._selectchangeHandler=null),this._selectclickHandler&&(this._select1&&$removeHandler(this._select1,"click",this._selectclickHandler),this._selectclickHandler=null),window.document.body.removeChild(this._popup),this._popup=null),this._IsShow=!1},show_Popup:function(){var f,u,t,n,s,e,h;this._IsShow||(f=this.getFilterText(),this.setFilterText(""),f==null||f==""||f==this._textbox.value.toLowerCase()||(this.resetPopupListItems(),this._Popup_Rows=this.calcPopupRows(this._dataSource.length))),this._popup==null&&(this._Popup_Rows=this.calcPopupRows(this._dataSource.length));var i=this.getBoundingClientRect(),c=document.body.clientWidth,l=document.body.clientHeight,r=i.right-i.left,o=this._hasCode?DropDownListTemplate.PopupMinWidth2:DropDownListTemplate.PopupMinWidth;r<o&&(r=o),u=40,u+=12*(this._Popup_Rows-2)+2,this._select1&&(this._select1.value=this.get_SelectedValue()),t=document.body,n=this.get_popup().style,n.backgroundColor="#e6e6e6",n.position="absolute",n.zIndex=9999,n.border="1px solid #909090",s=l-(i.top+this.get_element().clientHeight+u),s>0?n.top=i.bottom+t.scrollTop-t.clientTop+"px":(e=i.top-u+t.scrollTop-t.clientTop,e<10&&(e=10),n.top=e+"px"),h=c-(i.left+this.get_element().clientWidth+r),n.left=h>0?i.left+t.scrollLeft-t.clientLeft+"px":i.left+t.scrollLeft-t.clientLeft-r+this.get_element().clientWidth+2+"px",n.width=r+"px",n.height=u+"px",n.display="",this._IsShow=!0},PopupFocusOut:function(){var n=null;n=this._element.ownerDocument?this._element.ownerDocument.activeElement:this._element.document.activeElement,this._popup.contains(n)||this.get_element().contains(n)||(this.hide_Popup(),this.popup_onchange())},hide_Popup:function(){this.get_popup().style.display="none",this._IsShow=!1},CloseMenu:function(){if(this.popup_onchange(),this.BtnMouseOut(),this.hide_Popup(),!this._textbox.cusAttr("isDisabled"))try{this._textbox.focus(),this._textbox.select()}catch(n){}window.$Event(event).stopPropagation()},getFilterText:function(){var n=this._element.cusAttr("FilterText");return(typeof n=="undefined"||n==null)&&(n=""),n.toLowerCase()},setFilterText:function(n){this._element.cusAttr("FilterText",n)},clearPopupSelectOptions:function(){if(this._select1){for(var n=this._select1.offsetWidth,t=this._select1.offsetHeight;this._select1.lastChild;)this._select1.removeChild(this._select1.lastChild);this._select1.style.width=n+"px",this._select1.style.height=t+"px",this._select1.style.width="100%",this._select1.style.height="100%"}},doFilter:function(){this.filterKeyDownTimeOut&&window.clearTimeout(this.filterKeyDownTimeOut),this.popupStartFilter(encodeURI(this._textbox.value))},popupStartFilter:function(n){var p,k,h,r,e,o,y,c,s,l,t,i;if(this._IsShow||(this.show_Popup(),this._textbox.setActive&&this._textbox.setActive()),this._isFiltering=!0,n=decodeURI(n),p=this.getFilterText(),n!=p){var w=this._Popup_Rows,a=!1,b=0;if(n==null||n=="")this.clear_Popup(),this.get_popup(),this.show_Popup(),w=this._Popup_Rows,b=this._dataSource.length;else{var u=[],f=[],d=this._dataSource.length,v=0;for(n=n.toLowerCase(),t=0;t<d;t++)k=this._dataSource[t].Value,h=this._codeHash[k],(typeof h=="undefined"||h==null)&&(h=""),r=h,r=r.toLowerCase(),e=r.indexOf(n),o=!1,e==0?(u.push(this._dataSource[t]),o=!0):e>0?(f.push(this._dataSource[t]),o=!0):(r=this._dataSource[t].Text,r=r.toLowerCase(),e=r.indexOf(n),e==0?(u.push(this._dataSource[t]),o=!0):e>0&&(f.push(this._dataSource[t]),o=!0)),o==!0&&(v=this._dataSource[t].Value.toString().length);for(y=this._select1.nextSibling,this.removePopupSelectElement(),this._select1=document.createElement("select"),this._select1.setAttribute("id","select1"),this._select1.setAttribute("className","popupSelect"),this._select1.style.cssText="width:100%;height:100%;",c=u.length,t=0;t<c;t++)i=document.createElement("option"),i.className="popupSelectOption",i.value=u[t].Value,u[t].Selected&&(i.selected="selected",a=!0),s=this.formatItemText(u[t],v),i.title=s.trimStart(),i.innerText=s,this._select1.appendChild(i);for(l=f.length,t=0;t<l;t++)i=document.createElement("option"),i.className="popupSelectOption",i.value=f[t].Value,f[t].Selected&&(i.selected="selected",a=!0),s=this.formatItemText(f[t],v),i.title=s.trimStart(),i.innerText=s,this._select1.appendChild(i);this._Popup_Rows=this.calcPopupRows(c+l),this._select1.setAttribute("size",this._Popup_Rows),y?this.get_popup().insertBefore(this._select1,y):this.get_popup().appendChild(this._select1),$addHandler(this._select1,"change",this._selectchangeHandler),$addHandler(this._select1,"click",this._selectclickHandler),b=c+l}w!=this._Popup_Rows&&this.show_Popup(),a==!1&&(this._select1.selectedIndex=this._select1.childNodes.length>0?0:-1)}this.setFilterText(n),this._textbox.setActive&&this._textbox.setActive()},isCustomerEnumType:function(){return this._isCustomerEnumType},getIsShowWithRefForm:function(){return this._isShowWithRefForm},StringToList:function(n,t){var i=[];return n==null||n==""?i:i=n.split(t)},getRefInfo:function(){var n={RefType:"983c20c1-a1f4-44ee-8ee2-52ecffa10707",RefTitle:"",RefWidth:"580",RefHeight:"408"};return n.KeyField="EValue",n.ValueField="Code",n.TextField="Name",n},GetUrl:function(n,t,i,r){var e=this._element.cusAttr("CustomURI"),f,u;return e?e:(f=this.GetQueryString(n,t,i,r),u="simple.aspx",u+=u.indexOf("?")==-1?"?"+f:u[u.length-1]=="?"||u[u.length-1]=="&"?f:"&"+f)},GetQueryString:function(n,t,i,r){var o="lnk="+n+"&CtrlId="+this._element.cusAttr("CtrlId")+"&chromeType=4&ShowType="+t,y="&",s,u,f,e,h,v;if(i!=!0&&(s=this._element.cusAttr("EntityFullName"),s!=null&&s!=""&&(o+="&ExtEnumTypeCode="+encodeURI(s)),!r)){if(u="",this._element.cusAttr("SINs")&&(f=this._element.cusAttr("SINs"),f.indexOf(this._splitter1)>-1&&(h=new RegExp(this._splitter1,"g"),f=f.replace(h,",")),f.length>0&&(f.indexOf(",")>0?(u&&(u+=" and "),u+="EValue in ("+f+")"):(u&&(u+=" and "),u+="EValue="+f))),this._element.cusAttr("HINs")&&(e=this._element.cusAttr("HINs"),e.indexOf(this._splitter1)>-1&&(h=new RegExp(this._splitter1,"g"),e=e.replace(h,",")),e.length>0&&(e.indexOf(",")>0?(u&&(u+=" and "),u+="EValue not in ("+e+")"):(u&&(u+=" and "),u+="EValue!="+e))),this._element.cusAttr("StartI")&&this._element.cusAttr("EndI")){var a=this.get_element(),c=a.cusAttr("StartI"),l=a.cusAttr("EndI");c!=null&&c!=""&&(u&&(u+=" and "),u+="EValue>="+c),l!=null&&l!=""&&(u.length>0&&(u+=" and "),u+="EValue<="+l)}u.length>0&&(o+="&UBF_CustomFilter="+encodeURI(u)),v=this.get_element().cusAttr("IsMulTiRefTag"),v&&(o+="&IsMultiRefTag=true")}return o.replace(/#/g,"%23")},ShowRefForm:function(n){var i,r,u,e,o,f,s,t;if(this._CancelShowForm){this._CancelShowForm=!1;return}this._IsShowForm&&this.getIsShowWithRefForm()&&(_ClientPostBackManager.Runing||(i=this.getRefInfo(),r=this.GetUrl(i.RefType,"ModalRef",!1,!1),n&&n!=""&&(r+="&QueryNameField="+i.TextField+"&QueryField="+i.ValueField+"&"+i.ValueField+"="+encodeURIComponent(n)),n&&n!=""||(n=this._textbox.value),n&&n!=""&&(r+="&ValueByClick="+encodeURIComponent(n)),u=i.RefTitle,u||(u=""),e=i.RefWidth,o=i.RefHeight,r.length>2e3&&(f="simple.aspx?lnk="+i.RefType+"&CtrlId="+this._element.cusAttr("CtrlId")+"&chromeType=4&ShowType=ModalRef",s=r.substring(f.length,r.length),r=f+"&OverLength=1",window.Ref_Params=s),this._IsDialogOpenning!=!0)&&(this._IsDialogOpenning=!0,t=this,ShowModalDialogForAll(r,u,o,e,!1,!1,function(n){var i,r,u;t._IsDialogOpenning=!1,n!=null&&typeof n!="boolean"?(t._xmlReturnHidden&&(t._xmlReturnHidden.value=n),i=t._element.cusAttr("GridCltID4P"),r=t._element.cusAttr("ColFldID4P"),i!=null&&r!=null&&$find(i)!=null&&(u=t.get_IsPersonalProcess(),t.set_OldIsPersonalProcess(u),t.set_IsPersonalProcess(!0)),t.get_element().name&&$E(t.get_element()).document.children[t.get_element().name]&&($E(t.get_element()).document.children[t.get_element().name].value=n),t.OnContentChanged(n)):t.set_SelectedValue(t.get_SelectedValue());try{t._textbox.focus()}catch(f){}})))},OnContentChanged:function(n){var t=PopupFormHelper.TranslateInfor(n);t==null&&(t=new ReferenceData),this.DoContentChanged(t)},DoContentChanged:function(n){var r=this.getRefInfo(),h=this.get_Value(),t=n.GetValue(r.KeyField),o,u,f,s,e,i;if(t!=h){for(o=this._dataSource.length,u=!1,f=0;f<o;f++)if(this._dataSource[f].Value==t){u=!0;break}s=this._isCustItems,e=!1,t!=""||u?(u||(this.AddItem(t,n.GetValue(r.TextField),!1),i=this._itemsHidden.value,i||(i=""),i.length>0&&(i+=this._splitter1),i+=n.GetValue(r.TextField),i+=this._splitter2,i+=t,this._itemsHidden.value=i,this._codeHash[t]=n.GetValue(r.ValueField)),this._codeHash[t]=n.GetValue(r.ValueField),this._hasCode=!0,this.set_SelectedValue(t),e=!0):this._HideRequiredFlag?(this.set_SelectedText(""),e=!0):this.set_SelectedValue(this.get_SelectedValue()),this._isCustItems=s,e&&!this._disableEvent&&(this._datas=n,this._code=n.GetValue(r.ValueField),this.raiseonchange(this.createChnageEventArgs(this._datas)),this.raiseOnValueChanged(Sys.EventArgs.Empty),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&(this.set_IsChanged(!0),this.set_IsValueChanged(!0)),this.raiseOnValueChanged4P(Sys.EventArgs.Empty))}else t!=""&&(this._codeHash[t]=n.GetValue(r.ValueField),this.set_SelectedValue(this.get_SelectedValue()))},createChnageEventArgs:function(n){if(n==undefined)return Sys.EventArgs.Empty;var t=new UF.UI.ChangeEventArgs;return t.result=n,t},AddDynamicItem:function(n,t){if(this.isCustomerEnumType()){this.AddItem(n,t,!1);var i=this._itemsHidden.value;i||(i=""),i.length>0&&(i+=this._splitter1),i+=t,i+=this._splitter2,i+=n,this._itemsHidden.value=i}},onInputReturn:function(){if(this._CancelShowForm=!1,this._textbox.value==""){this.OnContentChanged(null);return}var n=this._textbox.value;this.CallXmlHttp(n)},GetXmlHttpRequest:function(){this._xmlhttpRequest||(this._xmlhttpRequest=RequestHelper.getXHR())},getXHR:function(){return RequestHelper.getXHR()},CallXmlHttp:function(n,t){var i=this.getRefInfo(),u=t?i.KeyField:i.ValueField,r;this._inputValue=G_Trim(n),r=this.GetUrl(i.RefType,"ModalRef",!1,!1)+"&CommandType=callback&QueryField="+u+"&QueryNameField="+i.TextField+"&"+u+"="+encodeURIComponent(n),r=AppendPopupUrl(r),this._xmlhttpRequest||this.GetXmlHttpRequest(),this._xmlhttpRequest&&this.ProcessRequest(r,this.CallbackComplete)},ProcessRequest:function(n,t){if(n.length>2e3){alert(Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_ReferenceUrlOverLength);try{this._textbox.focus(),this._textbox.select()}catch(u){}return;var i,r}else this._xmlhttpRequest.open("GET",n,!1),this._xmlhttpRequest.onreadystatechange=t,this._xmlhttpRequest.send("")},GetPostUrl:function(n,t){for(var o=this.GetUrlAttributeList(n),i=this.GetUrlAttributeList(t),u,f,r,e=0;e<o.length;e++)for(u=0;u<i.length;u++)if(o[e].key==i[u].key){i[u].del=!0;break}for(f="",r=0;r<i.length;r++)i[r].del||(f!=""&&(f+="&"),f+=i[r].key+"="+i[r].value);return f},GetUrlAttributeList:function(n){var i=[],u=n.split("?"),r,t;if(u.length==2&&(r=u[1]),!r)return i;for(pl=r.split("&"),t=0;t<pl.length;t++)i[t]={},i[t].key=pl[t].split("=")[0],i[t].value=pl[t].substring(pl[t].split("=")[0].length+1);return i},clickInRect:function(){var n=this.get_popup().offsetTop+2,t=this.get_popup().offsetTop+this.get_popup().offsetHeight-2,i=this.get_popup().offsetLeft+5,r=this.get_popup().offsetLeft+this.get_popup().offsetWidth-5;return event.clientX>i&&event.clientX<r&&event.clientY>n&&event.clientY<t?!0:!1},doKeypress:function(){var t,n;switch(event.keyCode){case 13:t=!0,this._IsShow&&(t=!1,this._select1.selectedIndex>=0?(t=!0,this.popup_onchange(),this.hide_Popup()):this._select1.childNodes.length>0&&(this._select1.selectedIndex=0)),t&&(this._textbox.focus(),this._textbox.select()),window.$Event(event).stopPropagation(),$Event(event).preventDefault();break;case 40:if(event.altKey)return;this.get_SelectControl().selectedIndex<this.get_SelectControl().options.length-1&&(n=this.get_SelectControl(),n.selectedIndex++,this._textbox.value=this.getTextByValue(n.value),this._textbox.cusAttr("Evalue",this.getSelectedValueByValue(n.value)),this.setTextboxSelectedText(),this._popup.setActive()),window.$Event(event).stopPropagation(),$Event(event).preventDefault();break;case 38:if(event.altKey)return;this.get_SelectControl().selectedIndex>0&&(n=this.get_SelectControl(),n.selectedIndex--,this._textbox.value=this.getTextByValue(n.value),this._textbox.cusAttr("Evalue",this.getSelectedValueByValue(n.value)),this.setTextboxSelectedText(),this._popup.setActive()),window.$Event(event).stopPropagation(),$Event(event).preventDefault();break;default:event.shiftKey||(this._textbox.focus(),event.keyCode==KeyCode.tab&&($Event(event).preventDefault(),$Event(event).preventDefault()))}},setTextboxSelectedText:function(){var n=this.getFilterText(),t=this._textbox.value;t!=null&&t.length>0&&(n!=null&&n.length>0?t.indexOf(n)==0?this._textbox.select(n.length,t.length-n.length):this._textbox.select():this._textbox.select())},getIndexByValue:function(n){for(var t=0,i=this._dataSource.length;t<i;t++)if(this._dataSource[t].Value==n)return t;return-1},FindByValue:function(n){for(var t=0,i=this._dataSource.length;t<i;t++)if(this._dataSource[t].Value==n)return this._dataSource[t];return null},FindByText:function(n){for(var i=-1,t=0,r=this._dataSource.length;t<r;t++)if(this._dataSource[t].Text==n&&(i==-1&&(i=t),this._textbox.cusAttr("Evalue",this._dataSource[t].Value)))return this._dataSource[t];return i!=-1?this._dataSource[i]:null},ClearSelection:function(){for(var n=0,t=this._dataSource.length;n<t;n++)this._dataSource[n].Selected=!1},button_click:function(){this._CancelShowForm=!1;var n=this.getIsShowWithRefForm();if(n)this.ShowRefForm();else{if(this._isFiltering&&this._IsShow)return;this.get_popup()&&(this._IsShow?this.CloseMenu():(this.show_Popup(),this._select1.focus()))}},textboxKeydown:function(){var n,i,t;if(!this.getIsShowWithRefForm()&&(n=this.get_ReadOnly()==!1&&this.get_Enabled()==!0,window.event.keyCode!=9&&window.event.keyCode!=KeyCode.left&&window.event.keyCode!=KeyCode.right))if(window.event.keyCode==KeyCode.enter){if(n){if(i=this.getFilterText(),t=this._textbox.value,i==null||i==""){if(t==this.get_Text()||t=="")return;if(this._hasCode&&t==this.get_Code())return}if(i==t.toLowerCase())if(this.filterKeyDownTimeOut&&window.clearTimeout(this.filterKeyDownTimeOut),this._IsShow)this.doKeypress();else return;else this.doFilter();return window.$Event(event).stopPropagation(),$Event(event).preventDefault(),!1}}else if(window.event.keyCode==KeyCode.ESC){if(n)return this.clear_Popup(),this.set_SelectedValue(this.get_SelectedValue()),window.$Event(event).stopPropagation(),$Event(event).preventDefault(),!1}else if(window.event.keyCode==KeyCode.down||window.event.keyCode==KeyCode.up){if(n)return this._isFiltering?(this._IsShow||this.show_Popup(),this._popup.focus(),window.$Event(event).stopPropagation(),$Event(event).preventDefault(),!1):void 0}else window.event.altKey||window.event.keyCode==KeyCode.F2||window.event.keyCode==118||(window.event.ctrlKey||window.event.keyCode==123?event.keyCode==KeyCode.space&&(window.$Event(event).stopPropagation(),$Event(event).preventDefault()):this.get_AutoComplete()==!1&&(window.event.keyCode!=KeyCode.left&&window.event.keyCode!=KeyCode.right&&this.filterKeyDownTimeOut&&window.clearTimeout(this.filterKeyDownTimeOut),n&&(this._isFiltering=!0),window.$Event(event).stopPropagation()))},textboxKeyup:function(){var t,n,i;if(this.get_ReadOnly()==!1&&this.get_Enabled()==!0){if(this.getIsShowWithRefForm())return;if(!this._isFiltering)return;if(window.event.ctrlKey||window.event.keyCode==KeyCode.ESC||window.event.keyCode==KeyCode.up||window.event.keyCode==KeyCode.down)return;window.event.keyCode!=KeyCode.enter&&(t=this.getFilterText(),t==null&&(t=""),n=this._textbox.value,n==null&&(n=""),i=this.get_Text(),t==n.toLowerCase()&&(n!=null&&n!=""||this._HideRequiredFlag)||(this.filterKeyDownTimeOut&&window.clearTimeout(this.filterKeyDownTimeOut),this.filterKeyDownTimeOut=window.setTimeout(new Function("$find('"+this.get_id()+"').popupStartFilter(\""+encodeURI(this._textbox.value)+'");'),200)))}},onkeyDown:function(){var n;if(!this._button.disabled)switch(window.event.keyCode){case KeyCode.F2:this.button_click(),window.$Event(event).stopPropagation();break;case KeyCode.down:this.getIsShowWithRefForm()?(n=this._hasCode?this.get_Code():this.get_Text(),n!=this._textbox.value&&(this.onInputReturn(),window.$Event(event).stopPropagation())):window.event.ctrlKey&&(this.button_click(),window.$Event(event).stopPropagation());break;case KeyCode.tab:case 13:this.getIsShowWithRefForm()?(n=this._textbox.value,n!=this._code&&(this.onInputReturn(),window.$Event(event).stopPropagation(),$Event(event).preventDefault())):this._curactb&&this._curactb.actb_display||this.textboxChange();break;case KeyCode.up:case KeyCode.down:this.getIsShowWithRefForm()&&(n=this._hasCode?this.get_Code():this.get_Text(),n!=this._textbox.value&&(this.onInputReturn(),window.$Event(event).stopPropagation()))}},textboxChange:function(){var t=null,n=this;setTimeout(function(){var i,r;if(t=n._element.ownerDocument?n._element.ownerDocument.activeElement:n._element.document.activeElement,n._element.contains(t)||n._popup&&n._popup.contains(t)){n._textbox.setActive&&n._textbox.setActive();return}if(n._curactb&&n._curactb.actb_display){try{n._textbox.focus()}catch(u){}return}i=n.get_SelectedValue(),n._select1&&n._IsShow?(n._select1.childNodes.length>0||n._HideRequiredFlag?n.set_SelectedValue(n._select1.value):n.set_SelectedValue(i),n.clear_Popup()):(r=n._textbox.value,r!=""||n._HideRequiredFlag?n.set_SelectedText(r):n.set_SelectedValue(n.get_SelectedValue())),i!=n.get_SelectedValue()&&(n.raiseonchange(Sys.EventArgs.Empty),n.raiseOnValueChanged(Sys.EventArgs.Empty),n.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&(n.set_IsChanged(!0),n.set_IsValueChanged(!0)),n.raiseOnValueChanged4P(Sys.EventArgs.Empty))},0)},textboxFocus:function(){var i=this,n,t;if(this.ControlFocus(),this.get_AutoComplete()==!0&&!this._curactb&&this.get_ReadOnly()==!1&&this.get_Enabled()==!0){for(Array.clear(this._autoCompleteArray),n=0,t=this._dataSource.length;n<t;n++)this._autoCompleteArray[n]=this._dataSource[n].Text;this._curactb=new actb(this._textbox.id,this._autoCompleteArray)}this.getIsShowWithRefForm()&&((typeof this._code=="undefined"||this._code==null)&&(this._code=""),this._textbox.value=this._code),this._isFiltering||this._textbox.select()},textboxBlur:function(){var n=null,t;if(n=this._element.ownerDocument?this._element.ownerDocument.activeElement:this._element.document.activeElement,t=!1,(this._element.contains(n)||this._popup&&this._popup.contains(n))&&(t=!0),this.getIsShowWithRefForm()){this._code!=this._textbox.value?t||this.onInputReturn():(this.ControlBlur(),this._textbox.value=this.get_Text(),this._textbox.cusAttr("Evalue",this.get_SelectedValue()));return}if(!t){if(this._curactb&&this._curactb.actb_display){try{this._textbox.focus()}catch(i){}return}this.ControlBlur(),this.textboxChange()}},textboxPaste:function(){if(!this.getIsShowWithRefForm()){var t=this.getFilterText(),n="";window.clipboardData&&(n=window.clipboardData.getData("Text")),t==n.toLowerCase()&&(n!=null&&n!=""||this._HideRequiredFlag)||(this.filterKeyDownTimeOut&&window.clearTimeout(this.filterKeyDownTimeOut),this.filterKeyDownTimeOut=window.setTimeout(new Function("$find('"+this.get_id()+"').popupStartFilter(\""+encodeURI(n)+'");'),200),event.cancelBubble=!1)}},textboxDrag:function(){event.cancelBubble=!1,$Event(event).preventDefault()},popup_onchange:function(){this._isFiltering&&this.clear_Popup();var n=this.get_SelectedValue();this.set_SelectedValue(this._select1.value),this.get_SelectedValue()!=n&&(this.raiseonchange(Sys.EventArgs.Empty),this.raiseOnValueChanged(Sys.EventArgs.Empty),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&(this.set_IsChanged(!0),this.set_IsValueChanged(!0)),this.raiseOnValueChanged4P(Sys.EventArgs.Empty))},getBoundingClientRect:function(){return this.get_element().getBoundingClientRect()},BtnMouseOver:function(){},BtnMouseOut:function(){},get_Splitter4Item:function(){return this._splitter1},get_Splitter4ItemData:function(){return this._splitter2},get_AutoComplete:function(){return this._autoComplete},set_AutoComplete:function(n){this._autoComplete=n!=null&&n.toString().toLowerCase()=="true"?!0:!1},SetControlAttribute:function(n){if(UF.UI.DropDownList.callBaseMethod(this,"SetControlAttribute"),n&&n.length>2){this.set_IsReloadItems(!0);var t=this.get_element();t.Items=n[2],t.HINs=n[3],t.SINs=n[4],t.StartI=n[5],t.EndI=n[6],this.set_Items(t.Items),(t.StartI.length>0||t.EndI.length>0)&&this.ResetItemByInterval(t.StartI,t.EndI),t.HINs&&(this.ResetItem(!0,t.HINs),this._hidden.value=this.get_Value()),t.SINs&&(this.ClearItems(),this.ResetItem(!1,t.SINs),this._hidden.value=this.get_Value()),this.clear_Popup()}}},UF.UI.DropDownList.registerClass("UF.UI.DropDownList",UF.UI.InputControl),DropDownListTemplate.Enabled=InputControlTemplate.Enabled,DropDownListTemplate.ReadOnly=InputControlTemplate.ReadOnly,DropDownListTemplate.TBClassName=InputControlTemplate.TBClassName,DropDownListTemplate.TBClassName_R=InputControlTemplate.TBClassName_R,DropDownListTemplate.TBClassName_D=InputControlTemplate.TBClassName_D,DropDownListTemplate.BtnClassName="btn DDLBtn",DropDownListTemplate.BtnClassName_Dis="btn DDLBtn_Dis",DropDownListTemplate.BtnClassName_Ref="btn RefBtn",DropDownListTemplate.BtnClassName_Ref_Dis="btn RefBtn_Dis",DropDownListTemplate.BtnClassName_MouseOver="btn DDLBtnMO",DropDownListTemplate.BtnClassName_Ref_MouseOver="btn RefBtnMO",DropDownListTemplate.PopupMinWidth=150,DropDownListTemplate.PopupMinWidth2=240,Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Label=function(n){UF.UI.Label.initializeBase(this,[n]);var t=this;this._datas,this._selectIndex=-1,this._assoControl=null,this._readOnly=!1,this._enabledEx=!0,this._showLabelFormAfterCallBack="false",this._isMultiOrg,this._assControlKeyField,this._dataGetter,this._NeedConvIDs,this._entityFullName,this.EntityFullNameFlag="EntityFullName",this.SrcOrgFlag="SrcOrg",this._isCustomerMultiOrg=!1,this._onclickHandler,this._title=""},UF.UI.Label.prototype={initialize:function(){(this.$element=$(this._element),this._title=this.$element.attr("title"),this._element.parentNode&&(this._element.className+=" textEclipsis",this.setMultiLangToolTip()),this._element.cusAttr("PartID")!==null)&&(UF.UI.Label.callBaseMethod(this,"initialize"),this._isMultiOrg=this._element.cusAttr("ISMultiOrg"),this.initControl(),this.RemoveMouseHandler(),this.setMultiLangToolTip())},textEclipsis:function(){var n,t;this.$element.css("display")!="none"&&(n=this.$element.html().length,n>4&&(t=this.$element.parent().width(),this.$element.width()>t&&(this.$element.css("display","block"),this.$element.css("overflow","hidden"))))},setMultiLangToolTip:function(){this._title===""?this.$element.attr("title",this.get_element().innerText):this.$element.attr("title",this._title)},dispose:function(){this.cleanupEvent(),this._datas&&(this._datas.dispose(),this._datas=null),this._assoControl=null,this._enabledEx=null,UF.UI.Label.callBaseMethod(this,"dispose")},cleanupEvent:function(){this._onclickHandler&&($removeHandler(this._element,"click",this._onclickHandler),this._onclickHandler=null)},get_Type:function(){return ControlType.Label},getAllData:function(n,t){var i=[];return i[0]=n,i[1]=t,i[2]=this._datas,i},get_ReadOnly:function(){return this._readOnly},set_ReadOnly:function(n){this.get_Enabled()&&(this._readOnly=n,this.ResetReadOnly())},ResetReadOnly:function(n){this.get_EnabledEx()!=!1&&(this.cleanupEvent(),n!=!0&&(this._readOnly||(this._element.style.color="#000000")),this._onclickHandler=Function.createDelegate(this,this.onMouseUp),$addHandler(this._element,"click",this._onclickHandler))},getData:function(n){return this._datas.GetValue(n)},get_Datas:function(){return this._datas},initControl:function(){this._isMultiOrg=="true"&&(this._assoControl=document.getElementById(this._element.cusAttr("AssControl")),this._entityFullName=this.getAssoControl().cusAttr(this.EntityFullNameFlag),this._dataGetter=new DataGetter,this._MultiOrg=this.getAssoControl().cusAttr(this.SrcOrgFlag),this._NeedConvIDs=this.getAssoControl().cusAttr("NeedConvIDs"),this._assControlKeyField=this.getAssoControl().cusAttr("KeyField"),this._isCustomerMultiOrg=this.getAssoControl().cusAttr("CustomerMulti")),this._readOnly=this._element.cusAttr("R"),this._enabledEx=this._element.cusAttr("EnabledEx"),this._readOnly=this._readOnly=="Y"?!0:!1,this.ResetReadOnly(!0),this._element.cusAttr("ShowLabelFormAfterCallBack")!=null&&(this._showLabelFormAfterCallBack=this._element.cusAttr("ShowLabelFormAfterCallBack").toString().toLowerCase())},set_PartID:function(n){this._element.cusAttr("PartID",n)},onMouseUp:function(){if(_ClientCallBackManager&&_ClientCallBackManager.Runing||$(this._element).attr("disabled")=="disabled")return!1;var n=this._element.getAttribute("onclick"),t=this._element.cusAttr("PartID");!n&&t&&(this.raiseBeforeLoadData(Sys.EventArgs.Empty),this._showLabelFormAfterCallBack!="true"&&this.ShowLabelForm())},DoContentChanged:function(n){_this._datas=n;var t=new UF.UI.ChangeEventArgs;t.result=_this._datas,_this.raiseContentChanged(t)},OnAfterWindowClose:function(n){var t,r,u,i,f;n=HtmlHelper.HtmlDecode(n),this._readOnly||this.isLableDisabled()||(t=null,n&&(t=this.TranslateInfor(n),t==null?t=new ReferenceData:(r="ID",u=t.GetValue(r),u&&(i={},i.key=r,i.value=u,f=[],f.push(i),$Cache$RemoveByQueryPara(f))),_this=this,this.DoContentChanged(t)))},isLableDisabled:function(){var n=this.get_element();if(n==null)return!0;for(n;n.parentElement;n=n.parentElement)if(n.parentElement.disabled)return!0;return!1},ShowLabelForm:function(){var t=this.GetUrl(this._element.cusAttr("PartID"),"TitleLink"),r,i,n,u,e,h;this._isMultiOrg=="true"&&this.getAssoControl().control.get_Key()!=-1&&(this._entityFullName=this.getAssoControl().cusAttr(this.EntityFullNameFlag),t+="&EntityFullName="+this._entityFullName,r=this.getAssoControl().cusAttr("DataOrgControl"),r&&(i=$find(r),i&&i.get_Key()!=-1&&(t+="&DataOrg="+i._DataOrg))),n=this._element.cusAttr("WinTitle"),u=this._element.innerText,(n==null||n=="")&&(n=u),n||(n="");var o=this._element.cusAttr("WinWidth"),s=this._element.cusAttr("WinHeight"),f=!1;this._element.cusAttr("HideStatusBar")&&this._element.cusAttr("HideStatusBar")=="Y"&&(f=!0),this._MultiOrg&&(e=this.getAssoControl().control.get_SrcOrg(),t+="&MultiOrgID="+e),h=ShowModalDialogForAll(t,n,s,o,f,!1,this)},showDialogCallback:function(n){this.OnAfterWindowClose(n)},get_Enabled:function(){return!this._readOnly},set_Enabled:function(n){this._readOnly=!n,this.ResetReadOnly()},get_EnabledEx:function(){return this._enabledEx},set_EnabledEx:function(n){this._enabledEx=n!=null&&n.toString().toLowerCase()=="false"?!1:!0,this.ResetEnabledEx()},ResetEnabledEx:function(){this.cleanupEvent(),this._enabledEx?(this._element.style.color="#000000",this._onclickHandler=Function.createDelegate(this,this.onMouseUp),$addHandler(this._element,"click",this._onclickHandler)):this._element.style.color="#808080"},getAssoControl:function(){return this._assoControl||this.SearchAssoFieldControls(),this._assoControl},SearchAssoFieldControls:function(){for(var r=window.document.getElementsByTagName("span"),n,i,t=0,u=r.length;t<u;t++)if((n=r[t],n.control&&UF.UI.Control.isInstanceOfType(n.control)&&n.control.get_Type()&&(n.control.get_Type()==ControlType.DropDownList||n.control.get_Type()==ControlType.Reference))&&n.control.get_Visible()&&(i=n.cusAttr("L"),i&&this.get_id().indexOf(i)>=0)){this._assoControl=n;break}return this._assoControl},setSelectValueToControl:function(n){var t=this.getAssoControl();t&&(t.control.SetFocus(),this._selectIndex>=0&&t.control.set_Value(n.Rows[this._selectIndex].Code))},ReplaceResult:function(n,t,i){if(this.referenceData=n,this._isCustomerMultiOrg=="true"){_this=this,this.DoContentChanged(n);return}var r=this.InitMultiOrgParams(n,t,i,this._entityFullName);this._dataGetter.Do(r,this.GetResult,this)},GetResult:function(n,t){var f,r,i,u;if(_this=t,n!=null&&n.trim()!=""){for(f=Sys.Serialization.JavaScriptSerializer.deserialize(n),r=f.AllDatas,i=0;i<r.length;i++)r[i]&&(u=r[i].split(":"),u.length==2&&_this.referenceData.SetValue(u[0],u[1]));_this.DoContentChanged(_this.referenceData)}},TranslateInfor:function(n){var i=new ReferenceData,s,f,t,e,u,o;if(n==null||n=="")return i;for(s=PopupFormHelper.StringToXMLDom(n),f=s.getElementsByTagName("ReferenceReturn"),t=0;t<f.length;t++){var h=[],c=f[t],r=c.getAttribute("IsSelected");for(r&&r=="Y"&&(this._selectIndex=t),e=c.getElementsByTagName("ReturnField"),u=0;u<e.length;u++)o=e[u],h[o.getAttribute("name")]=o.getAttribute("value");i.Rows[t]=h,r&&r=="Y"&&(i.Rows[t].Selected=!0)}return this.setSelectValueToControl(i),i},set_ReadOnlyEx:function(n){this._readOnly=n},set_EventLabel:function(n){this._element.className=n!=null&&n.toLowerCase()=="true"?"ELbl":"normalLabel"},get_EventLabel:function(){return this._element.className!=null&&this._element.className=="ELbl"?!0:!1},set_Value:function(n){this._element.innerText=n},get_Value:function(){return this._element.innerText},set_Text:function(n){this._element.innerHTML=n},get_Text:function(){return this._element.innerHTML}},UF.UI.Label.registerClass("UF.UI.Label",UF.UI.PopupForm),Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Reference=function(n){UF.UI.Reference.initializeBase(this,[n]);var t=this;this.AlwaysFirechangeEvent=!1,this.AlwaysFirechangeEvent=!1,this.$element,this._oldKey,this._oldValue,this._oldText,this._textbox,this._button,this._hidden,this._hiddenReturn,this._tagHidden,this._datas,this._key4Simulator="",this._key="",this._value="",this._text="",this._eventCounter=0,this._keyChanged=!1,this._IsShowForm=!0,this._IsLoadDefaultParams=!0,this._CustomInParams,this._xmlhttpRequest,this._dataGetter,this._IsPostBack=!1,this._inputValue,this._elementkeydownHandler,this._textboxfocusHandler,this._textboxblurHandler,this._textboxkeypressHandler,this._textboxpasteHandler,this._buttonclickHandler,this._btnmouseoverHandler,this._btnmouseoutHandler,this._isNeedValidate=!0,this._isValidating=!1,this._isPressEnterKey=!1,this._MultiOrg,this._isMultiOrg=!1,this._MultiOrgHiddenID,this._NeedConvIDs,this.SrcOrgFlag="SrcOrg",this._autoCompleteArray=[],this._focusEventSource="",this._autoComplete=!1,this._CancelShowForm=!1,this._entityFullName,this._isForceFireContentChange=!1,this.EntityFullNameFlag="EntityFullName",this._isCustomerMultiOrg=!1,this.postbackBeforeShowRefForm=!1,this.referenceData,this._ChildToParentOrg=null,this._DataOrgControl=null,this._DataOrg=null,this._IsDialogOpenning=!1,this._IsShowFormWhenNoMatchValue=!0,this._autoCompleteOpath="",this.searchAdapter=null,this.searchKey="$$AutoCompleteKey$$",this.CallbackComplete=function(n){var r,u,s,h,f,c;if((n||t._xmlhttpRequest)&&(n||t._xmlhttpRequest.readyState==4)){var e=!1,i="",o="";if(n&&typeof n=="string"?i=n:(i=t._xmlhttpRequest.responseText,i=unescapeHTML(i),t.isAllowCache()&&i!=""&&($Cache(t.url,i),e=!0)),o=i,r=i.indexOf("<ReferenceReturns>"),u=i.indexOf("<\/ReferenceReturns>")+"<\/ReferenceReturns>".length,r!=-1&&u!=-1)i=i.substring(r,u);else return;if(JavaScriptDebugTool.LogReferenceReturnValue&&$alert("Return:"+i),i=="<ReferenceReturns>__MultiRows<\/ReferenceReturns>"||i=="<ReferenceReturns><\/ReferenceReturns>"){if(t._isForceFireContentChange&&t._oldValue!=t._value){s=t.get_IsRaiseEvent(),t.set_IsRaiseEvent(!1),t.set_Key(t._oldKey),t.set_Value(t._oldValue),t.set_Text(t._oldText),t.set_IsRaiseEvent(s),i=="<ReferenceReturns>__MultiRows<\/ReferenceReturns>"&&(t.set_IsShowForm(!0),h=UF.UI.Reference.DisableShowForm,UF.UI.Reference.DisableShowForm=!1,t.ShowRefForm(t._inputValue),UF.UI.Reference.DisableShowForm=h);return}if(!t._isNeedValidate&&t._oldValue!=t._value){t.set_Key(t._oldKey),t.PostBack();return}t.set_IsShowForm(!0),t._IsShowFormWhenNoMatchValue==!0?t.ShowRefForm(t._inputValue):(t._textbox.style.borderBottomStyle="dotted",t._textbox.style.borderBottomColor="red",t._textbox.style.borderBottomWidth=2,t._textbox.focus(),window.event&&($Event(window.event).stopPropagation(),$Event(window.event).preventDefault()));return}if(i=="<ReferenceReturns>true<\/ReferenceReturns>")return;if(i=="<ReferenceReturns>false<\/ReferenceReturns>"){t.get_SetControlValue()&&t.get_SetControlValue().IsSetControlValue==!0&&t.ShowSetControlValueErrorMsg(),t.OnContentChanged(null);return}t.saveReturnXml(o),t.OnContentChanged(i),t._CancelShowForm=!0,e&&!t.isAllowCache()&&(_ClientPostBackManager.Runing||Get_Global_WillDoPostBack()||_ClientCallBackManager.Runing)&&(f=t.get_id(),c="if($find('"+f+"') && !$find('"+f+"').isAllowCache()) { $Cache$Remove(\""+t.url.replace(/\"/g,'\\"')+'"); }',_ClientJSExecQueueManager.Push(c))}}},UF.UI.Reference.prototype={initialize:function(){var t,i,n;for(UF.UI.Reference.callBaseMethod(this,"initialize"),this.$element=$(this._element),t=this._element.cusAttr("ValueField"),i=this._element.cusAttr("TextField"),t==""&&this._element.cusAttr("ValueField","Code"),i==""&&this._element.cusAttr("TextField","Name"),this._textbox=this._element.children[0],n=this._element.children.length-1;n>0;n--)this._element.children[n].id==this.get_element().id+"_button"&&(this._button=this._element.children[n]);for(n=this.get_element().children.length;n>0;n--)if(this._element.children[n-1].id==this.get_id()+"_Hidden"){this._hidden=this._element.children[n-1];break}this._tagHidden=$get(this.get_id()+"_TagHidden"),this._hiddenReturn=$get(this.get_id()+ReferenceTemplate.hiddenReturn),this.btnClassName==null&&(this.btnClassName=ReferenceTemplate.BtnClassName),this.btnClassName_Dis==null&&(this.btnClassName_Dis=ReferenceTemplate.BtnClassName_Dis),this.visibleAuthority=this._element.cusAttr("VisibleAuthority"),this.enableAuthority=this._element.cusAttr("EnableAuthority"),this._isMultiOrg=this._element.cusAttr("ISMultiOrg"),this._autoCompleteOpath=this._element.cusAttr("AutoCompleteOpath"),this.initControl(),this._elementkeydownHandler=Function.createDelegate(this,this.onkeyDown),$addHandler(this.get_element(),"keydown",this._elementkeydownHandler),this._textboxfocusHandler=Function.createDelegate(this,this.onInputFocus),$addHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxblurHandler=Function.createDelegate(this,this.onInputBlur),$addHandler(this._textbox,"blur",this._textboxblurHandler),this.hasSearchDispaly()&&(this.searchBlurHandler=Function.createDelegate(this,this.onSearchBlur),$addHandler(this._textbox,"blur",this.searchBlurHandler),this.searPressHandler=Function.createDelegate(this,this.onSearchPress),$addHandler(this._textbox,"keyup",this.searPressHandler)),this._textboxkeypressHandler=Function.createDelegate(this,this.CheckMarkChar),$addHandler(this._textbox,"keypress",this._textboxkeypressHandler),this._textboxpasteHandler=Function.createDelegate(this,this.CheckMarkChars),$addHandler(this._textbox,"paste",this._textboxpasteHandler),this._buttonclickHandler=Function.createDelegate(this,this.onButtonClicked),$addHandler(this._button,"click",this._buttonclickHandler),isReadOnly=this._element.cusAttr("ReadOnly")?!0:ReferenceTemplate.ReadOnly=="true"?!0:!1,this._readOnly=isReadOnly,isReadOnly&&($(this._textbox).attr("readOnly",isReadOnly),$(this._button).attr("disabled",isReadOnly)),this._element.cusAttr("AlwaysFireChangeEvent")=="true"&&(this.AlwaysFirechangeEvent=!0),this._element.cusAttr("TextBoxReadOnly")!=null&&(this._textbox.onkeydown=this._textboxReadonlyOnKeyDown,this._textbox.onkeypress=this._textboxReadonlyOnKeyPress),this._element.cusAttr("AutoComplete")=="true"&&(this._autoComplete=!0),this.set_IsInitComlete(!0)},initControl:function(){var u,t,i;this._isMultiOrg=="true"&&(this._dataGetter=new DataGetter,this._MultiOrg=this._element.cusAttr(this.SrcOrgFlag),this._NeedConvIDs=this._element.cusAttr("NeedConvIDs"),this._entityFullName=this._element.cusAttr(this.EntityFullNameFlag),this._MultiOrgHiddenID=this._element.cusAttr("SrcOrgHidden"),this._isCustomerMultiOrg=this._element.cusAttr("CustomerMulti")),u=this._element.cusAttr("R")=="y"?!0:!1,this.DisplayRequiredFlag(u),this._element.cusAttr("ReadOnly")&&(isReadOnly=this._element.cusAttr("ReadOnly"),isReadOnly&&(this._textbox.readOnly=isReadOnly,this._button.disabled=isReadOnly),this._readOnly=isReadOnly),this._isNeedValidate=this._element.cusAttr("IsNeedValidate")!=undefined?ToBoolean(this._element.cusAttr("IsNeedValidate")):ToBoolean(ReferenceTemplate.IsNeedValidate),this._element.cusAttr("RefType")==""&&(this._button.disabled=!0),this._element.cusAttr("IsShowFormWhenNoMatchValue")=="false"&&(this._IsShowFormWhenNoMatchValue=!1),this._datas=new ReferenceData;var r=this.get_element(),e=this._hidden.value,n=this.StringToList(e,ReferenceTemplate.SplitString1);if(n.length==3){this._key=n[0],this._value=n[1],this._text=n[2];var f=this.StringToList(n[0],ReferenceTemplate.SplitString2),o=this.StringToList(n[1],ReferenceTemplate.SplitString2),s=this.StringToList(n[2],ReferenceTemplate.SplitString2);for(t=0;t<f.length;t++)i=[],i[r.cusAttr("KeyField")]=f[t],i[r.cusAttr("ValueField")]=o[t],i[r.cusAttr("TextField")]=s[t],this._datas.Rows[t]=i}this._oldKey=this._key,this._element.cusAttr("IsShow")&&ToBoolean(this._element.cusAttr("IsShow"))&&(this.postbackBeforeShowRefForm=!0,Global_JSQueueEvalAfterPageLoadedManager.Add("var ref2 = $find('"+this.get_id()+"');if(ref2){ref2.get_element().cusAttr('IsShow','true');ref2.set_IsShowForm(true);ref2.onButtonClicked();}"))},dispose:function(){this._elementkeydownHandler&&($removeHandler(this._element,"keydown",this._elementkeydownHandler),this._elementkeydownHandler=null),this._textboxfocusHandler&&($removeHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxfocusHandler=null),this._textboxblurHandler&&($removeHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxblurHandler=null),this._textboxkeypressHandler&&($removeHandler(this._textbox,"keypress",this._textboxkeypressHandler),this._textboxkeypressHandler=null),this.searPressHandler&&($removeHandler(this._textbox,"keyup",this.searPressHandler),this.searPressHandler=null),this._textboxpasteHandler&&($removeHandler(this._textbox,"paste",this._textboxpasteHandler),this._textboxpasteHandler=null),this._buttonclickHandler&&($removeHandler(this._button,"click",this._buttonclickHandler),this._buttonclickHandler=null),this._textboxReadonlyOnKeyDown=null,this._textboxReadonlyOnKeyPress=null,this._button=null,this._hidden=null,this._hiddenReturn=null,this._tagHidden=null,this._datas&&(this._datas.dispose(),this._datas=null),this._xmlhttpRequest&&(this._xmlhttpRequest=null),this._curactb&&(this._curactb.dispose(),this._curactb=null),this.curHandler!=null&&(this.curHandler=null),this._autoComplete=null,this._textbox=null,this.visibleAuthority=null,this.enableAuthority=null,UF.UI.Reference.callBaseMethod(this,"dispose")},hasSearchDispaly:function(){return this.get_ReadOnly()===!0?!1:this.IfAllowMultiSelection()===!0?!1:this._element.cusAttr("IsAuto")==="false"?!1:UF.UI.JControl===undefined?!1:!0},updateHistroy:function(n,t,i){try{var r=[n,t,i];this.getSearchAdapter().updateReturnValue(r)}catch(u){}},isSearchDispaly:function(){return this.getSearchAdapter().isVisible()},getSearchAdapter:function(){var n;if(this.searchAdapter===null){var r=new RefInputCallback(this._textbox),t=this.getInputPos(),n=$UF$buildHistorySearchContext(this.get_UserInfo(),this.get_CurOrgID(),this.getUrlPara("lnk"),this._element.id+this.getCtxValue()),i=new UF.UI.JControl.AutoComplete.AutoCompleteAdapter(t,n,r,{refID:this.get_id(),searchAllData:this._element.cusAttr("IsSearchAll")==undefined?!1:!0,allDataCount:this._element.cusAttr("MaxLine")==undefined?10:parseInt(this._element.cusAttr("MaxLine")),allMinLength:this._element.cusAttr("MinLength")==undefined?10:parseInt(this._element.cusAttr("MinLength")),filter:this._element.cusAttr("Filter")==undefined?"":this._element.cusAttr("Filter"),orderby:this._element.cusAttr("OrderBy")==undefined?"":this._element.cusAttr("OrderBy"),searchHistory:!0,KeyField:this._element.cusAttr("KeyField"),ValueField:this._element.cusAttr("ValueField"),TextField:this._element.cusAttr("TextField"),EntityFullName:this._element.cusAttr("EntityFullName"),Lan_History:this._element.cusAttr("HistoryData"),Lan_AllData:this._element.cusAttr("AllData"),IsLeftMatch:this._element.cusAttr("LeftMatch"),ExtSearchFields:this._element.cusAttr("ExtSearchFields")});i.setPos(t),this.searchAdapter=i}else this.isCtxChanged()===!0&&(n=$UF$buildHistorySearchContext(this.get_UserInfo(),this.get_CurOrgID(),this.getUrlPara("lnk"),this.$element.attr("id")+this.getCtxValue()),this.searchAdapter.setSearchContext(n));return this.searchAdapter},get_UserInfo:function(){var n="";try{n=UF.UI.Portal.Context.getCurrent().get_userID()}catch(t){}return n},get_CurOrgID:function(){var n="";try{n=UF.UI.Portal.Context.getCurrent().get_orgID()}catch(t){}return n},getUrlPara:function(n){var t=new RegExp("(^|\\?|&)"+n+"=([^&]*)(\\s|&|$)","i");return t.test(location.href)?unescape(RegExp.$2.replace(/\+/g," ")):""},getInputPos:function(){var n=$(this._textbox).offset();return{x:n.left-1,y:n.top+this._textbox.clientHeight+1,w:this._element.style.width}},onFocusOnSearch:function(){this.getSearchAdapter().setPos(this.getInputPos()),this.getSearchAdapter().active()},isCtxChanged:function(){return(this.curCtx===undefined&&(this.curCtx=""),this.getCtxValue()!==this.curCtx)?(this.curCtx=this.getCtxValue(),!0):!1},getCtxValue:function(){var n="",t,i;if($UF$getRM().get_data(this.searchKey)===undefined)return n;t=$UF$getRM().get_data(this.searchKey);for(i in t)n+=String.format("{0}:{1};",i,t[i]);return n},_textboxReadonlyOnKeyDown:function(){if(window.event.keyCode!=KeyCode.F2&&window.event.keyCode!=KeyCode.backspace&&window.event.keyCode!=KeyCode.del)return!1},_textboxReadonlyOnKeyPress:function(){if(window.event.keyCode!=KeyCode.enter&&window.event.keyCode!=KeyCode.tab)return!1},onInputReturn:function(){var t,i,n,r;if(this._textbox.style.borderBottomWidth=0,this._CancelShowForm=!1,this.IfAllowMultiSelection()){if(t=this.get_Values(),i=this.StringToList(this._textbox.value,ReferenceTemplate.SplitString2),this.CompareList(t,i))return}else if((this._textbox.value==this.get_Value()||this._textbox.value==this.get_Text()&&this.get_Text()!="")&&!this._isForceFireContentChange)return;if(this._textbox.value==""){this.OnContentChanged(null);return}n=this._textbox.value,this._isNeedValidate||this._isForceFireContentChange||(this._oldValue=this._value,this._value=n,this._text=n,this._key=-1,this._hidden.value=this._key+ReferenceTemplate.SplitString1+this._value+ReferenceTemplate.SplitString1+this._text),r=_ClientCallBackManager.Runing,this.raiseBeforeLoadData(Sys.EventArgs.Empty),r||_ClientCallBackManager.Runing!=!0?this.CallXmlHttp(n):_ClientJSExecQueueManager.Unshift("$find('"+this.get_id()+"').CallXmlHttp(\""+n+'");')},onkeyDown:function(){this.get_ReadOnly()||(this.hasSearchDispaly()===!1?this._oldKeyDown():this.hasSearchDispaly()===!0&&this.isSearchDispaly()===!1?this._oldKeyDown():(event.keyCode==13||event.keyCode==38||event.keyCode==40)&&($Event(event).stopPropagation(),$Event(event).preventDefault()))},_oldKeyDown:function(){switch(window.event.keyCode){case KeyCode.F2:this._textbox.value=this.get_Value(),this.onButtonClicked(),this._IsShowForm||this._button.onclick&&this._button.fireEvent("onclick"),$Event(event).stopPropagation();break;case 123:this._textbox.value!=""&&this._textbox.value!=this._value&&this._textbox.value!=this._text&&(event.keyCode=KeyCode.enter);case KeyCode.down:case KeyCode.up:case KeyCode.tab:case KeyCode.enter:if(this._curactb&&this._curactb.actb_display)return;this._isPressEnterKey=!0,event.keyCode==KeyCode.enter&&this._element.cusAttr("ChangeEnterToTab")&&(event.keyCode=KeyCode.tab),this.onInputReturn(),(_ClientPostBackManager&&_ClientPostBackManager.Runing||window.AfterZlayerJsQueue)&&event&&event.keyCode==13&&($Event(event).stopPropagation(),$Event(event).preventDefault())}},onInputBlurOnly:function(){this.ControlBlur(),this.IfAllowMultiSelection()?this._textbox.value=this.ListToString(this._datas.GetValues(this._element.cusAttr("TextField")),ReferenceTemplate.SplitString2):this.IsCodeChange()?this._isPressEnterKey||this.onInputReturn():this._textbox.value=this._text},onInputBlur:function(){if(this._curactb&&this._curactb.actb_display){try{this._textbox.focus()}catch(n){}return}this.ControlBlur(),this.IfAllowMultiSelection()?this._textbox.value=this.ListToString(this._datas.GetValues(this._element.cusAttr("TextField")),ReferenceTemplate.SplitString2):this.IsCodeChange()?this._isPressEnterKey||this.onInputReturn():this._textbox.value=this._text},onInputFocus:function(){var n=this;this._isPressEnterKey=!1,this.ControlFocus(),this.IfAllowMultiSelection()?this._textbox.value=this.ListToString(this._datas.GetValues(this._element.cusAttr("ValueField")),ReferenceTemplate.SplitString2):(this._textbox.value=this._value,this.hasSearchDispaly()&&this.onFocusOnSearch());try{this._textbox.select()}catch(t){}},onButtonClicked:function(){var bCallBackRun,iValue,func,inputValue;if(this.isAsynShowModal!==!0){if(this._textbox.style.borderBottomWidth=0,this._CancelShowForm=!1,_ClientCallBackManager&&_ClientCallBackManager.Runing)return this.isAsynShowModal=!0,func="$find('"+this.get_id()+"').isAsynShowModal=false;",func+="$find('"+this.get_id()+"').onButtonClicked();",_ClientJSExecQueueManager.Push(func),!1;if(this._button.cusAttr("PostBackHandle")&&(!this._element.cusAttr("IsShow")||!ToBoolean(this._element.cusAttr("IsShow")))){window.event&&$Event(window.event).stopPropagation(),eval(this._button.cusAttr("PostBackHandle")),this._button.cusAttr("PostBackHandle",null);return}this._element.cusAttr("IsShow","False"),bCallBackRun=_ClientCallBackManager.Runing,this.raiseBeforeLoadData(Sys.EventArgs.Empty),bCallBackRun||_ClientCallBackManager.Runing!=!0||this._IsPostBack==!0?(this._IsShowForm&&(inputValue=this._textbox.value,(inputValue==this._value||inputValue==this._text)&&(inputValue=null),this.ShowRefForm(inputValue)),this._IsPostBack==!0&&this.FirePostBack()):(this._IsShowForm&&(inputValue=this._textbox.value,(inputValue==this._value||inputValue==this._text)&&(inputValue=null)),iValue=inputValue!=null?'"'+inputValue.replace(/"/g,'\\"')+'"':"null",func="$find('"+this.get_id()+"').ShowRefForm("+iValue+");",_ClientJSExecQueueManager.Push(func))}},onSearchPress:function(){var n;this.isSearchDispaly()===!1?(n=$(this._textbox).val(),this.autoCompleteForSearchAdapter(n)):event.keyCode=="13"?(this.getSearchAdapter().confirm(),$Event(event).stopPropagation(),$Event(event).preventDefault()):event.keyCode=="27"?this.getSearchAdapter().hide():event.keyCode=="38"?this.getSearchAdapter().prevoius():event.keyCode=="40"?this.getSearchAdapter().next():(n=$(this._textbox).val(),this.autoCompleteForSearchAdapter(n))},autoCompleteForSearchAdapter:function(n){var t=this.getSearchAdapter();this._autoCompleteOpath&&(t.refInfo.filter=this._autoCompleteOpath),t.inputChanged(n)},onSearchBlur:function(){this.getSearchAdapter().hide()},add_OnAutoComplete:function(n){this.get_events().addHandler("OnAutoComplete",n)},remove_OnAutoComplete:function(n){this.get_events().removeHandler("OnAutoComplete",n)},raiseOnAutoComplete:function(n){var t=this.get_events().getHandler("OnAutoComplete");t&&t(this,n)},set_AutoCompleteOpath:function(n){this._autoCompleteOpath=n},DoContentChanged:function(n){var t,u,f,o,s,h,i,r,e;if(t=_this._element.cusAttr("KeyField"),u=_this._element.cusAttr("ValueField"),f=_this._element.cusAttr("TextField"),_this.IfAllowMultiSelection()){if(h=_this.get_Keys(),i=n.GetValues(t),_this.CompareList(h,i))return!1;r=n.GetValues(u),e=n.GetValues(f),_this._hidden.value=_this.ListToString(i,ReferenceTemplate.SplitString2)+ReferenceTemplate.SplitString1+_this.ListToString(r,ReferenceTemplate.SplitString2)+ReferenceTemplate.SplitString1+_this.ListToString(e,ReferenceTemplate.SplitString2),_this._textbox.value=_this.ListToString(e,ReferenceTemplate.SplitString2),_this._key=i.length>0?i[0]:"",_this._value=r.length>0?r[0]:"",_this._text=r.length>0?e[0]:""}else{if((!n.Rows||!(n.Rows.length>1))&&n.GetValue(t)==_this._datas.GetValue(t))if(o=n.GetValue(u),s=n.GetValue(f),(_this._value!=o||_this._text!=s)&&(_this._value=o,_this._text=s,_this._hidden.value=_this._key+ReferenceTemplate.SplitString1+_this._value+ReferenceTemplate.SplitString1+_this._text,_this._textbox.value=_this._text),_this._textbox.value=_this.hf=="1"?_this._value:_this._text,_this._isForceFireContentChange)_this._isForceFireContentChange=!1;else if(!n.getIsForceChange())return!1;_this._key=n.GetValue(t),_this._value=n.GetValue(u),_this._text=n.GetValue(f),_this._hidden.value=_this._key+ReferenceTemplate.SplitString1+_this._value+ReferenceTemplate.SplitString1+_this._text,_this._textbox.value=this.hf=="1"?_this._value:_this._text,_this.hasSearchDispaly()&&_this.updateHistroy(_this._key,_this._value,_this._text)}_this._datas=n,_this.fireContentChangedEvent(_this._datas),this&&this._element&&this.get_Type()==ControlType.Reference&&(_this=this),_this.fireonchangeEvent(_this._datas),this&&this._element&&this.get_Type()==ControlType.Reference&&(_this=this),_this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&_this.set_IsChanged(!0),_this.fireOnValueChangedEvent(_this._datas),_this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&_this.set_IsValueChanged(!0),_this.PostBack(),_this.fireContentChanged4PEvent(_this._datas),_this.fireOnValueChanged4PEvent(_this._datas)},OnContentChanged:function(n){var t=PopupFormHelper.TranslateInfor(n);if(t==null)t=new ReferenceData;else{if(this._isMultiOrg&&this._isCustomerMultiOrg!="true"&&t.GetValue(this._element.cusAttr("KeyField")).trim().length>0){if(this._element.parentElement&&this._element.parentElement.className.match(/\btbc\b/)!=null&&window.event)try{$Event(window.event).stopPropagation(),$Event(window.event).preventDefault()}catch(i){}_this=this,this.DoContentChanged(t);return}_this=this}this.DoContentChanged(t)},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(args){this._element!=null&&this.$element.attr("onchange")&&eval($(this.get_element()).attr("onchange"));var eh=this.get_events().getHandler("onchange");eh&&eh(this,args)},add_OnValueChanged:function(n){this.get_events().addHandler("OnValueChanged",n)},remove_OnValueChanged:function(n){this.get_events().removeHandler("OnValueChanged",n)},raiseOnValueChanged:function(n){var t,i;if(this.BeforeRaiseOnValueChanged4Personal(),t=this.get_events().getHandler("OnValueChanged"),t&&(window.event&&(window.event.keyCode==KeyCode.enter||window.event.keyCode==KeyCode.tab||window.event.keyCode==KeyCode.up||window.event.keyCode==KeyCode.down||$Event(window.event).stopPropagation()),t(this,n)),this._element.cusAttr("SndLoad")){if(i=this.get_element().className.split(" ")[0],i=="GridInput")return;this._element&&this._element.cusAttr("AutoPostBack")!="True"&&(_ClientPostBackManager.Runing==!0||_ClientCallBackManager.Runing==!0?_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').SecondLoadAjaxCall()"):this.SecondLoadAjaxCall())}},add_OnValueChanged4P:function(n){this.get_events().addHandler("OnValueChanged4P",n)},remove_OnValueChanged4P:function(n){this.get_events().removeHandler("OnValueChanged4P",n)},raiseOnValueChanged4P:function(n){var t=this.get_events().getHandler("OnValueChanged4P");t&&(window.event&&(window.event.keyCode==KeyCode.enter||window.event.keyCode==KeyCode.tab||window.event.keyCode==KeyCode.up||window.event.keyCode==KeyCode.down||$Event(window.event).stopPropagation()),this.curHandler=t,t(this,n))},fireContentChangedEvent:function(n){if(this.get_IsRaiseEvent()!=!1){var t=new UF.UI.ChangeEventArgs;t.result=n,this.raiseContentChanged(t)}},fireContentChanged4PEvent:function(n){if(this.get_IsRaiseEvent()!=!1){var t=new UF.UI.ChangeEventArgs;t.result=n,this.raiseContentChanged4P(t)}},fireOnValueChangedEvent:function(n){if(this.get_IsRaiseEvent()!=!1&&(this._key!=""&&this._key!="-1"||this.get_IsFireOnValueChangedEvent())){var t=new UF.UI.ChangeEventArgs;t.result=n,this.raiseOnValueChanged(t)}},fireOnValueChanged4PEvent:function(n){if(this.get_IsRaiseEvent()!=!1&&(this._key!=""&&this._key!="-1"||this.get_IsFireOnValueChangedEvent())){var t=new UF.UI.ChangeEventArgs;t.result=n,this.raiseOnValueChanged4P(t)}},fireonchangeEvent:function(n){if(this.get_IsRaiseEvent()!=!1){var t=new UF.UI.ChangeEventArgs;t.result=n,this.raiseonchange(t)}},set_Enabled:function(n){if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")){n=ToBoolean(n),this.btnmouseOutClass=n==!0?this.btnClassName:this.btnClassName_Dis,this._element.cusAttr("disabled",!n),this._textbox&&$(this._textbox).attr("readOnly",!n);for(var t=0,i=this._element.children.length;t<i;t++)$(this._element.children[t]).attr("disabled",!n),this._element.children[t].type=="text"&&(n?(this._element.className=UIControlClass.UFTextBox.CssClass,this._element.children[t].className=ReferenceTemplate.TBClassName_R):this._element.children[t].className=ReferenceTemplate.TBClassName_D),this.get_element().children[t].type=="button"&&(this.get_element().children[t].className=n?this.btnClassName:this.btnClassName_Dis)}},get_ReadOnly:function(){return this._element.cusAttr("ReadOnly")},set_ReadOnly:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&this.get_Enabled()&&(n=ToBoolean(n),$(this._textbox).attr("readOnly",n),n?$(this._button).attr("disabled",!0):this.get_Enabled()&&$(this._button).attr("disabled",!1),n?(this._textbox.className=this.tbClassName_R,this._button.className=this.btnClassName_Dis,this.btnmouseOutClass=this.btnClassName_Dis,this._element.className=UIControlClass.UFTextBox.ReadOnlyCssClass):(this._textbox.className=this.tbClassName,this._button.className=this.btnClassName,this.btnmouseOutClass=this.btnClassName,this._element.className=UIControlClass.UFTextBox.CssClass),this._element.cusAttr("ReadOnly",n),this.set_HDValue("ReadOnly",n.toString().toLowerCase()),this.AfterSetReadOnly4Personal())},set_CustomInParams:function(n){this._CustomInParams=n,this._element.cusAttr("CustomInParams",n)},get_CustomInParams:function(){return this._element.cusAttr("CustomInParams")},set_AddParams:function(n){this._element.cusAttr("AddParams",n)},get_AddParams:function(){return this._element.cusAttr("AddParams")},get_IsFireOnValueChangedEvent:function(){return this._element.cusAttr("FireVC")&&this._element.cusAttr("FireVC").toLowerCase()=="f"?!1:!0},get_Key:function(){return this._key==""&&(this._key=-1),this._key},get_Value:function(){return this._value},get_Text:function(){return this._text},set_Key:function(n){if(n==""&&(n=-1),this._eventCounter++,n==this._key&&!this.AlwaysFirechangeEvent){this._eventCounter==3&&(this.CallXmlHttpValidate(this._key),this._eventCounter=0);return}this._keyChanged=!0,this._datas.SetValue(this._element.cusAttr("KeyField"),n),this._key=n,this._hidden.value=this._key+ReferenceTemplate.SplitString1+this._value+ReferenceTemplate.SplitString1+this._text,this._eventCounter==3&&(this._keyChanged=!1,this._eventCounter=0,this.fireonchangeEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this.fireOnValueChangedEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0),this.CallXmlHttpValidate(this._key),this.PostBack(),this.fireOnValueChanged4PEvent(this._datas))},set_Value:function(n){this._datas.SetValue(this._element.cusAttr("ValueField"),n),this._value=n,this.hf=="0"?this._textbox.value=this._text:this.hf=="1"&&(this._textbox.value=this._value),this._hidden.value=this._key+ReferenceTemplate.SplitString1+this._value+ReferenceTemplate.SplitString1+this._text,this._eventCounter++,this._eventCounter==3&&(this._keyChanged?(this.fireonchangeEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this.fireOnValueChangedEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0),this.CallXmlHttpValidate(this._key),this.PostBack(),this.fireOnValueChanged4PEvent(this._datas)):this.CallXmlHttpValidate(this._key),this._keyChanged=!1,this._eventCounter=0)},set_Text:function(n){this._datas.SetValue(this._element.cusAttr("TextField"),n),this._text=n,this.hf=="0"?this._textbox.value=n:this.hf=="1"&&(this._textbox.value=this._value),this._hidden.value=this._key+ReferenceTemplate.SplitString1+this._value+ReferenceTemplate.SplitString1+this._text,this._eventCounter++,this._eventCounter==3&&(this._keyChanged?(this.fireOnValueChangedEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0),this.fireonchangeEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this.CallXmlHttpValidate(this._key),this.PostBack(),this.fireOnValueChanged4PEvent(this._datas)):this.CallXmlHttpValidate(this._key),this._keyChanged=!1,this._eventCounter=0)},SetDataValues:function(n,t,i){if(this.IfAllowMultiSelection()){if(this.CompareList(this._datas.GetValues(this._element.cusAttr("KeyField")),n))return}else if(n==this._key)return;this.set_IsRaiseEvent(!1),this._datas=new ReferenceData,this.IfAllowMultiSelection()?(this.set_Keys(n),this.set_Values(t),this.set_Texts(i)):(n==""&&(n=-1),this._datas.SetValue(this._element.cusAttr("KeyField"),n),this._key=n,this._datas.SetValue(this._element.cusAttr("ValueField"),t),this._value=t,this._datas.SetValue(this._element.cusAttr("TextField"),i),this._text=i,this.hf=="0"?this._textbox.value=i:this.hf=="1"&&(this._textbox.value=this._value),this._hidden.value=this._key+ReferenceTemplate.SplitString1+this._value+ReferenceTemplate.SplitString1+this._text),this.set_IsRaiseEvent(!0)},SetValues:function(n,t,i){if(this.IfAllowMultiSelection()){if(this.CompareList(this._datas.GetValues(this._element.cusAttr("KeyField")),n))return}else if(n==this._key)return;this._datas=new ReferenceData,this.IfAllowMultiSelection()?(this.set_Keys(n),this.set_Values(t),this.set_Texts(i)):(this.set_Key(n),this.set_Value(t),this.set_Text(i))},set_Keys:function(n){if(typeof n=="object"){if(this._eventCounter++,this.CompareList(this._datas.GetValues(this._element.cusAttr("KeyField")),n)){this._eventCounter==3&&(this._eventCounter=0);return}this._keyChanged=!0,this._datas.SetValues(this._element.cusAttr("KeyField"),n),this._key=this.ListToString(n,ReferenceTemplate.SplitString2),this._hidden.value=this._key+ReferenceTemplate.SplitString1+this.ListToString(this.get_Values(),ReferenceTemplate.SplitString2)+ReferenceTemplate.SplitString1+this.ListToString(this.get_Texts(),ReferenceTemplate.SplitString2),this._key=n.length>0?n[0]:"",this._eventCounter==3&&(this._keyChanged=!1,this._eventCounter=0,this.fireonchangeEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this.fireOnValueChangedEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0),this.PostBack(),this.fireOnValueChanged4PEvent(this._datas))}},set_Values:function(n){typeof n=="object"&&(this._datas.SetValues(this._element.cusAttr("ValueField"),n),this._value=this.ListToString(n,ReferenceTemplate.SplitString2),this._hidden.value=this.ListToString(this.get_Keys(),ReferenceTemplate.SplitString2)+ReferenceTemplate.SplitString1+this._value+ReferenceTemplate.SplitString1+this.ListToString(this.get_Texts(),ReferenceTemplate.SplitString2),this._value=n.length>0?n[0]:"",this._eventCounter++,this._eventCounter==3&&(this._keyChanged&&(this.fireonchangeEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this.PostBack()),this._keyChanged=!1,this._eventCounter=0))},set_Texts:function(n){typeof n=="object"&&(this._datas.SetValues(this._element.cusAttr("TextField"),n),this._text=this.ListToString(n,ReferenceTemplate.SplitString2),this._hidden.value=this.ListToString(this.get_Keys(),ReferenceTemplate.SplitString2)+ReferenceTemplate.SplitString1+this.ListToString(this.get_Values(),ReferenceTemplate.SplitString2)+ReferenceTemplate.SplitString1+this._text,this._textbox.value=this._text,this._text=n.length>0?n[0]:"",this._eventCounter++,this._eventCounter==3&&(this._keyChanged&&(this.fireonchangeEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this.PostBack()),this._keyChanged=!1,this._eventCounter=0))},get_Datas:function(){return this._datas},get_Keys:function(){return this._datas.GetValues(this._element.cusAttr("KeyField"))},get_Values:function(){return this._datas.GetValues(this._element.cusAttr("ValueField"))},get_Texts:function(){return this._datas.GetValues(this._element.cusAttr("TextField"))},set_Data:function(n,t){this._datas.SetValue(n,t)},CheckMarkChars:function(){var i=event.srcElement,n,t;try{textinputmaskChars&&(n=textinputmaskChars,n&&(t=event?event.clipboardData.getData("text/plain"):window.clipboardData.getData("text"),isMasks(t,n)&&$Event(event).preventDefault()))}catch(r){}},CheckMarkChar:function(){var t=event.srcElement,n=t.maskChars;n!=""&&isMask(event.keyCode,n)&&$Event(event).preventDefault()},GetXmlHttpRequest:function(){this._xmlhttpRequest||(this._xmlhttpRequest=RequestHelper.getXHR())},CallXmlHttpValidate:function(n){var t,i;this._isNeedValidate&&n!=-1&&(this._isValidating=!0,this.raiseBeforeLoadData(Sys.EventArgs.Empty),n!="")&&(this._inputValue=n,this.postbackBeforeShowRefForm!=!0?t=this.GetUrl(this._element.cusAttr("RefType"),"ModalRef")+"&CommandType=validate&QueryField="+this._element.cusAttr("KeyField")+"&"+this._element.cusAttr("KeyField")+"="+encodeURIComponent(n):(t=this.GetUrl(this._element.cusAttr("RefType"),"ModalRef",this.postbackBeforeShowRefForm)+"&CommandType=validate&QueryField="+this._element.cusAttr("KeyField")+"&"+this._element.cusAttr("KeyField")+"="+encodeURIComponent(n),this.postbackBeforeShowRefForm=!1),this._isMultiOrg&&this._ChildToParentOrg!=null?(t+="&ChildToParentOrg="+this._ChildToParentOrg,this._ChildToParentOrg=null):this._isMultiOrg&&(t.indexOf("MultiOrgID")<0&&(i=this.get_SrcOrg(),t+="&MultiOrgID="+i),this._entityFullName&&(t+="&EntityFullName="+this._entityFullName)),t=AppendPopupUrl(t),this._xmlhttpRequest||this.GetXmlHttpRequest(),this._xmlhttpRequest&&this.ProcessRequest(t,this.CallbackComplete))},ProcessRequest:function(n,t){if(n.length>2e3){alert(Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_ReferenceUrlOverLength);try{this._textbox.focus(),this._textbox.select()}catch(u){}return;var i,r}else{if(this.url=n,this.isAllowCache()&&$Cache(n)!=null){t($Cache(n));return}this._xmlhttpRequest.open("GET",n,!1),this._xmlhttpRequest.onreadystatechange=t,this._xmlhttpRequest.send("")}},CallXmlHttp:function(n){var i=this._element.cusAttr("ValueField"),t,r;this._isForceFireContentChange&&(this.get_IsUseCodeMatch()||this._key4Simulator!=""&&this._key4Simulator>0&&(i=this._element.cusAttr("KeyField"),n=this._key4Simulator,this._key4Simulator="")),this._inputValue=G_Trim(n),this.postbackBeforeShowRefForm!=!0?t=this.GetUrl(this._element.cusAttr("RefType"),"ModalRef")+"&CommandType=callback&QueryField="+i+"&QueryNameField="+this._element.cusAttr("TextField")+"&"+i+"="+encodeURIComponent(n):(t=this.GetUrl(this._element.cusAttr("RefType"),"ModalRef",!0)+"&CommandType=callback&QueryField="+i+"&QueryNameField="+this._element.cusAttr("TextField")+"&"+i+"="+encodeURIComponent(n),this.postbackBeforeShowRefForm=!1),this._isForceFireContentChange&&this.get_IsUseCodeMatch()&&(t+="&MatchType=28"),this._isMultiOrg&&(t.indexOf("MultiOrgID")<0&&(r=this.get_SrcOrg(),t+="&MultiOrgID="+r),this._entityFullName&&(t+="&EntityFullName="+this._entityFullName)),t=AppendPopupUrl(t),this._xmlhttpRequest||this.GetXmlHttpRequest(),this._xmlhttpRequest&&this.ProcessRequest(t,this.CallbackComplete)},CallXmlHttp_AutoComplete:function(n){this._inputValue=G_Trim(n);var t;this.postbackBeforeShowRefForm!=!0?t=this.GetUrl(this._element.cusAttr("RefType"),"ModalRef")+"&CommandType=auotcomplete&QueryField="+this._element.cusAttr("TextField")+"&"+this._element.cusAttr("TextField")+"="+encodeURIComponent(n):(t=this.GetUrl(this._element.cusAttr("RefType"),"ModalRef",!0)+"&CommandType=auotcomplete&QueryField="+this._element.cusAttr("TextField")+"&"+this._element.cusAttr("TextField")+"="+encodeURIComponent(n),this.postbackBeforeShowRefForm=!1),t=AppendPopupUrl(t),this._xmlhttpRequest||this.GetXmlHttpRequest(),this._xmlhttpRequest&&(this._xmlhttpRequest.open("GET",t,!1),this._xmlhttpRequest.onreadystatechange=this.CallbackComplete_AutoComplete,this._xmlhttpRequest.send(""))},ShowRefForm:function(n){var t,e,r,i,u,f,o,s,h,c;if(UF.UI.Reference.DisableShowForm!=!0){if(this._CancelShowForm){this._CancelShowForm=!1;return}this._IsShowForm&&(_ClientPostBackManager.Runing||(this.postbackBeforeShowRefForm!=!0?t=this.GetUrl(this._element.cusAttr("RefType"),"ModalRef"):(t=this.GetUrl(this._element.cusAttr("RefType"),"ModalRef",!0),this.postbackBeforeShowRefForm=!1),n&&n!=""&&(t+="&QueryNameField="+this._element.cusAttr("TextField")+"&QueryField="+this._element.cusAttr("ValueField")+"&"+this._element.cusAttr("ValueField")+"="+encodeURIComponent(n)),n&&n!=""||(n=this._textbox.value),n&&n!=""&&(e=t+"&ValueByClick="+encodeURIComponent(n),e.length<2e3&&(t=e)),r=this._element.cusAttr("RefTitle"),r||(r=""),i=this._element.cusAttr("RefWidth"),u=this._element.cusAttr("RefHeight"),t.length>2e3&&(f=this._element.cusAttr("CtrlId"),f==null&&(f=""),o="simple.aspx?lnk="+this._element.cusAttr("RefType")+"&CtrlId="+f+"&chromeType=4&ShowType=ModalRef",s=t.substring(o.length,t.length),t=o+"&OverLength=1",window.Ref_Params=s),this._isMultiOrg&&(t.indexOf("MultiOrgID")!=-1||(h=this.get_SrcOrg(),t+="&MultiOrgID="+h),this._entityFullName&&(t+="&EntityFullName="+this._entityFullName)),this._IsDialogOpenning!=!0)&&(this._IsDialogOpenning=!0,c=null,i||(i=600),u||(u=400),i=parseInt(i)+10,ShowModalDialogForAll(t,r,u,i,!0,!1,this)))}},showDialogCallback:function(n){var t,i,r;this._IsDialogOpenning=!1,n!=null&&typeof n!="boolean"?(t=this._element.cusAttr("GridCltID4P"),i=this._element.cusAttr("ColFldID4P"),t!=null&&i!=null&&$find(t)!=null&&(r=this.get_IsPersonalProcess(),this.set_OldIsPersonalProcess(r),this.set_IsPersonalProcess(!0)),this.saveReturnXml(n),this.OnContentChanged(n)):(window.event&&window.event.keyCode==KeyCode.enter&&($Event(window.event).stopPropagation(),$Event(window.event).preventDefault()),this._isForceFireContentChange==!0&&(this._key==""||this._key==-1||this._key=="-1")&&(this._key="-1",this._value="",this._text="",this._textbox.value=""));try{this._textbox.focus()}catch(u){}},PostBack:function(){if(this.get_IsRaiseEvent()!=!1&&this._element&&this._element.cusAttr("AutoPostBack")=="True"&&typeof __doPostBack!="undefined"){if(window.event&&($Event(window.event).stopPropagation(),$Event(window.event).preventDefault()),!this.isMustPostBack&&this.OnBeforePostBack()){this.SetClientIsAbortPostBack(!0);return}if(this._isNeedValidate&&(this._key==this._oldKey||(this._key==""||this._key=="-1")&&(this._oldKey==""||this._oldKey=="-1"))&&!this._isForceFireContentChange)return;this.RecordFocus(),window._TextBoxFirePostBack=!0,__doPostBack(this._element.id,"")}},FirePostBack:function(){typeof __doPostBack!="undefined"&&(window.event&&$Event(window.event).stopPropagation(),this.RecordFocus(),window._TextBoxFirePostBack=!0,__doPostBack(this.get_id(),""))},get_Type:function(){return ControlType.Reference},set_IsShowForm:function(n){var t=ToBoolean(n);this._IsShowForm=t},get_IsShowForm:function(){return this._IsShowForm},get_IsValidating:function(){return this._isValidating},set_IsValidating:function(n){var t=ToBoolean(n);this._isValidating=t},set_IsLoadDefaultParams:function(n){this._IsLoadDefaultParams=n},get_IsLoadDefaultParams:function(){return this._IsLoadDefaultParams},set_Width:function(n){this._element.style.width=n+"px",this._textbox.style.width=n-18+"px"},isAllowCache:function(){var n=this._element.cusAttr("AllowClientCache");return typeof n!="undefined"&&n=="y"},set_SingleCode:function(n){this._textbox.value=n,this.onInputReturn()},set_AutoPostBack:function(n){_IsPostBack=n},get_AutoPostBack:function(){return _IsPostBack},ValidateInput:function(){return this.onInputReturn()},InputXmlHttpValidate:function(){this.CallXmlHttpValidate(this._key)},SetFocus:function(){Basic.GridEditSetFocus(this._textbox)},IfAllowMultiSelection:function(){return typeof this._element.cusAttr("AllowMultiSelection")=="undefined"||this._element.cusAttr("AllowMultiSelection")=="False"?!1:!0},get_NeedValidate:function(){return this._isNeedValidate},set_NeedValidate:function(n){this._isNeedValidate=n},set_RefType:function(n){this._element.cusAttr("RefType",n)},get_RefType:function(){return this._element.cusAttr("RefType")},set_RefWidth:function(n){this._element.cusAttr("RefWidth",n)},set_RefHeight:function(n){return this._element.cusAttr("RefHeight",n)},GetPostUrl:function(n,t){for(var o=this.GetUrlAttributeList(n),i=this.GetUrlAttributeList(t),u,f,r,e=0;e<o.length;e++)for(u=0;u<i.length;u++)if(o[e].key==i[u].key){i[u].del=!0;break}for(f="",r=0;r<i.length;r++)i[r].del||(f!=""&&(f+="&"),f+=i[r].key+"="+i[r].value);return f},GetUrlAttributeList:function(n){var i=[],u=n.split("?"),r,t;if(u.length==2&&(r=u[1]),!r)return i;for(pl=r.split("&"),t=0;t<pl.length;t++)i[t]={},i[t].key=pl[t].split("=")[0],i[t].value=pl[t].substring(pl[t].split("=")[0].length+1);return i},get_IsUseCodeMatch:function(){return!0},saveReturnXml:function(n){this._hiddenReturn.value=encodeURIComponent(n),this.rowDatas=n},getReturnXml:function(){try{return PopupFormHelper.TranslateInfor(this.rowDatas)}catch(n){}return null},get_SrcOrg:function(){var t=this._MultiOrg,n;return this._MultiOrgHiddenID&&(n=document.getElementById(this._MultiOrgHiddenID),n&&(t=n.control?n.control.get_Key():n.value)),t},set_SrcOrg:function(n){this._MultiOrg=n,this.get_element().cusAttr(this.SrcOrgFlag,n)},ReplaceResult:function(n){this.keyCode=event,this.referenceData=n;var t=this.InitMultiOrgParams(n,this._element.cusAttr("KeyField"),this._NeedConvIDs,this._entityFullName);this._dataGetter.Do(t,this.GetResult,this)},GetResult:function(n,t){var f,r,i,u;if(_this=t,n!=null&&n.trim()!=""){for(f=Sys.Serialization.JavaScriptSerializer.deserialize(n),r=f.AllDatas,i=0;i<r.length;i++)r[i]&&(u=r[i].split(":"),u.length==2&&_this.referenceData.SetValue(u[0],u[1]));_this.DoContentChanged(_this.referenceData)}},postBackCheck:function(){_PostBack=="2"&&Post()},SetClientIsAbortPostBack:function(n){this._tagHidden&&(this._tagHidden.value=n===!0?"1":"")},OnBeforePostBack:function(){var n=new UF.UI.ChangeEventArgs;return n.result=this._datas,n.arg={},n.arg.CancelAction=!1,this.raiseEvent("BeforePostBack",n),n.arg.CancelAction},IsCodeChange:function(){return this._textbox.value!=this._value},ListToString:function(n,t){var r,u,i;if(n==null)return"";for(r="",u="",i=0;i<n.length;i++)r+=u+n[i],u=t;return r},StringToList:function(n,t){var i=[];return n==null||n==""?i:i=n.split(t)},CompareList:function(n,t){if(n!=null&&t!=null&&n.length==t.length){for(var i=0;i<n.length;i++)if(n[i]!=t[i])return!1;return!0}return!1},BtnMouseOver:function(){this._button.className=this.btnmouseOverClass},BtnMouseOut:function(){this._button.className=this.btnmouseOutClass},RecordFocus:function(){var n=window.document.getElementById("HiddenCurrentControl");n&&(n.value=n.value.split("|",2)[1]&&n.value.split("|",2)[1]!=""?this._textbox.id+"|"+n.value.split("|",2)[1]:this._textbox.id+"|false",window.event&&window.event.type=="click"&&(n.value=this._textbox.id+"|stay"))},get_AutoComplete:function(){return this._autoComplete},set_AutoComplete:function(n){this._autoComplete=n!=null&&n.toString().toLowerCase()=="true"?!0:!1},ForceFireContentChange:function(){this._isForceFireContentChange=!0,this.onInputFocus(),this.onInputReturn()},SecondLoadAjaxCall:function(){$alert("{------二次加载AJAX-开始------}");var n,t=$("input[name*='TASKID_HIDDENFIELD']"),i=this.get_Key();n="SecondLoad.aspx?SourceID="+this.get_id()+"&SourceKey="+i+"&TaskID="+t.val(),n=AppendPopupUrl(n),$alert("URL:"+n),this._xmlhttpRequest||this.GetXmlHttpRequest(),this._xmlhttpRequest&&this.ProcessRequest(n,new Function("$find('"+this.get_id()+"').SecondLoadCallBack();"))},SetControlAttribute:function(n){if(UF.UI.Reference.callBaseMethod(this,"SetControlAttribute"),n&&n.length>2){this.set_RefType(n[2]),this.set_RefWidth(n[3]),this.set_RefHeight(n[4]);var t=this.get_element();t.KeyField=n[5],t.ValueField=n[6],t.TextField=n[7],this.ClearAllParams(),this.set_CustomInParams(n[8]),this.set_AddParams(""),t.setAttribute("CustomInParamsSer",n[9]),t.setAttribute("AddParams",n[10]),t.setAttribute("CustomInParamsControl",n[11])}},SecondLoadCallBack:function(){var n,t,i;_this=this,_this._xmlhttpRequest&&_this._xmlhttpRequest.readyState==4&&(n=_this._xmlhttpRequest.responseText,n=unescapeHTML(n),$alert("Result:"+n),t=$.parseJSON(n),i=$SetSndLoadControlValue(t),$alert("{------二次加载AJAX-结束------}"))}},UF.UI.Reference.registerClass("UF.UI.Reference",UF.UI.PopupForm),UF.UI.Reference.DisableShowForm===undefined&&(UF.UI.Reference.DisableShowForm=!1),ReferenceTemplate.Enabled=InputControlTemplate.Enabled,ReferenceTemplate.ReadOnly=InputControlTemplate.ReadOnly,ReferenceTemplate.TBClassName=InputControlTemplate.TBClassName,ReferenceTemplate.TBClassName_R=InputControlTemplate.TBClassName_R,ReferenceTemplate.TBClassName_D=InputControlTemplate.TBClassName_D,ReferenceTemplate.BtnClassName="btn RefBtn",ReferenceTemplate.BtnClassName_Dis="btn RefBtn_Dis",ReferenceTemplate.SplitString1="__&URS1&_",ReferenceTemplate.SplitString2="__&URS2&_",ReferenceTemplate.IsNeedValidate="True",ReferenceTemplate.hiddenReturn="_ReturnHidden",RefInputCallback.prototype={_input:null,onDisplay:RefInputCallback$onDisplay,onDisconnect:RefInputCallback$onDisconnect,onSelectItem:RefInputCallback$onSelectItem,onConfirmItem:RefInputCallback$onConfirmItem},UF.UI.JControl!==undefined&&RefInputCallback.registerClass("RefInputCallback",null,UF.UI.JControl.AutoComplete.IAutoCompleteCallback),displayData={columns:["ID","Code","Name"],data:[]},Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.TabControl=function(n){UF.UI.TabControl.initializeBase(this,[n]),this.tabGroup=new Tabs,this.treeGroup,this.heads,this.pages,this.control,this.Mode,this.SelectedIndex,this._fireEventTabIndex=-1,this._elementkeydownHandler,this.m_CustomFilterToolbarDiv=null},UF.UI.TabControl.prototype={initialize:function(){UF.UI.TabControl.callBaseMethod(this,"initialize"),this.initControl(),this._elementkeydownHandler=Function.createDelegate(this,this.onkeyDown);var n=this;$(this._element).bind("keydown",function(){n.onkeyDown()})},dispose:function(){this._elementkeydownHandler&&($(this._element).unbind("keydown"),this._elementkeydownHandler=null),this.tabGroup&&(this.tabGroup.dispose(),this.tabGroup=null),this.control=null,this.heads=null,this.pages=null,UF.UI.TabControl.callBaseMethod(this,"dispose")},initControl:function(){this.SelectedIndex=this._element.cusAttr("SelectedIndex"),this.Mode=this._element.cusAttr("DisplayModel"),this.heads=this._element.children[0].children[0],this.pages=this._element.children[1];for(var n=0,t=this.heads.children.length-1;n<t;n++)this.tabGroup.AddTab(this.heads.children[n],this.pages.children[n],n,this);this.m_CustomFilterToolbarDiv=this.GetCustomFilterToolbar(),this.m_CustomFilterToolbarDiv!=null&&(this.m_CustomFilterManagerInstance=GridCustomFilterToolbarManager.GetInstance(this.m_CustomFilterToolbarDiv,this,"Tab"),this.m_CustomFilterManagerInstance.Initialize())},GetCustomFilterToolbar:function(){var i,n,t;return this.pages.children.length>0?(i=this.pages.children.length-1,n=this.pages.children[i],n.id=="TabFilter"?(n.cusAttr("ParentTabID",this._element.id),top.CustomFilterLocation&&(t=top.CustomFilterLocation.getLocationItem(this._element.id),t&&(n.style.left=t.Left+"px",n.style.bottom=t.Bottom+"px")),n.style.display="block",n):null):null},OnCustomFilterClick:function(action){if(_ClientCallBackManager&&_ClientCallBackManager.Runing)return!1;this.SetCustomerFilterHiddenInfo(action),this.get_CallPostBack()!=null&&eval(this.get_CallPostBack())},add_onTabClick:function(n){this.get_events().addHandler("onTabClick",n)},remove_onTabClick:function(n){this.get_events().removeHandler("onTabClick",n)},raiseonTabClick:function(n){var t=this.get_events().getHandler("onTabClick");t&&t(this,n)},get_Type:function(){return ControlType.TabControl},set_ReadOnly:function(n){this.SetReadOnly(this.get_TabIndex(),n)},SetReadOnly:function(n,t){if(this.heads){var i=this.heads.children[n];t?$(i).addClass("disabled"):$(i).removeClass("disabled")}},set_Enabled:function(){this.SetEnabled(this.get_TabIndex(),bReadonly)},SetEnabled:function(n,t){if(this.heads){var i=this.heads.children[n];t?$(i).removeClass("disabled"):$(i).addClass("disabled")}this.pages&&this.pages.children[n]&&this.pages.children[n].cusAttr("disabled",!t)},SetTabIndex:function(n){if(n!=this.SelectedIndex){if(_ClientCallBackManager&&_ClientCallBackManager.Runing)return!1;this.SetSelected(n),$(this.heads.children[n]).click()}},SetTabByPageID:function(n){for(var i=-1,t=0,r=this.pages.children.length;t<r;t++)if(n==this.pages.children[t].id){i=t;break}i!=-1&&this.SetTabIndex(i)},set_TabIndex:function(n){this.SetTabIndex(n)},get_TabIndex:function(){return this.SelectedIndex},FireEventTabIndex:function(n){this._fireEventTabIndex=n},SetFocus:function(){var n=$find(this.tabGroup.TabCollection[this.SelectedIndex].Page.id);return n?n.setContainerControlFocus(this.tabGroup.TabCollection[this.SelectedIndex].Page,!1):!1},getTab:function(){return this.tabGroup},onkeyDown:function(){var t,r,i,n;if(window.document.readyState=="complete"&&(window.event.ctrlKey||window.event.altKey&&(window.event.keyCode==KeyCode.pup||window.event.keyCode==KeyCode.pdn)))switch(window.event.keyCode){case KeyCode.left:n=this.getNextIndex(this.SelectedIndex,this.heads.children.length,!0),this.SetTabIndex(n);break;case KeyCode.right:n=this.getNextIndex(this.SelectedIndex,this.heads.children.length,!1),this.SetTabIndex(n);break;case KeyCode.pup:window.event.altKey&&(t=this.tabGroup.TabCollection[this.get_TabIndex()],t&&t.NavButton&&t.NavButton.PreButton&&t.NavButton.PreButton.fireEvent("onclick"));break;case KeyCode.pdn:window.event.altKey&&(t=this.tabGroup.TabCollection[this.get_TabIndex()],t&&t.NavButton&&t.NavButton.NextButton&&t.NavButton.NextButton.fireEvent("onclick"));break;case 84:r=this.getNextTabControl(),r!=null&&r.control!=null&&r.control.SetFocus(r.control.tabGroup.TabCollection[r.control.get_TabIndex()].Page),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault();break;default:i=window.event.keyCode,n=-1,i>48&&i<58?n=i-49:i>96&&i<106&&(n=i-97),n!=-1&&(n=this.getViewedIndex(n),this.SetTabIndex(n))}},getNextTabControl:function(){for(var i=document.getElementsByTagName("DIV"),t=[],r,n=0;n<i.length;n++)i[n].className&&i[n].className.containsCssClass("TC tPn")&&(t[t.length]=i[n]);if(i=null,t.length<=1)return null;for(r=!1,n=0;n<t.length;n++){if(r==!0)return t[n];t[n].id==this.get_id()&&(r=!0),n==t.length-1&&(n=-1)}},getViewedIndex:function(n){for(var i=-1,t=0;t<this.tabGroup.TabCollection.length;t++)if(!this.IsTabPageDisabled(t)&&!this.IsTabPageHidden(t)&&((i++,i==n)||t==this.tabGroup.TabCollection.length-1))return t},getNextIndex:function(n,t,i){var u,r;if(i){if(n>0)return r=parseInt(n)-1,this.IsTabPageDisabled(r)||this.IsTabPageHidden(r)?this.getNextIndex(r,t,i):r;for(u=this.heads.children.length-2;u>0;u--)if(this.heads.children[u].className=="nav-item"&&this.heads.children[u].style.display!="none")return u}else if(n<t-2)return r=parseInt(n)+1,this.IsTabPageDisabled(r)||this.IsTabPageHidden(r)?this.getNextIndex(r,t,i):r;return 0},SetSelected:function(n){this.get_element().cusAttr("SelectedIndex",n+""),this.SelectedIndex=n,this.SetHiddenInfo()},SetHiddenInfo:function(){$get(this.get_id()+"_Infor").value=this.Mode+"|"+this.SelectedIndex},SetHiddenInfo:function(n){$get(this.get_id()+"_Infor").value=this.Mode+"|"+this.SelectedIndex+"|"+n},SetCustomerFilterHiddenInfo:function(n){$get(this.get_id()+"_Infor").value=this.Mode+"|"+this.SelectedIndex+"||"+n},get_CallPostBack:function(){return this._element.cusAttr("CallPostBack")},IsTabPageDisabled:function(n){return this.heads.children[n]&&this.heads.children[n].className.indexOf("disabled")>-1?!0:!1},IsTabPageHidden:function(n){return this.heads.children[n]&&this.heads.children[n].style.display=="none"?!0:!1},to_Help:function(n){var i=this.heads,r=this;$(this.heads).after("<div class='controlBg1' forid='"+this._element.id+"' z-index='"+n+"'><\/div>")},to_Translate:function(n,t){var u=this,i=$(this.heads).find(".nav-item"),r=$(this.heads).parents(".webpart_div").attr("id"),f=function(){$.each(i,function(i,u){var f=$(u).attr("id");$(u).append("<div class='translateBg' forid='"+f+"' z-index='"+n+"'><\/div>"),t&&$("[forid='"+f+"']").click(function(n){n.preventDefault(),n.stopPropagation();var i=r.length+1,u=f.lastIndexOf("_"),e=f.substring(i,u);t(f,e)})})}(this)},set_translateName:function(n,t){n.find(".nav-link").text(t)},to_Defualt:function(){$(this.heads).next(".controlBg1").length>0&&$(this.heads).next(".controlBg1").remove(),$(this.heads).find(".translateBg").length>0&&$(this.heads).find(".translateBg").unbind("click").remove();for(var n=0;n<this.tabGroup.TabCollection.length;n++)$("[forid='"+this.tabGroup.TabCollection[n].Head.id+"']").unbind("click"),$("[forid='"+this.tabGroup.TabCollection[n].Head.id+"']").remove()}},UF.UI.TabControl.registerClass("UF.UI.TabControl",UF.UI.Control),Tabs=function(){this.TabCollection=[]},Tabs.prototype.dispose=function(){for(var n=0;n<this.TabCollection.length;n++)this.TabCollection[n].dispose();Array.clear(this.TabCollection),this.TabCollection=null},Tabs.prototype.AddTab=function(n,t,i,r){this.TabCollection.push(new Tab(n,t,this,i,r))},Tabs.prototype.TabsHidden=function(n){for(var i=this.TabCollection,t=0,r=i.length;t<r;t++)i[t].Hidden(n)},Tabs.prototype.TabsDisplay=function(n){for(var i=this.TabCollection,t=0,r=i.length;t<r;t++)i[t].Display(n)},Tabs.prototype.SetSelectedIndex=function(n){this.TabCollection[parseInt(n)].Onclick()},Tab=function(n,t,i,r,u){this.Head=n,this.Page=t,this.Parent=i,this.Index=r,this._tabControl=u,n.clickSender=this,n.onclick=inputHeadOnClick,this.NavButton=new NavButton(n,this)},Tab.prototype.dispose=function(){this.Head=null,this.Page=null,this.Parent=null,this._tabControl=null,this.NavButton=null},Tab.prototype.Hidden=function(n){$(this.Head).attr("class").indexOf("disabled")==-1&&$(this.Head).attr("class","nav-item"),this.Page&&!n&&(this.Page.style.display="none")},Tab.prototype.Display=function(n){$(this.Head).attr("class","nav-item selected"),this.Page&&!n&&(this.Page.style.display="block")},Tab.prototype.GetIndex=function(){return this.Index},Tab.prototype.Onclick=function(){var r,args,PageId;if(_ClientCallBackManager&&_ClientCallBackManager.Runing||(r=this.Head,$(this.Head).attr("class").indexOf("disabled")>-1)||$(this.Head).attr("class").indexOf("selected")>-1)return!1;this._tabControl.get_CallPostBack()||(this.Parent.TabsHidden(this._tabControl.get_CallPostBack()),this.Display(this._tabControl.get_CallPostBack())),this._tabControl.SetSelected(this.Index),args=new UF.UI.ChangeEventArgs,args.TabIndex=this.GetIndex(),this._tabControl.raiseonTabClick(args),this._tabControl.get_CallPostBack()!=null?(BaseTop.NextCurrentContainer=this.Page,BaseTop.NextCurrentContainerDirection=!1,SetNextCurrentContainerValue(),eval(this._tabControl.get_CallPostBack()),PageId=$(this.Page).attr("id"),$("body").attr("tabOnclickID",PageId),_ClientJSExecQueueManager.Push('$("body").attr("tabOnclickID","")')):(PageId=$(this.Page).attr("id"),this._tabControl.SetFocus(this),this.DomProcess(PageId))},Tab.prototype.DomProcess=function(n){var t;if(TdSetHeightHelper.GetInstance($("#"+n).closest("td"),"yesTab").init(),t=$("#"+n).find(".dataGridMainBody"),t.length>0){var r=t.find("table"),i=t.find("thead"),u=i.find(".FixedColumnTitleCell").length,f=t[0].scrollLeft,e=t[0].scrollTop;GridFrozenColumnsHelper.GetInstance(t,r,i,u,f,e).init()}},Tab.prototype.OnNavButtonClick=function(buttonType){if(_ClientCallBackManager&&_ClientCallBackManager.Runing)return!1;this._tabControl.SetHiddenInfo(buttonType),this._tabControl.get_CallPostBack()!=null&&eval(this._tabControl.get_CallPostBack())},NavButton=function(n,t){if(n.className.indexOf("selected")>-1&&n.cusAttr("ShowNavButton")){this.PreButton=n.children[0],this.NextButton=n.children[2],this.Tab=t;var i=this;this.PreButton.clickSender=this;$(this.PreButton).on("click",function(){this.className.indexOf("disabled")<0&&$(this).parent().attr("class").indexOf("disabled")<0&&PreButton_OnClick.call(i.NextButton)});this.NextButton.clickSender=this;$(this.NextButton).on("click",function(){this.className.indexOf("disabled")<0&&$(this).parent().attr("class").indexOf("disabled")<0&&NextButton_OnClick.call(i.NextButton)})}},ParmaArr=[],Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.GlobalInput=function(n){UF.UI.GlobalInput.initializeBase(this,[n]),this._langCollection,this._textbox,this._button,this._hidden,this._dropDownDiv,this._curTable,this._maxLength,this._excludeTxtboxWidth=56,this._textboxchangeHandler,this._textboxkeypressHandler,this._textboxpasteHandler,this._textboxfocusHandler,this._textboxblurHandler,this._textboxKeyupHandler,this._buttonclickHandler,this._btnmouseoverHandler,this._btnmouseoutHandler,this._dropDownDivfocusoutHandler,this._dropDownDivkeydownHandler,this._divtextboxkeypressHandler,this._divtextboxpasteHandler,this._elementkeydownHandler,this._mouseElement},UF.UI.GlobalInput.prototype={initialize:function(){var n,t,i;for(UF.UI.GlobalInput.callBaseMethod(this,"initialize"),this._textbox=this._element.children[0],n=this._element.children.length-1;n>0;n--)this._element.children[n].id==this._element.id+"_button"&&(this._button=this._element.children[n]);for(n=this._element.children.length;n>0;n--)if(this._element.children[n-1].id==this.get_id()+"_Hidden"){this._hidden=this._element.children[n-1];break}this.btnClassName==null&&(this.btnClassName=GlobalInputTemplate.BtnClassName),this.btnClassName_Dis==null&&(this.btnClassName_Dis=GlobalInputTemplate.BtnClassName_Dis),t=this._textbox.cusAttr("MaxLength"),t||(i=this._textbox.getAttributeNode("MaxLength"),i&&i.value&&(t=Number(i.value))),this._maxLength=t,this._dropDownDiv=$get(this.get_id()+"_DropDown"),this._element.removeChild(this._dropDownDiv),window.document.body.appendChild(this._dropDownDiv),this.initControl(),this._elementkeydownHandler=Function.createDelegate(this,this.OnKeyDown),$addHandler(this._element,"keydown",this._elementkeydownHandler),this._dropDownDivfocusoutHandler=Function.createDelegate(this,this.DivFocusOut),$addHandler(this._dropDownDiv,"focusout",this._dropDownDivfocusoutHandler),this._dropDownDivkeydownHandler=Function.createDelegate(this,this.OnDivKeyDown),$addHandler(this._dropDownDiv,"keydown",this._dropDownDivkeydownHandler),this._textboxchangeHandler=Function.createDelegate(this,this.InputChange),$addHandler(this._textbox,"change",this._textboxchangeHandler),this._textboxkeypressHandler=Function.createDelegate(this,this.CheckMarkChar),$addHandler(this._textbox,"keypress",this._textboxkeypressHandler),this._textboxpasteHandler=Function.createDelegate(this,this.CheckMarkChars),$addHandler(this._textbox,"paste",this._textboxpasteHandler),this._textboxfocusHandler=Function.createDelegate(this,this.selectValues),$addHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxblurHandler=Function.createDelegate(this,this.InputBlur),$addHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxKeyupHandler=Function.createDelegate(this,this.OnKeyUp),$addHandler(this._textbox,"keyup",this._textboxKeyupHandler),this._buttonclickHandler=Function.createDelegate(this,this.displayDiv),$addHandler(this._button,"click",this._buttonclickHandler),this._element.cusAttr("Mask")?this._textbox.cusAttr("maskChars",MaskChar.Default+this._element.cusAttr("Mask")):this._textbox.cusAttr("maskChars",MaskChar.Default),isMasks(this._textbox.value,this._textbox.cusAttr("maskChars"))&&(this._textbox.value=this._textbox.cusAttr("SourceValue")),this.set_IsInitComlete(!0)},dispose:function(){this._elementkeydownHandler&&($removeHandler(this._element,"keydown",this._elementkeydownHandler),this._elementkeydownHandler=null),this._textboxchangeHandler&&($removeHandler(this._textbox,"change",this._textboxchangeHandler),this._textboxchangeHandler=null),this._textboxkeypressHandler&&($removeHandler(this._textbox,"keypress",this._textboxkeypressHandler),this._textboxkeypressHandler=null),this._textboxpasteHandler&&($removeHandler(this._textbox,"paste",this._textboxpasteHandler),this._textboxpasteHandler=null),this._textboxfocusHandler&&($removeHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxfocusHandler=null),this._textboxblurHandler&&($removeHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxblurHandler=null),this._textboxKeyupHandler&&($removeHandler(this._textbox,"keyup",this._textboxKeyupHandler),this._textboxKeyupHandler=null),this._buttonclickHandler&&($removeHandler(this._button,"click",this._buttonclickHandler),this._buttonclickHandler=null),this._btnmouseoverHandler&&($removeHandler(this._button,"mouseover",this._btnmouseoverHandler),this._btnmouseoverHandler=null),this._btnmouseoutHandler&&($removeHandler(this._button,"mouseout",this._btnmouseoutHandler),this._btnmouseoutHandler=null),this._dropDownDivfocusoutHandler&&($removeHandler(this._dropDownDiv,"focusout",this._dropDownDivfocusoutHandler),this._dropDownDivfocusoutHandler=null),this._dropDownDivkeydownHandler&&($removeHandler(this._dropDownDiv,"keydown",this._dropDownDivkeydownHandler),this._dropDownDivkeydownHandler=null);for(var n=0,t=this._langCollection.Items.length;n<t;n++)this._divtextboxkeypressHandler&&$removeHandler(this._langCollection.Items[n].TextBox,"keypress",this._divtextboxkeypressHandler),this._divtextboxpasteHandler&&$removeHandler(this._langCollection.Items[n].TextBox,"paste",this._divtextboxpasteHandler);this.curHandler!=null&&(this.curHandler=null),this._divtextboxkeypressHandler=null,this._divtextboxpasteHandler=null,this._langCollection&&(this._langCollection.dispose(),this._langCollection=null),this._textbox=null,this._button=null,this._hidden=null,window.document.body.removeChild(this._dropDownDiv),this._dropDownDiv=null,this._curTable=null,UF.UI.GlobalInput.callBaseMethod(this,"dispose")},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(n){var t=this.get_events().getHandler("onchange");t&&t(this,n)},add_OnValueChanged:function(n){this.get_events().addHandler("OnValueChanged",n)},remove_OnValueChanged:function(n){this.get_events().removeHandler("OnValueChanged",n)},raiseOnValueChanged:function(args){this._element.getAttribute("OnValueChanged")&&eval(this._element.getAttribute("OnValueChanged"));var eh=this.get_events().getHandler("OnValueChanged");eh&&eh(this,args)},fireValueChangeEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseOnValueChanged(n)}},add_OnValueChanged4P:function(n){this.get_events().addHandler("OnValueChanged4P",n)},remove_OnValueChanged4P:function(n){this.get_events().removeHandler("OnValueChanged4P",n)},raiseOnValueChanged4P:function(n){var t=this.get_events().getHandler("OnValueChanged4P");t&&(this.curHandler=t,t(this,n)),this.AfterRaiseOnValueChanged4Personal()},fireValueChange4PEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseOnValueChanged4P(n)}},initControl:function(){this._curTable=this._dropDownDiv.children[0],this._element.cusAttr("disabled")||(this._element.cusAttr("Mask")?this._textbox.cusAttr("maskChars",MaskChar.Default+this._element.cusAttr("Mask")):this._textbox.cusAttr("maskChars",MaskChar.Default)),this._langCollection=new ItemCollection,this._curTable&&this.InitialData()},selectValues:function(){var n=this;this.ControlFocus();try{this._textbox.select()}catch(t){}},InputBlur:function(){this.ControlBlur()},CheckMarkChars:function(){var t=event.srcElement,i=t.cusAttr("maskChars"),n;n=event?event.clipboardData.getData("text/plain"):window.clipboardData.getData("text"),isMasks(n,i)&&$Event(event).preventDefault()},CheckMarkChar:function(){var t=event.srcElement,n=t.cusAttr("maskChars");n!=""&&isMask(event.keyCode,n)&&$Event(event).preventDefault()},keyPress:function(){isMask(event.keyCode,this._element.cusAttr("Mask"))&&$Event(window.event).preventDefault()},CheckMaxLength:function(){this._textbox.value.length>this._maxLength&&(this._textbox.value=this._textbox.value.substr(0,this._maxLength))},get_ReadOnly:function(){return this._element.cusAttr("readOnly")},set_ReadOnly:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&this.get_Enabled()&&(n=ToBoolean(n),$(this._textbox).attr("readOnly",n),n?(this._textbox.className=this.tbClassName_R,this._button.className=this.btnClassName_Dis,this._element.className=UIControlClass.getReadOnlyCss(this._element)):(this._textbox.className=this.tbClassName,this._button.className=this.btnClassName,this._element.className=UIControlClass.getNotReadOnlyCss(this._element)),this._element.cusAttr("ReadOnly",n),this.set_HDValue("ReadOnly",n.toString().toLowerCase()),this.AfterSetReadOnly4Personal())},get_Type:function(){return ControlType.GlobalInput},set_Width:function(n){this._element.style.width=n+"px",this._textbox.style.width=n-18+"px"},SetFocus:function(){Basic.GridEditSetFocus(this._textbox)},set_Value:function(n){if(!isMasks(n,this._textbox.cusAttr("maskChars"))){var t=this._langCollection.GetSelectedItem();t!=null?t.TextBox.value=n:this._langCollection.Items.length>0&&(this._langCollection.Items[0].TextBox.value=n),this._textbox.value=n,this.CheckMaxLength(),this.SetHiddenFieldValue(),this.fireValueChangeEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0),this.fireValueChange4PEvent()}},SetHiddenFieldValue:function(){this._hidden.value=encodeURIComponent(this._langCollection.GetDatas())},get_Value:function(){return G_SplitLongString(G_Trim(this._textbox.value),this._maxLength)},AdjustPosition:function(){var c=this._textbox.getBoundingClientRect(),l=$E(this._element).document.body,t=this._dropDownDiv.style,u,i;t.display="";var n=this._element.getBoundingClientRect(),o=$E(this._element.parentElement).document.body.clientWidth,s=$E(this._element.parentElement).document.body.clientHeight,f=this._dropDownDiv.getBoundingClientRect().right-this._dropDownDiv.getBoundingClientRect().left,r=this._dropDownDiv.getBoundingClientRect().bottom-this._dropDownDiv.getBoundingClientRect().top,h=o+document.body.scrollLeft-(n.left+f),e=s+document.body.scrollTop-(n.bottom+r);h>=0?(t.left=n.left-2+"px",e>=0?t.top=n.bottom+document.body.scrollTop+"px":(i=n.top+document.body.scrollTop-2-r,t.top=i>0?i+"px":0)):(u=n.right-f,t.left=u>0?u+"px":0,e>=0?t.top=n.bottom+document.body.scrollTop+"px":(i=n.top-r,t.top=i>0?i+"px":0)),this._dropDownDiv.focus()},displayDiv:function(){var t,n,i;if(this._langCollection.Items.length!=1){if(ParmaArr.length>0&&(document.getElementById(ParmaArr[0]+"_DropDown").style.display="none",ParmaArr=[]),ParmaArr.push(this.get_id()),this._dropDownDiv.style.width="200px",this._dropDownDiv.style.zIndex=999,this.AdjustPosition(),t=this._langCollection.GetSelectedItem(),this.get_ReadOnly())for(n=0,i=this._langCollection.Items.length;n<i;n++)this._langCollection.Items[n].TextBox.readOnly=!0;else for(n=0,i=this._langCollection.Items.length;n<i;n++)this._langCollection.Items[n].TextBox.readOnly=!1;t!=null?(t.TextBox.focus(),t.TextBox.select()):this._langCollection.Items.length>0&&(this._langCollection.Items[0].TextBox.focus(),this._langCollection.Items[0].TextBox.select())}},eventHandler:function(n){$(document).click(function(t){var u=$(t.target),i="#"+ParmaArr[0]+"_DropDown",f="#"+ParmaArr[0]+"_button",r;u.is(""+i+","+i+" tr,"+i+" td,"+i+" input,"+i+" textarea,"+f+"")||(ParmaArr[0]&&(document.getElementById(ParmaArr[0]+"_DropDown").style.display="none"),ParmaArr.splice(0),$(document).unbind("click"),r=n._langCollection.GetSelectedItem(),r!=null&&(n._textbox.value=r.TextBox.value),n.SetHiddenFieldValue()),t.stopPropagation()})},DivFocusOut:function(){var t=null,n=this;setTimeout(function(){if(!n._dropDownDiv.contains(document.activeElement)){n.HiddenDiv();var t=n._langCollection.GetSelectedItem();t!=null&&(n._textbox.value=t.TextBox.value),n.SetHiddenFieldValue()}},0)},HiddenDiv:function(){this._dropDownDiv.style.display="none"},InitialData:function(){var t,r,n,i;for(this._divtextboxkeypressHandler=Function.createDelegate(this,this.CheckMarkChar),this._divtextboxpasteHandler=Function.createDelegate(this,this.CheckMarkChars),t=0,r=this._curTable.rows.length;t<r;t++)n=new Item(this),i=this._curTable.rows[t],n.ID=i.cells[0].children[0].value,n.TextBox=i.cells[2].children[0],n.TextBox.setAttribute("Index",t),$addHandler(n.TextBox,"keypress",this._divtextboxkeypressHandler),$addHandler(n.TextBox,"paste",this._divtextboxpasteHandler),n.maskChars=this._element.cusAttr("Mask")?MaskChar.Default+this._element.cusAttr("Mask"):MaskChar.Default,n.Radio=i.cells[0].children[0],n.Radio.disabled=!0,this._langCollection.Items.push(n);this.SetHiddenFieldValue()},changeFire:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseonchange(n)}},InputChange:function(){var i,n=$(this._textbox),t=this._langCollection.GetSelectedItem();(t!=null&&(n.val(this.RemoveMarkChars(n.val(),this._textbox.cusAttr("maskChars"))),this.CheckMaxLength(),i=t.TextBox.value,$(t.TextBox).val(n.val()),this.SetHiddenFieldValue()),i!=n.val())&&(this.changeFire(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this.fireValueChangeEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0),this.fireValueChange4PEvent())},OnKeyDown:function(){switch(window.event.keyCode){case KeyCode.F2:this.displayDiv(),$Event(event).preventDefault(),$Event(event).stopPropagation();break;case KeyCode.down:window.event.ctrlKey&&(this.displayDiv(),$Event(event).preventDefault(),$Event(event).stopPropagation());break;case KeyCode.tab:this.InputChange()}},OnKeyUp:function(){},OnDivKeyDown:function(){if(event.srcElement.tagName=="INPUT"&&event.srcElement.type=="text"||event.srcElement.tagName=="TEXTAREA"&&event.srcElement.type=="textarea"){var t=event.srcElement,n=parseInt(t.Index);switch(window.event.keyCode){case KeyCode.down:if(!window.event.ctrlKey)break;n==this._langCollection.Items.length-1?n=0:n++,this._langCollection.Items[n].TextBox.focus(),this._langCollection.Items[n].TextBox.select(),$Event(event).preventDefault(),$Event(event).stopPropagation();break;case KeyCode.up:if(!window.event.ctrlKey)break;n==0?n=this._langCollection.Items.length-1:n--,this._langCollection.Items[n].TextBox.focus(),this._langCollection.Items[n].TextBox.select(),$Event(event).preventDefault(),$Event(event).stopPropagation()}}switch(window.event.keyCode){case KeyCode.tab:case KeyCode.enter:this._textbox.focus(),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault()}},ClearData:function(){this._langCollection.ClearData(),$(this._textbox).val("")},LoadXml:function(n){this._langCollection.LoadXml(n);var t=this._langCollection.GetSelectedItem();t!=null&&$(this._textbox).val(t.TextBox.value)},SetMultiinputData:function(n){this.ClearData(),this._langCollection.LoadXml(n);var t=this._langCollection.GetSelectedItem();t!=null&&(this._textbox.value=t.TextBox.value)},GetMultiinputData:function(){return this._langCollection.GetDatas()},BtnMouseOver:function(){this._button.className=this.btnmouseOverClass},BtnMouseOut:function(){this._button.className=this.btnmouseOutClass}},UF.UI.GlobalInput.registerClass("UF.UI.GlobalInput",UF.UI.InputControl),Item=function(n){this.ID,this.TextBox,this.Radio,this._owner=n},Item.prototype.dispose=function(){this.TextBox=null,this.Radio=null,this._owner=null},Item.prototype.GetData=function(n){var t=n.createElement("Item");return this.Radio.checked==!0&&t.setAttribute("Checked","True"),t.setAttribute("Text",encodeURIComponent(this.TextBox.value)),t.setAttribute("ID",this.ID),t.setAttribute("Name",this._owner.get_id()),t},ItemCollection=function(){this.Items=[],this.DataDom},ItemCollection.prototype.dispose=function(){for(var n=0,t=this.Items.length;n<t;n++)this.Items[n].dispose();Array.clear(this.Items),this.Items=null,this.DataDom=null},ItemCollection.prototype.GetDatas=function(){var n,t,i;for(this.DataDom||(this.DataDom=Basic.GetXmlDom()),n=this.DataDom.createElement("Items"),t=0,i=this.Items.length;t<i;t++)n.appendChild(this.Items[t].GetData(this.DataDom));return this.DataDom.documentElement=n,XMLHelper.serializeXMLNodeToString(n)},ItemCollection.prototype.GetSelectedItem=function(){for(var n=0,t=this.Items.length;n<t;n++)if(this.Items[n].Radio.checked)return this.Items[n];return null},ItemCollection.prototype.ClearData=function(){for(var n=0,t=this.Items.length;n<t;n++)$(this.Items[n].TextBox).val("")},ItemCollection.prototype.LoadXml=function(n){var r,i,t;if(n&&n!="")for(this.DataDom=XMLHelper.createXMLDocument(n),r=this.DataDom.getElementsByTagName("Item"),i=0;i<r.length;i++){var u=r[i],f=u.getAttribute("ID"),e=u.getAttribute("Text");for(t=0;t<this.Items.length;t++)if(this.Items[t].ID==f){$(this.Items[t].TextBox).val(decodeURIComponent(e));break}}},GlobalInputTemplate.Enabled=InputControlTemplate.Enabled,GlobalInputTemplate.ReadOnly=InputControlTemplate.ReadOnly,GlobalInputTemplate.TBClassName=InputControlTemplate.TBClassName,GlobalInputTemplate.TBClassName_R=InputControlTemplate.TBClassName_R,GlobalInputTemplate.TBClassName_D=InputControlTemplate.TBClassName_D,GlobalInputTemplate.BtnClassName="btn GlobalBtn",GlobalInputTemplate.BtnClassName_Dis="btn GlobalBtn_Dis",Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.CheckBox=function(n){UF.UI.CheckBox.initializeBase(this,[n]),this._checkbox,this._checked,this._ReadOnly=!1,this._enabledEx=!0,this._clickHandler,this._ckClickHandler,this.clickHandlerAtServer=null,this._chkboxfocusHandler=null,this._chkboxblurHandler=null},UF.UI.CheckBox.prototype={initialize:function(){UF.UI.CheckBox.callBaseMethod(this,"initialize"),this._checkbox=this._element.childNodes[0],this._ReadOnly=this._element.cusAttr("ReadOnly")!=null?ToBoolean(this._element.cusAttr("ReadOnly")):ToBoolean(CheckBoxTemplate.ReadOnly),this._enabledEx=this._element.cusAttr("EnabledEx")!=undefined?ToBoolean(this._element.cusAttr("EnabledEx")):ToBoolean(CheckBoxTemplate.EnabledEx),this._checked=this.get_Checked(),this.clickHandlerAtServer=this._checkbox.onclick,this._chkboxfocusHandler=Function.createDelegate(this,this.ControlFocus),$addHandler(this._checkbox,"focus",this._chkboxfocusHandler),this._chkboxblurHandler=Function.createDelegate(this,this.ControlBlur),$addHandler(this._checkbox,"blur",this._chkboxblurHandler),this.ResetReadOnly(),this.ResetEnabledEx(),this.set_IsInitComlete(!0)},dispose:function(){this.cleanupEvent(),this.curHandler!=null&&(this.curHandler=null),this._checkbox=null,this.clickHandlerAtServer=null,this._enabledEx=null,UF.UI.CheckBox.callBaseMethod(this,"dispose")},cleanupEvent:function(){this._ckClickHandler&&$removeHandler(this._checkbox,"click",this._ckClickHandler),this._clickHandler&&$removeHandler(this._checkbox,"click",this._clickHandler),this._chkboxfocusHandler&&$removeHandler(this._checkbox,"focus",this._chkboxfocusHandler),this._chkboxblurHandler&&$removeHandler(this._checkbox,"blur",this._chkboxblurHandler),this._chkboxblurHandler=null,this._chkboxfocusHandler=null,this._clickHandler=null,this._ckClickHandler=null},cleanupServerEvent:function(){this._checkbox.onclick=null},resumeServerEvent:function(){this._checkbox.onclick=this.clickHandlerAtServer},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(n){var t=this.get_events().getHandler("onchange");t&&t(this,n)},fireonchangedEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._checkbox.checked,this.raiseonchange(n)}},add_OnValueChanged4P:function(n){this.get_events().addHandler("OnValueChanged4P",n)},remove_OnValueChanged4P:function(n){this.get_events().removeHandler("OnValueChanged4P",n)},raiseOnValueChanged4P:function(n){var t=this.get_events().getHandler("OnValueChanged4P");t&&(this.curHandler=t,t(this,n)),this.AfterRaiseOnValueChanged4Personal()},fireValueChange4PEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._checkbox.checked,this.raiseOnValueChanged4P(n)}},add_onclick:function(n){this.get_events().addHandler("onclick",n)},remove_onclick:function(n){this.get_events().removeHandler("onclick",n)},raiseonclick:function(n){var t=this.get_events().getHandler("onclick");t&&t(this,n)},get_Type:function(){return ControlType.CheckBox},get_Value:function(){return this.get_Checked()},set_Value:function(n){this.set_Checked(n)},get_Checked:function(){return this._checkbox.checked},set_Checked:function(n){typeof n=="string"&&(n=n.toString().toLowerCase(),n=ToBoolean(n)),this._checked!=n&&(this._checkbox.checked=n,this.fireonchangedEvent(),this.fireValueChange4PEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this._checked=n)},set_Enabled:function(n){n=ToBoolean(n),this.set_ReadOnly(!n)},get_EnabledEx:function(){return this._enabledEx},set_EnabledEx:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&(n=ToBoolean(n),this._enabledEx=n,this.ResetEnabledEx())},ResetEnabledEx:function(){var i=!this.get_EnabledEx(),n,t,r;if(this._element.cusAttr("disabled",i),n=this._element.childNodes,n)for(t=0,r=n.length;t<r;t++)$(n[t]).attr("disabled",i)},get_ReadOnly:function(){return this._ReadOnly},set_ReadOnly:function(n){if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")){n=ToBoolean(n),this._ReadOnly=n;var t=UIControlClass.getReadOnlyCss(this._element);n||(t=UIControlClass.getNotReadOnlyCss(this._element)),this._element.className=t,this.ResetReadOnly(),this.set_HDValue("ReadOnly",n.toString().toLowerCase()),this.AfterSetReadOnly4Personal()}},ResetReadOnly:function(){this._clickHandler&&($removeHandler(this._checkbox,"click",this._clickHandler),this._clickHandler=null),this._ckClickHandler&&($removeHandler(this._checkbox,"click",this._ckClickHandler),this._ckClickHandler=null),this._ReadOnly?(this._ckClickHandler=Function.createDelegate(this,this.ckClick),$addHandler(this._checkbox,"click",this._ckClickHandler),this.cleanupServerEvent()):(this._clickHandler=Function.createDelegate(this,this.changePD),$addHandler(this._checkbox,"click",this._clickHandler),this.resumeServerEvent())},ckClick:function(){var n=$Event(event);return n.stopPropagation(),n.preventDefault(),!1},changePD:function(){this.fireonchangedEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0),this._checked=this._checkbox.checked;var n=new UF.UI.ChangeEventArgs;n.value=this._checkbox.checked,this.raiseonclick(n),window.setTimeout("$find('"+this.get_element().id+"').fireValueChange4PEvent()",0)},ControlFocus:function(){this.hf="1"},ControlBlur:function(){this.hf="0"},MouseOver:function(){},MouseOut:function(){}},UF.UI.CheckBox.registerClass("UF.UI.CheckBox",UF.UI.InputControl),CheckBoxTemplate.Enabled=InputControlTemplate.Enabled,CheckBoxTemplate.ReadOnly=InputControlTemplate.ReadOnly,CheckBoxTemplate.EnabledEx="true",Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.DateTimePicker=function(n){UF.UI.DateTimePicker.initializeBase(this,[n]),this.initDateTime=new Date;var t=this;this._textbox,this._button,this._popup,this._show=!1,this.calID,this.isInit=!0,this._date,this._formatString,this._cultureName,this.const_CalendarWidth=220,this.const_Calendarheight=170,this._buttonclickHandler,this._btnmouseoverHandler,this._btnmouseoutHandler,this._textboxchangeHandler,this._textboxfocusHandler,this._textboxblurHandler,this._elementkeyDownHandler,this._isAM,this._isPM,this._timeSeparator,this._isCustomDateTimeFormat="false",this._customDateTimeFormat="...",this.serverDateTime,this._isShowedInvalidMessage=null,this._hiddenValue=null,this.onSelect=function(n){var i=t._date,u=n.dateClicked,r;if(u){if(t.get_FormatString()=="F"||t.get_FormatString()=="G"||t.get_FormatString()=="g"){var o=new Date,f=new Date(n._calendarDate.year,n._calendarDate.month,n._calendarDate.day),e=Date$toFormattedStringEx(f,"d",t.get_CultureName().toLowerCase());t._textbox.value=e+" "+n._calendarDate.time,t.inputChange()}else r=new Date(n._calendarDate.year,n._calendarDate.month,n._calendarDate.day),t.validInputDate(r)&&t.set_Value(r),i==null&&t._date!=null||i!=null&&t._date==null?(t.fireChangeEvent(),t.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&t.set_IsChanged(!0)):i&&t._date&&i.toString()!=t._date.toString()&&(t.fireChangeEvent(),t.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&t.set_IsChanged(!0));if(n.callCloseHandler(),!t._button)return;t._button.className="btn DateBtn"}Basic.SetFocus(t._textbox)},this.onClose=function(n){n.hide(),t._popup=null,Basic.SetFocus(t._textbox)}},UF.UI.DateTimePicker.prototype={initialize:function(){var i,t,n,r,u;for(UF.UI.DateTimePicker.callBaseMethod(this,"initialize"),i=this._element.cusAttr("Value"),i&&parseInt(i.split("-")[0],10)>=100&&(re=/-/g,intDate=i.replace(re,"/"),this._date=new Date(intDate)),this._textbox=this._element.children[0],n=this._element.children.length-1;n>0;n--)this._element.children[n].id==this._element.id+"_button"&&(this._button=this._element.children[n]);for(n=this._element.children.length-1;n>0;n--)this._element.children[n].id==this._element.id+"_HTV"&&(this._hiddenValue=this.get_element().children[n]);if(this.btnClassName==null&&(this.btnClassName=DateTimePickerTemplate.BtnClassName),this.btnClassName_Dis==null&&(this.btnClassName_Dis=DateTimePickerTemplate.BtnClassName_Dis),this.isInit=!1,this.calID=this.get_id(),this._formatString=this._element.cusAttr("FormatString"),this._isCustomDateTimeFormat=this._element.cusAttr("IsCustomDateTimeFormat"),this._customDateTimeFormat=this._element.cusAttr("CustomDateTimeFormat"),this._isCustomDateTimeFormat&&this._isCustomDateTimeFormat.toLowerCase()=="true"&&(this._textbox.value=this._customDateTimeFormat,this._date=null),t=new Date,t=Date$parseEx(t,t.toString(),this.get_FormatString(),this.get_CultureName().toLowerCase()),this._ShowControlBindingInfoTitle&&(this._textbox.title=t.getDateTimePattern(this.get_FormatString(),this.get_CultureName().toLowerCase())),this.get_FormatString()=="T"&&(this._button.style.visibility="hidden"),this._timeSeparator=this.get_TimeSeparator(this.get_CultureName().toLowerCase()),this._elementkeyDownHandler=Function.createDelegate(this,this.onkeyDown),$addHandler(this._element,"keydown",this._elementkeyDownHandler),this._buttonclickHandler=Function.createDelegate(this,this.button_click),$addHandler(this._button,"click",this._buttonclickHandler),this._textboxchangeHandler=Function.createDelegate(this,this.inputChange),$addHandler(this._textbox,"change",this._textboxchangeHandler),this._textboxfocusHandler=Function.createDelegate(this,this.TextBoxFocus),$addHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxblurHandler=Function.createDelegate(this,this.TextBoxBlur),$addHandler(this._textbox,"blur",this._textboxblurHandler),isReadOnly=this._element.cusAttr("ReadOnly")?!0:ToBoolean(DateTimePickerTemplate.ReadOnly),isReadOnly)for(this._element.children[0].readOnly=isReadOnly,n=1,r=this._element.children.length;n<r;n++)this._element.children[n].disabled=isReadOnly;u=this._element.cusAttr("R").toLowerCase()=="y"?!0:!1,this.DisplayRequiredFlag(u),this.set_IsInitComlete(!0),this._hiddenValue.disabled=!1},ConvertToDate:function(n){var t=null,i=this.get_FormatString(),r=this.get_CultureName().toLowerCase();return t=Date$parseEx(new Date,n,i,r)},ConvertToString:function(n){var t="",i=this.get_FormatString(),r=this.get_CultureName().toLowerCase();return t=Date$toFormattedStringEx(n,i,r)},dispose:function(){this._elementkeyDownHandler&&($removeHandler(this.get_element(),"keydown",this._elementkeyDownHandler),this._elementkeyDownHandler=null),this._buttonclickHandler&&($removeHandler(this._button,"click",this._buttonclickHandler),this._buttonclickHandler=null),this._btnmouseoverHandler&&($removeHandler(this._button,"mouseover",this._btnmouseoverHandler),this._btnmouseoverHandler=null),this._btnmouseoutHandler&&($removeHandler(this._button,"mouseout",this._btnmouseoutHandler),this._btnmouseoutHandler=null),this._textboxchangeHandler&&($removeHandler(this._textbox,"change",this._textboxchangeHandler),this._textboxchangeHandler=null),this._textboxfocusHandler&&($removeHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxfocusHandler=null),this._textboxblurHandler&&($removeHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxblurHandler=null),this.curHandler!=null&&(this.curHandler=null),this._textbox=null,this._button=null,this._popup=null,this._date=null,this._isAM=null,this._isPM=null,this._timeSeparator=null,this._isCustomDateTimeFormat=null,this._customDateTimeFormat=null,this.initDateTime=null,this.serverDateTime=null,UF.UI.DateTimePicker.callBaseMethod(this,"dispose")},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(args){this._element.getAttribute("onchange")&&eval(this._element.getAttribute("onchange"));var eh=this.get_events().getHandler("onchange");eh&&eh(this,args)},fireChangeEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseonchange(n),this.fireValueChangeEvent(),this.fireValueChange4PEvent()}},add_OnValueChanged:function(n){this.get_events().addHandler("OnValueChanged",n)},remove_OnValueChanged:function(n){this.get_events().removeHandler("OnValueChanged",n)},raiseOnValueChanged:function(n){var t=this.get_events().getHandler("OnValueChanged");t&&t(this,n),this.AfterRaiseOnValueChanged4Personal()},fireValueChangeEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseOnValueChanged(n)}},add_OnValueChanged4P:function(n){this.get_events().addHandler("OnValueChanged4P",n)},remove_OnValueChanged4P:function(n){this.get_events().removeHandler("OnValueChanged4P",n)},raiseOnValueChanged4P:function(n){var t=this.get_events().getHandler("OnValueChanged4P");t&&(this.curHandler=t,t(this,n)),this.AfterRaiseOnValueChanged4Personal()},fireValueChange4PEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseOnValueChanged4P(n)}},get_ReadOnly:function(){return this._element.cusAttr("ReadOnly")},set_ReadOnly:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&this.get_Enabled()&&(n=ToBoolean(n),this._textbox&&$(this._textbox).attr("readOnly",n),this._button&&$(this._button).attr("readOnly",n),n?(this._textbox.className=this.tbClassName_R,this._button.className=this.btnClassName_Dis,this._button.disabled=!0,this._element.className=UIControlClass.UFTextBox.ReadOnlyCssClass):(this._textbox.className=this.tbClassName,this._button.className=this.btnClassName,this._button.disabled=!1,this._element.className=UIControlClass.UFTextBox.CssClass),this._element.cusAttr("ReadOnly",n),this.btnmouseOutClass=this._button.className,this.set_HDValue("ReadOnly",n.toString().toLowerCase()),this.AfterSetReadOnly4Personal())},get_Type:function(){return ControlType.DateTime},set_Width:function(n){this._element.style.width=n+"px",this._textbox.style.width=n-18+"px"},SetFocus:function(){Basic.GridEditSetFocus(this._textbox)},get_Value:function(){return this.get_IsCustomDateTimeFormat()=="true"?null:this.getDateYmdHms()},set_Value:function(n){if(this.get_IsCustomDateTimeFormat()!="true"&&n!=this._date){var t=this._date;if(typeof n=="string"?n==""||isNaN(new Date(this.fromymd2mdy(n)))?(this._date=null,this._hiddenValue.value=""):(n=this.fromymd2mdy(n),this._date=new Date(n),this.set_HiddenValue(),this._date.getFullYear()==1753&&this._date.getMonth()==0&&this._date.getDate()==1&&(this._date.setDate(this._date.getDate()+1),this.set_HiddenValue())):(n!=null&&(this.get_FormatString()=="D"||this.get_FormatString()=="d")&&n.setHours(0,0,0),this._date=n,this._date?(this._date.getFullYear()==1753&&this._date.getMonth()==0&&this._date.getDate()==1&&this._date.setDate(this._date.getDate()+1),this.set_HiddenValue()):this._hiddenValue.value=""),this.isInit){this._textbox.value=this.get_Text();return}this._textbox.value=this.get_Text(),this._isShowedInvalidMessage&&(RemoveErrorMsgElment(this.get_id(),this.get_element()),this._isShowedInvalidMessage=!1),this.fireValueChangeEvent(),this.fireValueChange4PEvent()}},set_HiddenValue:function(){var t="",n;this.get_FormatString()=="D"||this.get_FormatString()=="d"?this._hiddenValue.value!=""&&(n=new Date(this.fromymd2mdy(this._hiddenValue.value)),t=" "+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()):t=String.format(" {0}:{1}:{2}",this.get_ValueIns().getHours(),this.get_ValueIns().getMinutes(),this.get_ValueIns().getSeconds()),this._hiddenValue.value=this.get_ValueIns().getFullYear()+"-"+(this.get_ValueIns().getMonth()+1)+"-"+this.get_ValueIns().getDate()+t},get_Text:function(){return this.get_IsCustomDateTimeFormat()=="true"?this.get_CustomDateTimeFormat():this.get_ValueIns()?Date$toFormattedStringEx(this.get_ValueIns(),this.get_FormatString(),this.get_CultureName().toLowerCase()):""},set_Text:function(n){this.get_IsCustomDateTimeFormat()!="true"&&(this._textbox.value=n)},get_FormatString:function(){return this._formatString},set_FormatString:function(n){this._formatString=n},get_CultureName:function(){return getCultureName()},set_CultureName:function(n){this._cultureName=n},get_TimeSeparator:function(n){var t,i;try{n=n.toLowerCase(),t=Sys.CultureInfo[n].DateTimeFormat,i=t.TimeSeparator}catch(r){}return i},showIllegalInputWarningMsg:function(){var t,u,f,i;this._isShowedInvalidMessage&&(RemoveErrorMsgElment(this.get_id(),this._element),this._isShowedInvalidMessage=!1);var r=new Date,e=r.getHours()+":"+r.getMinutes()+":"+r.getSeconds(),n=Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_DateTimeIllegal;n=n.replace(/\$time\$/g,e),t=this.get_element().getAttribute("LC"),t==null||t==""||$get(t)==null?this._element.parentNode.className.split(" ")[0]=="tbc"?(u=GetParentGrid(this.get_id()),f="",u&&(i=u.control,f=i.getColumnHeadCell(i.m_currentColumnIndex,i.MainCols[i.m_currentColumnIndex].FieldID).outerText),n=n.replace(/\$title\$/g,f)):n=n.replace(/\$title\$/g,""):n=n.replace(/\$title\$/g,$get(t).title),n=n.replace(/\$value\$/g,"'"+this._textbox.value+"'"),this.ShowWarnMsg(n),this._isShowedInvalidMessage=!0},ShowWarnMsg:function(n){this._element.parentNode.className.split(" ")[0]=="tbc"?showStatus(n):CreateWarnMsg(n,this._element)},reviseInputText:function(n){var t=this.get_FormatString();if(!(t=="d"||t=="D"||t=="F"||t=="G"||t=="s"||t=="g")||n.length>2)return n;var i=new Date,r=i.getFullYear(),u=i.getMonth()+1;return String.format("{0} {1} {2}",r,u,n)},inputChange:function(){var r=this._date,i=$(this._textbox),u,n,e,t;if(i.val()==""){this.set_Value(null),r!=this._date&&(this.fireChangeEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0));return}if(u=this.get_ValueIns(),this.get_ValueIns()||(u=new Date),n=this.wideChars2NarrowChars(i.val()),this.get_FormatString()==="G"&&typeof n=="string"&&(n.length===8||n.length===7)&&n.indexOf(" ")===-1){var l=n.substring(0,4),a=n.substring(4,6),v=n.substring(6,8);n=String.format("{0} {1} {2}",l,a,v)}if(n=this.reviseInputText(n),n=this.validateInputDate(n,this.get_FormatString()),this.get_FormatString()==="T"&&(n=n.replace(":"," "),(n.split(" ").length===2||n.split(" ").length===3&&n.split(" ")[2]==="")&&(n+=" 0")),n=="")this.showIllegalInputWarningMsg(),i.val(this.get_Text()),e=this._textbox.getAttribute("onchange"),e&&e.toString().indexOf("__doPostBack")>=0&&(window._NotFirePostBackControl=i.attr("id").replace(/_/g,"$"));else if(this._isShowedInvalidMessage&&(RemoveErrorMsgElment(this.get_id(),this.get_element()),this._isShowedInvalidMessage=!1),this.get_FormatString()=="F"||this.get_FormatString()=="G"||this.get_FormatString()=="g"){var s=n.split(" "),y=s[0],p=s[1],o=p.split(this._timeSeparator),h=parseInt(o[0],10),c=parseInt(o[1],10),f=0;if(this.get_FormatString()!=="g"&&(f=parseInt(o[2],10)),t=Date$parseEx(u,y,this.get_FormatString(),this.get_CultureName().toLowerCase()),u!=null&&t==null){i.val(this.get_Text());return}if(isNaN(h)||(t.setHours(0),t.setHours(h)),isNaN(c)||(t.setMinutes(0),t.setMinutes(c)),isNaN(f)||(t.setSeconds(0),t.setSeconds(f)),isNaN(f&&this.get_FormatString()!="g")||(t.setSeconds(0),t.setSeconds(f)),!this.validInputDate(t)){i.val(this.get_Text());return}this._date=t,this._hiddenValue.value=this._date.format("yyyy-MM-dd HH:mm:ss"),i.val(this.get_Text())}else{if(t=Date$parseEx(u,n,this.get_FormatString(),this.get_CultureName().toLowerCase()),this.get_FormatString()!="T"&&!this.validInputDate(t)){i.val(this.get_Text());return}t?this.set_Value(t):i.val(this.get_Text())}r==null&&this._date!=null||r!=null&&this._date==null?(this.fireChangeEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0)):r&&this._date&&r.toString()!=this._date.toString()&&(this.fireChangeEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsChanged(!0))},fromymd2mdy:function(n){var u;if(n){if(n.charAt(4)=="-"){var r=n.substr(0,4),t=n.substr(5),i=t.indexOf(" ");i>0?(u=t.substring(0,i),n=u+"-"+r+t.substr(i)):n=t+"-"+r}return n}},validateInputDate:function(n,t){if(t=="d"||t=="D"||t=="F"||t=="G"||t=="s"||t=="g"){var i=this.AnalysisInputDate(n);if(!i.ok)return"";n=this.ConvertToString(i.date)}return n},AnalysisInputDate:function(n){var t={},r,i,u,o,f,e;t.ok=!0,t.year="",t.month="",t.day="";try{if(r=n.split(/[-* *]/),r.removeAll(""),r.length==1?(n.length<6?t.ok=!1:(t.year=n.substring(0,4),n.length==8?(t.month=n.substring(4,6),t.day=n.substring(6,8)):n.length==6?(t.month=n.substring(4,5),t.day=n.substring(5,6)):n.length==7?(t.month=n.substring(4,5),t.day=n.substring(5,7)):t.ok=!1),t.date=new Date(t.month+"-"+t.day+"-"+t.year)):r.length==3||r.length==4?(i=this.ConvertToDate(n),i!=null?(t.year=i.getFullYear().toString(),t.month=i.getMonth().toString(),t.day=i.getDate().toString(),t.date=i):t.ok=!1):t.ok=!1,t.time!=null&&t.time.length>0)for(u=t.time.split(this._timeSeparator),this._isPM&&(o=parseInt(u[0],10)+12,u[0]=o.toString()),t.time="",f=0,e=u.length;f<e;f++)t.time+=u[f],f<e-1&&(t.time+=this._timeSeparator)}catch(s){t.ok=!1}return t},wideChars2NarrowChars:function(n){var i,t;for(this.setFlag4AMPM(n),i="",t=0;t<n.length;t++)i+=this.wideChar2NarrowChar(n.substr(t,1));return i},setFlag4AMPM:function(n){n.indexOf("上午")>-1&&(this._isAM=!0,this._isPM=!1),n.indexOf("下午")>-1&&(this._isAM=!1,this._isPM=!0),n.indexOf("AM")>-1&&(this._isAM=!0,this._isPM=!1),n.indexOf("PM")>-1&&(this._isAM=!1,this._isPM=!0)},wideChar2NarrowChar:function(n){var i=escape(n),t;switch(i){case"0":t="0";break;case"1":t="1";break;case"2":t="2";break;case"3":t="3";break;case"4":t="4";break;case"5":t="5";break;case"6":t="6";break;case"7":t="7";break;case"8":t="8";break;case"9":t="9";break;case"%3A":t=":";break;case"%uFF10":t="0";break;case"%uFF11":t="1";break;case"%uFF12":t="2";break;case"%uFF13":t="3";break;case"%uFF14":t="4";break;case"%uFF15":t="5";break;case"%uFF16":t="6";break;case"%uFF17":t="7";break;case"%uFF18":t="8";break;case"%uFF19":t="9";break;case"%u3000":t=" ";break;case"%uFF0D":t="_";break;case"%uFF1A":t=":";break;case escape(this._timeSeparator):t=this._timeSeparator;break;default:t=" "}return t},getDateYmdHms:function(){if(!this.get_ValueIns())return"";var n=this.get_ValueIns().getFullYear()+"-"+(this.get_ValueIns().getMonth()+1)+"-"+this.get_ValueIns().getDate();return this.get_FormatString()!="D"&&(n+=" "+this.get_ValueIns().getHours()+":"+this.get_ValueIns().getMinutes()+":"+this.get_ValueIns().getSeconds()),n},get_elemPopup:function(){if(window._dynarch_popupCalendar==null&&(this._popup=null),this._popup==null){if(!this.serverDateTime){var t=this._element.cusAttr("ServerDateTime"),n=t.split("-");n[1]=n[1]-1,this.serverDateTime=new Date(n[0],n[1],n[2],n[3],n[4],n[5])}this._popup=new Calendar(this.get_ValueIns(),this.get_CultureName().toLowerCase(),this.onSelect,this.onClose,this.calID,this)}return this._popup},get_ValueIns:function(){return this._date},get_ValueInsWithoutMS:function(){if(this._date==null)return null;return new Date(this._date.getFullYear(),this._date.getMonth(),this._date.getDate(),this._date.getHours(),this._date.getMinutes(),this._date.getSeconds(),0)},get_ValueNumberWithoutMS:function(){return this.get_ValueInsWithoutMS()-0},TextBoxFocus:function(){var n=this;this.ControlFocus(),this._textbox&&this._textbox.select()},TextBoxBlur:function(){this.ControlBlur(),this._textbox.value=this._textbox.value},BtnMouseOver:function(){this._button.className=this.btnmouseOverClass},BtnMouseOut:function(){this._button.className=this.btnmouseOutClass},button_click:function(){if(this.get_elemPopup().show)this.get_elemPopup().callCloseHandler();else{var n=this.getBoundingClientRect(),r=document.body.clientWidth,u=document.body.clientHeight,t=r-(n.left+this.const_CalendarWidth),i=u-(n.top+this._element.clientHeight+this.const_Calendarheight);t>=0&&i>=0?this.get_elemPopup().showAt(n.left-2,n.top+document.body.scrollTop+this._element.clientHeight):t>=0&&i<0?n.top>this.const_Calendarheight?this.get_elemPopup().showAt(n.left-2,n.top+document.body.scrollTop-2-this.const_Calendarheight):this.get_elemPopup().showAt(n.left-2,0):t<0&&i>=0?n.right>=this.const_CalendarWidth?this.get_elemPopup().showAt(n.right-this.const_CalendarWidth,n.top+this._element.clientHeight):this.get_elemPopup().showAt(0,n.top+this._element.clientHeight):t<0&&i<0&&(n.right>=this.const_CalendarWidth?n.top>this.const_Calendarheight?this.get_elemPopup().showAt(n.right-this.const_CalendarWidth,n.top-this.const_Calendarheight):this.get_elemPopup().showAt(n.right-this.const_CalendarWidth,0):n.top>this.const_Calendarheight?this.get_elemPopup().showAt(0,n.top-this.const_Calendarheight):this.get_elemPopup().showAt(0,0))}},onkeyDown:function(){if(!this.get_ReadOnly())switch(window.event.keyCode){case KeyCode.F2:this.button_click(),window.$Event(event).stopPropagation();break;case KeyCode.down:window.event.ctrlKey&&(this.button_click(),window.$Event(event).stopPropagation());break;case KeyCode.tab:case KeyCode.enter:this.inputChange()}},getBoundingClientRect:function(){return this.get_element().getBoundingClientRect()},validInputDate:function(n){var t,i,r,u,f;return this._element?(t=this._element.cusAttr("MaxDate"),i=this._element.cusAttr("MinDate"),t||(t="9999-12-31 23:59:59"),i||(i="1753-1-2"),r=new Date(n),isNaN(r))?!1:(u=new Date(this.fromymd2mdy(t)),u!=null&&r>u)?!1:(f=new Date(this.fromymd2mdy(i)),f!=null&&r<f)?!1:!0:!1},get_TextFromInput:function(){return this._textbox.value},set_IsCustomDateTimeFormat:function(n){this._isCustomDateTimeFormat=n!=null&&n.toLowerCase()=="true"?"true":"false"},get_IsCustomDateTimeFormat:function(){return this._isCustomDateTimeFormat},set_CustomDateTimeFormat:function(n){this._customDateTimeFormat=n!=null?n.toString():""},get_CustomDateTimeFormat:function(){return this._customDateTimeFormat}},UF.UI.DateTimePicker.registerClass("UF.UI.DateTimePicker",UF.UI.InputControl),DateTimePickerTemplate.Enabled=InputControlTemplate.Enabled,DateTimePickerTemplate.ReadOnly=InputControlTemplate.ReadOnly,DateTimePickerTemplate.TBClassName=InputControlTemplate.TBClassName,DateTimePickerTemplate.TBClassName_R=InputControlTemplate.TBClassName_R,DateTimePickerTemplate.TBClassName_D=InputControlTemplate.TBClassName_D,DateTimePickerTemplate.BtnClassName="btn DateBtn",DateTimePickerTemplate.BtnClassName_Dis="btn DateBtn_Dis",Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.TextBox=function(n){UF.UI.TextBox.initializeBase(this,[n]),this._textbox,this.$element,this._$textbox,this._CaseSensitive=!1,this._IsSelectText=!0,this._textboxblurHandler,this._textboxchangeHandler,this._textboxkeypressHandler,this._textboxpasteHandler,this._textboxfocusHandler,this._textboxkeypress4CaseSensitiveHandler,this._masked=!1,this._isOnChangedFired=!1},UF.UI.TextBox.prototype={initialize:function(){UF.UI.TextBox.callBaseMethod(this,"initialize"),this._textbox=this.get_element().childNodes[0],this._$textbox=$(this._textbox),this.$element=$(this._element);var n=this._element.cusAttr("r")=="y"?!0:!1;this.DisplayRequiredFlag(n),this._textboxchangeHandler=Function.createDelegate(this,this.changePD),$addHandler(this._textbox,"change",this._textboxchangeHandler),this._textboxblurHandler=Function.createDelegate(this,this.blurPD),$addHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxfocusHandler=Function.createDelegate(this,this.selectValues),$addHandler(this._textbox,"focus",this._textboxfocusHandler),this._masked=this._element.cusAttr("masked")?ToBoolean(this._element.cusAttr("masked")):ToBoolean(TextBoxTemplate.Masked),this._IsSelectText=this._element.cusAttr("selecttext")?ToBoolean(this._element.cusAttr("selecttext")):ToBoolean(TextBoxTemplate.SelectText),this._CaseSensitive=this._element.cusAttr("casesensitive")?ToBoolean(this._element.cusAttr("casesensitive")):ToBoolean(TextBoxTemplate.CaseSensitive),this._CaseSensitive||(this._textboxkeypress4CaseSensitiveHandler=Function.createDelegate(this,this.keyPressCaseSensitive),$addHandler(this._textbox,"keypress",this._textboxkeypress4CaseSensitiveHandler)),this._masked&&(this._textboxkeypressHandler=Function.createDelegate(this,this.CheckMarkChar),$addHandler(this._textbox,"keypress",this._textboxkeypressHandler),this._textboxpasteHandler=Function.createDelegate(this,this.CheckMarkChars),$addHandler(this._textbox,"paste",this._textboxpasteHandler),this._element.cusAttr("mask")?this._textbox.cusAttr("maskChars",this._element.cusAttr("mask")+MaskChar.Default):this._textbox.cusAttr("maskChars",MaskChar.Default),isMasks(this._textbox.value,this._textbox.cusAttr("maskChars"))&&(this._textbox.value=this._textbox.cusAttr("SourceValue"))),this._textbox.getAttribute("onchange")&&$(this._textbox).bind("blur",function(){window._TextBoxFirePostBack=!0,window.setTimeout("window._TextBoxFirePostBack = false;",200)}),this.set_IsInitComlete(!0)},dispose:function(){this._textboxblurHandler&&($removeHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxblurHandler=null),this._textboxchangeHandler&&($removeHandler(this._textbox,"change",this._textboxchangeHandler),this._textboxchangeHandler=null),this._textboxkeypressHandler&&($removeHandler(this._textbox,"keypress",this._textboxkeypressHandler),this._textboxkeypressHandler=null),this._textboxkeypress4CaseSensitiveHandler&&($removeHandler(this._textbox,"keypress",this._textboxkeypress4CaseSensitiveHandler),this._textboxkeypress4CaseSensitiveHandler=null),this._textboxpasteHandler&&($removeHandler(this._textbox,"paste",this._textboxpasteHandler),this._textboxpasteHandler=null),this._textboxfocusHandler&&($removeHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxfocusHandler=null),this.curHandler!=null&&(this.curHandler=null),this._textbox=null,UF.UI.TextBox.callBaseMethod(this,"dispose")},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(n){var t=this.get_events().getHandler("onchange");t&&t(this,n)},add_OnValueChanged:function(n){this.get_events().addHandler("OnValueChanged",n)},remove_OnValueChanged:function(n){this.get_events().removeHandler("OnValueChanged",n)},raiseOnValueChanged:function(args){this.get_element().getAttribute("OnValueChanged")&&eval(this.get_element().getAttribute("OnValueChanged"));var eh=this.get_events().getHandler("OnValueChanged");eh&&eh(this,args)},add_OnValueChanged4P:function(n){this.get_events().addHandler("OnValueChanged4P",n)},remove_OnValueChanged4P:function(n){this.get_events().removeHandler("OnValueChanged4P",n)},raiseOnValueChanged4P:function(n){var t=this.get_events().getHandler("OnValueChanged4P");t&&(this.curHandler=t,t(this,n)),this.AfterRaiseOnValueChanged4Personal()},add_onblur:function(n){this.get_events().addHandler("onblur",n)},remove_onblur:function(n){this.get_events().removeHandler("onblur",n)},raiseonblur:function(n){var t=this.get_events().getHandler("onblur");t&&t(this,n)},add_onkeypress:function(n){this.get_events().addHandler("onkeypress",n)},remove_onkeypress:function(n){this.get_events().removeHandler("onkeypress",n)},raiseonkeypress:function(n){var t=this.get_events().getHandler("onkeypress");t&&t(this,n)},get_Type:function(){return ControlType.TextBox},set_Enabled:function(n){if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")){n=ToBoolean(n),this._element.cusAttr("disabled",!n);for(var t=0,i=this.get_element().children.length;t<i;t++)$(this._element.children[t]).attr("disabled",!n),this._element.className=n?UIControlClass.UFTextBox.CssClass:UIControlClass.UFTextBox.ReadOnlyCssClass}},get_ReadOnly:function(){return this._element.cusAttr("readOnly")},set_ReadOnly:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&this.get_Enabled()&&(n=ToBoolean(n),this._element.cusAttr("readOnly",n),n?(this._textbox.className=InputControlTemplate.TBClassName_R,this._element.className=UIControlClass.UFTextBox.ReadOnlyCssClass,$(this._textbox).attr("readOnly","readOnly")):(this._textbox.className=InputControlTemplate.TBClassName,this._element.className=UIControlClass.UFTextBox.CssClass,$(this._textbox).removeAttr("readOnly")),this.set_HDValue("ReadOnly",n.toString().toLowerCase()),this.AfterSetReadOnly4Personal())},get_Value:function(){return G_Trim(this._textbox.value)},set_Value:function(n){if(!isMasks(n,this._textbox.cusAttr("maskChars"))){var t=this._textbox.value;this._textbox.value=n,this._textbox.value!=t&&(this.fireValueChangeEvent(),this._isOnChangedFired!=!0&&this.fireValueChange4PEvent(),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0))}},get_Text:function(){return this._textbox.value},set_Text:function(n){this.set_Value(n)},CheckMarkChars:function(){var t=event.srcElement,i=t.cusAttr("maskChars"),n;n=event?event.clipboardData.getData("text/plain"):window.clipboardData.getData("text"),isMasks(n,i)&&$Event(event).preventDefault()},CheckMarkChar:function(){this.raiseonkeypress(Sys.EventArgs.Empty);var t=event.srcElement,n=t.cusAttr("maskChars");n!=""&&isMask(event.keyCode,n)&&$Event(event).preventDefault()},keyPressCaseSensitive:function(){this._CaseSensitive||event.keyCode>96&&event.keyCode<123&&(event.keyCode-=32)},firechangeEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseonchange(n)}},fireValueChangeEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseOnValueChanged(n)}},fireValueChange4PEvent:function(){if(this.get_IsRaiseEvent()!=!1){var n=new UF.UI.ChangeEventArgs;n.value=this._textbox.value,this.raiseOnValueChanged4P(n)}},changePD:function(){this._isOnChangedFired=!0,this.firechangeEvent(),this.fireValueChangeEvent(),this.fireValueChange4PEvent(),Get_Global_IsPageLoadComplete()==!0&&(this.set_IsChanged(!0),this.set_IsValueChanged(!0)),this._isOnChangedFired=!1},blurPD:function(){this._masked&&(this._textbox.value=filtrateMaskChar(this._textbox.value,this._textbox.cusAttr("maskChars"))),this.ControlBlur(),this._textbox.value=this._textbox.value;var n=new UF.UI.ChangeEventArgs;this.raiseonblur(n)},selectValues:function(){var n=this;if(this.ControlFocus(),this._IsSelectText)try{document.activeElement!=this._textbox&&window.setTimeout("try{$ID('"+this._textbox.id+"').focus();}catch(e){}",10),this._textbox.select()}catch(t){}}},UF.UI.TextBox.registerClass("UF.UI.TextBox",UF.UI.InputControl),TextBoxTemplate.Enabled=InputControlTemplate.Enabled,TextBoxTemplate.ReadOnly=InputControlTemplate.ReadOnly,TextBoxTemplate.TBClassName=InputControlTemplate.TBClassName,TextBoxTemplate.TBClassName_R=InputControlTemplate.TBClassName_R,TextBoxTemplate.TBClassName_D=InputControlTemplate.TBClassName_D,TextBoxTemplate.Masked="True",TextBoxTemplate.SelectText="True",TextBoxTemplate.CaseSensitive="True",Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),_isEnterOverTime=!0,UF.UI.Panel=function(n){UF.UI.Panel.initializeBase(this,[n]);var t;this._focusContainer=null,this._topPanel=null,this._ToolBar=null,this._ExtraToolbar=null,this._ExtraToolbarButtons=null,this._OldControl=null,this._OldControl2DDRMenu=null,this._keydownHandler,this._focusinHandler,this._clickHandler,this._hcc,this._ncc,this._hcp},UF.UI.Panel.prototype={initialize:function(){UF.UI.Panel.callBaseMethod(this,"initialize"),this.initControl(),this._focusinHandler=Function.createDelegate(this,this.onMouseDown),$addHandler(this._element,"focusin",this._focusinHandler),this._clickHandler=Function.createDelegate(this,this.onMouseDown),$addHandler(this._element,"click",this._clickHandler),this._keydownHandler=Function.createDelegate(this,this.onkeyDown),$addHandler(this._element,"keydown",this._keydownHandler)},dispose:function(){this._focusinHandler&&($removeHandler(this._element,"focusin",this._focusinHandler),this._focusinHandler=null),this._clickHandler&&($removeHandler(this._element,"click",this._clickHandler),this._clickHandler=null),this._keydownHandler&&($removeHandler(this._element,"keydown",this._keydownHandler),this._keydownHandler=null),this._focusContainer=null,this._ToolBar=null,this._ExtraToolbar=null,this._ExtraToolbarButtons=null,this._OldControl=null,this._OldControl2DDRMenu=null,this._hcc=null,this._ncc=null,UF.UI.Panel.callBaseMethod(this,"dispose")},get_Type:function(){return ControlType.Panel},get_ReadOnly:function(){return this._element.cusAttr("readOnly")},set_ReadOnly:function(n){for(var r=ToBoolean(n),i,t=0,u=this._element.children.length;t<u;t++)i=$find(this._element.children[t].id),i?i.set_ReadOnly?i.set_ReadOnly(r):i.cusAttr("readOnly",r):$(this._element.children[t]).attr("readOnly",r);this._element.cusAttr("readOnly",r)},get_Enabled:function(){return!this._element.cusAttr("disabled")},set_Enabled:function(n){var t,r,i;for(n=ToBoolean(n),this._element.cusAttr("disabled",!n),t=0,r=this._element.children.length;t<r;t++)i=$find(this._element.children[t].id),i?i.set_Enabled?i.set_Enabled(n):i.cusAttr("disabled",!n):$(this._element.children[t]).attr("disabled",!n)},initControl:function(){var n,t,i,r;if(_this=this,this._element.className.containsCssClass(ControlClass.TopPanel)&&(this._hcc=window.document.getElementById("HiddenCurrentControl"),this._ncc=window.document.getElementById("NextCurrentContainer"),this._hcp=window.document.getElementById("HiddenCurrentContainer")),n=this._hcc,n&&n.value&&n.value.split("|",2)[0]!=""&&(t=window.document.getElementById(n.value.split("|",2)[0]),t&&t.tagName=="INPUT"&&t.type=="text"))try{t.focus(),n.value.split("|",2)[1]!="stay"?this.Jump2Control(null,t,ToBoolean(n.value.split("|",2)[1])):t.select(),n.value=""}catch(u){n.value=""}BaseTop.NextCurrentContainer&&this._element.id==BaseTop.NextCurrentContainer.id?(i=this._element,i.style.display!="none"&&(BaseTop.__UFCurrentFocusControl=i.id)):(r=this._ncc,r&&r.value&&r.value.split("|",2)[0]==this._element.id&&(i=this._element,i.style.display!="none"&&(BaseTop.__UFCurrentFocusControl=i.id)))},onMouseDown:function(){var u=event.srcElement.tagName,t=event.srcElement,i,r,n,o,f,h,s,e;if(u=="INPUT"&&(t.className=="DDBO"||t.className=="TBI")||(u=="TD"&&event.srcElement.className=="tcc"||u=="INPUT"&&(event.srcElement.parentElement.className=="tcc"||event.srcElement.parentElement.className=="thc")?(i=this.getParentContainer(t.parentElement.parentElement),i!=null&&i.id!=null&&(BaseTop.__UFCurrentFocusControl=i.id)):u=="INPUT"&&t.parentElement&&t.parentElement&&t.parentElement.parentElement.tagName=="TD"&&t.parentElement.parentElement.className.split(" ")[0]=="tbc"?(i=this.getParentContainer(t.parentElement.parentElement),BaseTop.__UFCurrentFocusControl=i!=null&&i.id!=null?i.id:"Grid"):(u=="INPUT"||u=="TEXTAREA")&&(r=event.srcElement.offsetParent,r&&(r.id=="gg"||r.tagName=="TD"&&r.className.split(" ")[0]=="tbc"||r.offsetParent&&r.offsetParent.tagName=="TD"&&r.offsetParent.className.split(" ")[0]=="tbc")||(BaseTop.__UFCurrentFocusControl=event.srcElement.id))),n=this._focusContainer,window.event.srcElement&&window.event.srcElement.tagName!="BUTTON"&&window.event.srcElement.tagName!="IMG"||window.event.srcElement.className=="btn DateBtnMO"){if(o=!1,window.event.srcElement.className)for(f=0,h=ContainerAsControlTag.length;f<h;f++)window.event.srcElement.className.containsCssClass(ContainerAsControlTag[f])&&(this._focusContainer=window.event.srcElement,o=!0);o||(this._focusContainer=this.getParentContainer(event.srcElement))}if(this._focusContainer){if(this._focusContainer.className==ControlClass.ToolBar||this._focusContainer.cusAttr("FunctionBar")=="FunctionBar")return;s=this._hcp,s&&(s.value=this._focusContainer.id)}this._element.className.containsCssClass(ControlClass.TopPanel)&&(n&&this._focusContainer&&n.id!=this._focusContainer.id||!n)&&(e=new UF.UI.ChangeEventArgs,e.sourceElement=n,e.aimElement=this._focusContainer,this.raiseOnContainerChanged(e),n&&$(n).hasClass(ControlClass.Grid)&&n.control&&n.control.EndEdit())},add_OnContainerChanged:function(n){this.get_events().addHandler("OnContainerChanged",n)},remove_OnContainerChanged:function(n){this.get_events().removeHandler("OnContainerChanged",n)},raiseOnContainerChanged:function(n){var t=this.get_events().getHandler("OnContainerChanged");t&&t(this,n)},SetNextCurrentContainerValue:function(){if(BaseTop.NextCurrentContainer&&BaseTop.NextCurrentContainer.id){var n=this._ncc;n&&(n.value=BaseTop.NextCurrentContainer.id+"|"+BaseTop.NextCurrentContainerDirection)}},SetCurrentControlDirection:function(n){var t=this._hcc;t&&(t.value=t.value&&t.value.split("|",2)[0]?t.value.split("|",2)[0]+"|"+n:"|"+n)},SetFocus:function(){return this.setContainerControlFocus(this._element,!1)},subIframeOnkeyDown:function(n,t){switch(n.keyCode){case KeyCode.enter:case KeyCode.tab:if(n.ctrlKey)return;n.shiftKey||this.setContainerControlFocus($ID(t+"_TabPage10"),!1);break;case KeyCode.G_B:case KeyCode.g_s:if(!n.ctrlKey)return;n.shiftKey?$ID(t+"_TreeControl1")&&$ID(t+"_TreeControl1").focus():this.setContainerControlFocus($ID(t+"_TabPage10"),!1);break;case KeyCode.right:case KeyCode.left:if(!n.ctrlKey)return;n.keyCode==KeyCode.left?$ID(t+"_TabPage11")&&this.setContainerControlFocus($ID(t+"_TabPage11"),!1):$ID(t+"_TabPage10")&&this.setContainerControlFocus($ID(t+"_TabPage10"),!1);break;case KeyCode.Zero:case 96:n.ctrlKey&&this.ReDo2DDRMenu(n)}},onkeyDown:function(){var refence,label,labels,l,i,curCtnr,nextT;if(document.readyState=="complete"){GridIsInFocus=!1;switch(window.event.keyCode){case 123:if(refence=event.srcElement.parentElement,label=refence.cusAttr("L"),!label)return $Event(window.event).stopPropagation(),$Event(window.event).preventDefault(),!1;for(labels=this._element.getElementsByTagName("label"),l=null,i=0;i<labels.length;i++)if(!(labels[i].id.length<=label.length)&&"_"+label==labels[i].id.substring(labels[i].id.length-label.length-1,labels[i].id.length)){l=labels[i];break}l&&l.className=="ELbl"&&(l.attributes("onclick")?eval(l.attributes.onclick.value):l.control&&(l.control.raiseBeforeLoadData(Sys.EventArgs.Empty),l.control.ShowLabelForm())),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault();break;case KeyCode.enter:case KeyCode.tab:if(window.event.ctrlKey)return;if(event.srcElement.type==ControlClass.TextArea&&event.keyCode==13)return;if(event.srcElement.type=="button"||event.srcElement.type=="submit"||event.srcElement.type=="reset"||event.srcElement.tagName=="BUTTON")return;if(_isEnterOverTime)_isEnterOverTime=!1,window.setTimeout(function(){_isEnterOverTime=!0},200);else{$Event(window.event).stopPropagation(),$Event(window.event).preventDefault();return}event.srcElement.className==ControlClass.TableCell||(this.SetCurrentControlDirection(window.event.shiftKey),event.srcElement.type=="radio"?event.srcElement.offsetParent&&event.srcElement.offsetParent.offsetParent&&event.srcElement.offsetParent.offsetParent.tagName=="TABLE"&&event.srcElement.offsetParent.offsetParent.className==ControlClass.RadioList?this.Jump2Control(event,event.srcElement.offsetParent.offsetParent,window.event.shiftKey):($Event(window.event).stopPropagation(),$Event(window.event).preventDefault()):this.Jump2Control(event,event.srcElement,window.event.shiftKey));break;case KeyCode.GridTab:case KeyCode.G_B:case KeyCode.g_s:if(window.event.keyCode!=KeyCode.GridTab&&(!this._element.className.containsCssClass("toppanel")||!window.event.ctrlKey))return;if(curCtnr=this.getParentContainer(window.event.srcElement),curCtnr==null)return;if(this.getExtraToolbar()&&curCtnr.id==this.getExtraToolbar().id||this.getToolbar()&&curCtnr.id==this.getToolbar().id)return;this.Jump2Container(event,window.event.shiftKey),window.event.keyCode==KeyCode.GridTab&&($Event(window.event).stopPropagation(),$Event(window.event).preventDefault());break;case 84:if(!this._element.className.containsCssClass("toppanel")||!window.event.ctrlKey)return;nextT=this.getFirstTabControl(),nextT!=null&&nextT.control!=null&&nextT.control.SetFocus(nextT.control.tabGroup.TabCollection[nextT.control.get_TabIndex()].Page),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault();break;case KeyCode.Zero:case 96:if(!this._element.className.containsCssClass("toppanel"))return;window.event.altKey&&this.ReDo2Toolbar(event),window.event.ctrlKey&&this.ReDo2DDRMenu(event);break;case KeyCode.left:case KeyCode.right:if(window.event.altKey||window.event.ctrlKey)return;if(this.ExtraToolbar||(this.ExtraToolbar=this.getExtraToolbar()),!this.ExtraToolbar)return;this._element.id==this.ExtraToolbar.id&&this.Jump2NextExtraButton(event,window.event.keyCode==KeyCode.left)}}},ReDo2Toolbar:function(n){if(this.isInToolbar(n.srcElement))if(this._OldControl&&!this.isInExtraToolbar(this._OldControl)){try{this._OldControl.focus()}catch(t){}this._OldControl=null}else this.setContainerControlFocus(this.getTopPanel(this._element));else this._OldControl=n.srcElement,this.Jump2Toolbar(n)},ReDo2DDRMenu:function(n){if(this.isInExtraToolbar(n.srcElement))if(this._OldControl2DDRMenu&&!this.isInToolbar(this._OldControl2DDRMenu)){try{this._OldControl2DDRMenu.focus()}catch(t){}this._OldControl2DDRMenu=null}else this.setContainerControlFocus(this.getTopPanel(this._element));else this._OldControl2DDRMenu=n.srcElement,this.Jump2ExtraToolbar(n)},Jump2Control:function(n,t,i){var u=this.getParentContainer(t),f,r;if(!u)if(t.className.containsCssClass(ControlClass.TopPanel))this.setContainerControlFocus(t,i);else return;if(window.event&&window.event.keyCode==KeyCode.tab&&u&&u.className==ControlClass.Tree){window.event.keyCode=KeyCode.GridTab,this.onkeyDown();return}if(f=this.getSubControls(u),r=null,f.length>0)if(r=this.getNextControl(t,f,i),r){if(r.tagName=="DIV"||r.tagName=="FIELDSET"){try{this.getTopPanel(this._element).focus()}catch(e){}this.setContainerControlFocus(r,i)||this.Jump2Control(n,r,i)}else if(r.tagName=="TABLE"&&r.className==ControlClass.RadioList)this.setRadioListControlFocus(r);else try{r.focus(),r.select()}catch(e){}n&&($Event(n).stopPropagation(),$Event(n).preventDefault())}else this.Jump2Control(n,u,i)},getNextControl:function(n,t,i){var u,f=-1,r=n.cusAttr("TI");if(r&&(f=parseInt(r)),i){if(r==this.getMinControl(t).cusAttr("TI"))return null;u=this.getCurrentPrevControlByIndex(f,t)}else{if(r==this.getMaxControl(t).cusAttr("TI"))return null;u=this.getCurrentNextControlByIndex(f,t)}return u},getMaxControl:function(n){for(var i=n[0],t=0,r=n.length;t<r;t++)parseInt(i.cusAttr("TI"))<parseInt(n[t].cusAttr("TI"))&&(i=n[t]);return i},getMinControl:function(n){for(var i=n[0],t=0,r=n.length;t<r;t++)parseInt(i.cusAttr("TI"))>parseInt(n[t].cusAttr("TI"))&&(i=n[t]);return i},getCurrentPrevControlByIndex:function(n,t){for(var r=null,s=n,f=-1,e=0,u,i=0,o=t.length;i<o;i++)u=parseInt(s)-parseInt(t[i].cusAttr("TI")),u>0&&(e==0&&(f=u,r=t[i],e++),f>u&&(f=u,r=t[i]));return r||(r=this.getMaxControl(t)),r},getCurrentNextControlByIndex:function(n,t){for(var r=null,s=n,f=-1,e=0,u,i=0,o=t.length;i<o;i++)u=parseInt(t[i].cusAttr("TI"))-parseInt(s),u>0&&(e==0&&(f=u,r=t[i],e++),f>=u&&(f=u,r=t[i]));return r||(r=this.getMinControl(t)),r},getSubControls:function(n){var f=[],r=[],s=[],h,u,c,i,v,e,l,a,t,o;if(!n)return f;if(n.cusAttr("IsFilterControl")&&n.cusAttr("IsFilterControl")=="true")return this.getFilterSubControls(n);if(n)if(r=n.getElementsByTagName("input"),r.length==0)r=n.getElementsByTagName("TEXTAREA");else if(h=n.getElementsByTagName("TEXTAREA"),h.length>0){for(t=0;t<r.length;t++)s[t]=r[t];for(t=0;t<h.length;t++)s.push(h[t])}if(s.length>0&&(r=s),r.length>0){if(u=n,u.className==ControlClass.Wizard){for(c=null,t=0;t<u.children.length;t++)u.children[t].style.display!="none"&&(c=u.children[t]);if(c)u=c;else return f}for(t=0,o=r.length;t<o;t++)if(i=r[t],i.type!="image"){try{if(i.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement!=u||!i.cusAttr("TI"))if(i.type=="radio"){if(i.offsetParent&&i.offsetParent.offsetParent&&i.offsetParent.offsetParent.tagName=="TABLE"&&i.offsetParent.offsetParent.className==ControlClass.RadioList)continue;if(this.getParentContainer(i).id!=n.id)continue}else continue}catch(y){continue}i.style.display=="none"||i.type=="hidden"||i.type=="button"||i.disabled||f.push(i)}}for(v=n.getElementsByTagName("table"),t=0,o=v.length;t<o;t++)e=v[t],e.cusAttr("TI")&&e.className&&e.className==ControlClass.RadioList&&(l=this.getParentContainer(e),l&&l.id&&l.id==n.id&&f.push(e));if(a=this.getChildrenContainersAsControl(n),a)for(t=0,o=a.length;t<o;t++)f.push(a[t]);return f},getFilterSubControls:function(n){var e=[],i=[],o=[],s,a,r,l,u,h,c,t,f;if(!n)return e;if(n)if(i=n.getElementsByTagName("input"),i.length==0)i=n.getElementsByTagName("TEXTAREA");else if(s=n.getElementsByTagName("TEXTAREA"),s.length>0){for(t=0;t<i.length;t++)o[t]=i[t];for(t=0;t<s.length;t++)o.push(s[t])}if(o.length>0&&(i=o),i.length>0)for(a=n,t=0,f=i.length;t<f;t++)(r=i[t],r.type!="image")&&r.cusAttr("TI")&&(r.style.display=="none"||r.type=="hidden"||r.type=="button"||r.disabled||e.push(r));for(l=n.getElementsByTagName("table"),t=0,f=l.length;t<f;t++)u=l[t],u.cusAttr("TI")&&u.className&&u.className==ControlClass.RadioList&&(h=this.getParentContainer(u),h&&h.id&&h.id==n.id&&e.push(u));if(c=this.getChildrenContainersAsControl(n),c)for(t=0,f=c.length;t<f;t++)e.push(c[t]);return e},setRadioListControlFocus:function(n){var t;if(n.tagName=="TABLE"&&n.className==ControlClass.RadioList){if(n.disabled)return!1;for(t=0;t<n.rows.length;t++)t==0?n.rows[t].cells[0].children[0].focus():n.rows[t].cells[0].children[0].checked&&n.rows[t].cells[0].children[0].focus();if(n.rows.length==1)for(t=0;t<n.rows[0].cells.length;t++)n.rows[0].cells[t].children[0].checked&&n.rows[0].cells[t].children[0].focus();return!0}},GetGridFirstViewColumn:function(n){for(var t=1;t<n.m_columns;){if(!n.MainCols[t])break;if(n.MainCols[t].style.display=="none")t=t+1;else break}return t==n.m_columns&&(t=startIndex-1),t},setGridControlFocus:function(n){if(n.cusAttr("GridReadyState")=="complete")try{BaseTop.__UFCurrentFocusControl="Grid",n.focus(),n.control.m_currentRowIndex==0&&n.control.m_currentColumnIndex==0&&(n.control.m_currentColumnIndex=this.GetGridFirstViewColumn(n.control)),n.control.Focus(!0)}catch(t){}else window.setTimeout(function(){_this.setGridControlFocus(n)},200)},setContainerControlFocus:function(n,t){var s,f,i,l,e,h,r,c,u,o;if((BaseTop.NextCurrentContainer=null,BaseTop.NextCurrentContainerDirection=null,s=this._ncc,s&&s.value&&(s.value=""),!n)||n.isDisabled||(f=n.className,typeof f!="string"))return!1;if(f.indexOf(ControlClass.Tree)>-1)return window.document.getElementById(n.id.substring(0,n.id.length-1))?(window.document.getElementById(n.id.substring(0,n.id.length-1)).focus(),!0):!1;if(f.indexOf(ControlClass.Grid)>-1){i=n;try{i.focus()}catch(a){}return this.setGridControlFocus(i),event&&($Event(event).stopPropagation(),$Event(event).preventDefault()),!0}if(f.indexOf(ControlClass.TabPage)>-1||f.indexOf(ControlClass.Wizard)>-1||f.indexOf(ControlClass.Panel)>-1||f.indexOf(ControlClass.TopPanel)>-1||f==""){if(n.className==""&&n.tagName!="FIELDSET")return;if(n.className.containsCssClass(ControlClass.TabPage)){if((BaseTop.__UFCurrentFocusControl=n.id,_ClientCallBackManager&&_ClientCallBackManager.Runing)||(l=-1,i=n.parentElement==null?document.getElementById(n.id).parentElement.parentElement:n.parentElement.parentElement,e=0,i=i.control,!i))return!1;for(l=i.get_TabIndex(),r=0;r<i.getTab().TabCollection.length;r++)if(i.getTab().TabCollection[r].Page.id==n.id){e=r;break}if(i.IsTabPageHidden(e)||i.IsTabPageDisabled(e))return!1;if(l!=e&&(BaseTop.NextCurrentContainer=n,BaseTop.NextCurrentContainerDirection=t,this.SetNextCurrentContainerValue(),i.SetTabIndex(e,t),i.get_CallPostBack()&&i.get_CallPostBack().length>0))return!0}if(n.className==ControlClass.Wizard){for(h=null,r=0;r<n.children.length;r++)n.children[r].style.display!="none"&&(h=n.children[r]);if(h)n=h;else return!1}try{n.className.containsCssClass("toppanel")||(n.focus(),n.select())}catch(a){}return c=this.getSubControls(n),c.length>0?(u=t?this.getMaxControl(c):this.getMinControl(c),u.tagName=="DIV"||u.tagName=="FIELDSET"?this.setContainerControlFocus(u,t):u.tagName=="TABLE"&&u.className==ControlClass.RadioList?this.setRadioListControlFocus(u):(window.setTimeout(function(){try{u.focus(),u.select()}catch(n){}},50),event&&($Event(event).stopPropagation(),$Event(event).preventDefault()),!0)):!1}try{return n.children[0].focus(),n.children[0].SetFocus(),o=n,o.id=="gg"||o.tagName=="TD"&&o.className.split(" ")[0]=="tbc"||o.offsetParent.tagName=="TD"&&o.offsetParent.className.split(" ")[0]=="tbc"||(BaseTop.__UFCurrentFocusControl=n.children[0].id),BaseTop.NextCurrentContainer=n,BaseTop.NextCurrentContainerDirection=t,this.SetNextCurrentContainerValue(),!0}catch(v){return!1}},getParentContainer:function(n){var t,i,r;if(n.parentContainer)return n.parentContainer;if((n.tagName=="INPUT"||n.className==ControlClass.TextArea)&&(n=n.parentElement),!n)return null;if(t=n.parentElement,t){if(t.tagName=="FIELDSET")return n.parentContainer=t,t;if(t.className)for(i=0,r=ContainerAsControlTag.length;i<r;i++)if(t.className.containsCssClass(ContainerAsControlTag[i]))return n.parentContainer=t,t;return this.getParentContainer(t)}return null},getChildrenContainersAsControl:function(n){var u=[],o,f,s,t,e,h,r,i;if(!n)return null;for(o=n.getElementsByTagName("div"),f=0,s=o.length;f<s;f++)if((t=o[f],t&&t.cusAttr("TI")&&!t.isDisabled)&&(e=t.className,e))for(i=0,h=ContainerAsControlTag.length;i<h;i++)if(e.containsCssClass(ContainerAsControlTag[i])){if((e==ControlClass.Tree||$(t).hasClass(ControlClass.Grid))&&t.cusAttr("TI")&&this.isChildControl(t,n)){u.push(t);continue}if(!t.cusAttr("TI")||!this.isChildControl(t,n)||t.style.display=="none"&&!t.className.containsCssClass(ControlClass.TabPage)||!this.hasChildControls(t)&&!t.className.containsCssClass(ControlClass.TabPage)||t.disabled)continue;u.push(t);break}for(r=n.getElementsByTagName("FIELDSET"),i=0;i<r.length;i++)r[i].cusAttr("TI")&&this.hasChildControls(r[i])&&this.isChildControl(r[i],n)&&u.push(r[i]);return u},isChildControl:function(n,t){var i=this.getParentContainer(n),u,r;if(i.className==ControlClass.Wizard)for(u=null,r=0;r<i.children.length;r++)i.children[r].style.display!="none"&&(u=i.children[r]);return i&&i.id&&(i.id==t.id||i.className==ControlClass.Wizard&&u&&u.id==t.id)?!0:!1},hasChildControls:function(n){var t=this.getSubControls(n);return t&&t.length>0?!0:!1},Jump2Container:function(n,t){var i=this.getContainers(),u;if(i&&i.length!=0){if(u=this.getCurContainer(n.srcElement,i),!u){t?this.setContainerControlFocus(i[i.length-1],!1):this.setContainerControlFocus(i[0],t);return}var f=parseInt(u.cusAttr("TI")),e=i,r=null;(t?(r=this.getCurrentPrevControlByIndex(f,e),r||(r=i[i.length-1])):(r=this.getCurrentNextControlByIndex(f,e),r||(r=i[0])),r)&&this.setContainerControlFocus(r,!1)}},getCurContainer:function(n,t){if(n){for(var i=0,r=t.length;i<r;i++)if(n.id==t[i].id)return n;return this.getCurContainer(this.getParentContainer(n),t)}},isAContainsB:function(n,t){var r,i,u;if(!n||!t)return!1;for(r=n.getElementsByTagName("div"),i=0,u=r.length;i<u;i++)if(t.id==r[i].id)return!0;return!1},getCurrentTabPage:function(){if(window.event&&window.event.srcElement)for(var t=window.event.srcElement,n=t;;){if(n.className&&n.className.containsCssClass(ControlClass.TabPage))return n;if(n.className&&n.className.containsCssClass(ControlClass.TopPanel))return null;if(n.parentElement)n=n.parentElement;else return null}},getContainers:function(n){var c=n?n:this.getTopPanel(this._element),i,r,f,h,u,o;if(c){var s=[],e=[],t=c.getElementsByTagName("div");for(i=0;i<t.length;i++)if(t[i].cusAttr("TI")&&(t[i].className.containsCssClass(ControlClass.Panel)||t[i].className.containsCssClass(ControlClass.TabPage)||$(t[i]).hasClass(ControlClass.Grid)||t[i].className==ControlClass.Tree)){if(t[i].disabled)continue;if(t[i].className==ControlClass.Tree&&window.tlrkTreeViews[t[i].id.substring(0,t[i].id.length-1)].Nodes.length==0)continue;if($(t[i]).hasClass(ControlClass.Grid)&&t[i].control&&t[i].control.m_rows!=null&&t[i].control.m_rows==0)continue;if(($(t[i]).hasClass(ControlClass.Grid)||t[i].className==ControlClass.Tree)&&!this.isControlInView(t[i]))continue;s.push(t[i])}for(t=s,s=null,i=0;i<t.length;i++)t[i].IsRemove=null;for(r=0;r<t.length;r++)for(f=r+1;f<t.length;f++)if(this.isAContainsB(t[r],t[f])){if(($(t[f]).hasClass(ControlClass.Grid)||t[f].className==ControlClass.Tree)&&!this.isInTabPage(t[f])&&!this.isChildrenIsOneControl(this.getParentContainer(t[f]))){t[f].IsRemove&&(t[f].IsRemove=null);continue}if(t[f].className.containsCssClass(ControlClass.TabPage))if(this.getParentContainer(t[f]).id==t[r].id)if(this.IsChildrenAllTabPage(t[r]))t[r].IsRemove="1";else continue;else continue;else t[f].IsRemove="1"}else if(this.isAContainsB(t[f],t[r])){if(($(t[r]).hasClass(ControlClass.Grid)||t[r].className==ControlClass.Tree)&&!this.isInTabPage(t[r])&&!this.isChildrenIsOneControl(this.getParentContainer(t[r]))){t[r].IsRemove&&(t[r].IsRemove=null);continue}if(t[r].className.containsCssClass(ControlClass.TabPage))if(this.getParentContainer(t[r]).id==t[f].id)if(this.IsChildrenAllTabPage(t[f]))t[f].IsRemove="1";else continue;else continue;else t[r].IsRemove="1"}for(u=0;u<t.length;u++)t[u].className.containsCssClass(ControlClass.TabPage)||$(t[u]).hasClass(ControlClass.Grid)||t[u].className==ControlClass.Tree||(h=this.getSubControls(t[u]),h&&h.length!=0||(t[u].IsRemove="1"));if(window.event&&window.event.shiftKey)for(u=0;u<t.length;u++)t[u].className.containsCssClass(ControlClass.TabPage)&&t[u].style.display!="none"&&t[u].parentElement.firstChild.id!=t[u].id&&this.getCurrentTabPage()&&t[u].id==this.getCurrentTabPage().id&&t[u].id!=this.getParentContainer(window.event.srcElement).id&&!this.getParentContainer(window.event.srcElement).className.containsCssClass(ControlClass.Panel)&&(t[u].IsRemove="1");for(o=0;o<t.length;o++)t[o].IsRemove||e.push(t[o]);return(t.splice(0,t.length),e.length==1&&!$(e[0]).hasClass(ControlClass.Grid)&&e[0].className!=ControlClass.Tree)?this.getContainers(e[0]):e}},IsChildrenAllTabPage:function(n){for(var i=this.getSubControls(n),t=0;t<i.length;t++)if(!i[t].className.containsCssClass(ControlClass.TabPage))return!1;return!0},getTopPanel:function(n){return this._topPanel!=null?this._topPanel:n?n.className.containsCssClass(ControlClass.TopPanel)?(this._topPanel=n,n):this.getTopPanel(this.getParentContainer(n)):null},isInTabPage:function(n){if(!n||n.className.containsCssClass(ControlClass.TopPanel))return!1;var t=this.getParentContainer(n);return t?!1:t.className.containsCssClass(ControlClass.TabPage)?!0:this.isInTabPage(t)},isChildrenIsOneControl:function(n){var t=this.getSubControls(n);return t.length>1?!1:!0},isControlInView:function(n){var i=!0,t;for(n.className.containsCssClass(ControlClass.TopPanel)||(t=n.parentElement);t&&!t.className.containsCssClass(ControlClass.TopPanel);){if(t.style.display=="none"||t.style.visibility=="hidden"){i=!1;break}t=t.parentElement}return i},Jump2ExtraToolbar:function(){var t,i;if(this.ExtraToolbar||(this.ExtraToolbar=this.getExtraToolbar()),this.ExtraToolbar)if(t=this.getButtonsFromExtraToolbar(this.ExtraToolbar),t&&t.length!=0){if(i=this.getMinControl(t),i)try{i.focus()}catch(r){}}else return},Jump2NextExtraButton:function(n,t){var r=this.getButtonsFromExtraToolbar(this.ExtraToolbar),i;if(r&&r.length!=0){i=null,n.srcElement.cusAttr("TI")?(i=this.getNextControl(n.srcElement,r,t),i||(i=t?this.getMaxControl(r):this.getMinControl(r))):i=t?this.getMaxControl(r):this.getMinControl(r);try{i.focus()}catch(u){}}},getExtraToolbar:function(){var n=this.getTopPanel(this._element),t,u,i,r;if(!n)return null;if(n.control&&n.control._ExtraToolbar)return n.control._ExtraToolbar;for(t=null,u=n.getElementsByTagName("div"),i=u.length-1;i>=0;i--)if(r=u[i],r.cusAttr("FunctionBar")&&r.cusAttr("FunctionBar")=="FunctionBar"){t=r;break}return n.control&&(n.control._ExtraToolbar=t),t},getButtonsFromExtraToolbar:function(n){var u=[],r,i,t;if(!n)return u;for(r=n.getElementsByTagName("BUTTON"),i=n.getElementsByTagName("INPUT"),t=0;t<r.length;t++)if(!r[t]||!r[t].cusAttr("TI")||r[t].style.display=="none"||r[t].disabled||r[t].cusAttr("disabled")||r[t].isDisabled)continue;else u.push(r[t]);for(t=0;t<i.length;t++)if(!i[t]||!i[t].cusAttr("TI")||i[t].style.display=="none"||i[t].disabled||i[t].cusAttr("disabled")||i[t].isDisabled||i[t].parentElement.tagName!="TD"||i[t].parentElement.className!="DropDownBtn_Center"){i[t]&&i[t].cusAttr("TI")&&i[t].className=="textbox"&&u.push(i[t]);continue}else u.push(i[t]);return u},isInExtraToolbar:function(n){var t=this.getExtraToolbar(),i=this.getParentContainer(n);return t&&i&&t.id==i.id?!0:!1},Jump2Toolbar:function(n){var t=this.getToolbar(n),i;if(t&&t.control){for(i=0;i<t.control.controls.length;i++)if(!t.control.controls[i].isDisabled&&t.control.controls[i].style.display!="none"){t.control.controls[i].focus();break}$Event(n).stopPropagation(),$Event(n).preventDefault()}},getToolbar:function(){var n=this.getTopPanel(this._element),r,u,t,f,i;if(!n)return null;if(n.control&&n.control._Toolbar)return n.control._Toolbar;for(u=this._element.getElementsByTagName("div"),t=0,f=u.length;t<f;t++)if(i=u[t],i.className==ControlClass.ToolBar&&i.style.display!="none"){r=i;break}return n.control&&(n.control._Toolbar=r),r},isInToolbar:function(n){var t=!1;if(!n)return t;for(;n&&n.parentElement;){if(n.className&&n.className==ControlClass.ToolBar){t=!0;break}if(n.className&&n.className.containsCssClass(ControlClass.TopPanel))break;n=n.parentElement}return t},getFirstTabControl:function(){for(var t=document.getElementsByTagName("DIV"),i=[],n=0;n<t.length;n++)if(t[n].className&&t[n].className.containsCssClass("TC tPn"))return t[n]}},UF.UI.Panel.registerClass("UF.UI.Panel",UF.UI.Control),ControlClass.TextArea="textarea",ControlClass.TableCell="tbc",ControlClass.TabControl="TC tPn",ControlClass.TabPage="TP",ControlClass.Grid="main_Span",ControlClass.Panel="ufpanel",ControlClass.TopPanel="toppanel",ControlClass.ToolBar="TB",ControlClass.Wizard="Wizard",ControlClass.Tree="TreeBorder",ControlClass.RadioList="ufRadioBoxList",ContainerTag=[ControlClass.ToolBar,ControlClass.Panel,ControlClass.TabPage],ContainerAsControlTag=[ControlClass.Grid,ControlClass.ToolBar,ControlClass.Panel,ControlClass.TopPanel,ControlClass.TabPage,ControlClass.Wizard,ControlClass.Tree],Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.FlexField=function(n){UF.UI.FlexField.initializeBase(this,[n]);var t=this;this._textbox,this._button,this._value,this._name,this._isKey=!1,this._datas,this._xmlhttpRequest,this._inputValue,this._textboxkeypressHandler,this._textboxkeydownHandler,this._textboxpasteHandler,this._textboxfocusHandler,this._textboxblurHandler,this._textboxchangeHandler,this._buttonclickHandler,this._btnmouseoverHandler,this._btnmouseoutHandler,this.CallbackComplete=function(){var n,i,r,u;if(t._xmlhttpRequest&&t._xmlhttpRequest.readyState==4){if(n="",i=t._xmlhttpRequest.responseText,i=unescapeHTML(i),r=i.indexOf("<ReferenceReturns>"),u=i.indexOf("<\/ReferenceReturns>")+"<\/ReferenceReturns>".length,r!=-1&&u!=-1)n=i.substring(r,u);else return;if(n=="<ReferenceReturns>__MultiRows<\/ReferenceReturns>"||n=="<ReferenceReturns><\/ReferenceReturns>"||n=="<ReferenceReturns>false<\/ReferenceReturns>"){t.ShowRefForm(t._textbox.value);return}t.OnContentChanged(n)}},this.CallbackComplete4GetControlType=function(){var i,n,r,u;t._xmlhttpRequest&&t._xmlhttpRequest.readyState==4&&(i="",n=t._xmlhttpRequest.responseText,n=unescapeHTML(n),r=n.indexOf("<ReferenceReturns>"),u=n.indexOf("<\/ReferenceReturns>")+"<\/ReferenceReturns>".length,r!=-1&&u!=-1?(i=n.substring(r,u),i=="<ReferenceReturns>__MultiRows<\/ReferenceReturns>"?t.ShowRefForm(t._textbox.value):t.CheckControlType(i)):t.ShowRefForm(t._textbox.value))}},UF.UI.FlexField.prototype={initialize:function(){UF.UI.FlexField.callBaseMethod(this,"initialize"),this._textbox=this._element.children[0];for(var n=this._element.children.length-1;n>0;n--)this._element.children[n].id==this._element.id+"_button"&&(this._button=this._element.children[n]);this.btnClassName==null&&(this.btnClassName=FlexFieldTemplate.BtnClassName),this.btnClassName_Dis==null&&(this.btnClassName_Dis=FlexFieldTemplate.BtnClassName_Dis),this.InitControl(),this.set_IsInitComlete(!0)},dispose:function(){this._textboxkeypressHandler&&($removeHandler(this._textbox,"keypress",this._textboxkeypressHandler),this._textboxkeypressHandler=null),this._textboxkeydownHandler&&($removeHandler(this._textbox,"keydown",this._textboxkeydownHandler),this._textboxkeydownHandler=null),this._textboxpasteHandler&&($removeHandler(this._textbox,"paste",this._textboxpasteHandler),this._textboxpasteHandler=null),this._textboxfocusHandler&&($removeHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxfocusHandler=null),this._textboxblurHandler&&($removeHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxblurHandler=null),this._textboxchangeHandler&&($removeHandler(this._textbox,"change",this._textboxchangeHandler),this._textboxchangeHandler=null),this._buttonclickHandler&&($removeHandler(this._button,"click",this._buttonclickHandler),this._buttonclickHandler=null),this._textbox=null,this._button=null,this._datas&&(this._datas.dispose(),this._datas=null),this._xmlhttpRequest=null,UF.UI.FlexField.callBaseMethod(this,"dispose")},InitControl:function(){this.DisplayRequiredFlag(!this._element.cusAttr("disabled"));var n=this._element.cusAttr("IsKey");n&&(n.toLowerCase()=="y"?(this._textboxkeypressHandler=Function.createDelegate(this,this.CheckMarkChar),$addHandler(this._textbox,"keypress",this._textboxkeypressHandler),this._textboxkeydownHandler=Function.createDelegate(this,this.onKeyFlexKeyDown),$addHandler(this._textbox,"keydown",this._textboxkeydownHandler),this._textboxpasteHandler=Function.createDelegate(this,this.CheckMarkChars),$addHandler(this._textbox,"paste",this._textboxpasteHandler),this._textboxfocusHandler=Function.createDelegate(this,this.textboxFocus),$addHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxblurHandler=Function.createDelegate(this,this.textboxBlur),$addHandler(this._textbox,"blur",this._textboxblurHandler),this._textboxchangeHandler=Function.createDelegate(this,this.textboxOnchange),$addHandler(this._textbox,"change",this._textboxchangeHandler),this._element.cusAttr("Mask")?this._textbox.cusAttr("maskChars",MaskChar.Default+this._element.cusAttr("Mask")):this._textbox.cusAttr("maskChars",MaskChar.Default),this._element.cusAttr("Enabled")?(this._buttonclickHandler=Function.createDelegate(this,this.onButtonClicked),$addHandler(this._button,"click",this._buttonclickHandler)):(this._textbox.disabled=!0,this._button.disabled=!0,this._textbox.className=this.tbClassName_D,this._button.className=this.btnClassName_Dis,this._element.className=UIControlClass.getReadOnlyCss(this._element),this._element.cusAttr("disabled",!0)),this._isKey=!0,this.btnmouseOverClass="btn FlexBtnMO"):(this._textbox&&(this._textbox.style.width="1px",this._element.style.width="19px"),this.btnmouseOverClass="btn FlexBtnMO 4BorderMO",this._textboxfocusHandler=Function.createDelegate(this,this.textboxFocus),$addHandler(this._textbox,"focus",this._textboxfocusHandler),this._textboxblurHandler=Function.createDelegate(this,this.textboxBlur),$addHandler(this._textbox,"blur",this._textboxblurHandler),this._element.cusAttr("Enabled")?(this._buttonclickHandler=Function.createDelegate(this,this.onButtonClicked),$addHandler(this._button,"click",this._buttonclickHandler),this._textboxkeydownHandler=Function.createDelegate(this,this.onDescriptionFlexKeyDown),$addHandler(this._textbox,"keydown",this._textboxkeydownHandler),this._textbox.disabled=!1):(this._textbox.disabled=!0,this._button.disabled=!0,this._textbox.className=this.tbClassName_D,this._button.className=this.btnClassName_Dis,this._element.cusAttr("disabled",!0)))),this._element.cusAttr("ReadOnly")&&this.set_ReadOnly(!0),this._btnmouseoverHandler=Function.createDelegate(this,this.BtnMouseOver),$addHandler(this._button,"mouseover",this._btnmouseoverHandler),this._btnmouseoutHandler=Function.createDelegate(this,this.BtnMouseOut),$addHandler(this._button,"mouseout",this._btnmouseoutHandler)},set_Enabled:function(n){if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")){if(n=ToBoolean(n),$(this._button).attr("disabled",!n),$(this._textbox).attr("disabled",!n),n){if(this._textbox.className=this.tbClassName,this._button.className=this.btnClassName,this._buttonclickHandler||(this._buttonclickHandler=Function.createDelegate(this,this.onButtonClicked),$addHandler(this._button,"click",this._buttonclickHandler)),!this._textboxkeydownHandler){var t=this._element.cusAttr("IsKey");t&&t.toLowerCase()=="y"?(this._textboxkeydownHandler=Function.createDelegate(this,this.onKeyFlexKeyDown),$addHandler(this._textbox,"keydown",this._textboxkeydownHandler)):(this._textboxkeydownHandler=Function.createDelegate(this,this.onDescriptionFlexKeyDown),$addHandler(this._textbox,"keydown",this._textboxkeydownHandler))}this._element.className=UIControlClass.getNotReadOnlyCss(this._element)}else this._textbox.className=this.tbClassName_D,this._button.className=this.btnClassName_Dis,this._buttonclickHandler&&($removeHandler(this._button,"click",this._buttonclickHandler),this._buttonclickHandler=null),this._textboxkeydownHandler&&($removeHandler(this._textbox,"keydown",this._textboxkeydownHandler),this._textboxkeydownHandler=null),this._element.className=UIControlClass.getReadOnlyCss(this._element);this.DisplayRequiredFlag(n)}},get_ReadOnly:function(){return this._element.cusAttr("readOnly")},set_ReadOnly:function(n){if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&this.get_Enabled()){if(n=ToBoolean(n),this._element.cusAttr("readOnly",n),n)this._textbox.className=this.tbClassName_R,this._button.className=this.btnClassName_Dis,this._buttonclickHandler&&($removeHandler(this._button,"click",this._buttonclickHandler),this._buttonclickHandler=null),this._textboxkeydownHandler&&($removeHandler(this._textbox,"keydown",this._textboxkeydownHandler),this._textboxkeydownHandler=null),this._element.className=UIControlClass.getReadOnlyCss(this._element);else{if(this._textbox.className=this.tbClassName,this._button.className=this.btnClassName,this._buttonclickHandler||(this._buttonclickHandler=Function.createDelegate(this,this.onButtonClicked),$addHandler(this._button,"click",this._buttonclickHandler)),!this._textboxkeydownHandler){var t=this._element.cusAttr("IsKey");t&&t.toLowerCase()=="y"?(this._textboxkeydownHandler=Function.createDelegate(this,this.onKeyFlexKeyDown),$addHandler(this._textbox,"keydown",this._textboxkeydownHandler)):(this._textboxkeydownHandler=Function.createDelegate(this,this.onDescriptionFlexKeyDown),$addHandler(this._textbox,"keydown",this._textboxkeydownHandler))}this._element.className=UIControlClass.getNotReadOnlyCss(this._element)}$(this._textbox).attr("readOnly",n),$(this._button).attr("disabled",n),this.set_HDValue("ReadOnly",n.toString().toLowerCase())}},get_Visible:function(){return this._element.style.visibility!="hidden"},set_Visible:function(n){this._element.style.visibility=n?"visible":"hidden"},get_Type:function(){return ControlType.FlexField},set_PartID:function(n){this._element.cusAttr("PartID",n)},set_H:function(n){this._element.cusAttr("H",n)},set_W:function(n){this._element.cusAttr("W",n)},get_CustomInParams:function(){return this._element.cusAttr("CustomInParams")},set_CustomInParams:function(n,t){var r=this._element.cusAttr("CustomInParams")+"&",u=new RegExp(n+"=.*?&","g"),i=r.replace(u,n+"="+t+"&");i=i.substr(0,i.length-1),this._element.cusAttr("CustomInParams",i)},set_Value:function(n){isMasks(n,this._textbox.cusAttr("maskChars"))||(this._textbox.value=n,this._value=n)},get_Value:function(){return this._value},set_Code:function(n){isMasks(n,this._textbox.cusAttr("maskChars"))||(this._textbox.value=n,this._value=n)},get_Code:function(){return this._value},get_Name:function(){return this._name},onKeyFlexKeyDown:function(){switch(window.event.keyCode){case KeyCode.F2:this.onButtonClicked(),$Event(window.event).stopPropagation()}},CheckMarkChars:function(){var t=event.srcElement,i=t.cusAttr("maskChars"),n;n=event?event.clipboardData.getData("text/plain"):window.clipboardData.getData("text"),isMasks(n,i)&&$Event(window.event).preventDefault()},CheckMarkChar:function(){var t=event.srcElement,n=t.cusAttr("maskChars");n!=""&&isMask(event.keyCode,n)&&$Event(window.event).preventDefault()},onDescriptionFlexKeyDown:function(){switch(window.event.keyCode){case KeyCode.F2:this.onButtonClicked(),$Event(window.event).stopPropagation();break;case KeyCode.tab:case KeyCode.enter:this.onInputReturn();break;case KeyCode.G_B:case KeyCode.g_s:case KeyCode.left:case KeyCode.right:if(window.event.ctrlKey)break;else $Event(window.event).stopPropagation(),$Event(window.event).preventDefault();case KeyCode.Zero:case 96:if(window.event.altKey||window.event.ctrlKey)break;else $Event(window.event).stopPropagation(),$Event(window.event).preventDefault();default:$Event(window.event).stopPropagation(),$Event(window.event).preventDefault()}},onInputReturn:function(){if(this._textbox.value!=this.Value){if(this._textbox.value==""){this.OnContentChanged(null);return}var n=this._textbox.value;this.raiseBeforeLoadData(Sys.EventArgs.Empty),this.CallXmlHttp(n)}},getXHR:function(){var t,n,i;if(window.XMLHttpRequest)return new XMLHttpRequest;for(t=["Msxml","Msxml2","Msxml3","Microsoft"],n=0;n<t.length;n++)try{return i=t[n]+".XMLHTTP",new ActiveXObject(i)}catch(r){}return null},CallXmlHttp4GetControlType:function(){var n=this.GetUrl(this._element.cusAttr("PartID"))+"&CommandType=GetControlType";n=AppendPopupUrl(n),this._xmlhttpRequest||(this._xmlhttpRequest=this.getXHR()),this._xmlhttpRequest&&(this._xmlhttpRequest.open("GET",n,!1),this._xmlhttpRequest.onreadystatechange=this.CallbackComplete4GetControlType,this._xmlhttpRequest.send(""))},CallXmlHttp:function(n){this._inputValue=n;var t=this.GetUrl(this._element.cusAttr("PartID"))+"&CommandType=callback&InputCode="+encodeURIComponent(n);t=AppendPopupUrl(t),this._xmlhttpRequest||(this._xmlhttpRequest=this.getXHR()),this._xmlhttpRequest&&(this._xmlhttpRequest.open("GET",t,!1),this._xmlhttpRequest.onreadystatechange=this.CallbackComplete,this._xmlhttpRequest.send(""))},onButtonClicked:function(){if(_ClientCallBackManager&&_ClientCallBackManager.Runing)return!1;this.raiseBeforeLoadData(Sys.EventArgs.Empty);var n=null;this._isKey&&(n=this._textbox.value),this.CallXmlHttp4GetControlType()},textboxOnchange:function(){this.onInputReturn()},textboxFocus:function(){this.ControlFocus(),this._isKey!=!0&&(this._button.className=this.btnmouseOverClass);try{this._textbox.select()}catch(n){}},textboxBlur:function(){var n=this._textbox.cusAttr("maskChars");n&&n.length>0&&(this._textbox.value=filtrateMaskChar(this._textbox.value,n)),this.ControlBlur(),this._button.className="btn FlexBtn"},BtnMouseOver:function(){},BtnMouseOut:function(){},GetQueryString:function(n){var i="lnk="+n,u,f,t,e,r;if(this._isKey?(u=$find(this._element.cusAttr("StructID")),u&&(t=null,typeof u.get_Key!="undefined"&&(t=u.get_Key()),t||(t=u.get_Value()),i+="&StructID="+t)):this._element.cusAttr("ContextValueID")&&(f=$find(this._element.cusAttr("ContextValueID")),f&&(t=null,t=f.get_Value(),i+="&ContextValueID="+t)),e="&",this._dynamicParams!=null)for(key in this._dynamicParams)i+=e+key+"="+this._dynamicParams[key];return r=this._element.cusAttr("CustomInParams"),r!=null&&r!=""&&(i+=r[0]=="&"?r:"&"+r),i},ShowRefForm:function(n){var i=this.GetUrl(this._element.cusAttr("PartID")),t;n&&n!=""&&(i+="&InputCode="+encodeURIComponent(n)),i=AppendPopupUrl(i),t=this.get_element().getAttribute("Title"),t||(t=""),t="";var u=this._element.cusAttr("W"),f=this._element.cusAttr("H"),r=this;zlayer.open({title:t,area:[u+"px",f+"px"],argument:window,content:i,endHandle:function(n){n!=null&&typeof n!="boolean"&&r.OnContentChanged(n);try{r._textbox.focus()}catch(t){}}})},ShowRefForm4Reference:function(n,t,i,r){var f=this,u=this.GetUrl(n)+"&"+r;u=AppendPopupUrl(u),ShowModalDialogForAll(u,"",i,t,!0,!1,function(n){n!=null&&f.OnContentChanged(n);try{f._textbox.focus()}catch(t){}})},OnContentChanged:function(n){var t=PopupFormHelper.TranslateInfor(n),i,r,u;t==null&&(t=new ReferenceData),i=t.GetValues(this._element.cusAttr("CodeField")),r=t.GetValues(this._element.cusAttr("NameField")),i.length>0?(this._textbox.value=i[0],this._value=i[0],this._name=r[0]):(this._textbox.value="",this._value="",this._name=""),u=$find(this._element.cusAttr("AssoControl")),u&&(r.length>0?u.set_Value(r[0]):u.set_Value("")),this._datas=t,this.fireContentChangedEvent(this._datas),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0)},CheckControlType:function(n){var t=PopupFormHelper.TranslateInfor(n);if(t==null&&(t=new ReferenceData),t.Rows.length==1&&t.Rows[0].ControlType==ControlType.RefControl){this.ShowRefForm4Reference(t.Rows[0].RefType,t.Rows[0].RefWidth,t.Rows[0].RefHeight,t.Rows[0].CustomInParams);return}try{this._textbox.focus()}catch(i){}},fireContentChangedEvent:function(n){var t=new UF.UI.ChangeEventArgs;t.result=n,t.sender=this._element,this.raiseContentChanged(t)}},UF.UI.FlexField.registerClass("UF.UI.FlexField",UF.UI.PopupForm),FlexFieldTemplate.Enabled=InputControlTemplate.Enabled,FlexFieldTemplate.ReadOnly=InputControlTemplate.ReadOnly,FlexFieldTemplate.TBClassName=InputControlTemplate.TBClassName,FlexFieldTemplate.TBClassName_R=InputControlTemplate.TBClassName_R,FlexFieldTemplate.TBClassName_D=InputControlTemplate.TBClassName_D,FlexFieldTemplate.BtnClassName="btn FlexBtn",FlexFieldTemplate.BtnClassName_Dis="btn FlexBtnDisable",Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Menu=function(n){UF.UI.Menu.initializeBase(this,[n]),this.isKeyBoardEvent=!1;var t=this;this._isMutliGroup=!1,this.maxItemCount=25,this._deleteFlag=!0,this.popMenu,this.eventSource,this.menuItems=[],this.displayImage,this.oPopupBody1,this.oPopupEvent,this._datas,this._dynamicParams,this.TextStyle=this.get_element().className,this.itemStyle="height: 18px;",this.disItemStyle="height: 18px;cursor:default;color:#A2A2A2 !important",this.sepStyle="height:2px;",this.sepColor="#DADAC5",this.imageStyle="width: 16px; height: 18px;",this.tableStyle="border:0px;border-width:0px;",this.columstyle=[],this.columstyle[0]="width:17px;vertical-align:middle;text-align:center;",this.columstyle[1]="padding-top:3px;font-size:12px;cursor: hand;",this.columstyle[2]="width:30px;vertical-align:middle;text-align:center;cursor: hand;",this.imageSrc="",this.arrowHead="ArrowR.gif",this.selectedColor="#FFE9A6",this.selectedBorderStyle="1px #C8C8C8 solid",this.unselectedBorderStyle="1px #FFFFFF solid",this._hidden,this.popsIndex=[],this.popsSelected=[],this.attachDisplayControl,this.attachEventControl,this.popsDirection=[],this.Pops=[],this.selectedImageSrc="selected.gif",this.isInit=!1,this.Menu_nIndex=-1,this._customHandler,this._keydownHandler,this._isCancelMenuItemClick=!1,this.oPopup_oncontextmenu=function(){var n,i,r;t.oPopupEvent!=null&&t.oPopupEvent.ctrlKey==!0&&(n=t.oPopupEvent.srcElement,n.tagName=="NOBR"&&(i=n.innerText+"  "+n.parentElement.parentElement.title,r=window.clipboardData.getData("Text"),Clipboard.setData(r+"\r\n"+i),showStatus(i)),t.oPopupEvent.cancelBubble=!0,t.oPopupEvent.returnValue=!1)},this.oPopup_onclick=function(isResume){var SBTN,SDDB,SMI,pID,cc;if(t.oPopupEvent!=null&&(isResume||t.oPopupEvent.srcElement!=null&&(t.oPopupEvent.srcElement.tagName=="TD"||t.oPopupEvent.srcElement.tagName=="NOBR"))){if(t.eventSource=t.oPopupEvent.srcElement.tagName=="NOBR"?t.oPopupEvent.srcElement.parentElement.parentElement:t.oPopupEvent.srcElement.parentElement.tagName=="TD"?t.oPopupEvent.srcElement.parentElement.parentElement:t.oPopupEvent.srcElement.parentElement,!t.eventSource.cusAttr("Enabled"))return;if($(t.Pops[0]).css("visibility","hidden"),t.eventSource.cusAttr("AutoPostBack")!=undefined&&t.eventSource.cusAttr("AutoPostBack").toString().toLowerCase()=="false"){if(SBTN=t.eventSource.cusAttr("SBTN"),SBTN){$find(SBTN).fireClick();return}if(SDDB=t.eventSource.cusAttr("SDDB"),SDDB){SMI=t.eventSource.cusAttr("SMI"),$find(SDDB).fireItemClick(SMI);return}if(pID=t.eventSource.cusAttr("PartID"),pID){if(t.get_IsCancelMenuItemClick()==!1&&(t.OnBeforeLoadData(t.eventSource),t.get_IsCancelMenuItemClick()==!0))return;t.ShowMenuForm(t.eventSource),t.get_IsCancelMenuItemClick()==!0&&t.set_IsCancelButtonClick(!1)}else cc=t.eventSource.cusAttr("CC"),cc?eval(cc):(t._hidden.oldvalue=t._hidden.value,t._hidden.value=t.eventSource.cusAttr("index"),t.fireMenuItemClick(t.eventSource));return}if(t._hidden.oldvalue=t._hidden.value,t._hidden.value=t.eventSource.cusAttr("index")+","+t.eventSource.cusAttr("itemID"),t._deleteFlag)if(t._element.cusAttr("onfirequeuedevents")!=null){if(t.eventSource.cusAttr("VerifyNotNull")&&t.eventSource.cusAttr("VerifyNotNull")=="True"&&t.eventSource.cusAttr("TopPanelClientID")&&t.eventSource.cusAttr("TopPanelClientID")!=""&&!$ID(t.eventSource.cusAttr("TopPanelClientID")).TopPanelNoEmptyVerify()){t.fireMenuItemClick(t.eventSource);return}_ClientJSExecQueueManager.Push(' __doPostBack("'+t._element.id+'", "");$find("'+t._element.id+'")._hidden.value = ""')}else _ClientJSExecQueueManager.Push('$find("'+t._element.id+'")._hidden.value = ""');else _ClientJSExecQueueManager.Push('$find("'+t._element.id+'").set_DeleteFlag("true");');t.fireMenuItemClick(t.eventSource),window.AfterZlayerJsQueue||_ClientJSExecQueueManager.Start()}},this.oPopup_mouseover=function(){var o,s,i,e,h,r,u,c,n,f;if(t.isKeyBoardEvent){t.isKeyBoardEvent=!1;return}try{if(t.oPopupEvent==null)return;if(t.oPopupEvent.srcElement!=null&&(t.oPopupEvent.srcElement.tagName=="TD"||t.oPopupEvent.srcElement.tagName=="NOBR")){if(t.eventSource=t.oPopupEvent.srcElement.tagName=="NOBR"?t.oPopupEvent.srcElement.parentElement.parentElement:t.oPopupEvent.srcElement.parentElement,!t.eventSource.cusAttr("Enabled"))return;if(o=t.eventSource.cusAttr("index"),o&&t.menuItems[o]!=null?t.DisplayPopUp(t.menuItems[o],t.eventSource):t.HiddenPopUp(t.eventSource),s=t.eventSource.cusAttr("index").split(".").length-1,i=t.popsSelected[s],t.popsSelected[s]!=null,i!=null&&(i.style.background="",i.style.color="",i.children.length>0)){for(n=0,f=i.children.length;n<f;n++)i.childNodes[n].style.background="",i.childNodes[n].style.color="";i.childNodes[0].style.borderLeft=t.unselectedBorderStyle,i.childNodes[0].style.borderTop=t.unselectedBorderStyle,i.childNodes[0].style.borderBottom=t.unselectedBorderStyle,i.childNodes[1].style.borderTop=t.unselectedBorderStyle,i.childNodes[1].style.borderBottom=t.unselectedBorderStyle,i.childNodes[2].style.borderTop=t.unselectedBorderStyle,i.childNodes[2].style.borderBottom=t.unselectedBorderStyle,i.childNodes[2].style.borderRight=t.unselectedBorderStyle}if(t.eventSource!=null){for(e=t.eventSource.parentElement,h=e.childNodes.length,t.Menu_nIndex>=h?t.Menu_nIndex=1:t.Menu_nIndex<=0&&(t.Menu_nIndex=h-1),r=null,n=0,f=t.eventSource.parentElement.children.length;n<f;n++)t.eventSource.parentElement.children[n].id==e.childNodes[t.Menu_nIndex].id&&(r=t.eventSource.parentElement.children[n]);for(r.cusAttr("Enabled")&&(r.style.background="",r.style.color="",r.childNodes[0].style.borderLeft=t.unselectedBorderStyle,r.childNodes[0].style.borderTop=t.unselectedBorderStyle,r.childNodes[0].style.borderBottom=t.unselectedBorderStyle,r.childNodes[1].style.borderTop=t.unselectedBorderStyle,r.childNodes[1].style.borderBottom=t.unselectedBorderStyle,r.childNodes[2].style.borderTop=t.unselectedBorderStyle,r.childNodes[2].style.borderBottom=t.unselectedBorderStyle,r.childNodes[2].style.borderRight=t.unselectedBorderStyle),u=t.eventSource.parentElement.children,c=u.length,n=0;n<c;n++)u[n].style.background="",u[n].childNodes[0].style.borderLeft=t.unselectedBorderStyle,u[n].childNodes[0].style.borderTop=t.unselectedBorderStyle,u[n].childNodes[0].style.borderBottom=t.unselectedBorderStyle,u[n].childNodes[1].style.borderTop=t.unselectedBorderStyle,u[n].childNodes[1].style.borderBottom=t.unselectedBorderStyle,u[n].childNodes[2].style.borderTop=t.unselectedBorderStyle,u[n].childNodes[2].style.borderBottom=t.unselectedBorderStyle,u[n].childNodes[2].style.borderRight=t.unselectedBorderStyle;for(t.popsSelected[s]=t.eventSource,t.eventSource.style.backgroundColor=t.selectedColor,t.eventSource.style.cursor="pointer",t.eventSource.children.length>0&&(t.eventSource.childNodes[0].style.borderLeft=t.selectedBorderStyle,t.eventSource.childNodes[0].style.borderTop=t.selectedBorderStyle,t.eventSource.childNodes[0].style.borderBottom=t.selectedBorderStyle,t.eventSource.childNodes[1].style.borderTop=t.selectedBorderStyle,t.eventSource.childNodes[1].style.borderBottom=t.selectedBorderStyle,t.eventSource.childNodes[2].style.borderTop=t.selectedBorderStyle,t.eventSource.childNodes[2].style.borderBottom=t.selectedBorderStyle,t.eventSource.childNodes[2].style.borderRight=t.selectedBorderStyle),n=0,f=e.childNodes.length;n<f;n++)if(e.childNodes[n].innerText==t.eventSource.innerText){t.Menu_nIndex=n;break}}}}catch(l){}},this.oPopup_saveEventObject=function(n){t.oPopupEvent=n}},UF.UI.Menu.prototype={initialize:function(){UF.UI.Menu.callBaseMethod(this,"initialize"),this._hidden=$get(this._element.cusAttr("HelpId")),this.InitControl(),this.document=HtmlHelper.getElementDocument(this._element),this.attachEventPopBody()},dispose:function(){if(this._customHandler&&($removeHandler(this.attachEventControl,this._element.cusAttr("AttachEventStyle").substr(2),this._customHandler),this._customHandler=null),this._keydownHandler&&($removeHandler(this.attachEventControl,"keydown",this._keydownHandler),this._keydownHandler=null),this.popMenu=null,this.menuItems&&(Array.clear(this.menuItems),this.menuItems=null),this.displayImage=null,this.detachEventPopBody(),this.oPopupEvent=null,this.columstyle&&(Array.clear(this.columstyle),this.columstyle=null),this._hidden=null,this.Pops){for(var n=0;n<this.Pops.length;n++)document.body.removeChild(this.Pops[n]);this.Pops=null}this.popsIndex&&(Array.clear(this.popsIndex),this.popsIndex=null),this.popsSelected&&(Array.clear(this.popsSelected),this.popsSelected=null),this.attachDisplayControl=null,this.attachEventControl=null,this.popsDirection&&(Array.clear(this.popsDirection),this.popsDirection=null),this.isKeyBoardEvent=null,this.runtimeMenuItemState&&(Array.clear(this.runtimeMenuItemState),this.runtimeMenuItemState=null),this.runtimeMenuItemVisibleList&&(Array.clear(this.runtimeMenuItemVisibleList),this.runtimeMenuItemVisibleList=null),UF.UI.Menu.callBaseMethod(this,"dispose")},detachEventPopBody:function(){this.oPopupBody1&&($(this.oPopupBody1).unbind("click",this.oPopup_onclick),$(this.oPopupBody1).unbind("contextmenu",this.oPopup_oncontextmenu),$(this.oPopupBody1).unbind("mouseover",this.oPopup_mouseover),this.oPopupBody1=null)},attachEventPopBody:function(){$(window.document).on("mousedown","#root"+this._element.id,function(){$Event(event).preventDefault(),$Event(event).stopPropagation()});$(window.document).on("click","#root"+this._element.id,this.oPopup_onclick);$(window.document).on("contextmenu","#root"+this._element.id,this.oPopup_oncontextmenu);$(window.document).on("mouseover","#root"+this._element.id,this.oPopup_mouseover)},add_BeforeMenuItemClick:function(n){this.get_events().addHandler("BeforeMenuItemClick",n)},remove_BeforeMenuItemClick:function(n){this.get_events().removeHandler("BeforeMenuItemClick",n)},raiseBeforeMenuItemClick:function(n){var t=this.get_events().getHandler("BeforeMenuItemClick");return t&&t(this,n),this._deleteFlag},add_MenuItemClick:function(n){this.get_events().addHandler("MenuItemClick",n)},remove_MenuItemClick:function(n){this.get_events().removeHandler("MenuItemClick",n)},raiseMenuItemClick:function(n){var t,i;this.attachEventControl!=null&&(t=$find(this.attachEventControl.id),t&&t.raiseMenuItemclick&&t.raiseMenuItemclick(n)),i=this.get_events().getHandler("MenuItemClick"),i&&i(this,n)},add_BeforeLoadData:function(n){this.get_events().addHandler("BeforeLoadData",n)},remove_BeforeLoadData:function(n){this.get_events().removeHandler("BeforeLoadData",n)},raiseBeforeLoadData:function(n){var t=this.get_events().getHandler("BeforeLoadData");t&&(this._dynamicParams==null,t(this,n))},add_ContentChanged:function(n){this.get_events().addHandler("ContentChanged",n)},remove_ContentChanged:function(n){this.get_events().removeHandler("ContentChanged",n)},raiseContentChanged:function(n){var t=this.get_events().getHandler("ContentChanged");t&&t(this,n)},fireMenuItemClick:function(n){var t=new UF.UI.ChangeEventArgs;(t.ClientEventSource=n,t.Text=n.cusAttr("Text"),t.Value=n.cusAttr("Value"),t.Index=n.cusAttr("index")&&n.cusAttr("index").split(".").length>1?n.cusAttr("index").split(".")[1]:n.cusAttr("index"),this.get_IsCancelMenuItemClick()!=!1||(this.raiseBeforeMenuItemClick(t),this.get_IsCancelMenuItemClick()!=!0))&&(this.get_DeleteFlag()==!0&&this.raiseMenuItemClick(t),this.get_IsCancelMenuItemClick()==!0&&this.set_IsCancelMenuItemClick(!1))},fireBeforeLoadData:function(n){var t=new UF.UI.ChangeEventArgs;t.Text=n.Text,t.Value=n.Value,t.Index=n.index&&n.index.split(".").length>1?n.index.split(".")[1]:n.index,this.raiseBeforeLoadData(t),this.attachEventControl.control instanceof UF.UI.DropDownButton&&this.attachEventControl.control.raiseBeforeLoadData(t)},fireContentChanged:function(n){var t=new UF.UI.ChangeEventArgs;t.Text=n.Text,t.Value=n.Value,t.Index=n.index&&n.index.split(".").length>1?n.index.split(".")[1]:n.index,this.raiseContentChanged(t),this.attachEventControl.control instanceof UF.UI.DropDownButton&&this.attachEventControl.control.raiseContentChanged(t)},set_DeleteFlag:function(n){n==null||n.toString().toLowerCase()!="false"?this._deleteFlag=!0:(this._deleteFlag=!1,this._hidden.value="")},get_DeleteFlag:function(){return this._deleteFlag},get_Type:function(){return ControlType.Menu},InitControl:function(){this.AttachControls()},AttachControls:function(){this.attachEventControl=this._element.cusAttr("AttachEventControl")!=""?this._element.parentElement:this._element,this.attachDisplayControl=this._element.cusAttr("AttachDisplayControl")!=""?this._element.parentElement.children[0]:this._element,this._keydownHandler=Function.createDelegate(this,this.oattcontrol_keydown),$addHandler(this.attachEventControl,"keydown",this._keydownHandler),this.attachEventControl.control instanceof UF.UI.DropDownButton&&this.attachEventControl.control.set_Menu(this)},DropDown:function(n){var i,u,r;if(n!=!0&&($find(this.attachEventControl.id).get_MenuItemStateList&&(this.runtimeMenuItemState=$find(this.attachEventControl.id).get_MenuItemStateList()),$find(this.attachEventControl.id).get_MenuItemVisibleList&&(this.runtimeMenuItemVisibleList=$find(this.attachEventControl.id).get_MenuItemVisibleList()),(this.runtimeMenuItemState&&this.runtimeMenuItemState.length>0||this.runtimeMenuItemVisibleList)&&(this.isInit=!1)),i=this.document.createElement("PopMenu"),i.innerHTML=this._element.innerHTML,u=i.children[0].children,u.length>0&&(this.InitPopupMenu(),this.DisplayPopUp(this.menuItems[0],this.attachDisplayControl),!this._isMutliGroup&&n!=!0)){if(!this.menuItems[0])return;r=this.menuItems[0].displayBody,$(this.menuItems[0].displayBody).find("table").length>0&&(r=$(this.menuItems[0].displayBody).find("table")[0]),this.Menu_nIndex==-1&&(this.Menu_nIndex=r.childNodes.length-1),this.isKeyBoardEvent=!0,(this.getNextItemIndex(this.Menu_nIndex+1,!1)!=this.Menu_nIndex||this.isOnlyOneMenuItemEnabled())&&(this.Menu_nIndex=this.getNextItemIndex(this.Menu_nIndex+1,!1),this.moveSelectItem())}},HiddenPopUp:function(n){var t=null;n.index?t=n.index.split(".").length-1:($(n).find("table").length>0&&(n=$(n).find("table")[0]),t=n.cusAttr("index").split(".").length-1),this.Pops[t]==null&&this.CreatePopup(t),$(this.Pops[t]).css("visibility","hidden")},DisplayPopUp:function(n,t){var i,r,u,e,o,f;n.displayBody.innerText==""||n.displayBody.innerText.length<=0||(i=n.index.split(".").length-1,this.Pops[i]==null&&this.CreatePopup(i),r=this.Pops[i],r.isOpen!=!0||this.popsIndex[i]!=n.index)&&(curPopMenu=this,HtmlHelper.getElementDocument(r).bgColor="",this.oPopupBody1=r,this.oPopupBody1.innerHTML="<DIV id='root"+this._element.id+"' class='root' style='padding:1px;border:1px solid #959494;background-color:#FFFFFF;font-size:12px;width:98%;FILTER: progid:DXImageTransform.Microsoft.Shadow(direction=135,color=#959494,strength=5),progid:DXImageTransform.Microsoft.Alpha(opacity=100);' onkeydown='f(event);' onmouseover='f(event);return false;' onmousemove='return false;'>"+n.displayBody.outerHTML+"<\/DIV>",HtmlHelper.getElementDocument(r).f=this.oPopup_saveEventObject,this.oPopupBody1.style.overflow="hidden",$(r).css("visibility","hidden"),u=this.GetDimention(r),$(r).css({width:u.width,height:u.height,"z-index":1e4}),i!=0?(this.popsDirection[i]==null&&(this.popsDirection[i]=this.popsDirection[i-1]),this.JudageDisplayPosition(this.Pops[i-1],u,this.popsDirection[i])==!1&&(this.popsDirection[i]=this.popsDirection[i]=="left"?"right":"left"),this.popsDirection[i]=="right",$(r).css("visibility","")):(this.popsDirection=null,this.popsDirection=[],this.popsDirection[0]="right",$(r).css("visibility",""),e=this.JudageDisplayLRPosition(t,u),o=t.getBoundingClientRect().top,$(r).css({left:e,position:"absolute",top:o-u.height})),this.popsIndex[i]=n.index,this._element.id.indexOf("_SortMenu")>-1&&(f=$("#root"+this._element.id).parent("div"),f.attr("tabindex","-1"),f.focus(),f.blur(function(){window.setTimeout(function(){$(".root").hide()},0)})))},InitPopupMenu:function(){var i,r,u,t,s,e,o,n,h,f;if(!this.isInit&&(this.isInit=!0,this.popMenu=this.document.createElement("PopMenu"),this.popMenu.innerHTML=this._element.innerHTML,i=this.popMenu.children[0],i!=null))if(r=i.children.length,r<this.maxItemCount+1)this._isMutliGroup=!1,this.menuItems[0]=this.CreatePopDiv(i,"0");else{for(this._isMutliGroup=!0,u=[],n=0;n<r;n=n+this.maxItemCount)t={},t.from=n,t.to=n+this.maxItemCount-1,t.to>r-1&&(s=r%this.maxItemCount,t.to=t.from+s-1),u.push(t);for(e=$E(this.document).createElement("table"),o=$E(this.document).createElement("tr"),n=0,h=u.length;n<h;n++){var l=u[n],a=this.CreatePopDiv(i,"0",l),c=HtmlHelper.createElement("td",{valign:"top"});c.appendChild(a.displayBody),o.appendChild(c)}e.appendChild(o),f={},f.displayBody=e,f.index="0",this.menuItems[0]=f}},CreatePopDiv:function(n,t,i){var u={},e={cellspacing:"0",cellpadding:"0",style:this.tableStyle},f,r;if(u.displayBody=HtmlHelper.createElement("table",e),u.displayBody.appendChild(this.CreateColumns()),u.displayBody.focus(),u.index=t,f=n.children.length,i)for(r=i.from;r<i.to+1;r++)this.CreateMenuItem(n.children[r],u,r,n.children[r].cusAttr("itemID"));else for(r=0;r<f;r++)this.CreateMenuItem(n.children[r],u,r,n.children[r].cusAttr("itemID"));return u},CreateMenuItem:function(n,t,i,r){var s=i,v,c,f,p,l,u,o,w,b,a,h,k,y,e;if(n.cusAttr("Index")!=null&&(s=parseInt(n.cusAttr("Index"),10)),typeof n.cusAttr("Type")!="undefined"&&n.cusAttr("Type")=="MenuSeperator"){for(u=HtmlHelper.createElement("tr",{style:this.sepStyle}),v=3,c=0;c<v;c++)f=this.document.createElement("td"),c>=1?(f.style.borderLeft=this.unselectedBorderStyle,f.style.borderTop=this.unselectedBorderStyle,f.style.borderBottom=this.unselectedBorderStyle):c==v-1?(f.style.borderTop=this.unselectedBorderStyle,f.style.borderBottom=this.unselectedBorderStyle):(f.style.borderRight=this.unselectedBorderStyle,f.style.borderTop=this.unselectedBorderStyle,f.style.borderBottom=this.unselectedBorderStyle),u.appendChild(f),c>=1&&(f.style.background=this.sepColor);t.displayBody.appendChild(u),n.cusAttr("Visible")||(u.style.display="none")}else p=n.cusAttr("Value"),l=n.cusAttr("text"),l==""&&(l="&nbsp;&nbsp;&nbsp;&nbsp;"),n.cusAttr("Enabled")?this.runtimeMenuItemState!=null&&this.runtimeMenuItemState[r]!=null?this.runtimeMenuItemState[r].toString().toLowerCase()=="false"?(u=HtmlHelper.createElement("tr",{style:this.disItemStyle}),u.cusAttr("Enabled",!1)):(u=HtmlHelper.createElement("tr",{style:this.itemStyle}),u.cusAttr("Enabled",!0)):(u=HtmlHelper.createElement("tr",{style:this.itemStyle}),u.cusAttr("Enabled",!0)):this.runtimeMenuItemState!=null&&this.runtimeMenuItemState[r]!=null?n.cusAttr("EnableAuthority")==null&&this.runtimeMenuItemState[r].toString().toLowerCase()=="true"?(u=HtmlHelper.createElement("tr",{style:this.itemStyle}),u.cusAttr("Enabled",!0)):(u=HtmlHelper.createElement("tr",{style:this.disItemStyle}),u.cusAttr("Enabled",!1)):(u=HtmlHelper.createElement("tr",{style:this.disItemStyle}),u.cusAttr("Enabled",!1)),$(u).attr("title",n.getAttribute("title")),u.cusAttr("TopPanelClientID",n.cusAttr("TPnlID")),u.cusAttr("VerifyNotNull",n.cusAttr("VNull")),this.runtimeMenuItemVisibleList&&this.runtimeMenuItemVisibleList[r]===!1&&(u.style.display="none"),n.cusAttr("Visible")||(u.style.display="none",this.runtimeMenuItemVisibleList&&this.runtimeMenuItemVisibleList[r]===!0&&(u.style.display="")),u.cusAttr("index",s),o=this.document.createElement("td"),o.style.borderLeft=this.unselectedBorderStyle,o.style.borderTop=this.unselectedBorderStyle,o.style.borderBottom=this.unselectedBorderStyle,n.cusAttr("ImageUrl")!=null&&n.cusAttr("Selected")==undefined&&(w=n.cusAttr("ImageUrl"),e=$E(document).createElement("image",{style:this.imageStyle}),e.src=w,o.appendChild(e)),n.cusAttr("Selected")&&n.cusAttr("Selected").toString().toLowerCase()=="true"?(e=$E(document).createElement("image",{style:this.imageStyle}),e.src=this._element.cusAttr("ImagePath")+this.selectedImageSrc,o.appendChild(e)):(b=$E(document).createElement("div",{style:this.imageStyle}),o.appendChild(b)),a=this.document.createElement("td"),a.style.borderTop=this.unselectedBorderStyle,a.style.borderBottom=this.unselectedBorderStyle,h=this.document.createElement("td"),h.style.borderRight=this.unselectedBorderStyle,h.style.borderTop=this.unselectedBorderStyle,h.style.borderBottom=this.unselectedBorderStyle,k=$E(document).createElement("div",{style:this.imageStyle}),h.appendChild(k),y=this.document.createElement("NOBR"),y.innerHTML=l,a.appendChild(y),u.cusAttr("Value",p),u.cusAttr("Text",l),u.id="ss"+t.index+s,u.cusAttr("index",t.index+"."+s),u.cusAttr("itemID",n.cusAttr("itemid")),n.cusAttr("AutoPostBack")&&n.cusAttr("AutoPostBack").toString().toLowerCase()=="false"&&(u.cusAttr("AutoPostBack",!1),n.cusAttr("WinTitle")&&u.cusAttr("WinTite",n.cusAttr("WinTitle")),n.cusAttr("WinWidth")&&u.cusAttr("WinWidth",n.cusAttr("WinWidth")),n.cusAttr("WinHeight")&&u.cusAttr("WinHeight",n.cusAttr("WinHeight")),n.cusAttr("PartID")&&u.cusAttr("PartID",n.cusAttr("PartID")),n.cusAttr("CustomInParams")&&u.cusAttr("CustomInParams",n.cusAttr("CustomInParams")),n.cusAttr("HideStatusBar")&&u.cusAttr("HideStatusBar",n.cusAttr("HideStatusBar")),n.cusAttr("CC")&&u.cusAttr("CC",n.cusAttr("CC")),n.cusAttr("SDDB")&&u.cusAttr("SDDB",n.cusAttr("SDDB")),n.cusAttr("SMI")&&u.cusAttr("SMI",n.cusAttr("SMI")),n.cusAttr("SBTN")&&u.cusAttr("SBTN",n.cusAttr("SBTN"))),u.appendChild(o),u.appendChild(a),u.appendChild(h),t.displayBody.appendChild(u),$E(n.children).getElementTags("Items").length!=0&&(e=this.document.createElement("image"),e.src=this._element.cusAttr("ImagePath")+this.arrowHead,h.appendChild(e),this.menuItems[t.index+"."+s]=this.CreatePopDiv(HtmlHelper.getElementTags(n.children,"Items")[0],t.index+"."+s,s))},moveSelectItem:function(){var r,n,i,t;this.menuItems.length<=0||(r=this.menuItems[0].displayBody,$(r).find("table").length>0&&(r=$(r).find("table")[0]),nL=r.childNodes.length,this.Menu_nIndex>=nL?this.Menu_nIndex=1:this.Menu_nIndex<=0&&(this.Menu_nIndex=nL-1),n=r.childNodes[this.Menu_nIndex],n.cusAttr("index")&&this.menuItems[n.cusAttr("index")]!=null?this.DisplayPopUp(this.menuItems[parseInt(n.cusAttr("index"))],n):n.cusAttr("index")!=null&&this.HiddenPopUp(n),i=0,n.cusAttr("index")!=null&&(i=n.cusAttr("index").split(".").length-1),this.popsSelected[i]!=null&&this.popsSelected[i].cusAttr("Enabled")&&(t=this.popsSelected[i],t.style.background="",t.style.color="",t.children.length==3&&(t.childNodes[0].style.borderLeft=this.unselectedBorderStyle,t.childNodes[0].style.borderTop=this.unselectedBorderStyle,t.childNodes[0].style.borderBottom=this.unselectedBorderStyle,t.childNodes[1].style.borderTop=this.unselectedBorderStyle,t.childNodes[1].style.borderBottom=this.unselectedBorderStyle,t.childNodes[2].style.borderRight=this.unselectedBorderStyle,t.childNodes[2].style.borderTop=this.unselectedBorderStyle,t.childNodes[2].style.borderBottom=this.unselectedBorderStyle)),this.popsSelected[i]=n,this.popsSelected[i].cusAttr("Enabled")&&n.children.length==3&&(n.style.background=this.selectedColor,n.childNodes[0].style.borderLeft=this.selectedBorderStyle,n.childNodes[0].style.borderTop=this.selectedBorderStyle,n.childNodes[0].style.borderBottom=this.selectedBorderStyle,n.childNodes[1].style.borderTop=this.selectedBorderStyle,n.childNodes[1].style.borderBottom=this.selectedBorderStyle,n.childNodes[2].style.borderRight=this.selectedBorderStyle,n.childNodes[2].style.borderTop=this.selectedBorderStyle,n.childNodes[2].style.borderBottom=this.selectedBorderStyle),$(this.Pops[0]).css("visibility","hidden"),this.DropDown(!0))},oPopup_onEnter:function(){var sel,SBTN,SDDB,SMI,pID,cc,_this;if(!(this.Menu_nIndex<=0)&&(sel=this.menuItems[0].displayBody.childNodes[this.Menu_nIndex],sel!=null)){if(this.eventSource=sel,!sel.cusAttr("Enabled"))return;if($(this.Pops[0]).css("visibility","hidden"),this.eventSource.cusAttr("AutoPostBack")!=undefined&&this.eventSource.cusAttr("AutoPostBack").toString().toLowerCase()=="false"){if(SBTN=this.eventSource.cusAttr("SBTN"),SBTN){$find(SBTN).fireClick();return}if(SDDB=this.eventSource.cusAttr("SDDB"),SDDB){SMI=this.eventSource.cusAttr("SMI"),$find(SDDB).fireItemClick(SMI);return}pID=this.eventSource.cusAttr("PartID"),pID?(this.OnBeforeLoadData(this.eventSource),this.ShowMenuForm(this.eventSource)):(cc=this.eventSource.cusAttr("CC"),cc?eval(cc):(this._hidden.oldvalue=this._hidden.value,this._hidden.value=this.eventSource.cusAttr("index"),this.fireMenuItemClick(this.eventSource)));return}if(this._hidden.oldvalue=this._hidden.value,this._hidden.value=this.eventSource.cusAttr("index")+","+this.eventSource.cusAttr("itemID"),_this=this,_this._element.cusAttr("onfirequeuedevents")!=null){if(_this.eventSource.cusAttr("VerifyNotNull")&&_this.eventSource.cusAttr("VerifyNotNull").toString().toLowerCase()=="true"&&_this.eventSource.cusAttr("TopPanelClientID")&&_this.eventSource.cusAttr("TopPanelClientID")!=""&&!$ID(_this.eventSource.cusAttr("TopPanelClientID")).TopPanelNoEmptyVerify()){this.fireMenuItemClick(this.eventSource);return}_ClientJSExecQueueManager.Push(' __doPostBack("'+_this._element.id+'", "");$find("'+_this._element.id+'")._hidden.value = ""')}else _ClientJSExecQueueManager.Push('$find("'+_this._element.id+'")._hidden.value = ""');this.fireMenuItemClick(this.eventSource),window.AfterZlayerJsQueue||_ClientJSExecQueueManager.Start()}},oattcontrol_keydown:function(){switch(event.keyCode){case EventCodeDef.Enter:this.oPopup_onEnter(),$Event(event).stopPropagation(),$Event(event).preventDefault();break;case EventCodeDef.ArrowUp:if(!this.menuItems[0])return;this.Menu_nIndex==-1&&(this.Menu_nIndex=1),this.isKeyBoardEvent=!0,(this.getNextItemIndex(this.Menu_nIndex-1,!0)!=this.Menu_nIndex||this.isOnlyOneMenuItemEnabled())&&(this.Menu_nIndex=this.getNextItemIndex(this.Menu_nIndex-1,!0),this.moveSelectItem());break;case EventCodeDef.ArrowDown:if(!this.menuItems[0])return;var n=this.menuItems[0].displayBody;$(this.menuItems[0].displayBody).find("table").length>0&&(n=$(this.menuItems[0].displayBody).find("table")[0]),this.Menu_nIndex==-1&&(this.Menu_nIndex=n.childNodes.length-1),this.isKeyBoardEvent=!0,(this.getNextItemIndex(this.Menu_nIndex+1,!1)!=this.Menu_nIndex||this.isOnlyOneMenuItemEnabled())&&(this.Menu_nIndex=this.getNextItemIndex(this.Menu_nIndex+1,!1),this.moveSelectItem());break;case 39:this.menuItems[0]&&this.HiddenPopUp(this.menuItems[0]),this.getNext(!0);break;case 37:this.menuItems[0]&&this.HiddenPopUp(this.menuItems[0]),this.getNext(!1)}},getNextItemIndex:function(n,t){var i;return n==this.Menu_nIndex?n:t?(i=this.menuItems[0].displayBody,$(this.menuItems[0].displayBody).find("table").length>0&&(i=$(this.menuItems[0].displayBody).find("table")[0]),(n==0||n==-2)&&(n=i.childNodes.length-1),n==this.Menu_nIndex)?n:i.childNodes[n]&&i.childNodes[n].cusAttr("Enabled")?n:this.getNextItemIndex(--n,t):(i=this.menuItems[0].displayBody,$(this.menuItems[0].displayBody).find("table").length>0&&(i=$(this.menuItems[0].displayBody).find("table")[0]),n>i.childNodes.length-1&&(n=1),n==this.Menu_nIndex)?n:i.childNodes[n]&&i.childNodes[n].cusAttr("Enabled")?n:this.getNextItemIndex(++n,t)},isOnlyOneMenuItemEnabled:function(){var i=!0,r=0,t=this.menuItems[0].displayBody,n;for($(this.menuItems[0].displayBody).find("table").length>0&&(t=$(this.menuItems[0].displayBody).find("table")[0]),n=1;n<t.childNodes.length;n++)if(t.childNodes[n].cusAttr("Enabled")&&r++,r>1){i=!1;break}return i},getNext:function(n){var t=0,i=this.findDDRs(),e,r,u,f;if(i.length>0){for(e=this.attachEventControl.getElementsByTagName("Button")[0],r=0;r<i.length;r++)if(e==i[r]){t=r;break}for(n?t++:t--,t>=i.length&&(t=0),t<0&&(t=i.length-1),u=i[t],f=!0;f;)try{u=i[t],u.focus(),f=!1}catch(o){n?t++:t--,t>=i.length&&(t=0),t<0&&(t=i.length-1)}}},findDDRs:function(){for(var u=[],t=this.get_element().parentElement,r,n,f,i;!t.className.containsCssClass("ufpanel");)t=t.parentElement;for(r=t.getElementsByTagName("button"),n=0,f=r.length;n<f;n++)i=r[n],i.parentElement.cusAttr("tag")=="dropdownbutton"&&i.style.display!="none"&&(u[n]=i);return u},CreateColumns:function(n){var r,i,t;for(typeof n=="undefined",i=this.document.createElement("colgroup"),t=0;t<3;t++)r=HtmlHelper.createElement("col",{style:this.columstyle[t]}),i.appendChild(r);return i},JudageDisplayPosition:function(n,t,i){var r=t.width,o=t.height,s=window.screenLeft,h=window.screenTop,f=window.screen.width,c=window.screen.height,u=$E(n).document.parentWindow.screenLeft,l=$E(n).document.parentWindow.screenTop,e=$E(n).document.body.offsetWidth,a=$E(n).document.body.offsetHeight;return i=="right"?parseInt(f)-parseInt(u)-parseInt(e)-parseInt(r)<0?!1:!0:parseInt(u)-parseInt(r)<0?!1:!0},JudageDisplayLRPosition:function(n,t){var r=0,u=t.width,f=window.screen.width,i=0;return i=$(n).offset().left,r=i,f-i<u&&(r=f-i-u),r},JudageDisplayUpDownPosition:function(n,t){var i=n.getBoundingClientRect().top,r=document.body.clientHeight-i-n.offsetHeight;return r>t.height?!0:!1},getSigmaOffSetTop:function(n){for(var t=n,i=t.offsetTop;t.offsetParent!=null;)t=t.offsetParent,i=i+t.offsetTop;return i},GetDimention:function(n){var i,r,t=$(n).find("table").eq(0),u=t.find("col").eq(1);return u.width()==""&&t.css("tablelayout","fixed"),i=(t.width()||t[0].clientWidth)+10,r=(t.height()||t[0].clientHeight)+10,new Dimention(parseInt(i),parseInt(r))},OnAfterWindowClose:function(n){var i=null,t;n&&(i=PopupFormHelper.TranslateInfor(n),_datas=i,t=new UF.UI.ChangeEventArgs,t.result=_datas,t.sender=this.get_element(),this.fireContentChanged(t))},OnBeforeLoadData:function(n){var t=new UF.UI.ChangeEventArgs;t.sender=n,this.fireBeforeLoadData(t)},ShowMenuForm:function(n){var u=this.GetUrl(n),i=n.cusAttr("WinTitle"),r;i||(i="");var f=n.cusAttr("WinWidth"),e=n.cusAttr("WinHeight"),t=n.cusAttr("HideStatusBar");t=t&&t=="Y"?!0:!1,r=ShowModalDialog(u,i,e,f,t),this.OnAfterWindowClose(r)},AddParam:function(n,t,i){if(this._dynamicParams==null&&(this._dynamicParams=[]),i==undefined)this._dynamicParams[n]=t;else{var r=i+"__&_"+n;this._dynamicParams[r]=t}},GetUrl:function(n){var i=this.GetQueryString(n),t="simple.aspx";return t+=t.indexOf("?")==-1?"?"+i:t[t.length-1]=="?"||t[t.length-1]=="&"?i:"&"+i},GetQueryString:function(n){var r="lnk="+n.cusAttr("PartID"),f,i,u,e,t;if(f="&",this._dynamicParams!=null)for(id in this._dynamicParams)typeof this._dynamicParams[id]!="object"&&typeof this._dynamicParams[id]!="function"&&(i=null,id.indexOf("__&_")<0?i=id:(u=id.split("__&_"),e=u[0],e==this.eventSource.cusAttr("index").split(".")[1]&&(i=u[1])),i!=null&&(r+=f+i+"="+this._dynamicParams[id]));return t=n.cusAttr("CustomInParams"),t!=null&&t!=""&&(r+=t[0]=="&"?t:"&"+t),r},get_IsCancelMenuItemClick:function(){return this._isCancelMenuItemClick},set_IsCancelMenuItemClick:function(n){this._isCancelMenuItemClick=n!=null&&n.toString().toLowerCase()=="true"?!0:!1},CreatePopup:function(n){if(n<0)return null;if(this.Pops[n]!=null)return this.Pops[n];n==0?this.Pops[0]=window.document.createElement("div"):(this.Pops[n-1]==null&&(this.Pops[n-1]=this.CreatePopup(n-1)),this.Pops[n]=window.document.createElement("div")),document.body.appendChild(this.Pops[n]),this.Pops[n].setAttribute("degree",n)}},UF.UI.Menu.registerClass("UF.UI.Menu",UF.UI.Control),Dimention=function(n,t){this.width=n,this.height=t},EventCodeDef.Enter=13,EventCodeDef.ArrowUp=38,EventCodeDef.ArrowDown=40,Pops=[],Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Listbox=function(n){UF.UI.Listbox.initializeBase(this,[n]),this.imageCell=0,this.captionCell=1,this.valueCell=2,this.tagCell=3,this.selectedArray=new ListItemCollection,this.currentItem=null,this.optionsElement=null,this.selectedClass="2k3ListboxItemSelected",this.normalClass="2k3ListboxItem",this.moveClass="2k3ListboxItemOver"},UF.UI.Listbox.prototype={initialize:function(){UF.UI.Listbox.callBaseMethod(this,"initialize"),this.optionsElement=this.get_element().children[0];with(this.optionsElement)for(var i=0;i<rows.length;i++){typeof rows[i].selected!="undefined"&&rows[i].selected=="True"&&this.selectedArray.push(rows[i]);with(rows[i].children[this.imageCell])children.length==0?rows[i].children[this.imageCell].innerText=" ":this.children[0].hideFocus=!0}this.get_element().scrollTop=this.get_element().Top,this.get_element().scrollLeft=this.get_element().Left,this.get_element().selectedIndex=this.selectedArray.GetSeletedIndex(),this.get_element().children[0].rows[this.get_element().selectedIndex]!=null&&this.get_element().children[0].rows[this.get_element().selectedIndex].scrollIntoView(!1),this.setPostValue()},dispose:function(){this.imageCell=null,this.captionCell=null,this.valueCell=null,this.tagCell=null,this.selectedArray=null,this.currentItem=null,this.optionsElement=null,this.selectedClass=null,this.normalClass=null,this.moveClass=null,UF.UI.Listbox.callBaseMethod(this,"dispose")},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(n){var t=this.get_events().getHandler("onchange");t&&t(this,n)},add_ondoubleclick:function(n){this.get_events().addHandler("ondoubleclick",n)},remove_ondoubleclick:function(n){this.get_events().removeHandler("ondoubleclick",n)},raiseonondoubleclick:function(n){var t=this.get_events().getHandler("ondoubleclick");t&&t(this,n)},add_onrowclick:function(n){this.get_events().addHandler("onrowclick",n)},remove_onrowclick:function(n){this.get_events().removeHandler("onrowclick",n)},raiseonrowclick:function(n){var t=this.get_events().getHandler("onrowclick");t&&t(this,n)},elementOnMouseOver:function(){var n=getRealItem(window.event.srcElement);n.tagName=="TR"&&(n.className=this.moveClass),n=null},elementOnMouseOut:function(){var n=getRealItem(window.event.srcElement);n.tagName=="TR"&&(n.className=typeof n.selected!="undefined"&&n.selected=="True"?this.selectedClass:this.normalClass),n=null},elementOnClick:function(){var n=this.getRealItemClick(window.event.srcElement),r,u,t,i;if(n.tagName=="TR"){if(this.get_element().SelectType=="Multi"){if(this.currentItem==null||event.ctrlKey==!1&&event.shiftKey==!1)this.selectedArray.Clear(),this.currentItem=n,this.selectedArray.push(n);else if(event.ctrlKey==!0&&(n.selected=="True"?this.selectedArray.pop(n):this.selectedArray.push(n)),event.shiftKey==!0)for(this.selectedArray.Clear(),this.currentItem.rowIndex>=n.rowIndex?(r=n.rowIndex,u=this.currentItem.rowIndex):(u=n.rowIndex,r=this.currentItem.rowIndex),t=r;t<=u;t++)this.selectedArray.push(n.parentElement.rows[t]);this.get_element().selectedIndex=this.selectedArray.GetSeletedIndex(),this.get_element().text=""}else this.get_element().selectedIndex!=-1&&(this.get_element().selectedIndex!=""||typeof this.get_element().selectedIndex=="number"&&this.get_element().selectedIndex==0)&&(n.parentElement.children[this.get_element().selectedIndex].className=this.normalClass,n.parentElement.children[this.get_element().selectedIndex].selected="False"),n.className=this.selectedClass,n.selected="True",this.get_element().selectedIndex=n.rowIndex,this.get_element().text=n.children[this.captionCell].innerText,this.get_element().value=n.children[this.valueCell].innerText;i=new UF.UI.ChangeEventArgs,this.raiseonchange(i),i=new UF.UI.ChangeEventArgs,this.raiseonrowclick(i)}n=null,this.setPostValue()},setPostValue:function(){typeof this.get_element().document.all(this.get_element().HelpId)!="undefined"&&(this.get_element().document.all(this.get_element().HelpId).value=this.get_element().selectedIndex+"|"+parseInt(this.get_element().scrollTop)+","+parseInt(this.get_element().scrollLeft)),typeof this.get_element().PostBackHandle!="undefined"&&eval(this.get_element().PostBackHandle)},elementOnDoubleClick:function(){with(window.event){var el=getRealItemClick(srcElement);cancelBubble=!0,returnValue=!1}return el.tagName=="TR"&&ondoubleclick.fire(),el=null,!1},elementOnSelect:function(){with(window.event)cancelBubble=!0,returnValue=!1;return!1},itemCount:function(){return this.optionsElement.rows.length},sort:function(){for(var u=sortType=="Descending",t,n,r,c,i=0;i<this.optionsElement.rows.length;i++)for(t=this.optionsElement.rows[i].children[this.captionCell].innerText.toLowerCase(),n=0;n<=i;n++)if(r=this.optionsElement.rows[n].children[this.captionCell].innerText.toLowerCase(),(!u&&t<r||u&&t>r)&&i!=n){with(this.optionsElement.insertRow(this.optionsElement.rows[n].rowIndex)){for(className=this.normalClass,c=0;c<=3;c++)insertCell(c);with(children[this.imageCell])className="2k3ListboxImage",innerHTML=this.optionsElement.rows[i+1].children[this.imageCell].innerHTML;with(children[this.captionCell])className="2k3ListboxCaption",innerHTML=this.optionsElement.rows[i+1].children[this.captionCell].innerHTML;with(children[this.valueCell])className="2k3ListboxValue",innerText=this.optionsElement.rows[i+1].children[this.valueCell].innerText;with(children[this.tagCell])className="2k3ListboxTag",innerText=this.optionsElement.rows[i+1].children[this.tagCell].innerText}this.optionsElement.deleteRow(this.optionsElement.rows[i+1].rowIndex);break}setSelectedItem(getItemIndex(this.get_element().text))},addItem:function(itmType,text,value,n,exData,tagData){var t=this.optionsElement.insertRow(n),c;with(t){for(className=this.normalClass,c=0;c<=3;c++)insertCell(c);with(children[this.imageCell]){className="2k3ListboxImage";switch(itmType.toLowerCase()){case"n":innerHTML="<img src='"+this.get_element().currentStyle.noImageUrl+"'>";break;case"i":exData==""&&(exData=this.get_element().currentStyle.noImageUrl),innerHTML="<img src='"+exData+"'>";break;case"c":innerHTML=exData!=""&&exData.toLowerCase()!="false"&&exData?"<input type='checkbox' hidefocus checked style='height: 15px; overflow: hidden;'>":"<input type='checkbox' hidefocus style='height: 15px; overflow: hidden;'>"}}with(children[this.captionCell])className="2k3ListboxCaption",innerHTML=text;with(children[this.valueCell])className="2k3ListboxValue",innerText=value;with(children[this.tagCell])className="2k3ListboxTag",innerText=tagData}setSelectedItem(getItemIndex(text))},removeItem:function(n){this.optionsElement.deleteRow(n),this.get_element().selectedIndex==n&&(this.get_element().selectedIndex=-1,this.get_element().text="",this.get_element().value="",onchange.fire())},showItem:function(n){this.optionsElement.rows[n].style.display=""},hideItem:function(n){this.optionsElement.rows[n].style.display="none",selectedIndex==n&&(this.get_element().selectedIndex=-1,this.get_element().text="",this.get_element().value="",onchange.fire())},getItemIndex:function(itemText){with(this.optionsElement)for(var i=0;i<rows.length;i++)with(rows[i].children[this.captionCell])if(innerText==itemText)return rows[i].rowIndex;return-1},getItemText:function(n){return this.optionsElement.rows[n].children[this.captionCell].innerText},setItemText:function(n,t){this.optionsElement.rows[n].children[this.captionCell].innerText=t},getItemValue:function(n){return this.optionsElement.rows[n].children[this.valueCell].innerText},getItemHTML:function(n){return this.optionsElement.rows[n].children[this.captionCell].innerHTML},getItemTag:function(n){return this.optionsElement.rows[n].children[this.tagCell].innerText},getItemChecked:function(n){with(this.optionsElement.rows[n].children[this.imageCell])return children[0].tagName!="INPUT"?!1:children[0].checked},setSelectedItem:function(n){if(n==-1){if(this.get_element().selectedIndex!=-1){if(this.get_element().selectedIndex>this.optionsElement.rows.length-1){this.get_element().selectedIndex=-1,this.get_element().text="",this.get_element().value="";return}this.optionsElement.rows[this.get_element().selectedIndex].className=this.normalClass,this.get_element().selectedIndex=-1,this.get_element().text="",this.get_element().value="",onchange.fire()}}else{if(this.get_element().selectedIndex>this.optionsElement.rows.length-1){this.get_element().selectedIndex=-1,this.get_element().text="",this.get_element().value="";return}this.get_element().selectedIndex!=-1&&(this.optionsElement.rows[this.get_element().selectedIndex].className=this.normalClass);with(this.optionsElement.rows[n])className=this.selectedClass,this.get_element().selectedIndex=rowIndex,this.get_element().text=children[this.captionCell].innerText,this.get_element().value=children[this.valueCell].innerText;var t=new UF.UI.ChangeEventArgs;this.raiseonchange(t)}},getRealItem:function(n){if(n!=null){n.tagName=="IMG"&&(n=n.parentElement),n.tagName=="INPUT"&&(n=n.parentElement),n.tagName=="LI"&&(n=n.parentElement);switch(n.className){case"2k3ListboxImage":return n.parentElement;case"2k3ListboxCaption":return n.parentElement;default:return n}}else return n},getRealItemClick:function(n){if(n!=null){n.tagName=="IMG"&&(n=n.parentElement),n.tagName=="LI"&&(n=n.parentElement);switch(n.className){case"2k3ListboxImage":return n.parentElement;case"2k3ListboxCaption":return n.parentElement;default:return n}}else return n}},UF.UI.Listbox.registerClass("UF.UI.Listbox",UF.UI.Control),ListItemCollection=function(){this.selectedClass="2k3ListboxItemSelected",this.normalClass="2k3ListboxItem",this.moveClass="2k3ListboxItemOver",this.Item=[]},ListItemCollection.prototype={dispose:function(){Array.clear(this.Item),this.Item=null},Clear:function(){for(var n=0;n<this.Item.length;n++)this.Item[n].selected="False",this.Item[n].className=this.normalClass;this.Item=[]},push:function(n){n.className=this.selectedClass,n.selected="True",this.Item.push(n)},pop:function(n){n.selected="False",n.className=this.normalClass},GetSeletedIndex:function(){for(var n="",t=0;t<this.Item.length;t++)this.Item[t].selected=="True"&&(n+=this.Item[t].rowIndex+",");return n=n.length>=1?n.substring(0,n.length-1):-1},GetItemByIndex:function(){for(var n=0;n<this.Item.length;n++)this.Item[n].selected=="True"&&(result+=this.Item[n].rowIndex+",");result.length>=1&&(result=result.substring(0,result.length-1))}},Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Wizard=function(n){UF.UI.Wizard.initializeBase(this,[n]),this._hidden,this._readOnly=!1},UF.UI.Wizard.prototype={initialize:function(){UF.UI.Wizard.callBaseMethod(this,"initialize")},dispose:function(){this._hidden=null,UF.UI.Wizard.callBaseMethod(this,"dispose")},add_onchange:function(n){this.get_events().addHandler("onchange",n)},remove_onchange:function(n){this.get_events().removeHandler("onchange",n)},raiseonchange:function(n){var t=this.get_events().getHandler("onchange");t&&t(this,n)},get_ReadOnly:function(){return this._readOnly},set_ReadOnly:function(n){n=ToBoolean(n);for(var t=0,i=this._element.children.length;t<i;t++)$(this._element.children[t]).attr("readOnly",n);this._readOnly=n},get_Enabled:function(){return!this.get_ReadOnly()},set_Enabled:function(n){this.set_ReadOnly(!n)},get_Visible:function(){return this._element.style.visibility!="hidden"},set_Visible:function(n){this._element.style.visibility=n?"visible":"hidden"},get_Type:function(){return ControlType.Wizad},get_CurrentPageIndex:function(){return this.get_hiddenField().value},set_CurrentPageIndex:function(n){this.get_hiddenField().value=n,this.page_onchange()},get_hiddenField:function(){return this._hidden==null&&(this._hidden=window.document.getElementById($(this._element).attr("name"))),this._hidden},SetFocus:function(){},CurrentPage:function(){for(var t,n=0;n<this._element.children.length;n++)if(t=this._element.children[n],t.style.display!="none")return t;this.fireOnChangeEvent()},Clear:function(){for(var t,n=0;n<this._element.children.length;n++)return t=this._element.children[n],t&&this.ClearControls(t),t},ClearControls:function(n){for(var i=[],t=0,u=n.getElementsByTagName("span"),r=0,f=u.length;r<f;r++)u[r].className=="border4Box UFTextBox"?(i[t]=u[r],i[t].Value="",t++):u[r].className=="4BorderMO Reference"?(i[t]=u[r],i[t].Key="-1",i[t].Value="",i[t].Text="",t++):u[r].className=="4BorderMO DropDownList"&&(i[t]=u[r],i[t].Value="-1",t++);return i},page_onchange:function(){var i,elePage;if(this._element.cusAttr("Server")&&this._element.cusAttr("Server").toString().toLowerCase()=="true"){__doPostBack(this._element.id,"");return}for(i=0;i<this._element.children.length;i++)elePage=this._element.children[i],this.get_hiddenField().value.indexOf("$ID")>=0&&(this.get_hiddenField().value=eval(this.get_hiddenField().value)),this.get_hiddenField().value==i?(elePage.style.visibility="visible",elePage.style.display="",TdSetHeightHelper.GetInstance($(elePage),"yesWizard").init()):(elePage.style.visibility="hidden",elePage.style.display="none");this.fireOnChangeEvent()},fireOnChangeEvent:function(){var n=new UF.UI.ChangeEventArgs;n.value=this.get_hiddenField().value,n.srcElement=this._element,this.raiseonchange(n)}},UF.UI.Wizard.registerClass("UF.UI.Wizard",UF.UI.Control),Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Expression=function(n){UF.UI.Expression.initializeBase(this,[n]);var t;this._textbox,this._button,this._text,this._value,this._hidden,this._IsShow=!1,this._ReadOnly=!1,this._TextReadOnly=!1,this.dataDom=null,this._keydownHandler,this._clickHandler},UF.UI.Expression.prototype={initialize:function(){var n,t;for(_initGo=function(n){n._clickHandler=Function.createDelegate(n,n.onButtonClicked),$addHandler(n._button,"click",n._clickHandler),n._keydownHandler=Function.createDelegate(n,n.onkeyDown),$addHandler(n._textbox,"keydown",n._keydownHandler),n._textboxfocusHandler=Function.createDelegate(n,n.onInputFocus),$addHandler(n._textbox,"focus",n._textboxfocusHandler),n._textboxblurHandler=Function.createDelegate(n,n.onInputBlur),$addHandler(n._textbox,"blur",n._textboxblurHandler),n.set_IsInitComlete(!0)},UF.UI.Expression.callBaseMethod(this,"initialize"),this._textbox=this._element.children[0],n=this._element.children.length-1;n>0;n--)this._element.children[n].id==this._element.id+"_button"&&(this._button=this._element.children[n]);this._IsShow=ToBoolean(this._element.cusAttr("IsShow")),this._ReadOnly=this._element.cusAttr("ReadOnly"),this._ReadOnly||(this._ReadOnly=ToBoolean(ExpressionTemplate.ReadOnly)),this._TextReadOnly=this._element.hasCusAttr("TextReadOnly")?ToBoolean(this._element.cusAttr("TextReadOnly")):ToBoolean(ExpressionTemplate.TextReadOnly),this.btnClassName==null&&(this.btnClassName=ExpressionTemplate.BtnClassName),this.btnClassName_Dis==null&&(this.btnClassName_Dis=ExpressionTemplate.BtnClassName_Dis),this._element.hasCusAttr("Value")&&(this._value=this._element.cusAttr("Value")),this._element.hasCusAttr("Text")&&(this._text=this._element.cusAttr("Text")),this._hidden=window.document.getElementById(this._element.cusAttr("HelpId")),t=this.initControl(),t&&_initGo(this)},dispose:function(){this._clickHandler&&($removeHandler(this._button,"click",this._clickHandler),this._clickHandler=null),this._keydownHandler&&($removeHandler(this._textbox,"keydown",this._keydownHandler),this._keydownHandler=null),this._textbox=null,this._button=null,this._IsShow=null,UF.UI.Expression.callBaseMethod(this,"dispose")},initControl:function(){return(this._ReadOnly&&$(this._button).attr("disabled",!0),this._textbox.readOnly=!0,this._hidden.value=escape(this.getXMLValue(this._value,this._text,this._IsShow.toString())),this._IsShow)?(this._IsShow=!1,this._element.cusAttr("IsShow","false"),this._hidden.value=escape(this.getXMLValue(this._value,this._text,this._IsShow.toString())),this.ShowRefForm()):1},getXMLValue:function(n,t,i){var r,u,f;return this.dataDom==null&&(this.dataDom=Basic.GetXmlDom()),r=this.dataDom.createElement("D"),r.setAttribute("V",n),r.setAttribute("T",t),r.setAttribute("S",i),u=0,u=XMLHelper.serializeXMLNodeToString(r),f=/\+/g,u=u.replace(f,"^^")},get_Type:function(){return ControlType.Expression},get_InputParameter:function(){return this._element.cusAttr("InputParameter")},set_InputParameter:function(n){this._element.cusAttr("InputParameter",n)},get_Value:function(){return this._value},set_Value:function(n){this._textbox.value=n,this._value=n,this._text=n,this._hidden.value=escape(this.getXMLValue(this._value,this._text,this._IsShow.toString()))},get_Text:function(){return this._text},set_Text:function(n){this._text=n,this._element.cusAttr("Text",n),this._hidden.value=escape(this.getXMLValue(this._value,this._text,this._IsShow.toString()))},get_Enabled:function(){return!this._element.cusAttr("disabled")},set_Enabled:function(n){var n,t,i;if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")){for(n=ToBoolean(n),this._element.cusAttr("disabled",!n),t=0,i=this.get_element().children.length;t<i;t++)$(this._element.children[t]).attr("disabled",!n);n?(this._textbox.className=this.tbClassName,this._button.className=this.btnClassName,this.btnmouseOutClass=this.btnClassName,this._element.className=UIControlClass.getNotReadOnlyCss(this._element)):(this._textbox.className=this.tbClassName_D,this._button.className=this.btnClassName_Dis,this.btnmouseOutClass=this.btnClassName_Dis,this._element.className=UIControlClass.getReadOnlyCss(this._element))}},get_ReadOnly:function(){return this._ReadOnly},set_ReadOnly:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")&&this.get_Enabled()&&(n=ToBoolean(n),this._ReadOnly=n,this._textbox&&$(this._textbox).attr("readOnly",!0),this._button&&(n?$(this._button).attr("disabled",!0):this.get_Enabled()&&$(this._button).attr("disabled",!1)),n?(this._textbox.className=this.tbClassName_R,this._button.className=this.btnClassName_Dis,this.btnmouseOutClass=this.btnClassName_Dis,this._element.className=UIControlClass.getReadOnlyCss(this._element)):(this._textbox.className=this.tbClassName,this._button.className=this.btnClassName,this.btnmouseOutClass=this.btnClassName,this._element.className=UIControlClass.getNotReadOnlyCss(this._element)),this._element.cusAttr("ReadOnly",n))},get_Visible:function(){return this._element.style.visibility!="hidden"},set_Visible:function(n){(this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this._element.style.visibility=n?"visible":"hidden")},onkeyDown:function(){switch(window.event.keyCode){case KeyCode.down:window.event.altKey&&(this.onButtonClicked(),$Event(event).stopPropagation());break;case KeyCode.F2:this.onButtonClicked(),$Event(event).stopPropagation()}},onInputReturn:function(){this._textbox.value!=this.Value&&this.OnContentChanged(this._textbox.value)},onButtonClicked:function(){this.get_ReadOnly()!=!0&&this.SetIsShowForm("true")},GetUrl:function(){var t=this.GetQueryString(),n="Simple.aspx?lnk=6b14cbe3-39b3-44db-9d20-e86dfe39f5d3";return n+=n.indexOf("?")==-1?"?"+t:n[n.length-1]=="?"||n[n.length-1]=="&"?t:"&"+t},GetQueryString:function(){return"ExpressionType="+this._element.cusAttr("ExpressionType")+"&FunCategory="+this._element.cusAttr("FunCategory")+"&InputParameter="+this._element.cusAttr("InputParameter")+"&EleId="+this.get_element().id},ShowRefForm:function(){var r=this.GetUrl(),i=this._element.cusAttr("RefTitle");i||(i="");var u=this._element.cusAttr("W"),f=this._element.cusAttr("H"),t=this;return ShowModalDialogForAll(r,i,496,510,!1,!1,function(n){n!=null&&n!=undefined&&t.OnContentChanged(n);try{t._textbox.focus(),t._textbox.select()}catch(i){}_initGo(t)}),0},OnContentChanged:function(n){var t=PopupFormHelper.TranslateInfor(n);(t==null&&(t=new ReferenceData),this._value!=t.GetValue("Code"))&&(this._value=t.GetValue("Code"),this._text=t.GetValue("Name"),this._hidden.value=escape(this.getXMLValue(this._value,this._text,this._IsShow.toString())),this._textbox.value=this._text,this.fireContentChangedEvent(t),this.get_IsInitComlete()==!0&&Get_Global_IsPageLoadComplete()==!0&&this.set_IsValueChanged(!0))},fireContentChangedEvent:function(n){var t=new UF.UI.ChangeEventArgs;t.result=n,this.raiseContentChanged(t)},add_ContentChanged:function(n){this.get_events().addHandler("ContentChanged",n)},remove_ContentChanged:function(n){this.get_events().removeHandler("ContentChanged",n)},raiseContentChanged:function(args){this.get_element().onchange&&typeof this._element.cusAttr("PostBackHandle")!="undefined"&&eval(this._element.cusAttr("PostBackHandle"));var eh=this.get_events().getHandler("ContentChanged");eh&&eh(this,args)},SetIsShowForm:function(data){this._hidden.value=escape(this.getXMLValue(this._value,this._text,data.toString())),ToBoolean(data)&&typeof this._element.cusAttr("PostBackHandle")!="undefined"&&eval(this._element.cusAttr("PostBackHandle"))},onInputBlur:function(){this.ControlBlur(),this._textbox.value=this._text},onInputFocus:function(){this.ControlFocus(),this._textbox.value=this._value;try{this._textbox.select()}catch(n){}}},UF.UI.Expression.registerClass("UF.UI.Expression",UF.UI.InputControl),ExpressionTemplate.Enabled=InputControlTemplate.Enabled,ExpressionTemplate.ReadOnly=InputControlTemplate.ReadOnly,ExpressionTemplate.TBClassName=InputControlTemplate.TBClassName,ExpressionTemplate.TBClassName_R=InputControlTemplate.TBClassName_R,ExpressionTemplate.TBClassName_D=InputControlTemplate.TBClassName_D,ExpressionTemplate.BtnClassName="btn ExpBtn",ExpressionTemplate.BtnClassName_Dis="btn ExpBtn_Dis",ExpressionTemplate.TextReadOnly="False",Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.DropDownButton=function(n){UF.UI.DropDownButton.initializeBase(this,[n]),this._button,this._runtimeMenuItemState,this._runtimeMenuItemVisible,this._menu,this.IsFirstShowMenu=!0,this._focusHandler,this._blurHandler,this._clickHandler,this._keyDownHandler,this.visibleAuthority,this.enableAuthority},UF.UI.DropDownButton.prototype={initialize:function(){if(UF.UI.DropDownButton.callBaseMethod(this,"initialize"),this._runtimeMenuItemState=[],this._runtimeMenuItemVisible=[],this._button=this.GetTargetBtnfunction(),this.visibleAuthority=this._element.cusAttr("VisibleAuthority"),this.enableAuthority=this._element.cusAttr("EnableAuthority"),this._button){var n=this;this._focusHandler=Function.createDelegate(this,this.buttonFocus),$(this._button).bind("focus",function(){n.buttonFocus()}),this._blurHandler=Function.createDelegate(this,this.buttonBlur),$(this._button).bind("blur",function(){n.buttonBlur(),$(".root").hide()}),this._clickHandler=Function.createDelegate(this,this.buttonClick),$(this._button).bind("click",function(){n.buttonClick()}),this._keyDownHandler=Function.createDelegate(this,this.onkeyDown),$(this._button).bind("keydown",function(){n.onkeyDown()})}},dispose:function(){this._blurHandler&&(this._blurHandler=null,$(this._button).unbind("blur")),this._focusHandler&&(this._focusHandler=null,$(this._button).unbind("focus")),this._clickHandler&&(this._clickHandler=null,$(this._button).unbind("click")),this._keyDownHandler&&(this._keyDownHandler=null,$(this._button).unbind("keydown")),this.IsFirstShowMenu=null,this._runtimeMenuItemState=null,this._runtimeMenuItemVisible=null,UF.UI.DropDownButton.callBaseMethod(this,"dispose")},add_onclick:function(n){this.get_events().addHandler("onclick",n)},remove_onclick:function(n){this.get_events().removeHandler("onclick",n)},raiseonclick:function(n){var t=this.get_events().getHandler("onclick");t&&t(this,n)},add_BeforeShowMenu:function(n){this.get_events().addHandler("BeforeShowMenu",n)},remove_BeforeShowMenu:function(n){this.get_events().removeHandler("BeforeShowMenu",n)},raiseBeforeShowMenu:function(n){var t=this.get_events().getHandler("BeforeShowMenu");t?t(this,n):this.ShowMenu()},add_MenuItemClick:function(n){this.get_events().addHandler("MenuItemClick",n)},remove_MenuItemClick:function(n){this.get_events().removeHandler("MenuItemClick",n)},raiseMenuItemclick:function(n){var t=this.get_events().getHandler("MenuItemClick");t&&t(this,n)},add_BeforeLoadData:function(n){this.get_events().addHandler("BeforeLoadData",n)},remove_BeforeLoadData:function(n){this.get_events().removeHandler("BeforeLoadData",n)},raiseBeforeLoadData:function(n){var t=this.get_events().getHandler("BeforeLoadData");t&&t(this,n)},add_ContentChanged:function(n){this.get_events().addHandler("ContentChanged",n)},remove_ContentChanged:function(n){this.get_events().removeHandler("ContentChanged",n)},raiseContentChanged:function(n){var t=this.get_events().getHandler("ContentChanged");t&&t(this,n)},get_Type:function(){return ControlType.DropDownButton},GetTargetBtnfunction:function(){var n=null,t,i;try{t=$(this._element),i=this.get_id(),t.find("#"+i+"_button").length&&(n=t.find("#"+i+"_button")[0])}catch(r){n=null}return n},SetMenuItemEnable:function(n,t){var i=this.get_MenuItemByItemIndex(n);i&&i.cusAttr("itemID")&&this.SetMenuItemEnableByItemID(i.cusAttr("itemID"),t)},SetMenuItemEnableByItemID:function(n,t){var i=this.get_MenuItemByItemID(n);i&&(this._runtimeMenuItemState[n]=t,this._runtimeMenuItemState.length++),i&&i.cusAttr("ToDDB")?$find(i.cusAttr("ToDDB")).SetMenuItemEnableByItemID(i.cusAttr("ToMI"),t):i&&i.cusAttr("ToBTN")&&$find(i.cusAttr("ToBTN")).set_Enabled(t)},SetMenuItemVisible:function(n,t){var i=this.get_MenuItemByValue(n);i&&i.cusAttr("itemID")&&this.SetMenuItemVisibleByItemID(i.cusAttr("itemID"),t)},SetMenuItemVisibleByItemID:function(n,t){var i=this.get_MenuItemByItemID(n);i&&(this._runtimeMenuItemVisible[n]=t,this._runtimeMenuItemVisible.length++),i&&i.cusAttr("ToDDB")?$find(i.cusAttr("ToDDB")).SetMenuItemVisibleByItemID(i.cusAttr("ToMI"),t):i&&i.cusAttr("ToBTN")&&$find(i.cusAttr("ToBTN")).set_Visible(t)},get_MenuItemStateList:function(){return this._runtimeMenuItemState},get_MenuItemVisibleList:function(){return this._runtimeMenuItemVisible.length>0?this._runtimeMenuItemVisible:null},get_Menu:function(){return this._menu},set_Menu:function(n){this._menu=n},buttonFocus:function(){var n=this.GetTargetBtnfunction();$(n).css("border","1px dashed #FFFFFF")},buttonBlur:function(){var n=this.GetTargetBtnfunction();$(n).css("border","")},buttonClick:function(){var n=new UF.UI.ChangeEventArgs;this.raiseonclick(n),this.raiseBeforeShowMenu(n)},onkeyDown:function(){switch(event.keyCode){case EventCodeDef.ArrowUp:case EventCodeDef.ArrowDown:this.IsFirstShowMenu==!0&&(this.buttonClick(),window.$Event(event).stopPropagation(),$Event(event).preventDefault())}},set_Enabled:function(n){if((this.visibleAuthority==null||this.visibleAuthority.toString().toLowerCase()!="false")&&(this.enableAuthority==null||this.enableAuthority.toString().toLowerCase()!="false")){n=ToBoolean(n);var t=this.GetTargetBtnfunction();$(t).attr("disabled",!n),this._element.cusAttr("disabled",!n),this.set_HDValue("Enabled",n.toString().toLowerCase())}},get_Enabled:function(){return!this._element.cusAttr("disabled")},get_SelectedMenuItemText:function(){var n;return this.get_Menu()!=null&&this.get_Menu().eventSource!=null&&(n=this.get_Menu().eventSource.Text),n},ShowMenu:function(){this.get_Enabled()&&this._menu&&(this._menu.DropDown(),this.IsFirstShowMenu=!1)},HideMenu:function(){this._menu.Pops[0]&&$(this._menu.Pops[0]).css("visibility","hidden")},fireItemClick:function(n){if(this._menu){if(this._menu.oPopupBody1||this.buttonClick(),!this._menu.oPopupBody1||_ClientCallBackManager.Runing==!0){_ClientJSExecQueueManager.Clear("DDBClick"),_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').fireItemClick('"+n+"');","DDBClick");return}var t=this;$(this._menu.oPopupBody1).find("tr").each(function(i,r){if(r.cusAttr("ItemID")==n)return t._menu.oPopupEvent={},t._menu.oPopupEvent.srcElement=$(r).find("td").get(1),t._menu.oPopup_onclick(),t.HideMenu(),!1})}},get_MenuItemByValue:function(n){for(var i=this.get_element().children[1].children[0].children,t=0,r=i.length;t<r;t++)if(i[t].cusAttr("Value")==n)return i[t]},get_MenuItemByItemID:function(n){for(var i=this._element.children[1].children[0].children,t=0,r=i.length;t<r;t++)if(i[t].cusAttr("itemID")==n)return i[t]},get_MenuItemByItemIndex:function(n){for(var i=this._element.children[1].children[0].children,r=null,t=0,u=i.length;t<u;t++)i[t].hasCusAttr("Index")&&i[t].cusAttr("Index").toString()==n.toString()&&(r=i[t]);return r==null&&(r=i[t]),r}},UF.UI.DropDownButton.registerClass("UF.UI.DropDownButton",UF.UI.Control),Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.DataGrid=function(n){UF.UI.DataGrid.initializeBase(this,[n]),this.Values=[],this.GridIsInFocus=!1,this.stringEventSrc="",this.SortUPPattem="sort_up",this.SortDownPattem="sort_down",this.UNDEFINED_VALUE,this.RowAttribute=["Status","CopyRowArg"],this.ColAttribute=["ControlType","FieldID","Width","Sorted","DefaultValue"],this.CellAttribute=["Value","MultiLang","R"],this.MainCols,this.M_Table,this.D_Head,this.D_Body,this.D_Foot,this.S_Body,this.FullScreen=null,this.isFullScreen=!1,this.m_eventProcessLock=!1,this.m_gridFocusEventProcessed=!1,this.m_toolbarDiv,this.m_activeContainer,this.MainTableController,this.currentTable,this.pages,this.ParentDocument,this.Controls,this.dataDom,this.eventNode,this.calendar,this.cacuCol,this.testControl=0,this.ControlArray={},this.m_deletedRows=[],this.m_currentRowIndex=0,this.m_isRelaySwitchTag=!1,this.m_IsSwitchTabPage=!1,this.caculator=null,this.sumRowFlag="Original",this.newSumRowFlag="New",top.DataGridCurrentRowIndex4PCol==null&&(top.DataGridCurrentRowIndex4PCol=[],top.DataGridCurrentRowIndex4PCol[this.get_id()]=null),this.m_currentRowIndex4PCol=top.DataGridCurrentRowIndex4PCol[this.get_id()],this.m_batchModifyManager=null,top.DataGridBatchModifyManagerContainer&&top.DataGridBatchModifyManagerContainer[this.get_id()]&&(this.m_batchModifyManager=top.DataGridBatchModifyManagerContainer[this.get_id()]),this.m_currentColumnIndex=1,this._insertedRowNoType=InsertedRowNoType.HighAverage,this.m_lastRowIndex=0,this.m_columns=0,this.m_rows=0,this.m_gridReadOnly=!1,this.m_lastSelectedRow=-1,this.m_clientUserControl={},this.m_lastRowBackColor=DefaultSymbol.BodyCellBackgroundcolor,this.m_gridFaciesManager,this.m_behaviorManager,this.m_tableDimentionManager,this.m_gridBodyEventsHandler,this.m_pageBreakManagerInstance,this.m_CustomFilterManagerInstance,this.m_editMenuToolbar,this.m_InCellEditing=!1,this.m_AlwaysCollectData=!1,this.m_AlreadyBeforeCellEnter=!1,this.m_MaxRows=-1,this.m_CancelEditing=!0,this.m_ArrNos=[],this.m_FireEventByClickRefButton=!0,this.m_IsStartEdit=!1,this.m_PageSize=999999,this.m_aggregateColumnFieldNameValues=[],this.RefSplitter2="__&URS2&_",this.m_FrozenControlColumn=!1,this.m_OldColumnIndex=[],this.m_PageIndex=0,this.m_PageCount=1,this.m_TotalRows=0,this.m_SumAllData=!1,this.m_SumSelectedData=!1,this.m_isCheckedByClick=!0,this.Grid_IsDirtyData=!1,this.Grid_ClientRowDataDirtyDic={},this.ViewDirty=!1,this.m_Hidden_State=null,this.m_ColumnIndexList=[],this.m_DefaultValueColumns=[],this.m_DefaultValueColumnsOrder=[],this.DefaultValueSplitString="__*Split*_",this._columnsInforForEdit=[],this.m_SortColumns=[],this.m_SortColumnsLimit=3,this.m_IsSortSelectRecords=!1,this.m_SortedSelectIDs=[],this.m_UnSelectIDs=[],this.m_AllowEditSingleRow=!0,this.$element=$(this.get_element()),this.Maximized();var t=this;this.getColumnHeadCell=function(n,t){var u=this.D_Head.children.length-1,i,r;if(this.D_Head.children[u].cells[n]&&this.D_Head.children[u].cells[n].cusAttr("FieldID")==t)return this.D_Head.children[u].cells[n];for(i=u;i>=0;i--)for(r=0;r<this.D_Head.children[i].cells.length;r++)if(this.D_Head.children[i].cells[r].cusAttr("FieldID")==t)return this.D_Head.children[i].cells[r];return null},this.GetCurrentColumnsInfor=function(){var o=this.m_currentColumnIndex,l=this.MainCols[o].cusAttr("FieldID"),s,f,h,c,i,t,u,r,e,n;if(this._element.cusAttr("EditStatus")!=DisplayStyle.Browser&&!(this.m_currentRowIndex<0)){for(s=this.get_element().id+"_",f=0,h=0,c=this.MainCols.length,this._columnsInforForEdit=[],i=h;i<c;i++)if(t=this.MainCols[i],t.cusAttr("visible")){if(t.cusAttr("ColEditCtrlClientID4P")!=null&&!$find(t.cusAttr("ColEditCtrlClientID4P")))continue;if(t.cusAttr("IsEAll")=="false")continue;if(u=t.cusAttr("Name"),this.D_Head.children.length>1&&(u=this.getColumnHeadCell(i,t.cusAttr("FieldID"))?this.getColumnHeadCell(i,t.cusAttr("FieldID")).outerText:""),!u||u.trim()=="")continue;if(t.cusAttr("ColEditCtrlClientID4P")){if(e=t.cusAttr("ColEditCtrlClientID4P"),e&&(r=$ID(e)),this.GetColumnType(i)==ControlType.RefControl&&r&&r.control&&r.control.raiseBeforeLoadData&&r.control.raiseBeforeLoadData(Sys.EventArgs.Empty),r){n=new ColumnEditInfo(t.cusAttr("FieldID"),u),n.Control=r,this._columnsInforForEdit[f]=n,i==this.m_currentColumnIndex&&(n.Enabled=this.AllowEdit(i),n.IsInit=!0,n.Enabled&&(n.IsDefault=!0)),f++;continue}}else r=$get(s+t.cusAttr("FieldID"));r?(n=new ColumnEditInfo(t.cusAttr("FieldID"),u),n.Control=r,i==this.m_currentColumnIndex&&(n.Enabled=this.AllowEdit(i),n.IsInit=!0,n.Enabled&&(n.IsDefault=!0)),this._columnsInforForEdit[f]=n):t.cusAttr("ControlType")=="NORMAL"?(n=new ColumnEditInfo(t.cusAttr("FieldID"),u),n.Control=$E(window.document).createElement("Input",{type:"text","class":"border4Box"}),i==this.m_currentColumnIndex&&(n.Enabled=this.AllowEdit(i),n.IsInit=!0,n.Enabled&&(n.IsDefault=!0)),this._columnsInforForEdit[f]=n):t.cusAttr("ControlType")=="CHECKBOX"&&(n=new ColumnEditInfo(t.cusAttr("FieldID"),u),n.Control=$E(window.document).createElement("Input",{type:"checkbox","class":"border4Box"}),i==this.m_currentColumnIndex&&(n.Enabled=this.AllowEdit(i),n.IsInit=!0,n.Enabled&&(n.IsDefault=!0)),this._columnsInforForEdit[f]=n),this._columnsInforForEdit[f]&&f++}this.m_currentColumnIndex=o}},this.InitColumnInfor=function(n,t){var r,f,u,o,e,s,h,i;if(_ClientCallBackManager.Runing!=!0){if(r=this.GetColumnIndex(t),f=this.MainCols[r],f.cusAttr("ColEditCtrlClientID4P")){if(o=f.cusAttr("ColEditCtrlClientID4P"),o&&(u=$ID(o)),this.GetColumnType(r)==ControlType.RefControl&&u&&u.control&&u.control.raiseBeforeLoadData&&u.control.raiseBeforeLoadData(Sys.EventArgs.Empty),u){if(this.IsNeedSwitchTabPage(r)){_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').InitColumnInfor("+n+",'"+t+"');"),window.retvShowGridEdit&&_ClientJSExecQueueManager.Push("if(window.retvShowGridEdit) { window.retvShowGridEdit.CallMe(); }"),this.m_currentColumnIndex=r,this.ImitateSwitchTabPage(!0);return}i=this._columnsInforForEdit[n],i.IsInit=!0,i.Control=u,i.Enabled=this.AllowEdit(r),this._columnsInforForEdit[n]=i;return}}else u=$get(this.get_id()+"_"+t);e=this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this.m_currentRowIndex,r),this.m_gridBodyEventsHandler&&this.m_gridBodyEventsHandler.GridEditHelper.CellEditActive&&this.m_gridBodyEventsHandler.CanEndEdit(!1),e&&(this.AllowEdit(r)?(this.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.StartCellEdit(e),this.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.EndCellEdit(e)):f.cusAttr("ControlType")=="REF"&&(s=this.CreateReferenceControl(r),h=s.control,this.SetReferenceParameters(h,r,this.m_currentRowIndex,s.cusAttr("RefPara")))),u?(i=this._columnsInforForEdit[n],i.Control=u,i.Enabled=this.AllowEdit(r),i.IsInit=!0,this._columnsInforForEdit[n]=i):f.cusAttr("ControlType")=="NORMAL"?(i=this._columnsInforForEdit[n],i.Enabled=this.AllowEdit(r),i.IsInit=!0,this._columnsInforForEdit[n]=i):f.cusAttr("ControlType")=="CHECKBOX"&&(i=this._columnsInforForEdit[n],i.Enabled=this.AllowEdit(r),i.IsInit=!0,this._columnsInforForEdit[n]=i),this._columnsInforForEdit[n].IsInit=!0}},this.InitColumnsInfor=function(n){var p=this.m_currentColumnIndex,v,e,o,c,u,i,f,r,l,s,h,a,y,t;if(this._element.cusAttr("EditStatus")!=DisplayStyle.Browser&&!(this.m_currentRowIndex<0)){for(v=this._element.id+"_",e=0,o=0,c=this.MainCols.length,n!=null&&(o=this.GetColumnIndex(n),c=o+1),this._columnsInforForEdit=[],u=o;u<c;u++)if(i=this.MainCols[u],i.cusAttr("visible")){if(i.cusAttr("ColEditCtrlClientID4P")!=null&&!$find(i.cusAttr("ColEditCtrlClientID4P")))continue;if(i.cusAttr("IsEAll")=="false")continue;if(f=i.cusAttr("Name"),this.D_Head.children.length>1&&(f=this.getColumnHeadCell(u,i.cusAttr("FieldID"))?this.getColumnHeadCell(u,i.cusAttr("FieldID")).outerText:""),f.trim()=="")continue;if(i.cusAttr("ColEditCtrlClientID4P")){if(l=i.cusAttr("ColEditCtrlClientID4P"),l&&(r=$ID(l)),this.GetColumnType(u)==ControlType.RefControl&&r&&r.control&&r.control.raiseBeforeLoadData&&r.control.raiseBeforeLoadData(Sys.EventArgs.Empty),r){t={},t.DisplayName=f,t.FieldID=i.cusAttr("FieldID"),t.Control=r,t.Enabled=this.AllowEdit(this.GetColumnIndex(i.cusAttr("FieldID"))),this._columnsInforForEdit[e]=t,e++;continue}}else r=$get(v+i.cusAttr("FieldID"));s=this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this.m_currentRowIndex,u),this.m_gridBodyEventsHandler&&this.m_gridBodyEventsHandler.GridEditHelper.CellEditActive&&this.m_gridBodyEventsHandler.CanEndEdit(!1),s&&(h=this.GetColumnIndex(i.cusAttr("FieldID")),this.AllowEdit(h)?(this.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.StartCellEdit(s),this.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.EndCellEdit(s)):i.cusAttr("ControlType")=="REF"&&(a=this.CreateReferenceControl(h),y=a.control,this.SetReferenceParameters(y,h,this.m_currentRowIndex,a.cusAttr("RefPara")))),r?(t={},t.DisplayName=f,t.FieldID=i.cusAttr("FieldID"),t.Control=r,t.Enabled=this.AllowEdit(this.GetColumnIndex(i.cusAttr("FieldID"))),this._columnsInforForEdit[e]=t):i.cusAttr("ControlType")=="NORMAL"?(t={},t.DisplayName=f,t.FieldID=i.cusAttr("FieldID"),t.Control=$E(window.document).createElement("input",{type:"text","class":"border4Box"}),t.Enabled=this.AllowEdit(this.GetColumnIndex(i.cusAttr("FieldID"))),this._columnsInforForEdit[e]=t):i.cusAttr("ControlType")=="CHECKBOX"&&(t={},t.DisplayName=f,t.FieldID=i.cusAttr("FieldID"),t.Control=$E(window.document).createElement("input",{type:"checkbox","class":"border4Box"}),t.Enabled=this.AllowEdit(this.GetColumnIndex(i.cusAttr("FieldID"))),this._columnsInforForEdit[e]=t),e++}this.m_currentColumnIndex=p}},this.setFireEventByClickRefButton=function(n){t.m_FireEventByClickRefButton=n},this.FireCellChange=function(n,i,r){var u,f;if(i!=null&&r!=null){u=new CellDataContent(n,n),f=t.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(i,r),t.m_gridBodyEventsHandler.GridEditHelper.OnRowContentChanged(u,f.parentElement,r);return}u=new CellDataContent(n,n),f=t.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(t.m_currentRowIndex,t.m_currentColumnIndex),t.m_gridBodyEventsHandler.GridEditHelper.OnRowContentChanged(u,f.parentElement)},this.DoFirePostBack=function(){t.StoreState("YY"),t.GridIsInFocus=!0,t.FirePostBack(t.MainCols[t.m_currentColumnIndex].cusAttr("FieldID"),"")},this.RefBeforeLoadData=function(){if(this.m_FireEventByClickRefButton&&!t.m_AlreadyBeforeCellEnter){var n=new CellDataContent("","");t.SetCurrentCellInfo(n),n.CellEditEnabled=!0,t.OnBeforeCellFocusEnter(n)}},this.UpdateReferenceResult=function(n,i){var a,o,it,e,u,ct,c,v,y,rt,ut,f,p,w,ft,b,l,s,et,k,g,nt,tt,r,ht,at;if(window.UpdateReferenceResult4P==null&&(window.UpdateReferenceResult4P=[]),window.UpdateReferenceResult4P[t.get_id()]={},window.UpdateReferenceResult4P[t.get_id()].sender=n,window.UpdateReferenceResult4P[t.get_id()].args=i,t.UpdateReferenceResult4P.sender=n,t.UpdateReferenceResult4P.args=i,a=!1,i!=null&&i.result!=null&&i.result.Rows!=null){for(o=new ReferenceData,i.result.Rows.length>1&&(a=!0),r=0,it=i.result.Rows.length;r<it;r++)o.Rows[r]=i.result.Rows[r];o.isForceChange=i.result.isForceChange,window.UpdateReferenceResult4P[t.get_id()].result=o,window.UpdateReferenceResult4P[t.get_id()].args.result=o,t.UpdateReferenceResult4P.result=o}if((window.UpdateReferenceResult4P[t.get_id()].SourceRefOutFieldName=t.UpdateReferenceResult.SourceRefOutFieldName,t.UpdateReferenceResult4P.SourceRefOutFieldName=t.UpdateReferenceResult.SourceRefOutFieldName,n&&n.get_element()&&n.get_element().cusAttr("ColFldID4P")&&(window.UpdateReferenceResult4P[t.get_id()].SourceRefOutFieldName=t.UpdateReferenceResult4P.SourceRefOutFieldName=n.get_element().cusAttr("ColFldID4P")),e=null,u=null,n&&n.get_element()&&(e=n.get_element()),ct=$(e),c=e.columnIndex,c?(u=c,t.m_currentColumnIndex!=c):(v=e.cusAttr("GridCltID4P"),y=e.cusAttr("ColFldID4P"),v&&y&&(e.columnIndex=$find(v+"_"+y).get_element().columnIndex,u=e.columnIndex)),u)&&(t.GridIsInFocus=!0,rt=t.GetRowStatus(t.m_currentRowIndex),t.ResetRowStates(t.m_currentRowIndex),ut=t.m_currentRowIndex,f=u,t.MainCols[f].cusAttr("ReplaceColumn")&&(p=t.MainCols[f].cusAttr("ReplaceColumn"),p!==""&&(f=t.GetColumnIndex(p))),w=t.GetColValue(t.m_currentRowIndex,e.columnIndex),ft=i.result,t.MainCols[f]!=t.UNDEFINED_VALUE)){if(b=t.MainCols[f].cusAttr("RefRel"),l=[],b!=t.UNDEFINED_VALUE){for(s=b.split(";"),et=t.MainCols[f].cusAttr("FieldID"),r=0;r<s.length;r++)s[r].split(",").length>0&&s[r].split(",")[0]==et||(t.UpdateCellValueFromReferenceResult(ft,s[r]),k=s[r].split(","),k.length==4&&l.push(k[0]));t.UpdateNumbericPrecision(t.m_currentRowIndex)}t.MainCols[u].cusAttr("Post")=="2"&&t.FirePostBack(t.MainCols[u].cusAttr("FieldID"),"");var ot=t.CreateReferenceControl(f),h=ot.control,d=h.get_Key(),st=h.get_Text(),lt=h.get_Value();if(a==!0||i.result.getIsForceChange()||w!=t.GetColValue(t.m_currentRowIndex,u)||w!=d){if(t.SetColValue(t.m_currentRowIndex,u,d),t.SetColRefAttribute(t.m_currentRowIndex,u,lt+t.RefSplitter2+st),t.SetColText(t.m_currentRowIndex,f,st),ot.IsChange=!0,t.SetReferenceParameters(h,f,ut,h.get_element().cusAttr("RefPara")),t.FireCellChange(d,t.m_currentRowIndex,f),g=_ClientPostBackManager.Runing||t.IsThisGirdPosting,rt==RowStatus.Empty){if(nt=t.getCaculator(),t.m_gridBodyEventsHandler&&t.m_gridBodyEventsHandler.GridEditHelper&&nt){for(tt=t.m_gridBodyEventsHandler.GridEditHelper.GetSumColumnsDataList(),r=0;r<l.length;r++)ht=l[r],tt[ht]=null;nt.ResetAggForNewRow(tt)}at=t.SetDefaultValue4P(t.m_currentRowIndex,u),g&&_ClientJSExecQueueManager.Push("$find('"+t.get_id()+"').Focus(true);")}!g&&window.event&&window.event.type=="keydown"&&window.event.keyCode==KeyCode.enter&&(t.m_gridBodyEventsHandler.DoKeyEvent(window.event.keyCode,window.event),_ClientJSExecQueueManager.Push("UFFocus(true);"))}}},this.SecondLoadAjaxCall=function(n,t){var i,u,f,r;if($alert("{------二次加载AJAX-开始------}"),this.sndLoadRowIndex=n,u=$("input[name*='TASKID_HIDDENFIELD']"),f=this.GetCellValue(n,t).Value,i="SecondLoad.aspx?SourceID="+this.MainCols[t].cusAttr("FieldID")+"&SourceKey="+f+"&TaskID="+u.val(),r=this.GetColumnIndex("ID"),r>=0)i+="&pkey="+this.GetCellValue(n,r).Value;else{alert("请添加ID列！");return}i=AppendPopupUrl(i),$alert("URL:"+i),this._xmlhttpRequest||(this._xmlhttpRequest=GetXmlHttpRequest()),this._xmlhttpRequest&&ProcessRequest(this._xmlhttpRequest,i,this.SecondLoadCallBack)},this.SecondLoadCallBack=function(){var i,n,r;t._xmlhttpRequest&&t._xmlhttpRequest.readyState==4&&(i=t._xmlhttpRequest.responseText,$alert("Result:"+i),n=$.parseJSON(i),n.gridID=t.get_id(),n.rowIndex=t.sndLoadRowIndex,r=$SetSndLoadControlValue(n),$alert("{------二次加载AJAX-结束------}"))},this.UpdateReferenceResult4P=function(n,i,r){var u,p,f,s,b,c,l,e,a,v,y,h,w,o;if(t.UpdateReferenceResult4P.SourceRefOutFieldName==null){window.UpdateReferenceResult4P!=null&&window.UpdateReferenceResult4P[t.get_id()]!=null&&window.UpdateReferenceResult4P[t.get_id()].SourceRefOutFieldName!=null;return}if(_ClientPostBackManager.Runing==!0||Get_Global_WillDoPostBack()==!0){u="var _tmp_sender = window.UpdateReferenceResult4P['"+t.get_id()+"'].sender;",u+="var _tmp_args = window.UpdateReferenceResult4P['"+t.get_id()+"'].args;",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P.sender = _tmp_sender;",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P.args = _tmp_args;",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P.SourceRefOutFieldName = window.UpdateReferenceResult4P['"+t.get_id()+"'].SourceRefOutFieldName;",u+="var _tmp_curRowIndex = "+t.m_currentRowIndex+";",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P(_tmp_sender,_tmp_args,_tmp_curRowIndex)",Global_JSQueueEvalAfterPageLoadedManager.Add(u,!0);return}if(_ClientCallBackManager.Runing==!0){u="var _tmp_sender = window.UpdateReferenceResult4P['"+t.get_id()+"'].sender;",u+="var _tmp_args = window.UpdateReferenceResult4P['"+t.get_id()+"'].args;",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P.sender = _tmp_sender;",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P.args = _tmp_args;",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P.SourceRefOutFieldName = window.UpdateReferenceResult4P['"+t.get_id()+"'].SourceRefOutFieldName;",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P.result = window.UpdateReferenceResult4P['"+t.get_id()+"'].resutl;",u+="var _tmp_curRowIndex = "+t.m_currentRowIndex+";",u+="$find('"+t.get_id()+"').UpdateReferenceResult4P(_tmp_sender,_tmp_args,_tmp_curRowIndex)",_ClientCallBackManager.Add2PersonalProcessQueue(u);return}if((i==null||i.arg==null||t.UpdateReferenceResult4P.SourceRefOutFieldName==i.arg.ColField)&&(p=t.UpdateReferenceResult4P.SourceRefOutFieldName,t.UpdateReferenceResult4P.SourceRefOutFieldName=null,n=t.UpdateReferenceResult4P.sender,i=t.UpdateReferenceResult4P.args,i==null&&(i=this.CreateEventArgs()),i.result=t.UpdateReferenceResult4P.args.result,f=null,s=null,f=n&&n.get_element()?n.get_element():this.GetColumnControl(this.GetColumnIndex(p)),f!=null)&&(b=$(f),f.columnIndex?(s=f.columnIndex,t.m_currentColumnIndex!=s):(c=f.cusAttr("GridCltID4P"),l=f.cusAttr("ColFldID4P"),c&&l&&(f.columnIndex=$find(c+"_"+l).get_element().columnIndex,s=f.columnIndex)),s)&&(t.GridIsInFocus=!0,e=s,t.MainCols[e].cusAttr("ReplaceColumn")&&(a=t.MainCols[e].cusAttr("ReplaceColumn"),a!==""&&(e=t.GetColumnIndex(a))),v=i.result,t.MainCols[e]!=t.UNDEFINED_VALUE&&(y=t.MainCols[e].cusAttr("RefRel4P"),y!=t.UNDEFINED_VALUE))){for(h=y.split(";"),w=t.MainCols[e].cusAttr("FieldID"),o=0;o<h.length;o++)h[o].split(",").length>0&&h[o].split(",")[0]==w||(r==null?t.UpdateCellValueFromReferenceResult(v,h[o]):t.UpdateCellValueFromReferenceResult(v,h[o],r));r==null?t.UpdateNumbericPrecision(t.m_currentRowIndex):t.UpdateNumbericPrecision(r)}}},UF.UI.DataGrid.prototype={initialize:function(){UF.UI.DataGrid.callBaseMethod(this,"initialize"),this.InitControl()},dispose:function(){this.caculator&&(this.caculator.dispose(),this.caculator=null),this.m_gridFaciesManager&&(this.m_gridFaciesManager.dispose(),this.m_gridFaciesManager=null),this.m_behaviorManager&&(this.m_behaviorManager.dispose(),this.m_behaviorManager=null),this.m_tableDimentionManager&&(this.m_tableDimentionManager.dispose(),this.m_tableDimentionManager=null),this.m_gridBodyEventsHandler&&(this.m_gridBodyEventsHandler.dispose(),this.m_gridBodyEventsHandler=null),this.m_pageBreakManagerInstance&&(this.m_pageBreakManagerInstance.dispose(),this.m_pageBreakManagerInstance=null),this.m_editMenuToolbar&&(this.m_editMenuToolbar.dispose(),this.m_editMenuToolbar=null),this.Values=null,this.RowAttribute=null,this.ColAttribute=null,this.CellAttribute=null,this.MainCols=null,this.M_Table=null,this.D_Head=null,this.D_Body=null,this.D_Foot=null,this.S_Body=null,this.m_toolbarDiv=null,this.m_activeContainer=null,this.MainTableController=null,this.currentTable=null,this.pages=null,this.ParentDocument=null,this.dataDom=null,this.eventNode=null,this.ControlArray=null,this.m_ColumnIndexList=null,this.m_deletedRows&&(Array.clear(this.m_deletedRows),this.m_deletedRows=null),this.m_clientUserControl=null,this.m_aggregateColumnFieldNameValues&&(Array.clear(this.m_aggregateColumnFieldNameValues),this.m_aggregateColumnFieldNameValues=null),this.Grid_ClientRowDataDirtyDic=null,UF.UI.DataGrid.callBaseMethod(this,"dispose")},GetCloneHead:function(){return $(this.S_Body).find(".thead-tr")},InitOldCoumnIndex:function(){var i=this._element.cusAttr("ChangeColumInfo"),t,n;if(i.length>3&&(t=i.split(";"),t.length>0))for(n=0;n<t.length;n++)this.m_OldColumnIndex[n]=[],this.m_OldColumnIndex[n]=t[n].split(",")},GetOldColumnIndex:function(n){var r=n,i,t;if(typeof this._element.cusAttr("ChangeColumInfo")!="undefined"&&(this.m_OldColumnIndex.length==0&&this.InitOldCoumnIndex(),i=this.GetColumnFieldID(n),i!=""))for(t=0;t<this.m_OldColumnIndex.length;t++)if(i==this.m_OldColumnIndex[t][0]){r=this.m_OldColumnIndex[t][1];break}return r},GetColumnNameByOldIndex:function(n){var i=this.MainCols[n].cusAttr("FieldID"),t;if(typeof this._element.cusAttr("ChangeColumInfo")!="undefined"&&(this.m_OldColumnIndex.length==0&&this.InitOldCoumnIndex(),this.m_OldColumnIndex.length>0))for(t=0;t<this.m_OldColumnIndex.length;t++)if(n==this.m_OldColumnIndex[t][1]){i=this.m_OldColumnIndex[t][0];break}return i},AddAggregateColumnFieldNameValue:function(n,t,i){var r=this.m_aggregateColumnFieldNameValues.length,u=new AggregateColumnFieldNameValue(n,t,i);this.m_aggregateColumnFieldNameValues[r]=u},ClearAggregateColumnFieldNameValues:function(){Array.clear(this.m_aggregateColumnFieldNameValues)},SetMaxRows:function(n){this.m_MaxRows=n},GetMaxRows:function(){return this.m_MaxRows},ResetCurrencySymbolByColumnName:function(n){for(var r=this.GetColumnIndex(n),u,i=0;i<this.D_Body.rows.length;i++)u=this.D_Body.rows[i].cells[r],this.setCellListValue(u,this.m_formatHelper.FormatCellNumber(r,i,this.GetCellValue(i,r).Value,this.GetCellValue(i,r).Value).Text)},HasSwitchColumn:function(n){var t=!1;return this.MainCols[n].cusAttr("ReplaceColumn")&&(t=!0),t},HideMenu:function(){this.m_gridBodyEventsHandler&&this.m_gridBodyEventsHandler.GridEditHelper&&this.m_gridBodyEventsHandler.GridEditHelper.HideMenu()},ResetRowStates:function(n){n==this.UNDEFINED_VALUE&&(n=this.m_currentRowIndex);var t=this.D_Body.rows[n];t&&(t.cusAttr("Status")==RowStatus.UnChanged?t.cusAttr("Status",RowStatus.Modified):t.cusAttr("Status")==RowStatus.Empty&&(t.cusAttr("Status",RowStatus.Added),this.set_TotalRows(this.m_TotalRows+1)))},ResetRowState2UnChanged:function(n){n==this.UNDEFINED_VALUE&&(n=this.m_currentRowIndex);var t=this.D_Body.rows[n];t&&t.cusAttr("Status")!=RowStatus.Empty&&t.cusAttr("Status",RowStatus.UnChanged)},SetRefRelByColumnIndex:function(n,t){this.MainCols[n]!=this.UNDEFINED_VALUE&&this.MainCols[n].cusAttr("RefRel",t)},Set_PartIDByColumnName:function(n,t,i,r){var s=this.GetColumnIndex(n),u,l,o,h,e;if(s>=0&&this.MainCols[s]!=this.UNDEFINED_VALUE&&(u=this.MainCols[s].cusAttr("FormRef"),u)){if(u.indexOf("lnk")>=0&&(l="Simple.aspx?lnk="+t,o=l+u.substring(u.indexOf("&"),u.length),i&&r)){var a=o.substring(o.indexOf("#"),o.length),v=o.split("#")[0],f=v.split(","),c=!1;if(i!=""&&(f[2]=i,c=!0),r!=""&&(f[3]=r,c=!0),c){for(h="",e=0;e<f.length;e++)h+=e==f.length-1?f[e]:f[e]+",";u=h+a}}this.MainCols[s].cusAttr("FormRef",u),this.m_currentFormRef=u}},Set_FormRefParamByColumnName:function(n,t,i,r,u,f){var l=this.GetColumnIndex(n),o,s,h,e,c;if(!(l<0)&&this.MainCols[l]!=this.UNDEFINED_VALUE&&(o=this.MainCols[l].cusAttr("FormRef"),o)){if(s=!1,h=o.split("#"),h.length==3){if(e=h[1].split(";"),e.length>0)for(c=0;c<e.length;c++)if(e[c].split(",")[0]==t){e[c]=t+","+i+","+r+","+u+","+f,s=!0;break}s||(e.push(t+","+i+","+r+","+u+","+f),s=!0)}s&&(h[1]=e.join(";"),o=h.join("#"),this.MainCols[l].cusAttr("FormRef",o),this.m_currentFormRef=o)}},Remove_FormRefParamByColumnName:function(n,t){var e=this.GetColumnIndex(n),i,o,u,r,f;if(!(e<0)&&this.MainCols[e]!=this.UNDEFINED_VALUE&&(i=this.MainCols[e].cusAttr("FormRef"),i)){if(o=!1,u=i.split("#"),u.length==3&&(r=u[1].split(";"),r.length>0))for(f=0;f<r.length;f++)if(r[f].split(",")[0]==t){r.splice(f,1),o=!0;break}o&&(u[1]=r.join(";"),i=u.join("#"),this.MainCols[e].cusAttr("FormRef",i),this.m_currentFormRef=i)}},Clear_FormRefParamsByColumnName:function(n){var i=this.GetColumnIndex(n),t,u,r;i<0||this.MainCols[i]!=this.UNDEFINED_VALUE&&(t=this.MainCols[i].cusAttr("FormRef"),t&&(u=!1,r=t.split("#"),r.length==3&&(r[1]="",t=r.join("#"),this.MainCols[i].cusAttr("FormRef",t),this.m_currentFormRef=t)))},IsHiddeLoading:function(){var n=this.GetIsBatchModifyRunning();return n?!0:!1},GetIsBatchModifyRunning:function(){return this.m_batchModifyManager&&this.m_batchModifyManager.isInProcessing?!0:!1},BatchModifyFowardOneUnit:function(){this.m_batchModifyManager&&this.m_batchModifyManager.FowardOneUnit()},ReadyToStartBatchModifyProcess:function(n){this.GetIsBatchModifyRunning()||(this.m_batchModifyManager=new GridBatchModifyProcessManager(this,n),this.m_batchModifyManager.initialize(),top.DataGridBatchModifyManagerContainer||(top.DataGridBatchModifyManagerContainer={}),top.DataGridBatchModifyManagerContainer[this.get_id()]=this.m_batchModifyManager,this.m_batchModifyManager.ShowProcess())},CompleteBatchModify:function(){var n,t,i,r;this.GetIsBatchModifyRunning()&&(n=this.m_batchModifyManager,n.isInProcessing=!1,n.OnCompleted(),t=n.rowIndexBefore,i=n.columnIndexBefore,this.m_batchModifyManager.dispose(),this.m_batchModifyManager=null,top.DataGridBatchModifyManagerContainer&&top.DataGridBatchModifyManagerContainer[this.get_id()]&&delete top.DataGridBatchModifyManagerContainer[this.get_id()],r=this.m_currentRowIndex!=t,this.EndEdit(),this.m_currentRowIndex=t,this.m_currentColumnIndex=i,this.Focus(!0),r&&this.OnRowChanged())},IsPersonalColumnByMoved:function(n){var t=n>=0&&n<this.MainCols.length?this.MainCols[n].cusAttr("ColEditCtrlClientID4P"):null;return t!=null&&t!=""},IsNeedSwitchTabPage:function(n,t){(typeof n=="undefined"||n==null||n==""||n<0)&&(n=this.m_currentColumnIndex),(typeof t=="undefined"||t==null||t==""||t<0)&&(t=this.m_currentRowIndex);var i=n>=0&&n<this.MainCols.length,r=i?this.MainCols[n].cusAttr("ColEditCtrlClientID4P"):null,u=i?this.MainCols[n].style.display!="none":!1;return r!=null&&u&&(this.m_currentRowIndex4PCol!=this.m_currentRowIndex||this.GetClientRowDataDirtyTag(t))},ImitateSwitchTabPage:function(n){var i,u,f,r,e,o,t;return this.IsNeedSwitchTabPage()?(i=this.GetRowStatus(this.m_currentRowIndex),this.m_IsSwitchTabPage=!0,i==RowStatus.Empty)?(u=this.m_currentColumnIndex,f=this.AddNewRow(),this.m_currentColumnIndex=u,_ClientPostBackManager.Runing==!0||Get_Global_WillDoPostBack()==!0?(Set_GridCurrentRowIndex4P(this.m_currentRowIndex4PCol),this.m_currentRowIndex4PCol=this.m_currentRowIndex,!0):_ClientCallBackManager.Runing?(n||Global_JSQueueEvalAfterPageLoadedManager.AddLast("$find('"+this.get_id()+"').ImitateSwitchTabPage();"),!0):f>=0?this.ImitateSwitchTabPage():!1):(this.m_IsSwitchTabPage=!1,this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","BeforeCellFocusEnter"),this.eventNode.setAttribute("RowIndex",this.m_currentRowIndex),this.StoreState("Y"),this.GridIsInFocus=!0,_ClientJSExecQueueManager.AddToFirstQuery("IsGridInImitateSwitchTabPage=false;$find('"+this.get_id()+"').SetClientRowDataDirtyTag($find('"+this.get_id()+"').m_currentRowIndex,false);"),(i==RowStatus.Empty||i==RowStatus.Added)&&(r=this.GetColumnIndex("ID"),r>=0&&(e=this.GetCellValue(this.m_currentRowIndex,r).Value,_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').RemoveClientRowDataDirtyTagByRowKey('"+e+"');"))),i==RowStatus.Empty?(o="if($find('"+this.get_id()+"').get_Rows() > "+this.m_currentRowIndex+"){$find('"+this.get_id()+"').m_currentRowIndex="+this.m_currentRowIndex+";$find('"+this.get_id()+"').m_gridFaciesManager.SetSelectedRow("+this.m_currentRowIndex+");$find('"+this.get_id()+"').Focus();$find('"+this.get_id()+"').StartEdit();}",_ClientJSExecQueueManager.AddToFirstQuery(o)):_ClientJSExecQueueManager.AddToFirstQuery("$find('"+this.get_id()+"').Focus(true);"),Set_GridCurrentRowIndex4P(this.m_currentRowIndex4PCol),this.m_currentRowIndex4PCol=this.m_currentRowIndex,top.DataGridCurrentRowIndex4PCol[this.get_id()]=this.m_currentRowIndex4PCol,t=this.CreateEventArgs(),this.InitializeEvent(t),this.IsEmptyRow(this.D_Body.rows[this.m_currentRowIndex])||(t.SrcColIndex=this.GetColumnIndex(t.EventSrc),t.SrcRowIndex=this.m_currentRowIndex),t.sourceElement=this.get_element(),this.raiseEvent(DataGridEvent.OnImitateSwitchTabPage,t),IsGridInImitateSwitchTabPage=!0,!0):!1},SetClientRowDataDirtyTag:function(n,t){var u,r,i;n>=0&&n<this.get_Rows()&&(u=this.GetRowStatus(n),r=this.GetColumnIndex("ID"),r>=0&&(i=this.GetCellValue(n,r).Value.toString(),i="g"+i.replace(/-/g,"_"),this.Grid_ClientRowDataDirtyDic[i]=t))},RemoveClientRowDataDirtyTagByRowKey:function(n){n="g"+n.replace(/-/g,"_"),typeof this.Grid_ClientRowDataDirtyDic[n]!="undefined"&&(this.Grid_ClientRowDataDirtyDic[n]=null,delete this.Grid_ClientRowDataDirtyDic[n])},GetClientRowDataDirtyTag:function(n){var i,t,r;return n>=0&&n<this.get_Rows()?(i=this.GetColumnIndex("ID"),i>=0)?(t=this.GetCellValue(n,i).Value.toString(),t="g"+t.replace(/-/g,"_"),typeof this.Grid_ClientRowDataDirtyDic[t]=="undefined"||this.Grid_ClientRowDataDirtyDic[t]==null?(r=this.GetRowStatus(n),r==RowStatus.Empty)?!0:(r==RowStatus.Deleted,!1):this.Grid_ClientRowDataDirtyDic[t]?!0:!1):!0:!1},GetPersonelColumnIndexById:function(n){if(typeof n=="string"&&n!="")for(var t=0;t<this.MainCols.length;t++)if(this.MainCols[t].cusAttr("ColEditCtrlClientID4P")&&this.MainCols[t].cusAttr("ColEditCtrlClientID4P")==n)return t;return-1},MoveToNextPosition:function(n,t){var i=this.m_currentRowIndex;this.m_lastRowIndex=i,this.m_gridBodyEventsHandler.CanEndEdit(!1)&&this.m_gridBodyEventsHandler.GetNextCellPosition(n,t)&&(this.m_gridBodyEventsHandler.GridFaciesHelper.SetCurrentCellStyle(this.m_currentRowIndex,this.m_currentColumnIndex),this.m_currentRowIndex!=i&&this.OnRowChanged())},DoPersonalAssoEventAfterPost:function(n){var t,o;if(window.Global_GridAsso&&window.Global_GridAsso[this.get_id()]){var r=window.Global_GridAsso[this.get_id()],u=this.GetColumnIndex(r.eventColumn),p=this.GetColumnIndex("ID"),l="",a="",f=[],s=null,i={},h=!0;for(t=0;t<this.D_Body.rows.length;t++)if(this.IsEmptyRow(this.D_Body.rows[t])!==!0){var e=!0,w=this.D_Body.rows[t].cells[p].cusAttr("Value"),b=this.D_Body.rows[t].cells[u].cusAttr("Value");if(b&&r.rowIndex!=t||(e=!1),e)for(o=0;o<r.existsRows.length;o++)if(r.existsRows[o]==w){e=!1;break}if(e){var v=this.get_id(),y='var tGrid=$find("'+v+'");tGrid.EndEdit();if(tGrid.m_currentRowIndex != '+t+"){ tGrid.m_currentRowIndex="+t+";tGrid.OnRowChanged(true);}",c="var p={};p.hasAssoFire="+(n.hasAssoFire?"true":"false")+";p.hasDefault="+(n.hasDefault?"true":"false")+";";c+="$find('"+v+"').DoCellDataValueChanged4P("+t+","+u+",p);",t==this.m_currentRowIndex?(l=y,a=c,s=t):h?(_ClientJSExecQueueManager.Push(y),_ClientJSExecQueueManager.Push(c),h=!1):(i={},i.rowIndex=t,i.colIndex=u,f.push(i))}}s!=null&&(h?(_ClientJSExecQueueManager.Push(l),_ClientJSExecQueueManager.Push(a)):(i={},i.rowIndex=s,i.colIndex=u,f.push(i))),f.length>0&&(window.Global_GridAssoRunList=f),window.Global_GridAsso[this.get_id()]=null,_ClientJSExecQueueManager.Start()}},DoCellDataValueChanged4P:function(n,t,i){var f="var p={};p.hasAssoFire="+(i.hasAssoFire?"true":"false")+";p.hasDefault="+(i.hasDefault?"true":"false")+";",u,e,o;if(_ClientPostBackManager.Runing||Get_Global_WillDoPostBack()==!0){u=f,u+="$find('"+this.get_id()+"').DoCellDataValueChanged4P("+n+","+t+",p);",Global_JSQueueEvalAfterPageLoadedManager.Add(u);return}if(e=this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(n,t),e&&this.m_gridFaciesManager.SetCurrentCellStyle(n,t),o=new CellDataContent("",this.GetCellValue(n,t).Value),i.hasDefault&&this.SetDefaultValue4P(n,t),i.hasAssoFire&&this.OnCellDataValueChanged(o,n,t),window.Global_GridAssoRunList&&window.Global_GridAssoRunList.length>0){var r=window.Global_GridAssoRunList.shift(),s=this.get_id(),c='var tGrid=$find("'+s+'");tGrid.EndEdit();if(tGrid.m_currentRowIndex != '+r.rowIndex+"){ tGrid.m_currentRowIndex="+r.rowIndex+";tGrid.OnRowChanged(true);}",h=f;h+="$find('"+s+"').DoCellDataValueChanged4P("+r.rowIndex+","+r.colIndex+",p);",_ClientJSExecQueueManager.Push(c),_ClientJSExecQueueManager.Push(h),_ClientJSExecQueueManager.Start()}else _ClientJSExecQueueManager.Push("var g=$find('"+this.get_id()+"');g.Focus(true);"),_ClientJSExecQueueManager.Start()},PreparePersonalAssoEvent:function(n,t,i){var r,o,u,f,e;if(i&&(i.hasAssoFire||i.hasDefault)){for(r={},r.rowIndex=n,r.eventColumn=this.MainCols[t].cusAttr("FieldID"),r.existsRows=[],o=this.D_Body.rows.length,u=0;u<o;u++)f=this.GetRowStatus(u),(f==RowStatus.UnChanged||f==RowStatus.Modified)&&r.existsRows.push(this.GetCellValueByFieldAndRow("ID",u).Value);window.Global_GridAsso||(window.Global_GridAsso={}),window.Global_GridAsso[this.get_id()]=r,e='setTimeout("var p={};p.hasAssoFire='+(i.hasAssoFire?"true":"false")+";p.hasDefault="+(i.hasDefault?"true":"false")+";",e+="$find('"+this.get_id()+"').DoPersonalAssoEventAfterPost(p)\",0);",Global_JSQueueEvalAfterPageLoadedManager.Add(e)}},OnSort:function(columnIndex,sortArrow,fieldID){var evtArgs=this.CreateEventArgs(columnIndex,sortArrow);evtArgs.sourceElement=this.get_element(),this.raiseEvent(DataGridEvent.OnSortData,evtArgs),this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","OnSortData"),this.eventNode.setAttribute("SortArrow",sortArrow),fieldID==null&&(fieldID=this.GetColumnFieldID(columnIndex)),this.eventNode.setAttribute("ColName",fieldID),this.GridIsInFocus=!0,this.m_currentColumnIndex=columnIndex,eval(this._element.cusAttr("onfireevents"))},OnCellDataValueChanged:function(n,t,i){var e,o,r,s,h,f,c,u,p,l;this.Grid_IsDirtyData=!0;var a=this.MainCols[i].cusAttr("AssoFireCol"),v=a&&a=="true",y=this.hasPersonalDefaultValue();if((v||y)&&(_ClientPostBackManager.Runing==!0||Get_Global_WillDoPostBack()==!0)&&(e={},e.hasAssoFire=v,e.hasDefault=y,this.PreparePersonalAssoEvent(t,i,e)),o=i,serverColIndex=this.GetOldColumnIndex(o),this.ResetRowStates(t),this.SetCurrentCellInfo(n),r=this.CreateEventArgs(),this._element.cusAttr("EditStatus")==DisplayStyle.Edit){if(s=this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(t,o),!s)return"";if(u=this.getEventSrcs(),h=null,u[0]!="")for(f=0;f<u.length;f++)if(this.MainCols[s.cellIndex].cusAttr("FieldID")==u[f]){h=u[f];break}c=h,null!=c&&(u=this.getEventSrcs(),r.EventSrc=c)}return r.sourceElement=this.get_element(),r.arg=n,r.SrcColIndex=serverColIndex-1,r.SrcRowIndex=t,p=_ClientPostBackManager.Runing==!0||Get_Global_WillDoPostBack()==!0,this.raiseEvent(DataGridEvent.OnCellDataValueChanged,r),p||_ClientPostBackManager.Runing==!0||Get_Global_WillDoPostBack()==!0||(l=this.MainCols[i],l&&l.cusAttr("SndLoad")&&this.SecondLoadAjaxCall(t,i)),!n.Cancel},OnRowContentChanged4P:function(n,t,i){var e,r,o,s,f,h,u;if(this.Grid_IsDirtyData=!0,e=i,serverColIndex=this.GetOldColumnIndex(e),this.ResetRowStates(t),this.SetCurrentCellInfo(n),r=this.CreateEventArgs(),this._element.cusAttr("EditStatus")==DisplayStyle.Edit){if(o=this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(t,e),!o)return"";if(u=this.getEventSrcs(),s=null,u[0]!="")for(f=0;f<u.length;f++)if(this.MainCols[o.cellIndex].cusAttr("FieldID")==u[f]){s=u[f];break}h=s,null!=h&&(u=this.getEventSrcs(),r.EventSrc=h)}return r.sourceElement=this.get_element(),r.arg=n,r.SrcColIndex=serverColIndex,r.SrcRowIndex=t,this.raiseEvent(DataGridEvent.OnRowContentChanged4P,r),!n.Cancel},OnCellDataChanged:function(n,t,i){var u,r;return this.Grid_IsDirtyData=!0,Set_Global_IsDirtyData_TheForm(this.Grid_IsDirtyData),this.SetClientRowDataDirtyTag(t,!0),u=i,i=this.GetOldColumnIndex(u),this.ResetRowStates(this.m_currentRowIndex),this.SetCurrentCellInfo(n),r=this.CreateEventArgs(),r.SrcColIndex=u,r.SrcRowIndex=t,this.InitializeEvent(r),r.SrcColIndex=i-1,r.sourceElement=this.get_element(),r.arg=n,this.raiseEvent(DataGridEvent.OnCellDataChanged,r),!n.Cancel},OnBeforeCellFocusEnter:function(n){var i,r,t;if(this._element.cusAttr("NoFireEvent")==!0)return!1;if(this.IsNeedSwitchTabPage()){i="$find('"+this.get_id()+"').ImitateSwitchTabPage();",r="if(_ClientCallBackManager.Runing == true || _ClientPostBackManager.Runing == true || $find('"+this.get_id()+"').IsThisGirdPosting) { _ClientJSExecQueueManager.Push(\""+i+'"); } ',r+='else { eval("'+i+'"); }',window.setTimeout(r,0);return}return t=this.CreateEventArgs(),this.InitializeEvent(t),this.IsEmptyRow(this.D_Body.rows[this.m_currentRowIndex])||(t.SrcColIndex=this.GetOldColumnIndex(this.GetColumnIndex(t.EventSrc))-1,t.SrcRowIndex=this.m_currentRowIndex),t.sourceElement=this.get_element(),t.arg=n,this.raiseEvent(DataGridEvent.OnBeforeCellFocusEnter,t),n.CellEditEnabled},OnBeforeOpenDialog:function(n){colIndex=this.GetColumnIndex(n.FieldID),colIndex=this.GetOldColumnIndex(colIndex);var t=this.CreateEventArgs();return this.InitializeEvent(t),t.SrcColIndex=colIndex-1,t.SrcRowIndex=this.m_currentRowIndex,t.sourceElement=this.get_element(),t.arg=n,this.raiseEvent(DataGridEvent.OnBeforeOpenDialog,t),n.CancelDefaultAction},OnRowClicked:function(){var t=new CellDataContent("",""),n;this.SetCurrentCellInfo(t),n=this.CreateEventArgs(),n.sourceElement=this.get_element(),n.arg=t,this.raiseEvent(DataGridEvent.OnRowClick,n)},OnRowChanged:function(isBatModify,isRemoveRow){var context,evtArgs,js,func;this.m_currentRowIndex4PCol=-1,top.DataGridCurrentRowIndex4PCol[this.get_id()]=this.m_currentRowIndex4PCol,context=new CellDataContent("",""),this.SetCurrentCellInfo(context),evtArgs=this.CreateEventArgs(),evtArgs.sourceElement=this.get_element(),evtArgs.arg=context,this.m_IsSwitchTabPage||this.raiseEvent(DataGridEvent.OnRowChanged,evtArgs),typeof this._element.cusAttr("RowChangedEvent")!="undefined"?(this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","RowChanged"),this.eventNode.setAttribute("RowIndex",this.m_currentRowIndex),this.StoreState("Y"),this.GridIsInFocus=!0,this.GetRowStatus(this.m_currentRowIndex)==RowStatus.Empty&&(js="if($find('"+this.get_id()+"').get_Rows() > "+this.m_currentRowIndex+"){$find('"+this.get_id()+"').m_currentRowIndex="+this.m_currentRowIndex+";$find('"+this.get_id()+"').m_gridFaciesManager.SetSelectedRow("+this.m_currentRowIndex+");$find('"+this.get_id()+"').Focus();$find('"+this.get_id()+"').StartEdit();}",Global_JSQueueEvalAfterPageLoadedManager.Add(js)),this.m_currentRowIndex4PCol=this.m_currentRowIndex,top.DataGridCurrentRowIndex4PCol[this.get_id()]=this.m_currentRowIndex4PCol,eval(this._element.cusAttr("onfireevents"))):isBatModify==!0||typeof this._element.cusAttr("RowChangedInColumnsEvent")!="undefined",this.GetIsBatchModifyRunning()||_ClientPostBackManager.Runing!=!0&&Get_Global_WillDoPostBack()!=!0&&isBatModify!=!0&&(func="if($find('"+this.get_id()+"') && $find('"+this.get_id()+"').m_gridBodyEventsHandler && $find('"+this.get_id()+"').m_gridBodyEventsHandler.GridEditHelper)",func+="$find('"+this.get_id()+"').m_gridBodyEventsHandler.GridEditHelper.ShowMenu($find('"+this.get_id()+"').m_currentRowIndex);",window.setTimeout(func,100))},OnAfterOpenDialog:function(n){var t=this.CreateEventArgs();return t.sourceElement=this.get_element(),t.arg=n,this.raiseEvent(DataGridEvent.OnAfterOpenDialog,t),n.CancelDefaultAction},OnBodyRowSelected:function(n,t,i){var o=this.GetCellValueByFieldAndRow("ID",n).Value,r,u,s,f,e;if(t?this.SortedSelectIDs_Add(o):(this.SortedSelectIDs_Remove(o),this.UnSelectIDs_Add(o)),this.m_SumSelectedData&&t!=i)for(r=0;r<this.MainCols.length;r++)u=0,this.MainCols[r].cusAttr("HasSum")=="true"&&(u=parseFloat(this.D_Body.rows[n].cells[r].cusAttr("Value")),t?this.getCaculator().aggregationCalculater.Aggregating(r,0,u):this.getCaculator().aggregationCalculater.Aggregating(r,u,0));if(this._element.cusAttr("HasNewSumRow")=="true"&&t!=i)for(r=0;r<this.MainCols.length;r++)u=0,this.MainCols[r].cusAttr("HasSum")=="true"&&(u=parseFloat(this.D_Body.rows[n].cells[r].cusAttr("Value")),t?this.getCaculator().aggregationCalculater.AggregatingNewSum(r,0,u):this.getCaculator().aggregationCalculater.AggregatingNewSum(r,u,0));t||(s=this.m_gridFaciesManager.tableHead.children[0].cells[0],f=s.firstChild,f!=this.UNDEFINED_VALUE&&f.type=="checkbox"&&(f.checked=!1),this.m_pageBreakManagerInstance&&this.m_pageBreakManagerInstance.chk&&(this.m_pageBreakManagerInstance.chk.checked=!1)),e=this.CreateEventArgs(),e.sourceElement=this.get_element(),e.arg=new SelectRowArg(n,t),this.raiseEvent(DataGridEvent.OnBodyRowSelectedValueChange,e)},OnBodyRowSelectedClick:function(n,t){var i=this.CreateEventArgs();i.sourceElement=this.get_element(),i.arg=new SelectRowArg(n,t),this.raiseEvent(DataGridEvent.OnBodyRowSelected,i)},OnAfterRowAdded:function(n){var t=this.CreateEventArgs();t.sourceElement=this.get_element(),t.arg=n,this.InitializeEvent(t),this.raiseEvent(DataGridEvent.OnAfterRowAdded,t)},OnAfterRowInserted:function(n){var t=this.CreateEventArgs();t.sourceElement=this.get_element(),t.arg=n,this.InitializeEvent(t),this.raiseEvent(DataGridEvent.OnAfterRowInserted,t)},OnBeforeRowAdd:function(){var t=new CellDataContent("",""),n=this.CreateEventArgs();return n.sourceElement=this.get_element(),n.arg=t,this.InitializeEvent(n),this.raiseEvent(DataGridEvent.OnBeforeRowAdd,n),t.CancelAction},OnBeforeRowInsert:function(){var t=new CellDataContent("",""),n=this.CreateEventArgs();return n.sourceElement=this.get_element(),n.arg=t,this.InitializeEvent(n),this.raiseEvent(DataGridEvent.OnBeforeRowInsert,n),t.CancelAction},OnBeforeRowDelete:function(){var t=new CellDataContent("",""),n=this.CreateEventArgs();return n.sourceElement=this.get_element(),n.arg=t,this.InitializeEvent(n),this.raiseEvent(DataGridEvent.OnBeforeRowDelete,n),t.CancelAction},OnAfterRowDeleted:function(){var n=this.CreateEventArgs();n.sourceElement=this.get_element(),this.InitializeEvent(n),this.raiseEvent(DataGridEvent.OnAfterRowDeleted,n)},OnBeforeRowCopy:function(){var t=new CellDataContent("",""),n=this.CreateEventArgs();return n.sourceElement=this.get_element(),n.arg=t,this.InitializeEvent(n),this.raiseEvent(DataGridEvent.OnBeforeRowCopy,n),t.CancelAction},OnAfterRowCopyed:function(n,t){var i=this.CreateEventArgs();i.sourceElement=this.get_element(),i.SrcRowIndex=n,i.oldRowIndex=t,this.InitializeEvent(i),this.raiseEvent(DataGridEvent.OnAfterRowCopyed,i)},OnAfterRowCopyedDefaultAction:function(n,t){var r=!1,u,i;this._element.cusAttr("DisableDefaultCopyRowAction")!=this.UNDEFINED_VALUE&&(r=!0),u=this.GetRowStatus(t),u!=RowStatus.Modified&&u!=RowStatus.UnChanged&&(r=!0),r||(i=this.CreateEventArgs(),i.sourceElement=this.get_element(),i.SrcRowIndex=n,i.oldRowIndex=t,this.InitializeEvent(i),this.raiseEvent(DataGridEvent.OnAfterRowCopyed4Default,i))},OnCellClick:function(rowIndex,columnIndex){var context,evtArgs;this._element.cusAttr("NoFireEvent")&&this._element.cusAttr("NoFireEvent").toString()=="true"||(columnIndex=this.GetOldColumnIndex(columnIndex),context=new CellDataContent("",""),this.SetCurrentCellInfo(context),evtArgs=this.CreateEventArgs(),this.InitializeEvent(evtArgs),evtArgs.sourceElement=this.get_element(),evtArgs.arg=context,this.raiseEvent(DataGridEvent.OnCellClick,evtArgs),typeof this._element.cusAttr("ClickEvent")!="undefined"&&(this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","CellClick"),this.eventNode.setAttribute("RowIndex",rowIndex),this.eventNode.setAttribute("ColumnIndex",columnIndex),this.StoreState("Y"),this.GridIsInFocus=!0,eval(this._element.cusAttr("onfireevents"))))},SelectCurrentRow:function(){var n=this.D_Body.rows[this.m_currentRowIndex].getElementsByTagName("input")[0];if(n){if(n.type!="checkbox"||n.checked==!0)return!0;n.focus(),n.checked=!0,this.OnBodyRowSelected(this.m_currentRowIndex,!0,!1)}},SetCurrentRowChecked:function(n){this.SetRowChecked(this.m_currentRowIndex,n)},SetRowChecked:function(n,t,i){var r=this.D_Body.rows[n].getElementsByTagName("input")[0],u;if(r){if(r.type!="checkbox")return!0;r.focus(),u=r.checked,r.checked=t,i&&(this.OnBodyRowSelectedClick(n,t),this.OnRowClicked()),this.OnBodyRowSelected(n,t,u)}},OnCellDBClick:function(rowIndex,columnIndex){var context,evtArgs;columnIndex=this.GetOldColumnIndex(columnIndex),context=new CellDataContent("",""),this.SetCurrentCellInfo(context),evtArgs=this.CreateEventArgs(),this.InitializeEvent(evtArgs),evtArgs.arg=context,evtArgs.sourceElement=this.get_element(),this.raiseEvent(DataGridEvent.OnCellDbClick,evtArgs),typeof this._element.cusAttr("DBClickEvent")!="undefined"&&(this.m_isCheckedByClick&&this.SelectCurrentRow(),this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","CellDbClick"),this.eventNode.setAttribute("RowIndex",rowIndex),this.eventNode.setAttribute("ColumnIndex",columnIndex),this.StoreState("Y"),this.GridIsInFocus=!0,eval(this._element.cusAttr("onfireevents")))},OnMovePage:function(action,PageNumber){var evtArgs,fireevent;this.m_PageCount!=1&&(evtArgs=this.CreateEventArgs(),evtArgs.sourceElement=this.get_element(),evtArgs.arg=action,this.raiseEvent(DataGridEvent.OnMovePage,evtArgs),typeof this._element.cusAttr("TurnPage")!="undefined"&&(this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","TurnPage"),this.eventNode.setAttribute("StartRowIndex",this._element.cusAttr("StartRowIndex")),this.eventNode.setAttribute("ActionTag",action),PageNumber!=null?this.eventNode.setAttribute("GotoPage",PageNumber):this.eventNode.setAttribute("GotoPage","-1"),this.StoreState("P"),this.GridIsInFocus=!0,fireevent=this._element.cusAttr("onfireevents").replace("''","'MovePage'"),eval(this._element.cusAttr("onfireevents"))))},OnChangePageSize:function(pageSize){var cookieName="PageSize_"+$("#UserCode").val(),fireevent;this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","ChangePageSize"),this.eventNode.setAttribute("PageSize",pageSize),this.StoreState("P"),this.GridIsInFocus=!0,fireevent=this._element.cusAttr("onfireevents").replace("''","'ChangePageSize'"),eval(this._element.cusAttr("onfireevents"))},setCookie:function(n,t){var r=30,i=new Date;i.setTime(i.getTime()+r*864e5),document.cookie=n+"="+escape(t)+";expires="+i.toGMTString()},OnSelectAllPage:function(checked){var evtArgs=this.CreateEventArgs();evtArgs.sourceElement=this.get_element(),evtArgs.AllPageSelected=checked,evtArgs.arg=checked,this.raiseEvent(DataGridEvent.OnSelecteAllPage,evtArgs),typeof this._element.cusAttr("SelecteAllPage")!="undefined"&&(this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","SelecteAllPage"),this.eventNode.setAttribute("AllPageSelected",checked?"true":"false"),this.StoreState("Y"),this.GridIsInFocus=!0,eval(this._element.cusAttr("onfireevents")))},OnBatchModify:function(dataArg){var evtArgs=this.CreateEventArgs(),content,element,fCols;return(evtArgs.sourceElement=this.get_element(),content=new CellDataContent("",""),evtArgs.arg=content,evtArgs.arg.Data=dataArg.Data,this.raiseEvent(DataGridEvent.OnBatchModify,evtArgs),element=this.get_element(),fCols=element.cusAttr("EditCols"),typeof element.cusAttr("BatchModify")!="undefined"&&(!fCols||fCols.indexOf(dataArg.Column)>=0)&&(dataArg.Symbol==="="||dataArg.Symbol!=="="&&element.cusAttr("BCOnServer")==="True"))?(this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","BatchModify"),this.eventNode.setAttribute("Data",dataArg.Data),this.eventNode.setAttribute("ColName",dataArg.Column),this.eventNode.setAttribute("ColIndex",this.GetOldColumnIndex(this.GetColumnIndex(dataArg.Column))),this.StoreState("Y"),this.GridIsInFocus=!0,eval(element.cusAttr("onfireevents")),!0):content.CancelAction},IsBatchModifyRunAtServer:function(n){var t=this.get_element(),i=t.getAttribute("EditCols");return typeof t.cusAttr("BatchModify")!="undefined"&&(!i||i.indexOf(n)>=0)?!0:!1},OnCellFocusEnter:function(){var t,n;this.GridIsInFocus=!0,t=new CellDataContent("",""),this.SetCurrentCellInfo(t),n=this.CreateEventArgs(),this.InitializeEvent(n),n.arg=t,n.sourceElement=this.get_element(),this.raiseEvent(DataGridEvent.OnCellFocusEnter,n)},OnFireSelectAllEvent:function(){var n=this.CreateEventArgs(),t=new CellDataContent("","");this.SetCurrentCellInfo(t),n.arg=t,this.InitializeEvent(n),n.sourceElement=this.get_element(),this.raiseEvent(DataGridEvent.OnSelectAllRecords,n)},OnFireControlChangeEvent:function(){},OnCellFocusOut:function(n,t){t=this.GetOldColumnIndex(t);var i=this.CreateEventArgs(),r=new CellDataContent("","");this.SetCurrentCellInfo(r),i.arg=r,i.SrcColIndex=t,i.SrcRowIndex=n,this.InitializeEvent(i),i.SrcColIndex=t-1,i.sourceElement=this.get_element(),this.raiseEvent(DataGridEvent.OnCellFocusOut,i)},InitializeEvent:function(n){var t,i;this._element.cusAttr("EditStatus")==DisplayStyle.Edit&&(t=this.getCurId(n.SrcRowIndex,n.SrcColIndex),null!=t&&(i=this.getEventSrcs(),n.EventSrc=t))},SetCurrentCellInfo:function(n){n!=null&&(n.CurrentRowIndex=this.m_currentRowIndex,n.CurrentColumnIndex=this.m_currentColumnIndex-1,this.MainCols[this.m_currentColumnIndex]&&(n.ColField=this.MainCols[this.m_currentColumnIndex].cusAttr("FieldID")))},CreateEventArgs:function(){return new UF.UI.GridEventArgs},getCurId:function(n,t){var u,i,f,e,r;if(u=n==this.UNDEFINED_VALUE?this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this.m_currentRowIndex,this.m_currentColumnIndex):this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(n,t),!u)return"";if(i=this.getEventSrcs(),f=null,i[0]!="")for(e=this.MainCols[u.cellIndex].cusAttr("FieldID"),r=0;r<i.length;r++)if(e==i[r]){f=i[r];break}return f},ReadDataGridContent:function(){this.M_Table=this.get_element().children[0],this.m_activeContainer=this.M_Table.rows[0].cells[0].children[0],this.S_Body=this.m_activeContainer.children[0],this.D_Head=this.S_Body.tHead,this.D_Body=this.S_Body.tBodies[0],this.ParentDocument=$E(this._element.parentElement).document,this._element.cusAttr("HasSum")==DefaultSymbol.True&&(this.D_Foot=this.S_Body.tFoot),this.m_toolbarDiv=this.GetPageBreakToolbar(this.M_Table),this._element.cusAttr("PageSize")!=this.UNDEFINED_VALUE&&(this.m_PageSize=parseInt(this._element.cusAttr("PageSize"),10)),this._element.cusAttr("CustomFilter")!=this.UNDEFINED_VALUE&&(this.m_CustomFilterToolbarDiv=this.GetCustomFilterToolbar(this.M_Table)),this._element.cusAttr("RefSplitter2")!=this.UNDEFINED_VALUE&&(this.RefSplitter2=this._element.cusAttr("RefSplitter2")),this._element.cusAttr("FrozenCtrlCol")!=this.UNDEFINED_VALUE&&(this.m_FrozenControlColumn=this._element.cusAttr("FrozenCtrlCol")=="true"),this._element.cusAttr("SumAllData")!=this.UNDEFINED_VALUE&&(this.m_SumAllData=this._element.cusAttr("SumAllData")=="true"),this._element.cusAttr("SumSelectedData")!=this.UNDEFINED_VALUE&&(this.m_SumSelectedData=this._element.cusAttr("SumSelectedData")=="true"),this._element.cusAttr("ViewDirty")!=this.UNDEFINED_VALUE&&this._element.cusAttr("ViewDirty").toString()=="true"&&(this.ViewDirty=!0)},GetCustomFilterToolbar:function(n){if(n!=null){if(n.rows.length>2)return n.rows[2];if(n.rows.length>1){if(n.rows[1].className=="CustomFilterToolBar")return n.rows[1]}else if(n.rows.length==1&&n.children.length==2&&n.children[1].tagName.toLowerCase()=="tbody"){var t=n.children[1];if(t.children.length>2)return t.children[2];if(t.children.length>1&&t.children[1].className=="CustomFilterToolBar")return t.children[1]}}return null},GetPageBreakToolbar:function(n){return n!=null&&(n.rows.length>2||n.rows.length==2&&n.rows[1].cells.length>0&&n.rows[1].cells[0].firstChild&&n.rows[1].cells[0].firstChild.rows&&n.rows[1].cells[0].firstChild.rows.length>0&&n.rows[1].cells[0].firstChild.rows[0].cells.length>0)&&n.rows[1].cells.length>0?n.rows[1].cells[0].firstChild:null},InitControl:function(){var n=document.createElement("DIV"),i,r,t,u;n.style.position="absolute",n.style.left="15px",n.style.top="10px",n.id="gg",n.innerHTML="<input id='"+this._element.id+"_GB' style='height:0;width:0' />",this._element.insertAdjacentElement("beforeEnd",n),this.inDeleting=!1,this._element.cusAttr("NoFireEvent",!0),this.ReadDataGridContent(),this.InitHelperObject(),this.InitGridBehavior(),this.InitColumnSumDataFormat(),this.ResetState(),this._element.cusAttr("GridReadyState","complete"),this._element.cusAttr("AlwaysCollectData")=="true"&&(this.m_AlwaysCollectData=!0),this.m_batchModifyManager&&this.m_batchModifyManager.resetAfterPost(),this._element.cusAttr("AutoAddNewRowOnLastCellReturn")=="true"&&this.set_AutoAddNewRowOnLastCellReturn(!0),this._element.cusAttr("DefaultValueColumns")&&(this.m_DefaultValueColumns=this._element.cusAttr("DefaultValueColumns").split(this.DefaultValueSplitString)),this._element.cusAttr("DefaultValueColumnsOrder")&&(this.m_DefaultValueColumnsOrder=this._element.cusAttr("DefaultValueColumnsOrder").split(this.DefaultValueSplitString)),this._element.cusAttr("SortColumnsOrder")&&(this.m_SortColumns=this._element.cusAttr("SortColumnsOrder").split(",")),this._element.cusAttr("IsSortSelectRecords")&&this._element.cusAttr("IsSortSelectRecords")=="true"&&(this.m_IsSortSelectRecords=!0),this._element.cusAttr("CheckedByClick")&&this._element.cusAttr("CheckedByClick")=="false"&&(this.m_isCheckedByClick=!1),this._element.cusAttr("AllowEditSingleRow")&&this._element.cusAttr("AllowEditSingleRow")=="false"&&(this.m_AllowEditSingleRow=!1),top.ShowCustomFilter&&top.ShowCustomFilter[this.get_id()]==!0&&_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').m_currentRowIndex = "+this.m_currentRowIndex+";$find('"+this.get_id()+"').m_currentColumnIndex = "+this.m_currentColumnIndex+"; $find('"+this.get_id()+"').Focus(true)"),this._element.cusAttr("CustomFilter_Show")=="true"&&_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').m_CustomFilterManagerInstance.OnBtnSetFilterClick(null,true);"),this.ResetSortColumnNum(),this._element.cusAttr("EditStatus")==DisplayStyle.Edit&&this._element.cusAttr("AutoEditModel")=="true"&&top.DataGridAutoAddNewEmptyRow&&top.DataGridAutoAddNewEmptyRow[this.get_id()]==!0&&!this.IsEmptyRow(this.D_Body.rows[this.m_rows-1])&&this.m_rows<this.m_PageSize&&this.m_gridBodyEventsHandler.GridEditHelper!=null&&(i=Get_Global_IsCheckDirtyData_TheForm(),r=Get_Global_IsDirtyData_TheForm(),Set_Global_IsCheckDirtyData_TheForm(!1),t=this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.AddNewEmptyRow(),t!=-100&&this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.InitEmptyRow(t),Set_Global_IsCheckDirtyData_TheForm(i),Set_Global_IsDirtyData_TheForm(r)),this.m_rows>0&&this.InitIDFieldSequenceStartValue(),this._element.cusAttr("NoFireEvent",!1),this.HeadSelectedCauseClick=this._element.cusAttr("HeadSelectedCauseClick")==="False"?!1:!0,u=$(this.D_Head).find(".FixedColumnTitleCell").length,GridFrozenColumnsHelper.GetInstance(this.m_activeContainer,this.S_Body,this.D_Head,u,this.m_activeContainer.scrollLeft,this.m_activeContainer.scrollTop).init()},Maximized:function(){$(this._element).parents(".popLayer").length==0&&(this.FullScreen=$(this._element).siblings(".zoomBig").get(0),this.FullScreen&&(this.cssZoomElement(),this.bindOnMaximizedClick()))},cssZoomElement:function(){var n=$(this._element).attr("id");FullScreenGridHelper.GetInstance().cssZoomElement(n,this.FullScreen)},bindOnMaximizedClick:function(){var n=$(this._element).attr("id");$(this.FullScreen).unbind("click");$(this.FullScreen).on("click",function(){FullScreenGridHelper.GetInstance().onZoomElementClick(this,n)})},InitIDFieldSequenceStartValue:function(){var i=1,r=this.GetColumnIndex("ID"),t,n;if(r!=-1){for(t=0;t<this.m_rows;t++)n=parseInt(this.D_Body.rows[t].cells[r].cusAttr("Value"),10),n=Math.abs(n),i<n&&(i=n);this.MainCols[r].cusAttr("SequenceStart",(i+5e3).toString())}},SwitchColumnControl:function(n,t){this.MainCols[this.GetColumnIndex(t)].cusAttr("ReplaceColumn",n)},Replace:function(n,t,i){var r=/oldC/g;return n.replace(r,i)},StoreState:function(n){var t=null,r,i;if(this.m_Hidden_State==null?(r=/_/g,t=$get(this.get_id().replace(r,"$")+"_State")):t=this.m_Hidden_State,t){if(t.value!=null&&(t.value.indexOf(",F2")>=0||t.value.indexOf(",P,")>=0))return;i=!1,n=="YY"&&(n="Y",i=!0),event&&(event.type=="click"||event.type=="dblclick")&&event.srcElement&&event.srcElement.tagName=="TD"&&event.srcElement.className&&event.srcElement.className.split(" ")[0]=="tbc"&&(this.m_currentColumnIndex=event.srcElement.cellIndex),i?(t.value=this.m_currentRowIndex+","+(this.m_currentColumnIndex-1)+","+n+","+this.get_id()+",F2",this.GetColumnControl(this.m_currentColumnIndex).control.set_IsShowForm(!1)):t.value=this.m_currentRowIndex+","+(this.m_currentColumnIndex-1)+","+n+","+this.get_id()}},ResetState:function(){var t=null,f,r,n,e,u,i,o,s;this.m_Hidden_State==null?(f=/_/g,t=$get(this.get_id().replace(f,"$")+"_State")):t=this.m_Hidden_State,t&&(r=t.value,t.value="",r.indexOf(",")>=0&&(n=r.split(","),n[3]==this.get_id()&&(n[2]=="Y"||n[2]=="N"?(parseInt(n[0])>=this.D_Body.rows.length&&(n[0]=0,n[1]=0),(this._element.cusAttr("AlwaysFocus")=="true"||n[2]=="Y")&&(this._element.cusAttr("SelectedCell")!=this.UNDEFINED_VALUE?(this.m_currentRowIndex=parseInt(n[0]),this.m_currentColumnIndex=parseInt(n[1])+1):(this.m_currentRowIndex=parseInt(n[0]),this.m_currentColumnIndex=parseInt(n[1])+1)),n.length==5&&(this.m_currentRowIndex=parseInt(n[0]),this.m_currentColumnIndex=parseInt(n[1])+1,e=this._element.cusAttr("NoFireEvent"),this._element.cusAttr("NoFireEvent",!1),this.StartEdit(),this._element.cusAttr("NoFireEvent",e),u=this.ControlArray[this.MainCols[parseInt(n[1])+1].cusAttr("FieldID")],u&&(t.value="",Global_JSQueueEvalAfterPageLoadedManager.Add("var ref = $find('"+u.id+"');if(ref){ref.set_IsShowForm(true); ref.ShowRefForm('');ref.set_IsShowForm(false);}")))):n[2]=="P"&&(this.m_currentRowIndex=parseInt(this._element.cusAttr("SelectedCell").split(".")[0],10),this.m_currentColumnIndex=parseInt(this._element.cusAttr("SelectedCell").split(".")[1],10)+1)))),this._element.cusAttr("EditStatus")==DisplayStyle.Browser&&(this.m_currentRowIndex=parseInt(this._element.cusAttr("SelectedCell").split(".")[0],10),this.m_currentColumnIndex=parseInt(this._element.cusAttr("SelectedCell").split(".")[1],10)+1),i=this.m_currentRowIndex,o=this.m_currentColumnIndex,this.GetIsBatchModifyRunning()&&(i=this.m_batchModifyManager.rowIndexBefore,o=this.m_batchModifyManager.columnIndexBefore),i>=0&&this.GetRowStatus(i)!=RowStatus.Empty&&(s=this.m_gridFaciesManager.GetRowBackgroundColor(i),s||this.m_gridFaciesManager.SetRowBackgroundColor(i,DefaultSymbol.SelectedRowColor,!0))},Focus:function(n){var i,r,t;if(!(_ClientJSExecQueueManager.Count>0)){if(isInit=top.PageInitCompleted?!1:!0,this.m_gridBodyEventsHandler&&this.m_gridBodyEventsHandler.GridEditHelper&&this.m_gridBodyEventsHandler.GridEditHelper.CellEditActive){this.m_gridBodyEventsHandler&&this.m_gridBodyEventsHandler.GridEditHelper&&this.m_gridFaciesManager.Focus();return}if(this.m_gridFaciesManager!=null)if(this.m_gridBodyEventsHandler&&this.m_gridBodyEventsHandler.GridEditHelper){if(this.m_currentColumnIndex==0&&(this.m_currentColumnIndex=1),t=this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this.m_currentRowIndex,this.m_currentColumnIndex),t!=null){if(i=this.m_gridReadOnly,this.m_gridReadOnly=!0,this.GetIsBatchModifyRunning()||this.m_gridFaciesManager.SetCurrentCellStyle(this.m_currentRowIndex,this.m_currentColumnIndex,isInit),this.m_gridReadOnly=i,this.m_gridFaciesManager.lastRowIndex=this.m_currentRowIndex,this.m_gridFaciesManager.lastColumnIndex=this.m_currentColumnIndex,r=this.m_activeContainer.scrollLeft,n)try{if(isInit&&!this.m_gridFaciesManager.IsCellInHorizonViewArea(this.m_currentRowIndex,this.m_currentColumnIndex)){t.setActive();return}this.m_eventProcessLock=!0,this.m_eventProcessLock=!0,t.click(),this.m_eventProcessLock=!1,this.m_isRelaySwitchTag&&this.IsNeedSwitchTabPage(this.m_currentColumnIndex)?t.setActive():this.StartEdit(),t.firstChild&&$find(t.firstChild.id)&&$find(t.firstChild.id).SetFocus&&($find(t.firstChild.id).SetFocus(),$find(t.firstChild.id).input_onfocus&&$find(t.firstChild.id).input_onfocus())}catch(u){}else this.m_gridFaciesManager.Focus();r!=0||this.m_gridFaciesManager.ShowCellByScrollLayout(this.m_currentRowIndex,this.m_currentColumnIndex)}}else if(this.D_Body.rows[this.m_currentRowIndex]&&this.D_Body.rows[this.m_currentRowIndex].cells[0]){t=this.D_Body.rows[this.m_currentRowIndex].cells[0];try{this.m_eventProcessLock=!0,t.focus(),$(t).find("input:first").focus(),this.m_eventProcessLock=!0,t.click(),this.m_eventProcessLock=!1}catch(f){}}}},InitHelperObject:function(){if(this.MainCols=this.S_Body.getElementsByTagName("col"),this.dataDom==this.UNDEFINED_VALUE&&(this.dataDom=Basic.GetXmlDom()),this.m_lastSelectedRow=-1,this.m_columns=this.MainCols.length,this.m_rows=this.D_Body.rows.length,this.m_toolbarDiv){var n=this.m_toolbarDiv;this.m_PageIndex=parseInt(n.cusAttr("PageIndex"),10),this.m_PageCount=parseInt(n.cusAttr("PageCount"),10),this.m_TotalRows=parseInt(n.cusAttr("TotalRows"),10)}this.SetInitialFocus(this._element.cusAttr("SelectedCell"))},SetInitialFocus:function(n){if(n!=this.UNDEFINED_VALUE){var t=n.split(".");t.length==2&&(this.m_currentRowIndex=parseInt(t[0],10),this.m_currentColumnIndex=parseInt(t[1],10),this.m_currentRowIndex==-1&&(this.m_currentRowIndex=0),this.m_currentColumnIndex=this.m_currentColumnIndex==-1?this.GetNextColumn(1):this.GetNextColumn(this.m_currentColumnIndex+1),this._element.cusAttr("Focus")=="true"&&(this.GridIsInFocus=!0),this.m_lastSelectedRow=this.m_currentRowIndex)}},InitColumnSumDataFormat:function(){for(var i=0;i<this.MainCols.length;i++)this.MainCols[i].cusAttr("SDF")!=null&&(this.MainCols[i].SumDataFormat=eval("new NumberFormat('"+this.MainCols[i].cusAttr("SDF").replace(/,/g,"','")+"')"))},InitGridBehavior:function(){if(this.InitGridGeneralBehavior(),this._element.cusAttr("EditStatus")==DisplayStyle.Browser)this.m_toolbarDiv!=null&&(this.m_pageBreakManagerInstance=GridPageBreakManager.GetInstance(this.m_toolbarDiv,this.get_element(),this.D_Body,this),this.m_pageBreakManagerInstance.Initialize()),this.caculator=new CalculateHelper(this.D_Body,this.D_Foot,this._element,this),this.caculator.Init(),this.m_formatHelper=GridDataFormatHelper.GetInstance(this);else{this._element.cusAttr("AlwaysPagging")=="true"&&this.m_toolbarDiv!=null&&(this.m_pageBreakManagerInstance=GridPageBreakManager.GetInstance(this.m_toolbarDiv,this._element,this.D_Body,this),this.m_pageBreakManagerInstance.Initialize());var n=new GridEditManager(this.m_activeContainer,this.D_Body,this.D_Foot,this._element,this);n.Init(this.m_gridFaciesManager),this.m_gridBodyEventsHandler.AttachEditHelper(n),this.m_formatHelper=GridDataFormatHelper.GetInstance(this)}this.m_CustomFilterToolbarDiv!=null&&(this.m_CustomFilterManagerInstance=GridCustomFilterToolbarManager.GetInstance(this.m_CustomFilterToolbarDiv,this,"Grid"),this.m_CustomFilterManagerInstance.Initialize()),this.m_MessageToolbarManager=GridMessageToolbarManager.GetInstance(this),this._element.cusAttr("DisplayMessage")!=null&&this.m_MessageToolbarManager.ShowMessage(this._element.cusAttr("DisplayMessage"))},getCaculator:function(){return this._element.cusAttr("EditStatus")==DisplayStyle.Browser?this.caculator:this.m_gridBodyEventsHandler.GridEditHelper.CalculateHelper},InitGridGeneralBehavior:function(){this.InitGridDefaultLayout(),HeadGeneralBehaviorManager.GetInstance(this.D_Body,this.D_Head,this).Init(),TableDimentionManager.GetInstance(this.m_activeContainer,this.S_Body,this.D_Head,this.MainCols,this).Init(),GridBodyEventsHandler.GetInstance(this.get_element(),this.m_activeContainer,this.S_Body,this.D_Head,this).AttachEvents(),this.m_gridFaciesManager=GridFaciesManager.GetInstance(this.m_activeContainer,this.D_Head,this.D_Body,this.D_Foot,this.m_toolbarDiv,this),this.m_gridBodyEventsHandler.AttachFaciesHelper(this.m_gridFaciesManager),this._element.cusAttr("SelectModel")=="mulitline"&&this.SetHeadCheckBoxState()},InitGridDefaultLayout:function(){try{this.m_gridReadOnly=this._element.cusAttr("GridReadOnly")==DefaultSymbol.True?!0:!1}catch(n){}},get_EditMenuVisible:function(){return this.m_gridBodyEventsHandler.GetEditMenuEnabled()},set_EditMenuVisible:function(n){this.m_gridBodyEventsHandler.SetEditMenuEnabled(n)},get_AutoEditModelEnabled:function(){return this.m_gridBodyEventsHandler.GetAutoEditEnabled()},set_AutoEditModelEnabled:function(n){this.m_gridBodyEventsHandler.SetAutoEditEnabled(n)},get_AutoAddNewRowOnLastCellReturn:function(){return this.m_gridBodyEventsHandler.GetAutoAddNewRowOnLastCellReturn()},set_AutoAddNewRowOnLastCellReturn:function(n){this.m_gridBodyEventsHandler.SetAutoAddNewRowOnLastCellReturnEnabled(n)},get_CellDefaultBackgroundColor:function(){return DefaultSymbol.BodyCellBackgroundcolor},get_CurrentRowIndex:function(){return this.m_currentRowIndex==-1?0:this.m_currentRowIndex},set_CurrentRowIndex:function(n){n>=0&&n<this.m_rows&&(this.m_gridBodyEventsHandler.CanEndEdit(!1),this.m_currentRowIndex=n,this.FocusCurrentCell())},FocusCurrentCell:function(){var t,n;if(this.m_gridFaciesManager!=null){if(this.m_gridBodyEventsHandler.CanEndEdit(!1),this.m_currentColumnIndex==0){for(t=0,n=1;n<this.m_columns;n++)if(this.MainCols[n].style.display=="none")continue;else{t=n;break}this.m_currentColumnIndex=t}this.m_gridFaciesManager.SetCurrentCellStyle(this.m_currentRowIndex,this.m_currentColumnIndex),this.m_gridFaciesManager.Focus()}},get_CurrentColumnIndex:function(){return this.m_currentColumnIndex-1},set_CurrentColumnIndex:function(n){n>0&&n<this.m_columns&&(this.m_currentColumnIndex=n+1,this.FocusCurrentCell())},get_ReadOnly:function(){return this.m_gridReadOnly},set_ReadOnly:function(n){this.m_gridBodyEventsHandler!=null&&(this.m_gridBodyEventsHandler.CanEndEdit(!1),this.m_gridReadOnly=n,n&&this.m_gridBodyEventsHandler.GridEditHelper&&this.m_gridBodyEventsHandler.GridEditHelper.HideMenu())},get_Rows:function(){return this.D_Body==this.UNDEFINED_VALUE?this.m_rows:this.D_Body.rows.length},get_Columns:function(){return this.m_columns-1},get_PageCount:function(){return this.m_PageCount},set_PageCount:function(n){var t,i;this.m_toolbarDiv!=null&&this.m_toolbarDiv.tagName=="TABLE"&&this.m_toolbarDiv.rows[0].cells[0].children.length>0&&(t=this.m_toolbarDiv.rows[0].cells[1].getElementsByTagName("SPAN"),t.length==2&&(i=t[1],this.m_PageCount=n,this.m_PageCount<1&&(this.m_PageCount=1),i.innerHTML=i.innerHTML.replace(/\d+/g,this.m_PageCount)))},get_PageIndex:function(){return this.m_PageIndex},set_PageIndex:function(n){var t,i;this.m_toolbarDiv!=null&&this.m_toolbarDiv.tagName=="TABLE"&&this.m_toolbarDiv.rows[0].cells[0].children.length>0&&(t=this.m_toolbarDiv.rows[0].cells[1].getElementsByTagName("SPAN"),t.length==2&&(i=t[0],this.m_PageIndex=n-1,this.m_PageIndex<1&&(this.m_PageIndex=1),i.innerHTML=i.innerHTML.replace(/\d+/g,n)))},get_IsPaging:function(){return this._element.cusAttr("Pagging")==DefaultSymbol.True},get_TotalRows:function(){return this.m_TotalRows},set_TotalRows:function(n){var t,i;this.m_toolbarDiv!=null&&this.m_toolbarDiv.tagName=="TABLE"&&this.m_toolbarDiv.rows[0].cells[0].children.length>0&&(t=this.m_toolbarDiv.rows[0].cells[0].getElementsByTagName("A"),t.length==1&&(i=t[0],this.m_TotalRows=n,this.m_TotalRows<0&&(this._m_TotalRows=0),i.innerHTML=i.innerHTML.replace(/\d+/g,this.m_TotalRows)))},get_Data:function(){var n=/&nbsp/g;return this.GetTableXml().replace(n," ")},get_AllData:function(){return this.get_Data()},get_SelectedData:function(){var n=/&nbsp/g;return this.GetSelectRowXml().replace(n," ")},RowIsChecked:function(n){(n==null||n.toString()=="")&&(n=this.m_currentRowIndex);var t=this.D_Body.rows[n];return this.RowChecked(t)},ClearColumnData:function(n){var i,t;if(n)for(typeof n=="string"&&(n=this.GetColumnIndex(n)),i=this.D_Body.rows.length,t=0;t<i;t++)this.SetReferenceCellValue(t,n,"","","")},GetSelectedRows:function(){var n=[];return this._element.cusAttr("SelectModel")=="mulitline"?n=this.InsertSelectRowIndexToArray(this.D_Body.rows):n[0]=this.m_currentRowIndex,n},FirePostBack:function(n,t,i){var f,r,e,u;this.IsThisGirdPosting!=!0&&(this.IsThisGirdPosting=!0,f=new CellDataContent("",""),this.SetCurrentCellInfo(f),r=i?i:null,r==null&&(r=this.CreateEventArgs(),r.sourceElement=this.get_element(),r.arg=f,this.InitializeEvent(r)),(typeof r.SrcColIndex=="undefined"||r.SrcColIndex==null)&&(r.SrcColIndex=this.GetOldColumnIndex(this.m_currentColumnIndex)-1),this.raiseEvent(DataGridEvent.OnBeforeCustomerPostBack,r),e=$get("HiddenCurrentContainer"),e&&(e.value=this.get_id()),this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","CustomerPostBack"),this.eventNode.setAttribute("RowIndex",this.m_currentRowIndex),this.eventNode.setAttribute("ColIndex",r.SrcColIndex),this.eventNode.setAttribute("LastRowIndex",this.m_lastRowIndex),this.eventNode.setAttribute("EventName",t),typeof r.SrcColIndex!="undefined"&&r.SrcColIndex>=0&&this.eventNode.setAttribute("ColName",this.GetColumnNameByOldIndex(r.SrcColIndex+1)),n&&this.eventNode.setAttribute("PostTag",n),this.BeforeSubmit("CustomerPostBack"),window._GridWillPostBack=!0,Set_Global_WillDoPostBack(!0),this.m_gridBodyEventsHandler.CellKeyDownReceive(),u=this._element.cusAttr("onfireevents"),u=u.replace(/,''/,",'"+encodeURI(XMLHelper.serializeXMLNodeToString(this.eventNode))+"'"),window.setTimeout('eval("'+u+'")',0))},RecoveryEventNode:function(n){var r,u,i,t;if(n&&(r=decodeURI(n),r.indexOf("<Event")==0)){for(u=XMLHelper.createXMLDocument(r),this.eventNode=this.dataDom.createElement("Event"),i=u.childNodes[0].attributes,t=0;t<i.length;t++)this.eventNode.setAttribute(i[t].nodeName,i[t].nodeValue);return!0}return!1},GetControlByServerID:function(n){for(var r=null,i=window.document.getElementsByTagName("span"),f,t=0,u=i.length;t<u;t++)if(f=i[t].id+",",f.indexOf(n+",")>=0){r=i[t];break}return r},SetRowStatus:function(n,t){this.m_gridFaciesManager!=null&&this.m_gridFaciesManager.ChangeRowState(n,t)},GetRowStatus:function(n){return this.m_gridFaciesManager!=null?this.m_gridFaciesManager.GetRowState(n):null},GetCellValueByFieldAndRow:function(n,t){var i=null,r=null;return t==null&&(t=this.m_currentRowIndex),i=this.GetColumnIndex(n),this.m_gridFaciesManager!=null&&(r=this.m_gridFaciesManager.GetCellValue(t,i)),r},FireEventSrcs:function(n){var t=","+n;return this.stringEventSrc.indexOf(t)<0&&this.stringEventSrc.indexOf(n)!=0&&(this.stringEventSrc+=n),this.stringEventSrc},getEventSrcs:function(){var n=[];return n=this.stringEventSrc.split(",")},fireEventOnkeypress:function(){var u=this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this.m_currentRowIndex,this.m_currentColumnIndex),n,t;if(u){var r=!1,i=this.getEventSrcs(),f="";if(i[0]!=""){for(n=0;n<i.length;n++)if(this.MainCols[u.cellIndex].cusAttr("FieldID")==i[n]){f=i[n],r=!0;break}}else r=!0;r&&(t=this.CreateEventArgs(),t.EventSrc=f,t.keyCode=event.keyCode==229&&event.code=="Equal"?187:event.keyCode,this.raiseEvent(DataGridEvent.Onkeypress,t))}},GetCurrentColumnDefaultControl:function(){return this.GetColumnControl(this.m_currentColumnIndex)},GetColumnDefaultControl:function(n){var t=this.GetColumnIndex(n);return t>=0?this.GetColumnControl(t):null},ResumeColumnDefaultControl:function(n){this.m_clientUserControl[n]!=this.UNDEFINED_VALUE&&(this.m_clientUserControl[n]=null)},SetColumnReferenceControl:function(n,t,i){if(t==this.UNDEFINED_VALUE)throw new error("client eference control not exists!");if(this.GetColumnIndex(n)==-1)throw new error("field '"+fieldname+"' not exists!");else{var r=new ClientUserControl;r.ControlType=ControlType.RefControl,r.Control=t,r.refParas=i,this.m_clientUserControl[n]=r}},MoveFirstRow:function(n){this.m_gridBodyEventsHandler!=null&&this.m_gridBodyEventsHandler.MoveFirstRow(n)},MoveNextRow:function(n){this.m_gridBodyEventsHandler!=null&&this.m_gridBodyEventsHandler.MoveNextRow(n)},StartEdit:function(){this.m_gridBodyEventsHandler!=null&&(this.m_gridBodyEventsHandler.GridEditHelper?this.m_gridBodyEventsHandler.GridEditHelper.StartEdit():this.Focus(!0))},EndEdit:function(){this.m_gridBodyEventsHandler!=null&&this.m_gridBodyEventsHandler.CanEndEdit(!1)},RemoveData:function(){this.m_gridBodyEventsHandler!=null&&this.m_gridBodyEventsHandler.GridEditHelper.RemoveData()},ClearData:function(){this.m_gridBodyEventsHandler!=null&&(this.m_gridBodyEventsHandler.ClearData(),this.ClearTotalValues())},ClearTotalValues:function(){if(this.m_rows==0||this.m_rows==1&&this.D_Body.rows[0].cusAttr("Status")==RowStatus.Empty)for(var n=1;n<this.m_columns;n++)this.MainCols[n].cusAttr("HasSum")==DefaultSymbol.True&&this.SetTotalValue(this.MainCols[n].cusAttr("FieldID"),0)},MoveLastRow:function(n){this.m_gridBodyEventsHandler!=null&&this.m_gridBodyEventsHandler.MoveLastRow(n)},MovePreviousRow:function(n){this.m_gridBodyEventsHandler!=null&&this.m_gridBodyEventsHandler.MovePreviousRow(n)},GetRowIndexByID:function(n){var i=this.GetColumnIndex("ID"),t;if(i<0)return-1;for(t=0;t<this.D_Body.rows.length;t++)if(this.D_Body.rows[t].cells[i].cusAttr("Value").toString()==n.toString())return t},GetLastRealRowIndex:function(){for(var n=this.D_Body.rows.length-1;n>=0;n--)if(this.GetRowStatus(n)!=RowStatus.Empty)return n},GetColumnIndex:function(n){var i,t;if(this.m_ColumnIndexList[n]!=null)return this.m_ColumnIndexList[n];for(i=-1,t=1;t<this.m_columns;t++)if(this.MainCols[t].cusAttr("FieldID")==n){i=t;break}return this.m_ColumnIndexList[n]=i,i},IsColumnAllowSort:function(n){var t,i;return n&&n.length>0&&(t=this.GetColumnIndex(n),t>=0)?(i=this.MainCols[t].cusAttr("AllowSort"),typeof i=="undefined"||i.toLowerCase()=="true"):!1},GetColumnControlByColumnName:function(n){return this.GetColumnControl(this.GetColumnIndex(n))},GetColumnControl:function(n,t){var i=Get_Global_IsDirtyData_TheForm();switch(this.GetColumnType(n)){case ControlType.TextBox:return this.CreateTextBoxControl(n);case ControlType.CheckBox:return this.CreateCheckBoxControl(n);case ControlType.Date:return this.CreateDatePickerControl(n);case ControlType.Combox:return this.CreateComboxControl(n);case ControlType.TextArea:return this.CreateTextAreaControl(n);case ControlType.RefControl:return this.CreateReferenceControl(n);case ControlType.MultiInput:return this.CreateMultiInputControl(n);case ControlType.Numberic:return this.CreateNumbericControl(n,t)}return this.Grid_IsDirtyData==!0?Set_Global_IsDirtyData_TheForm(this.Grid_IsDirtyData):Set_Global_IsDirtyData_TheForm(i),null},FindNextGridData:function(){},FindGridData:function(){},RefreshGridData:function(){},MovePreviousPage:function(){},MoveFirstPage:function(){},MoveLastPage:function(){},MoveNextPage:function(){},SetReferenceCellValue:function(n,t,i,r,u,f){if(this.m_gridFaciesManager!=null){this.m_gridFaciesManager.SetReferenceCellValue(n,t,i,r,u,f);var e=new CellDataContent("",i);this.OnCellDataValueChanged(e,n,t)}},SetCellValue:function(n,t,i){this.m_gridFaciesManager!=null&&this.m_gridFaciesManager.SetCellValue(n,t,i)},GetCellValue:function(n,t){if(this.m_gridFaciesManager!=null)return this.m_gridFaciesManager.GetCellValue(n,t);return new CellValue("")},SetRowFrontColor:function(n,t){this.m_gridFaciesManager!=null&&this.m_gridFaciesManager.SetRowFrontColor(n,t)},GetRowFrontColor:function(n){return this.m_gridFaciesManager!=null?this.m_gridFaciesManager.GetRowFrontColor(n):""},SetRowBackgroundColor:function(n,t,i){this.m_gridFaciesManager!=null&&this.m_gridFaciesManager.SetRowBackgroundColor(n,t,i)},GetRowBackgroundColor:function(n){return this.m_gridFaciesManager!=null?this.m_gridFaciesManager.GetRowBackgroundColor(n):""},SetCellFrontColor:function(n,t,i){n>=0&&n<this.m_rows&&t>0&&t<this.m_columns&&this.m_gridFaciesManager!=null&&this.m_gridFaciesManager.SetCellFrontColor(n,t,i,"body")},GetCellFrontColor:function(n,t){return n>=0&&n<this.m_rows&&t>0&&t<this.m_columns&&this.m_gridFaciesManager!=null?this.m_gridFaciesManager.GetCellFrontColor(n,t,"body"):""},SetCellBackgroundColor:function(n,t,i){n>=0&&n<this.m_rows&&t>0&&t<this.m_columns&&this.m_gridFaciesManager!=null&&this.m_gridFaciesManager.SetCellBackgroundColor(n,t,i,"body")},GetCellBackgroundColor:function(n,t){return n>=0&&n<this.m_rows&&t>0&&t<this.m_columns&&this.m_gridFaciesManager!=null?this.m_gridFaciesManager.GetCellBackgroundColor(n,t,"body"):""},GetColumnDefaultValue:function(n){return n>0&&n<this.m_columns?this.MainCols[n].cusAttr("DefaultValue"):""},GetColumnDefaultValue4P:function(n){return n>0&&n<this.m_columns?this.MainCols[n].cusAttr("DefaultValue4P"):""},SetColumnDefaultValue:function(n,t){var u;n>0&&n<this.m_columns&&(this.GetColumnType(n)==ControlType.RefControl&&(t=t.replace(/,/g,this.RefSplitter2)),this.MainCols[n].cusAttr("DefaultValue",t));try{if(this.GetRowStatus(0)==="Empty"){var r=n,f=this.D_Body.rows[0],i=f.cells[r];switch(this.MainCols[r].cusAttr("ControlType")){case ControlType.CheckBox:i.cusAttr("Value",t),this.setCellListValue(i,this._owner.GetCheckBoxTextByValue(t,this._owner.MainCols[r].cusAttr("CheckBoxValueRef")));break;case ControlType.Combox:i.cusAttr("Value",t),this.setCellListValue(i,this._owner.GetComboxTextbyID(r,t));break;case ControlType.Date:i.cusAttr("Value",t),this.setCellListValue(i,this._owner.GetDateFormatedValue(t,r));break;case ControlType.RefControl:this.m_gridBodyEventsHandler&&this.m_gridBodyEventsHandler.GridEditHelper&&this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper&&this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.SetReferenceDefaultValue(i,t);break;case ControlType.Numberic:u=this._owner.m_formatHelper.FormatCellNumber(r,rowIndex,t,i.cusAttr("Value"),isNewRowInit),i.cusAttr("Value",u.Value),this.setCellListValue(i,u.Text);break;case ControlType.MultiInput:i.cusAttr("Value",t),i.MultiLang=this._owner.GetMultiinputData(t,r),this.setCellListValue(i,t);break;default:i.cusAttr("Value",t),this.setCellListValue(i,this._owner.GetFormatedValue(t,this._owner.MainCols[r].cusAttr("DataType"),this._owner.MainCols[r].cusAttr("DisplayFormat")))}}}catch(e){showStatus(e.description)}},SetColumnDefaultValueByFieldName:function(n,t){var i=this.GetColumnIndex(n);i>0&&i<this.m_columns&&(this.GetColumnType(i)==ControlType.RefControl&&(t=t.replace(/,/g,this.RefSplitter2)),this.MainCols[i].cusAttr("DefaultValue",t))},GetColumnControlType:function(n){return n>0&&n<this.m_columns?this.MainCols[n].cusAttr("CotrolType"):""},GetColumnDataType:function(n){return n>0&&n<this.m_columns?this.MainCols[n].cusAttr("DataType"):""},GetColumnEditEnable:function(n){return n>0&&n<this.m_columns?this.MainCols[n].cusAttr("Edit")==DefaultSymbol.True:!1},SetColumnEditEnable:function(n,t){if(n>0&&n<this.m_columns&&(t||this.m_gridBodyEventsHandler.CanEndEdit(!1)))if(t&&this.MainCols[n].cusAttr("EditEx")==DefaultSymbol.True){var i=this.MainCols[n].cusAttr("Edit");this.MainCols[n].cusAttr("Edit",DefaultSymbol.True),i==DefaultSymbol.False&&n==this.m_currentColumnIndex&&this.StartEdit()}else this.MainCols[n].cusAttr("Edit",DefaultSymbol.True)},SetCellEnabledByFieldId:function(n,t,i){var r=this.GetColumnIndex(t);r>0&&this.SetCellEnabled(n,r,i)},GetCellEnabledByFieldId:function(n,t){var i=this.GetColumnIndex(t);return i>0?this.GetCellEnabled(n,i):!1},SetCellEnabled:function(n,t,i){if(n>=this.D_Body.rows.length||n<0||t>=this.m_columns||t<0)return!1;var r=this.D_Body.rows[n].cells[t];r&&r.cusAttr("Enabled",i?"true":"false")},GetCellEnabled:function(n,t){if(n>=this.D_Body.rows.length||n<0||t>=this.m_columns||t<0)return!1;var i=this.D_Body.rows[n].cells[t];return i?i.cusAttr("Enabled"):!1},SetCellBgColorByFieldId:function(n,t,i){var r=this.GetColumnIndex(t);r>0&&this.SetCellBgColor(n,r,i)},GetCellBgColorByFieldId:function(n,t){var i=this.GetColumnIndex(t);return i>0?this.GetCellBgColor(n,i):""},SetCellBgColor:function(n,t,i){if(n>=this.D_Body.rows.length||n<0||t>=this.m_columns||t<0)return!1;var r=this.D_Body.rows[n].cells[t];r&&(r.cusAttr("bgColor",i),r.style.backgroundColor=i)},GetCellBgColor:function(n,t){if(n>=this.D_Body.rows.length||n<0||t>=this.m_columns||t<0)return!1;var i=this.D_Body.rows[n].cells[t];if(i)return i.cusAttr("bgColor")},SetCellFontColorByFieldId:function(n,t,i){var r=this.GetColumnIndex(t);r>0&&this.SetCellFontColor(n,r,i)},GetCellFontColorByFieldId:function(n,t){var i=this.GetColumnIndex(t);return i>0?this.GetCellFontColor(n,i):""},SetCellFontColor:function(n,t,i){if(n>=this.D_Body.rows.length||n<0||t>=this.m_columns||t<0)return!1;var r=this.D_Body.rows[n].cells[t];r&&(r.style.color=i)},GetCellFontColor:function(n,t){if(n>=this.D_Body.rows.length||n<0||t>=this.m_columns||t<0)return!1;var i=this.D_Body.rows[n].cells[t];if(i)return i.style.color},GetColumnWidth:function(n){return n>0&&n<this.m_columns?parseInt(this.MainCols[n].width,10):0},SetColumnWidth:function(n,t){n>0&&n<this.m_columns&&t>0&&this.m_gridBodyEventsHandler.CanEndEdit(!1)&&(this.MainCols[n].width=t+"px")},GetColumnVisible:function(n){if(n>0&&n<this.m_columns)return this.MainCols[n].cusAttr("visible")},SetColumnVisible:function(n,t){if(n>0&&n<this.m_columns){var i=this.MainCols[n];this.m_gridBodyEventsHandler.CanEndEdit(!1)&&(t&&this.MainCols[n].cusAttr("visibleEx")?(i.cusAttr("oldWidth")&&(i.width=i.cusAttr("oldWidth")),i.cusAttr("visible",DefaultSymbol.True),this.MainCols[n].style.display="",this.ResetColumnCellCssClass(n,!0,i.cusAttr("Frozen")==DefaultSymbol.True)):(i.cusAttr("oldWidth")||i.cusAttr("oldWidth",i.width),i.width="1px",i.cusAttr("visible",DefaultSymbol.False),this.MainCols[n].style.display="none",this.ResetColumnCellCssClass(n,!1)),this.m_tableDimentionManager.AdjustTableHeadPosition())}},ResetColumnCellCssClass:function(n,t,i){var u,r;if(this.D_Head.children.length==1&&(u=t?"":"none",this.D_Head.children[0].cells[n].style.display=u,$(this.S_Body).find(".thead-tr td").eq(n).css("display",u),t&&this.D_Head.children[0].cells[n].className!=(t?DefaultSymbol.cssthc+(i?" "+DefaultSymbol.cssFixedColumnTitleCell:""):"")&&(this.D_Head.children[0].cells[n].className=t?DefaultSymbol.cssthc+(i?" "+DefaultSymbol.cssFixedColumnTitleCell:""):""),$(this.D_Head).width($(this.S_Body).width())),this.D_Body.rows.length>0)for(r=0;r<this.D_Body.rows.length;r++)this.D_Body.rows[r].cells[n].style.display=t?"":"none",t&&this.D_Body.rows[r].cells[n].className!=(t?DefaultSymbol.csstbc+(i?" "+DefaultSymbol.cssFixedColumnDataCell:""):"")&&(this.D_Body.rows[r].cells[n].className=t?DefaultSymbol.csstbc+(i?" "+DefaultSymbol.cssFixedColumnDataCell:""):"")},ResetColumnsWidth:function(){for(var n=0;n<this.MainCols.length;n++)this.MainCols[n].cusAttr("oldWidth")&&(this.MainCols[n].width=this.MainCols[n].cusAttr("oldWidth"))},SelectAllRow:function(n){this.m_gridFaciesManager!=null&&this.m_gridFaciesManager.SelectAllRow(n)},SelectRow:function(n,t){this.m_gridFaciesManager!=null&&this.m_gridFaciesManager.SelectRow(n,t)},AddNewRow:function(){return this.m_gridBodyEventsHandler.GridEditHelper!=null&&this.m_gridBodyEventsHandler.CanEndEdit(!1)?(this.m_IsStartEdit=!0,this.m_gridBodyEventsHandler.GridEditHelper.OnAddRow()):-1},InsertRow:function(n){return this.m_gridBodyEventsHandler.GridEditHelper!=null&&this.m_gridBodyEventsHandler.CanEndEdit(!1)?this.m_gridBodyEventsHandler.GridEditHelper.OnInsertRow(n):-1},CopyRow:function(n){var i=this.m_currentRowIndex,t=-1,r,u;return this.m_gridBodyEventsHandler.GridEditHelper!=null&&this.m_gridBodyEventsHandler.CanEndEdit(!1)&&(this.m_IsStartEdit=!0,t=this.m_gridBodyEventsHandler.GridEditHelper.OnAddRow(!0)),t!==!1&&t>=0&&(r=this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.GetRowDataFromXml(n),this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.SetRowData(t,r),u=this.m_lastRowIndex,this.m_lastRowIndex=i,this.OnAfterRowCopyedDefaultAction(t,i),this.OnAfterRowCopyed(t,i),this.m_lastRowIndex=u,this.OnRowChanged()),-1},DeleteRow:function(n){n===undefined&&(n=this.m_currentRowIndex),this.m_gridBodyEventsHandler.GridEditHelper!=null&&this.m_gridBodyEventsHandler.CanEndEdit(!1)&&this.m_gridBodyEventsHandler.GridEditHelper.OnRemoveRow(n)},DeleteRowDirect:function(){this.m_gridBodyEventsHandler.GridEditHelper!=null&&this.m_gridBodyEventsHandler.CanEndEdit(!1)&&this.m_gridBodyEventsHandler.GridEditHelper.OnRemoveRowDirect()},DeleteRowAlways:function(){this.m_gridBodyEventsHandler.GridEditHelper!=null&&this.m_gridBodyEventsHandler.CanEndEdit(!1)&&this.m_gridBodyEventsHandler.GridEditHelper.OnRemoveRowAlways()},ContainOf:function(n,t){return this.m_gridBodyEventsHandler!=null?this.m_gridBodyEventsHandler.ContainOf(n,t):!1},BeforeSubmit:function(n){var i,t,u,r;if(this.IsThisGirdPosting==!0){if(this._isDataCollected==!0){this.ReplaceEventArgument();return}this._isDataCollected=!0}i=$get(this.get_id()+"_MainBody"),$get(this.get_id()+"_MainBody_ScrollPositionX").value=i.scrollLeft,$get(this.get_id()+"_MainBody_ScrollPositionY").value=i.scrollTop,this.m_gridBodyEventsHandler!=null&&(this.ResetColumnsWidth(),this.m_gridBodyEventsHandler.OnFormPostBack(),t=this.GetTableXml(n),u=/\+/g,t=t.replace(u,"^^"),r=this.ParentDocument.getElementById(this._element.cusAttr("HelpId")),r&&(r.value=encodeURIComponent(t)))},ReplaceEventArgument:function(){},GetCurRowData:function(n,t){for(var e=t.cells.length,f=n.createElement(RowData.RowFlag),r,u,i=0;i<e;i++)r=n.createElement(RowData.CellFlag),r.setAttribute(RowData.CellID,this.MainCols[t.cells[i].cellIndex].getAttribute(RowData.CellID)),u=t.cells[i].getAttribute(RowData.CellValue),u&&r.setAttribute(RowData.CellValue,u),f.appendChild(r);return XMLHelper.serializeXMLNodeToString(f)},SetInsertedRowNoType:function(n){n!=null&&(n=n.toString()),this._insertedRowNoType=n},GetInsertedRowNoType:function(){return this._insertedRowNoType},LoadCurRowData:function(n,t){var r,u,f,e,i;if(this.dataDom.loadXml(n),r=this.dataDom.getElementsByTagName(RowData.CellFlag),this.D_Body.rows.length>t)for(u=0;u<r.length;u++)for(f=r.getAttribute(RowData.CellID),e=r.getAttribute(RowData.CellValue),i=0;i<this.m_columns;i++)this.MainCols[i].getAttribute(RowData.CellID)==f&&this.innerSetCellValue(e,this.D_Body.rows[u].cells[i])},innerSetCellValue:function(n,t){t.cusAttr("Value",n),this.setCellListValue(t,n);var i=new CellDataContent("",n);this.OnCellDataValueChanged(i,this.m_currentRowIndex,this.m_currentColumnIndex)},GetTableXml:function(n){var t=this.dataDom.createElement("DataTable"),f,r,u,i;for(t.setAttribute("Name",this.get_id()),this._element.cusAttr("onfireevents")&&theForm.__EVENTTARGET.value.trim().length>0&&(f=this._element.cusAttr("onfireevents").trim().indexOf(theForm.__EVENTTARGET.value)>0,f&&n=="CustomerPostBack"&&t.setAttribute("AutoAddNewRow","true")),this.SetSelectedRowIndexs(t,this.dataDom),t.appendChild(this.GetCurrentCellInfo(this.dataDom)),r=this.dataDom.createElement("TotalRows"),XMLHelper.setXMLNodeContent(r,this.m_TotalRows),t.appendChild(r),u=this.GetCurrentCellPosition(this.dataDom),u&&t.appendChild(u),t.appendChild(this.GetScrollPosiion(this.dataDom)),t.appendChild(this.GetCurrentCellInfoEx(this.dataDom)),i=0;i<this.m_columns;i++)t.appendChild(this.GetColXml(this.dataDom,this.MainCols[i]));return t.appendChild(this.GetBodyXml(this.dataDom)),this.eventNode!=this.UNDEFINED_VALUE&&t.appendChild(this.eventNode),this.m_SumAllData&&t.appendChild(this.GetSumDatasXml(this.dataDom)),this.m_pageBreakManagerInstance&&this.m_pageBreakManagerInstance.chk&&t.appendChild(this.GetIsDBSelectAllXML(this.dataDom)),this.m_SortColumns.length>0&&t.appendChild(this.GetSortColumnsXML(this.dataDom)),this.dataDom.documentElement=t,this.GridIsInFocus===!0?this.StoreState("Y"):this.StoreState("N"),this._element.cusAttr("AlwaysFocus")=="true"&&(this.StoreState("Y"),this.GridIsInFocus=!0),XMLHelper.serializeXMLNodeToString(t)},GetIsDBSelectAllXML:function(){var t=this.dataDom.createElement("AllPageSelected");return XMLHelper.setXMLNodeContent(t,this.m_pageBreakManagerInstance.chk.checked?"true":"false"),t},GetSumDatasXml:function(){for(var r=this.dataDom.createElement("SumDatas"),i,t=1;t<this.m_columns;t++)this.MainCols[t].cusAttr("HasSum")==DefaultSymbol.True&&(i=this.dataDom.createElement("Item"),i.setAttribute("Key",this.MainCols[t].cusAttr("FieldID")),i.setAttribute("Value",this.GetTotalValue(this.MainCols[t].cusAttr("FieldID"))),r.appendChild(i));return r},GetSelectRowXml:function(n){var t=this.dataDom.createElement("DataTable"),u,r,i;for(t.setAttribute("Name",this.get_id()),this._element.cusAttr("onfireevents")&&theForm.__EVENTTARGET.value.trim().length>0&&(u=this._element.cusAttr("onfireevents").trim().indexOf(theForm.__EVENTTARGET.value)>0,u&&n=="CustomerPostBack"&&t.setAttribute("AutoAddNewRow","true")),this.SetSelectedRowIndexs(t,this.dataDom),t.appendChild(this.GetCurrentCellInfo(this.dataDom)),r=this.GetCurrentCellPosition(this.dataDom),r&&t.appendChild(r),t.appendChild(this.GetScrollPosiion(this.dataDom)),t.appendChild(this.GetCurrentCellInfoEx(this.dataDom)),i=0;i<this.m_columns;i++)t.appendChild(this.GetColXml(this.dataDom,this.MainCols[i]));return t.appendChild(this.GetSelectRowBodyXml(this.dataDom,this.m_currentRowIndex)),this.eventNode!=this.UNDEFINED_VALUE&&t.appendChild(this.eventNode),this.dataDom.documentElement=t,this.GridIsInFocus===!0?this.StoreState("Y"):this.StoreState("N"),this._element.cusAttr("AlwaysFocus")=="true"&&(this.StoreState("Y"),this.GridIsInFocus=!0),this.datadom,XMLHelper.serializeXMLNodeToString(t)},GetCurrentCellPosition:function(){var t,i;return this._element.cusAttr("Focus")!="focus"?null:(t=this.dataDom.createElement("SelectedCell"),this.m_currentRowIndex<0||this.IsEmptyRow(this.D_Body.rows[this.m_currentRowIndex])?XMLHelper.setXMLNodeContent(t,"-1.-1"):this._element.cusAttr("EditStatus")==DisplayStyle.Edit?XMLHelper.setXMLNodeContent(t,this.m_currentRowIndex+"."+(this.m_currentColumnIndex-1)):(i=this.GetColumnIndex("ID"),i==-1||this.m_currentRowIndex>=this.m_rows?XMLHelper.setXMLNodeContent(t,"-1.-1"):XMLHelper.setXMLNodeContent(t,this.D_Body.rows[this.m_currentRowIndex].cells[i].cusAttr("Value")+"."+(i-1))),t)},GetCurrentCellInfo:function(){var t=this.dataDom.createElement("SelectedCellInfo"),i;return this.m_currentRowIndex<0||this.IsEmptyRow(this.D_Body.rows[this.m_currentRowIndex])?XMLHelper.setXMLNodeContent(t,"-1.-1"):this._element.cusAttr("EditStatus")==DisplayStyle.Edit?XMLHelper.setXMLNodeContent(t,this.m_currentRowIndex+"."+(this.m_currentColumnIndex-1)):(i=this.GetColumnIndex("ID"),i==-1||this.m_currentRowIndex>=this.m_rows?XMLHelper.setXMLNodeContent(t,"-1.-1"):XMLHelper.setXMLNodeContent(t,this.D_Body.rows[this.m_currentRowIndex].cells[i].cusAttr("Value")+"."+(i-1))),t},GetCurrentCellInfoEx:function(){var t=this.dataDom.createElement("CellInfo");return this.m_currentColumnIndex<0||this.m_currentColumnIndex>=this.MainCols.length?XMLHelper.setXMLNodeContent(t,""):XMLHelper.setXMLNodeContent(t,this.MainCols[this.m_currentColumnIndex].cusAttr("FieldID")),t},GetSortColumnsXML:function(){var t=this.dataDom.createElement("SortColumnsOrder");return XMLHelper.setXMLNodeContent(t,this.m_SortColumns.join(",")),t},SetSelectedRowIndexs:function(n){var i=[],r=this.dataDom.createElement("SelRowKeys");this.CalculateNewAndDeletedRows(i)?XMLHelper.setXMLNodeContent(r,this.GetSelectedRowKeys(i)):XMLHelper.setXMLNodeContent(r,this.GetSelectedRowKeys(i)),n.appendChild(r),this.SetSortedSelectIDs(n,this.dataDom)},SetSortedSelectIDs:function(n){var f,i,r,u;this._element.cusAttr("SelectModel")!="mulitline"&&this.m_currentRowIndex>=0&&this.m_rows>0&&this.GetColumnIndex("ID")>-1&&this.GetCellValueByFieldAndRow("ID",this.m_currentRowIndex)&&(f=this.GetCellValueByFieldAndRow("ID",this.m_currentRowIndex).Value,this.m_SortedSelectIDs.push(f)),i=this.dataDom.createElement("SortedSelectIDs"),XMLHelper.setXMLNodeContent(i,this.m_SortedSelectIDs.join(",")),n.appendChild(i),r=this.dataDom.createElement("UnSelectIDs"),XMLHelper.setXMLNodeContent(r,this.m_UnSelectIDs.join(",")),n.appendChild(r),u=this.dataDom.createElement("IsSortSelectRecords"),XMLHelper.setXMLNodeContent(u,this.get_IsSortSelectRecords().toString()),n.appendChild(u)},CalculateNewAndDeletedRows:function(n){var i,t;if(this._element.cusAttr("SelectModel")=="mulitline")for(i=this.InsertSelectRowIndexToArray(this.D_Body.rows),t=0;t<i.length;t++)n.push(i[t]);else n.push(this.m_currentRowIndex);return n.length>0},GetSelectedRowKeys:function(n){var t="",i=this.GetRowKeys(n,this.GetColumnIndex("ID"));return this._element.cusAttr("SelectModel")=="mulitline"?i.length>0&&(t=i.join(",")):t=i.join(","),t},GetRowKeys:function(n,t){var u=[],r=this.D_Body.rows,i;if(r.length>0&&t>-1)for(i=0;i<n.length;i++)r[n[i]]!=null&&u.push(r[n[i]].cells[t].cusAttr("Value"));return u},MergeArrays:function(n,t,i){for(var u,r=0;r<i.length;r++)u=this.IndexOf(i[r],n),u>-1&&n.splice(u,1);for(r=0;r<t.length;r++)n.push(t[r])},CompareInteger:function(n,t){var i=parseInt(n,10),r=parseInt(t,10);return i<r?-1:i>r?1:0},IndexOf:function(n,t){for(var i=0;i<t.length;i++)if(t[i]==n)return i;return-1},InsertSelectRowIndexToArray:function(n){for(var i=[],r=n.length,t=0;t<r;t++)this.RowChecked(n[t])&&i.push(t);return i},RowChecked:function(n){var t=n.cells[0].firstChild;return t.type=="checkbox"?t.checked:!1},GetBodyXml:function(n){for(var i=n.createElement("DataContent"),u=this.D_Body.rows.length,r=this.D_Body.rows,t=0;t<u;t++)this.IsEmptyRow(r[t])||i.appendChild(this.GetRowXml(n,r[t],t));for(t=0;t<this.m_deletedRows.length;t++)i.appendChild(this.m_deletedRows[t]);return i},GetSelectRowBodyXml:function(n,t){var r=n.createElement("DataContent"),u=this.D_Body.rows.length,i=this.D_Body.rows;return(this._element.cusAttr("EditStatus")==DisplayStyle.Edit||this.m_AlwaysCollectData)&&(i[t]===undefined||this.IsEmptyRow(i[t])||r.appendChild(this.GetRowXml(n,i[t],t))),r},GetRowXml:function(n,t,i){for(var s=n.createElement("R"),o,c,l,a,f,h,e,u,r=0;r<this.RowAttribute.length;r++)o=t.getAttribute(this.RowAttribute[r]),o||(o=t.cusAttr(this.RowAttribute[r])),o!=null&&s.setAttribute(this.RowAttribute[r],o);for(typeof i!="undefined"&&i!=null&&(c=this.GetClientRowDataDirtyTag(i),s.setAttribute("DataChanged",c?"1":"0")),l=t.cells.length,a=this.CellAttribute.length,r=1;r<l;r++){for(this.MainCols[r].cusAttr("ControlType")==ControlType.RefControl&&this.MainCols[r].cusAttr("ColEditCtrlClientID4P")?(f=t.cells[r],f.cusAttr("Value")==""&&f.cusAttr("Value","-1"),f.cusAttr("R")||f.cusAttr("R",""+this.RefSplitter2)):this.MainCols[r].cusAttr("ControlType")==ControlType.Combox&&(f=t.cells[r],f.cusAttr("Value").toString()==""&&f.cusAttr("Value","-1")),h=n.createElement("C"),e=0;e<a;e++)u=t.cells[r].getAttribute(this.CellAttribute[e]),u||(u=t.cells[r].cusAttr(this.CellAttribute[e])),typeof u!="undefined"&&u!==null&&u!==""?h.setAttribute(this.CellAttribute[e].substring(0,1),u.toString()):this.MainCols[r].cusAttr("ControlType")==="NUMBERIC"&&u===""&&h.setAttribute(this.CellAttribute[e].substring(0,1),u.toString());s.appendChild(h)}return s},GetColXml:function(n,t){for(var u=n.createElement("Item"),f=this.ColAttribute.length,i,r=0;r<f;r++)i=t.cusAttr(this.ColAttribute[r]),i!==null&&i!==""&i!=undefined&&(this.ColAttribute[r]=="Width"&&i!=undefined&&(i=i.replace("px","")),u.setAttribute(this.ColAttribute[r],i));return u},GetScrollPosiion:function(n){var t=n.createElement("ScrollPosition");return t.setAttribute("ScrollLeft",this.S_Body.scrollLeft),t.setAttribute("ScrollTop",this.S_Body.scrollTop),t},RecieveData:function(n){var i,r,u,t,f;this.dataDom.loadXML(n),this.dataDom.childNodes[0].getAttribute("MaxPage")!=null&&this._element.cusAttr("Paging")==DefaultSymbol.True&&(this.dataDom.childNodes[0].getAttribute("MaxPage")!=null&&(i=this.dataDom.childNodes[0].getAttribute("MaxPage")),this.dataDom.childNodes[0].getAttribute("CurPage")!=null&&(r=this.dataDom.childNodes[0].getAttribute("CurPage")),this._element.cusAttr("Paging",r),this._element.cusAttr("MaxPage",i),this.pages.SetNumber(this._element.cusAttr("CurrentPage"),this._element.cusAttr("MaxPage"),!1)),u=decodeURIComponent(XMLHelper.serializeXMLNodeToString(this.dataDom.childNodes[0].firstChild)),t=document.createElement("div"),t.innerHTML=u,f=t.children[0]},IsEmptyRow:function(n){return n==this.UNDEFINED_VALUE?!1:n.cusAttr("Status")==RowStatus.Empty},CreateMultiInputControl:function(n){var t=null,i=this.GetColumnFieldID(n),r;return i!=""&&(t=this.ControlArray[i],t==null&&(t=window.document.getElementById(this.get_id()+"_"+i),Init(t.id,UF.UI.GlobalInput),r=parseInt(this.MainCols[n].cusAttr("MaxLength"),10),r>0&&(t.control._textbox.maxLength=r),this.ControlArray[i]=t)),t},CreateTextAreaControl:function(n){var t=null,i=this.GetColumnFieldID(n),r;return i!=""&&(t=this.ControlArray[i],t==null&&(t=window.document.createElement("TextArea"),t.id=this.get_id()+"_"+i,t.className="GridInput",t.DataType=this.GetColumnDataType(n),t.DisplayFormat=this.GetColumnDisplayFormat(n),t.maskChars=this.GetColumnMaskChars(n),r=parseInt(this.MainCols[n].cusAttr("MaxLength"),10),r>0&&(t.maxLength=r),t.onkeydown=this.TextAreaKeyDown,$(t).bind("keypress",this.CheckMarkChar),$(t).bind("paste",this.CheckMarkChars),this.ControlArray[i]=t)),t},TextAreaKeyDown:function(){switch(window.event.keyCode){case KeyCode.left:case KeyCode.right:case KeyCode.up:case KeyCode.down:case KeyCode.enter:$Event(event).stopPropagation()}},CreateNumbericControl:function(n,t,i){var h=Get_Global_IsDirtyData_TheForm(),r=null,u=this.GetColumnFieldID(n);if(u!=""){r=this.ControlArray[u],r==null&&(r=window.document.getElementById(this.get_id()+"_"+u),Init(r.id,UF.UI.Number),r.control&&tryAttachCtrlEvent(this.get_id()+"_"+u,"onchange",this.OnFireControlChangeEvent),this.ControlArray[u]=r);var f=this.GetColumnIndex(this.MainCols[n].cusAttr("sf")),e=this.GetColumnIndex(this.MainCols[n].cusAttr("tf")),o=this.GetColumnIndex(this.MainCols[n].cusAttr("vf")),s=this.GetColumnIndex(this.MainCols[n].cusAttr("CS"));t==null?this.SetDynamicScaleAndRoundType(n,r,null,f,e,o,s):this.SetDynamicScaleAndRoundType(n,r,t,f,e,o,s,i)}return this.Grid_IsDirtyData==!0?Set_Global_IsDirtyData_TheForm(this.Grid_IsDirtyData):Set_Global_IsDirtyData_TheForm(h),r},SetDynamicScaleAndRoundType:function(n,t,i,r,u,f,e,o){var s=t.control,h=this.m_currentRowIndex,l,a,v,c;i!=null&&i!=this.m_currentRowIndex&&(h=i),this.MainCols[n].cusAttr("sf")!=this.UNDEFINED_VALUE?(l=o==!0&&n<r?this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.GetCellDefaultValue(this.MainCols[r],h,r):this.InnerGetCellValue(h,r),a=o==!0&&n<u?this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.GetCellDefaultValue(this.MainCols[u],h,u):this.InnerGetCellValue(h,u),v=o==!0&&n<f?this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.GetCellDefaultValue(this.MainCols[f],h,f):this.InnerGetCellValue(h,f),l!=""&&s.set_Scale(l,!0),a!=""&&v!=""&&(s.set_RoundType(a,!0),s.set_RoundValue(v,!0)),this.MainCols[n].cusAttr("CS")&&(c=o==!0&&n<e?this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.GetCellDefaultValue(this.MainCols[e],h,e):this.InnerGetCellValue(h,e),s.set_CurrencySymbol(c,!0)),this.MainCols[n].SumDataFormat!=null&&(l!=""&&l>this.MainCols[n].SumDataFormat.scale&&(this.MainCols[n].SumDataFormat.scale=l,this.MainCols[n].SumDataFormat.roundType=a,this.MainCols[n].SumDataFormat.roundValue=v),this._element.cusAttr("EditStatus")==DisplayStyle.Browser||this.IsEmptyRow(this.D_Body.rows[i])||(c!=""?this.MainCols[n].SumDataFormat.currencySymbol!=""&&this.MainCols[n].SumDataFormat.currencySymbol!=c?this.MainCols[n].SumDataFormat.currencySymbol="":this.get_TotalRows()==1&&(this.MainCols[n].SumDataFormat.currencySymbol=c):this.MainCols[n].SumDataFormat.currencySymbol=""))):(this.MainCols[n].cusAttr("CS")&&(c=o==!0&&n<e?this.m_gridBodyEventsHandler.GridEditHelper.GridCRUDHelper.GetCellDefaultValue(this.MainCols[e],h,e):this.InnerGetCellValue(h,e),s.set_CurrencySymbol(c,!0)),s.set_Scale(s.get_element().cusAttr("Scale"),!0),s.set_RoundValue(s.get_element().cusAttr("RV"),!0),s.set_RoundType(s.get_element().cusAttr("RT"),!0),s.set_FormatString(s.get_element().cusAttr("FS")))},InnerGetCellValue:function(n,t){var r="",i;return this.m_gridFaciesManager!=null&&t>=0&&(i=this.m_gridFaciesManager.GetCellValue(n,t),i!=null&&(r=i.Value)),r},CreateDatePickerControl:function(n){var t=null,i=this.GetColumnFieldID(n);return i!=""&&(t=this.ControlArray[i],t==null&&(t=window.document.getElementById(this.get_id()+"_"+i),Init(t.id,UF.UI.DateTimePicker),this.ControlArray[i]=t)),t},GetDateValueString:function(n){var t="";if(n!=null){var i=n.getFullYear(),r=n.getMonth()+1,u=n.getDate(),f=n.getHours(),e=n.getMinutes(),o=n.getSeconds();t=i+"-"+r+"-"+u+" "+f+":"+e+":"+o}return t},CreateComboxControl:function(n){var t=null,i=this.GetColumnFieldID(n),r;return i!=""&&(t=this.ControlArray[i],t==null&&(t=window.document.getElementById(this.get_id()+"_"+i),Init(t.id,UF.UI.DropDownList),r=this.MainCols[n].cusAttr("IsNull"),r=="false"&&t.cusAttr("R","y"),this.ControlArray[i]=t)),t},CreateCheckBoxControl:function(n){var t=null,i=this.GetColumnFieldID(n);return i!=""&&(t=this.ControlArray[i],t==null&&(t=$E(this.get_element()).createElement("input",{type:"checkbox"}),t.className="GridInput",t.id=this.get_id()+"_"+i,this.ControlArray[i]=t)),t},SetCheckBoxValue:function(n,t){var i=this.MainCols[t].cusAttr("CheckBoxValueRef");return i==""?n==DefaultSymbol.True:this.GetCheckBoxSelect(n,i)},GetCheckBoxSelect:function(n,t){for(var u=t.split(";"),r,i=0;i<2;i++)if(r=u[i].split(","),n==r[0])return r[2]==DefaultSymbol.True;return!1},GetCheckBoxTextByValue:function(n,t){var u,i,r;if(t!="")for(u=t.split(";"),i=0;i<2;i++)if(r=u[i].split(","),n==r[0])return r[1];return" "},GetCheckBoxValue:function(n,t){var u,i,r;if(t!="")for(u=t.split(";"),i=0;i<2;i++)if(r=u[i].split(","),n==r[2])return r[0];return""},GetCheckBoxText:function(n,t){for(var u=t.split(";"),r,i=0;i<2;i++)if(r=u[i].split(","),n==r[2])return r[1];return""},setCellListValue:function(n,t,i,r,u){var o,c,h;n.style.padding="0 2 0 2";var s=!1,f=null,e=n.children[0];if(e==this.UNDEFINED_VALUE||e.tagName=="NOBR"||e.className=="FixedInner"?s=!1:(s=!0,f=$find(e.id)),s&&n.cusAttr("oldValue",n.cusAttr("Value")),o=n.cusAttr("Value"),s&&u==undefined)switch(i){case ControlType.CheckBox:c=o=="true"?!0:!1,e.checked=c;break;case ControlType.Combox:f.set_Value(o);break;case ControlType.MultiInput:f.SetMultiinputData(n.cusAttr("MultiLang")),f.set_Value(t);break;case ControlType.Numberic:f.set_Value(o),f.input_onfocus();break;case ControlType.RefControl:f._isNeedValidate=!f._isNeedValidate,this.SetReferenceValues(f,n),f._isNeedValidate=!f._isNeedValidate,f.onInputFocus();break;case ControlType.Date:f.set_Value(o);break;case ControlType.TextBox:f=$ID(e.id),f&&(n.children[0]!=null&&n.children[0].tagName=="INPUT"&&(n.innerText=t),f.value=t,n.title=t);break;default:f=$ID(e.id),f&&(f.value=t)}else t&&t!=""?n.children[0]!=null&&n.children[0].tagName=="SPAN"||(h=window.document.createElement("NOBR"),h.innerText=t,n.innerHTML="",n.appendChild(h)):(n.innerText=" ",n.title="")},GetColumnFieldID:function(n){if(n>0&&n<this.m_columns){var t=this.MainCols[n].cusAttr("FieldID");if(t!=this.UNDEFINED_VALUE)return t}return""},GetColumnDisplayFormat:function(n){if(n>0&&n<this.m_columns){var t=this.MainCols[n].cusAttr("DisplayFormat");if(t!=this.UNDEFINED_VALUE)return t}return""},GetColumnDataType:function(n){if(n>0&&n<this.m_columns){var t=this.MainCols[n].cusAttr("DataType");if(t!=this.UNDEFINED_VALUE)return t}return DataType.String},GetColumnMaskChars:function(n){var t=MaskChar.Default;return n>0&&n<this.m_columns&&(this.MainCols[n].cusAttr("IsUseDefaultMaskChars")==="False"&&(t=""),this.MainCols[n].cusAttr("MaskChars")!=this.UNDEFINED_VALUE)?t+this.MainCols[n].cusAttr("MaskChars"):t},CreateTextBoxControl:function(n){var t=null,i=this.GetColumnFieldID(n),r;return i!=""&&(t=this.ControlArray[i],t==null&&(t=$E(window.document).createElement("input",{type:"text"}),t.id=this.get_id()+"_"+i,t.className="GridInput",t.cusAttr("dataType",this.GetColumnDataType(n)),t.cusAttr("displayFormat",this.GetColumnDisplayFormat(n)),$(t).bind("keypress",this.CheckMarkChar),$(t).bind("paste",this.CheckMarkChars),t.cusAttr("maskChars",this.GetColumnMaskChars(n)),r=parseInt(this.MainCols[n].cusAttr("MaxLength"),10),r>0&&(t.maxLength=r),this.ControlArray[i]=t)),t},SetCheckMark:function(){var n=event.srcElement;n.ctrlv=!1,event.ctrlKey&&event.keyCode==86&&(n.ctrlv=!0)},CheckMarkChars:function(){var t=event.srcElement,i=t.cusAttr("maskChars"),n;n=event?event.clipboardData.getData("text/plain"):window.clipboardData.getData("text"),isMasks(n,i)&&$Event(event).preventDefault()},CheckMarkChar:function(){var t=event.srcElement,n=t.cusAttr("maskChars");n!=""&&isMask(event.keyCode,n)&&$Event(event).preventDefault()},RemoveCharOfString:function(n,t){var u="",r,i;if(n!="")for(r=n.split(t),i=0;i<r.length;i++)u+=r[i];return u},CreateReferenceControl:function(n){var t=null,i=this.GetColumnFieldID(n),r,u;return i!=""&&(t=this.GetUserDefineReferenceControl(i),t==null&&(t=this.ControlArray[i],t==null&&(r=this.MainCols[this.GetColumnIndex(i)].cusAttr("ColEditCtrlClientID4P"),r&&(t=$ID(r),t!=null&&(this.UpdateReferenceResult.IsCustomPersonal=!0,$find(r)||Init(t.id,UF.UI.Reference),tryAttachCtrlEvent(r,"ContentChanged",this.UpdateReferenceResult),this.UpdateReferenceResult.SourceRefOutFieldName=i,u=this.MainCols[n].cusAttr("RefRel4P"),u!=null&&u!=""&&tryAttachCtrlEvent(this.get_id(),"OnRowContentChanged4P",this.UpdateReferenceResult4P),this.RefBeforeLoadData.IsCustomPersonal=!0,tryAttachCtrlEvent(r,"BeforeLoadData",this.RefBeforeLoadData))),t==null&&(t=window.document.getElementById(this.get_id()+"_"+i),Init(t.id,UF.UI.Reference),t.cusAttr("RefPara",this.MainCols[n].cusAttr("RefPara")),t.cusAttr("CtrlId",this.MainCols[n].cusAttr("CtrlId")),tryAttachCtrlEvent(this.get_id()+"_"+i,"ContentChanged",this.UpdateReferenceResult),this.UpdateReferenceResult.SourceRefOutFieldName=i,u=this.MainCols[n].cusAttr("RefRel4P"),u!=null&&u!=""&&tryAttachCtrlEvent(this.get_id(),"OnRowContentChanged4P",this.UpdateReferenceResult4P),tryAttachCtrlEvent(this.get_id()+"_"+i,"BeforeLoadData",this.RefBeforeLoadData)),t.columnIndex=n,this.MainCols[n].cusAttr("Post")=="1"?(t.control.set_IsShowForm(!1),t.control._button.onclick=this.DoFirePostBack):this.MainCols[n].cusAttr("Post")=="2",this.ControlArray[i]=t)),this.UpdateReferenceResult.SourceRefOutFieldName=i),t},GetUserDefineReferenceControl:function(n){var t=null,i=this.m_clientUserControl[n];return i!=this.UNDEFINED_VALUE&&i.ControlType==ControlType.RefControl&&(t=i.Control,t!=null&&(t.RefPara=i.refParas)),t},SetReferenceValues:function(n,t){var o=n.get_IsRaiseEvent(),s=n.get_IsPersonalProcess(),u,r,f,e;n.set_IsRaiseEvent(!1),n.set_IsPersonalProcess(!1),n.SetValues("","",""),n.set_IsRaiseEvent(o),n.set_IsPersonalProcess(s),t.cusAttr("R")!=this.UNDEFINED_VALUE&&(u=t.cusAttr("R"),u!=""&&(r=u.split(this.RefSplitter2),r.length==2&&(f=r[0],e=r[1],n.SetValues(t.cusAttr("Value"),f,e))))},SetReferenceParameters:function(n,t,i,r){var f,u;if(n!=null&&r!=this.UNDEFINED_VALUE)for(f=r.split(";"),u=0;u<f.length;u++)this.SetReferenceParameter(n,i,f[u],t)},SetReferenceParameter:function(n,t,i,r){var o,e,l,u,f;if(i!=""&&(o=i.split(","),o.length==3)){var s=o[0],h=o[1],c=o[2];if(!n.get_IsLoadDefaultParams()&&n.GetParam(s)!=null&&!this.MainCols[r].cusAttr("ISMultiOrg"))return;c=="Context"?this.MainCols[r].hasCusAttr("ISMultiOrg")&&this.MainCols[r].cusAttr("ISMultiOrg").toString().toLowerCase()=="true"?(u="",e=$ID(h),u=e?e.control?e.control.get_Type()==ControlType.Reference?e.control.get_Key():e.control.get_Value():e.value:this.MainCols[r].cusAttr("SrcOrg"),n.AddParam(s,u)):n.AddParam(s,$ID(h).value):(l=this.GetColumnIndex(h),l>=0?n.AddParam(s,this.GetColumnRefContext(t,this.GetColumnIndex(h),c)):(u="",f=this.GetControlByServerID(h),f&&f.control&&(f.control.get_Type()==ControlType.Reference?c=="ByValue"?u=f.control.get_Key():c=="ByCode"?u=f.control.get_Value():c=="ByText"&&(u=f.control.get_Text()):u=f.control.get_Value(),n.AddParam(s,u))))}},GetColumnType:function(n){var t=this.MainCols[n].cusAttr("ControlType");return t==this.UNDEFINED_VALUE?"":t},GetColumnRefContext:function(n,t,i){return t>-1?i=="ByCode"?this.GetColumnType(t)==ControlType.RefControl?this.GetCellValue(n,t).Code:this.GetColValue(n,t):i=="ByText"?this.GetColText(n,t):this.GetColValue(n,t):""},GetColValue:function(n,t){return this.D_Body.rows[n].cells[t].cusAttr("Value")},GetColText:function(n,t){return $(this.D_Body.rows[n].cells[t]).text()},UpdateNumbericPrecision:function(n){for(var i,t=0;t<this.m_columns;t++)if(this.MainCols[t].cusAttr("sf")!=this.UNDEFINED_VALUE&&(i=this.m_gridFaciesManager.GetCellValue(n,t),i!=null)){var u=i.Value,f=this.m_formatHelper.FormatCellNumber(t,n,i.Value,i.Value),r=f.Value;this.SetColValue(n,t,r),this.SetColText(n,t,f.Text),this.MainCols[t].cusAttr("HasSum")=="true"&&r-u!=0&&this.SetTotalValue(this.MainCols[t].cusAttr("FieldID"),parseFloat(this.GetTotalValue(this.MainCols[t].cusAttr("FieldID")))+parseFloat(r)-parseFloat(u))}},UpdateCellValueFromReferenceResult:function(n,t,i){var f,e;if(t!=""&&(f=t.split(","),f.length==4)){var o=f[0],u=f[1],s=f[2],h=f[3],r=this.GetColumnIndex(o);if(r>-1)switch(this.GetColumnControlType(o)){case ControlType.RefControl:i==null?this.UpdateReferenceCell(n,this.m_currentRowIndex,r,u,s,h):this.UpdateReferenceCell(n,i,r,u,s,h);break;case ControlType.Combox:i==null?this.UpdateComboxCell(n,this.m_currentRowIndex,r,u):this.UpdateComboxCell(n,i,r,u);break;case ControlType.MultiInput:i==null?this.UpdateMultiInputCell(n,this.m_currentRowIndex,r,u):this.UpdateMultiInputCell(n,i,r,u);break;case ControlType.CheckBox:i==null?this.UpdateCheckBoxCell(n,this.m_currentRowIndex,r,u):this.UpdateCheckBoxCell(n,i,r,u);break;case ControlType.Numberic:i==null?this.UpdateNumbericCell(n,this.m_currentRowIndex,r,u):this.UpdateNumbericCell(n,this.m_currentRowIndex,r,u);break;case ControlType.Date:case ControlType.DateTime:i==null?this.UpdateDateCell(n,this.m_currentRowIndex,r,u):this.UpdateDateCell(n,i,r,u);break;default:i==null?this.UpdateNormalCell(n,this.m_currentRowIndex,r,u):this.UpdateNormalCell(n,i,r,u),e=new CellDataContent("",n),i==null?this.OnCellDataValueChanged(e,this.m_currentRowIndex,r):this.OnCellDataValueChanged(e,i,r)}}},UpdateReferenceCell:function(n,t,i,r,u,f){var e=n.GetValue(r),c=n.GetValue(u),s=n.GetValue(f),o=this.GetColValue(t,i),h;this.SetColValue(t,i,e),this.SetColText(t,i,s),this.SetColRefAttribute(t,i,c+this.RefSplitter2+s),o==""&&(o="-1"),e!=o&&e!=""&&(h=new CellDataContent("",e),this.OnCellDataValueChanged(h,t,i))},UpdateComboxCell:function(n,t,i,r){var u=n.GetValue(r);this.SetCellValue(t,i,u)},GetComboxTextbyID:function(n,t){var i=t,r=this.CreateComboxControl(n),u;return r!=this.UNDEFINED_VALUE&&(u=r.control,i=u.getTextByValue(t),i==""&&(i=" ")),i},UpdateCheckBoxCell:function(n,t,i,r){var u=n.GetValue(r);u&&typeof u=="string"&&(u=u.toLowerCase()),this.SetCellValue(t,i,u)},UpdateMultiInputCell:function(n,t,i,r){var u=n.GetValue(r);this.m_gridFaciesManager.SetMultiLangAttribute(this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(t,i),u),this.SetCellValue(t,i,u)},UpdateNumbericCell:function(n,t,i,r){var u=n.GetValue(r);this.SetCellValue(t,i,u)},UpdateDateCell:function(n,t,i,r){var u=n.GetValue(r);this.SetCellValue(t,i,u)},UpdateNormalCell:function(n,t,i,r){var u=n.GetValue(r);this.SetCellValue(t,i,u)},GetColumnControlType:function(n){for(var i="",t=0;t<this.m_columns;t++)if(n==this.MainCols[t].cusAttr("FieldID")){i=this.MainCols[t].cusAttr("ControlType");break}return i},SetColValue:function(n,t,i){this.D_Body.rows[n].cells[t].cusAttr("Value",i)},SetColRefAttribute:function(n,t,i){try{this.D_Body.rows[n].cells[t].cusAttr("R",i)}catch(r){}},SetColText:function(n,t,i){this.setCellListValue(this.D_Body.rows[n].cells[t],i)},GetFormatedValue:function(n){return n},GetMultiinputData:function(n,t){var r,u;if(!n)return"";if(r=this.GetColumnControl(t),r!=null){var f=Get_Global_IsDirtyData_TheForm(),i=r.control,e=i.GetMultiinputData(),o=i.get_Value();return i.ClearData(),i.set_Value(n),u=i.GetMultiinputData(),i.SetMultiinputData(e),i.set_Value(o),Set_Global_IsDirtyData_TheForm(f),u}return""},GetDateFormatedValue:function(n,t){var r=this.CreateDatePickerControl(t),u;if(r!=null){var f=Get_Global_IsDirtyData_TheForm(),i=r.control,e=i.get_Value();return i.set_Value(n),u=i.get_Text(),i.set_Value(e),Set_Global_IsDirtyData_TheForm(f),u}return n},SetColumnEdit:function(n,t){var i=this.GetColumnIndex(n);this.MainCols[i].cusAttr("Edit",t&&this.MainCols[i].cusAttr("EditEx")==DefaultSymbol.True)},AllowEdit:function(n,t){var f=this.m_currentRowIndex,i,r,u;return t!=null&&(this.m_currentRowIndex=t),i=!0,this.m_gridFaciesManager&&(r=this.m_gridFaciesManager.GetCurrentCell(this.m_currentRowIndex,n),r?this.m_gridBodyEventsHandler.GridEditHelper?(u=this.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.CellEditEnabled(n,r),i=u):i=!1:i=!1),this.MainCols[n]&&this.MainCols[n].style&&(this.MainCols[n].style.display=="none"||this.MainCols[n].cusAttr("Edit")=="false")&&(i=!1),this.m_currentRowIndex=f,i},IsEndColumn:function(n){for(var t=this.m_currentColumnIndex;n<this.m_columns;){if(this.IsNeedSwitchTabPage(n))break;if(this.MainCols[n])if(this.MainCols[n].style.display!="none"&&this.AllowEdit(n))break;else n=n+1}return this.m_currentColumnIndex=t,n==this.m_columns?!0:!1},GetFirstColumn:function(){for(var t=0,n=1;n<this.m_columns;n++){if(this.IsNeedSwitchTabPage(n))break;if(this.MainCols[n].style.display!="none"&&this.AllowEdit(n)){t=n;break}else continue}return t},GetNextColumn:function(n,t){for(var i=n;i<this.m_columns;){if(t!=null&&i==t)break;if(!this.MainCols[i])break;if(this.IsNeedSwitchTabPage(i))break;if(this.MainCols[i].style.display!="none"&&this.AllowEdit(i))break;else i=i+1}return i==this.m_columns&&(i=n-1),i},GetPreviousColumn:function(n){for(var t=n;t>0;){if(!this.MainCols[t])break;if(this.IsNeedSwitchTabPage(t))break;if(this.MainCols[t].style.display!="none"&&this.AllowEdit(t))break;else t=t-1}return t==0&&(t=n+1),t},SetHeadCheckBoxState:function(n){var i,r,t;if(this._element.cusAttr("SelectModel")=="mulitline"){i=!0,n!=null&&(i=n),i||(this.D_Head.children[0].cells[0].children[0]&&(this.D_Head.children[0].cells[0].children[0].checked=!1),this.m_pageBreakManagerInstance&&this.m_pageBreakManagerInstance.chk&&(this.m_pageBreakManagerInstance.chk.checked=!1));try{for(r=!0,t=0;t<this.D_Body.rows.length;t++)if(!this.D_Body.children[t].cells[0].children[0].checked){r=!1;break}this.D_Head.children[0].cells[0].children[0].checked=r}catch(u){}}},SetTotalValue:function(n,t){var r,i,u;if(this.D_Foot!=this.UNDEFINED_VALUE){if(r=this.GetColumnIndex(n),r<0)return;if(i=this.getFootOriginalRow().cells[r],!i)return;u=this.m_formatHelper.FormatTotalNumber(r,t),i.cusAttr("Value",u.Value),i.children.length>0?i.children[0].innerHTML=u.Text:i.innerHTML=u.Text}},GetTotalValue:function(n){var i,t;if(this.D_Foot!=this.UNDEFINED_VALUE){if((i=this.GetColumnIndex(n),i<0)||(t=this.getFootOriginalRow().cells[i],!t))return 0;if(t.cusAttr("Value"))return t.cusAttr("Value");if(t.innerText.replace(/[^-.\d]/g,"")!="")return parseFloat(t.innerText.replace(/[^-.\d]/g,""))}return 0},OnGotoErrorRecordClick:function(rcdID){for(var fldID,isCurrentPage=!1,i=0;i<this.m_rows;i++)if(fldID=this.GetCellValueByFieldAndRow("ID",i).Value,rcdID==fldID){isCurrentPage=!0,this.m_currentRowIndex=i,this.m_gridFaciesManager.SetSelectedRow(i),this.m_gridFaciesManager.ShowCellByScrollLayout(i,this.m_currentColumnIndex);break}isCurrentPage||(this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","GotoErrorRecord"),this.eventNode.setAttribute("ErrorRecordID",rcdID),eval(this._element.cusAttr("onfireevents")))},OnCustomFilterClick:function(action,currentRecordID){var oldRowIndex,startRowIndex;if(!(this.m_rows<2)){if(action=="BuildFilter"){this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","CustomFilter"),this.eventNode.setAttribute("StartRowIndex","0"),this.eventNode.setAttribute("ActionTag","None"),this.StoreState("P"),this.GridIsInFocus=!0,eval(this._element.cusAttr("onfireevents"));return}if(action=="select"||action=="unselect"){this.SelectMarkedRecord(action=="select");return}if(action!="SetFilter"&&this.m_gridBodyEventsHandler.CanEndEdit(!1)&&(oldRowIndex=this.m_currentRowIndex,this.GetNextMarkedRecord(action)==!0)){this.m_lastRowIndex=oldRowIndex,this.OnRowChanged(),this.Focus(!1);return}this.eventNode=this.dataDom.createElement("Event"),this.eventNode.setAttribute("Style","CustomFilter"),startRowIndex=0,this.m_currentRowIndex>=0&&(startRowIndex=this.GetCellValueByFieldAndRow("ID",this.m_currentRowIndex).Value),startRowIndex==""&&(startRowIndex="0"),this.eventNode.setAttribute("StartRowIndex",startRowIndex),this.eventNode.setAttribute("ActionTag",action),this.StoreState("P"),this.GridIsInFocus=!0,eval(this._element.cusAttr("onfireevents"))}},SelectMarkedRecord:function(n){for(var i=this.m_currentRowIndex,t=0;t<this.m_rows;t++)this.D_Body.rows[t].cusAttr("Marked")=="true"&&(this.m_currentRowIndex=t,this.SetRowChecked(t,n,!0));this.m_currentRowIndex=i},GetNextMarkedRecord:function(n){var t;if(n=="Next"){for(t=this.m_currentRowIndex+1;t<this.m_rows;t++)if(this.D_Body.rows[t].cusAttr("Marked")=="true")return this.m_currentRowIndex=t,this.m_gridFaciesManager.SetSelectedRow(t),this.m_gridFaciesManager.ShowCellByScrollLayout(t,this.m_currentColumnIndex),!0}else if(n=="Previous"){for(t=this.m_currentRowIndex-1;t>=0;t--)if(this.D_Body.rows[t].cusAttr("Marked")=="true")return this.m_currentRowIndex=t,this.m_gridFaciesManager.SetSelectedRow(t),this.m_gridFaciesManager.ShowCellByScrollLayout(t,this.m_currentColumnIndex),!0}else n=="First"||n=="Last";return!1},IsRowSelected:function(n){return(typeof n!="object"&&(n=this.D_Body.rows[parseInt(n,10)]),n&&n.cells&&n.cells.length>0&&n.cells[0].children.length>0&&n.cells[0].children[0].type=="checkbox")?n.cells[0].children[0].checked:!1},SetDefaultValue4P:function(n,t){var o,r,u,i,f,s,e;for(typeof t=="undefined"&&(t=-1),o=this.m_currentColumnIndex,r=0,u=0;u<this.m_DefaultValueColumnsOrder.length;u++)if((i=this.GetColumnIndex(this.m_DefaultValueColumnsOrder[u]),t!=i)&&!(i<1))if(this.IsInDefaultValueColumnsLastValue(this.m_DefaultValueColumnsOrder[u])){if(n<1)continue;f=this.GetCellValue(n-1,i),r==0&&_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').EndEdit();"),s="$SetGridCellValue('"+this.get_id()+"',$find(\""+this.get_id()+'").m_rows > '+n+" ?  "+n+" : '$find(\""+this.get_id()+"\").GetLastRealRowIndex()',"+i+",'"+f.Value+"','"+f.Code+"','"+f.Text+"',null,null,0,true)",_ClientJSExecQueueManager.Push(s),r++}else e=this.GetColumnDefaultValue4P(i),r==0&&_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').EndEdit();"),this.GetColumnType(i)==ControlType.RefControl?_ClientJSExecQueueManager.Push("$SetGridCellValue('"+this.get_id()+"',"+n+","+i+",'"+e.replace(/__&URS2&_/g,"','")+"',null,null,0,true)"):_ClientJSExecQueueManager.Push("$SetGridCellValue('"+this.get_id()+"',"+n+","+i+",'"+e+"',null,null,null,null,0,true)"),r++;return r>0&&(_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').EndEdit();"),_ClientJSExecQueueManager.Push("$find('"+this.get_id()+"').m_currentColumnIndex = "+o+";$find('"+this.get_id()+"').Focus();"),_ClientJSExecQueueManager.Start()),r},hasPersonalDefaultValue:function(){for(var t,n=0;n<this.m_DefaultValueColumnsOrder.length;n++)if(t=this.GetColumnIndex(this.m_DefaultValueColumnsOrder[n]),t>=1)return!0;return!1},IsInDefaultValueColumnsLastValue:function(n){for(var t=0;t<this.m_DefaultValueColumns.length;t++)if(this.m_DefaultValueColumns[t]==n)return!0;return!1},ShowMessage:function(n,t){this.msgDiv.innerHTML=n,this.msgDiv.style.display="",window.setTimeout("$find('"+this.get_id()+"').HideMessage();",t)},HideMessage:function(){this.msgDiv.style.display="none"},SetRefSingleValue:function(n,t,i){var u,r,f,e;if(this.EndEdit(),u=this.GetColumnIndex(t),!(u<=0)){if(this.m_currentRowIndex=n,this.m_currentColumnIndex=u,r=this.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(n,u),r&&this.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.StartCellEdit(r),r.children[0].tagName=="SPAN")f=r.children[0],e=f.control,e.set_SingleText(i);else return;r&&this.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.EndCellEdit(r)}},ShowFormReference:function(n){if(this.m_behaviorManager&&this.m_behaviorManager.HeadEventsManager){this.MainCols[this.GetColumnIndex(n)].cusAttr("_showLabelFormAfterCallBack",null);var t=this.m_behaviorManager.HeadEventsManager.GetFormReference(this.m_currentFormRef,n);this.m_behaviorManager.HeadEventsManager.ShowDialog(t,n)}},AddSortColumnToList:function(n,t){for(var u,e,f,o=this.m_SortColumns.length,r=o-1;r>=0;r--)if(this.m_SortColumns[r]==n){Array.removeAt(this.m_SortColumns,r);break}(t=="UP"||t=="DOWN")&&this.m_SortColumns.push(n),this.m_SortColumns.length>this.m_SortColumnsLimit&&(u=this.m_SortColumns.shift(),e=this.MainCols[this.GetColumnIndex(u)],e&&(e.Sorted="",f=this.getColumnHeadCell(this.GetColumnIndex(u),u),f.sortDiv&&f.removeChild(f.sortDiv)))},ResetSortColumnNum:function(){var n,i,t;if(this.m_SortColumns.length>0)for(n=0;n<this.m_SortColumns.length;n++)i=this.m_SortColumns[n],t=this.getColumnHeadCell(this.GetColumnIndex(i),i),t.sortDiv?t.sortDiv.className=t.sortDiv.className+"_"+(n+1):(Array.removeAt(this.m_SortColumns,n),n--)},GetRowIndex4BatchInput:function(n,t,i){if(n<0)return-1;for(var r=0;r<this.D_Body.rows.length;r++)if(!this.IsEqual(n,this.D_Body.rows[r].cells[n].cusAttr("Value").toString(),t.toString())){if(this.GetRowStatus(r)==RowStatus.Empty)continue;if(!this.AllowEdit(n,r))continue;if(i==null||this.CompareValue4BatchInput(r,i))return r}return-1},IsEqual:function(n,t,i){var r=!1,u;if(t==i)r=!0;else{u=this.GetColumnType(n);switch(u){case ControlType.Date:t==""&&i!=""||i==""&&t!=""||parseDate(t).toString()==parseDate(i).toString()&&(r=!0);break;case ControlType.RefControl:t==""&&(t=-1),t==i&&(r=!0)}}return r},CompareValue4BatchInput:function(n,t){var i,r,u;if(!t)return!1;for(i=0;i<t.length;i++)if(r=t[i],u=this.CompareValue4BatchInputItem(n,r),u===!1)return!1;return!0},CompareValue4BatchInputItem:function(rowIndex,conditions){var ct,opV,conditionV1,conditionV2;colIndex=conditions.colIndex,opV=conditions.op,conditionV1=conditions.V1,conditionV2=conditions.V2,gridCellV=this.GetCellValue(rowIndex,colIndex),gridCellV&&(gridCellV=this.MainCols[colIndex].cusAttr("ControlType")==ControlType.RefControl?gridCellV.Code:gridCellV.Value),gridCellV==""&&(gridCellV="''");var ct=this.GetColumnType(colIndex),result=!1,condition="1==2";switch(ct){case ControlType.TextBox:case ControlType.TextArea:case ControlType.RefControl:case ControlType.MultiInput:opV==3?condition='"'+gridCellV+'">="'+conditionV1+'" && "'+gridCellV+'"<="'+conditionV2+'"':opV==0?condition='"'+gridCellV+'"=="'+conditionV1+'"':opV==1?condition='"'+gridCellV+'">"'+conditionV1+'"':opV==2?condition='"'+gridCellV+'"<"'+conditionV1+'"':opV==4?condition='"'+gridCellV+'"== "\'\'"':opV==5&&(condition='"'+gridCellV+'"!= "\'\'"'),result=eval(condition);break;case ControlType.Date:var _DateCultureName=getCultureName().toLowerCase(),condiDate1=new Date,condiDate2=new Date,gridDate=new Date;gridDate&&(gridDate=Date$parseEx(gridDate,gridCellV.toString(),"G",_DateCultureName)),conditionV1&&(condiDate1=Date$parseEx(condiDate1,conditionV1.toString(),"G",_DateCultureName)),conditionV2&&(condiDate2=Date$parseEx(condiDate2,conditionV2.toString(),"G",_DateCultureName)),opV==3?result=gridDate>=condiDate1&&gridDate<=condiDate2:opV==0?result=!(gridDate>condiDate1)&&!(gridDate<condiDate1):opV==1?result=gridDate>condiDate1:opV==2&&(result=gridDate<condiDate1),opV==4?(condition='"'+gridCellV+'"== "\'\'"',result=eval(condition)):opV==5&&(condition='"'+gridCellV+'"!= "\'\'"',result=eval(condition));break;case ControlType.Numberic:case ControlType.CheckBox:case ControlType.Combox:opV==3?condition=gridCellV+">="+conditionV1+" && "+gridCellV+"<="+conditionV2:opV==0?condition=gridCellV+"=="+conditionV1:opV==1?condition=gridCellV+">"+conditionV1:opV==2&&(condition=gridCellV+"<"+conditionV1),opV==4&&ct==ControlType.Numberic?condition='"'+gridCellV+'"== "0"':opV==5&&ct==ControlType.Numberic?condition='"'+gridCellV+'"!= "0"':opV==4&&ct==ControlType.Combox?condition='"'+gridCellV+'"== "-1"':opV==5&&ct==ControlType.Combox?condition='"'+gridCellV+'"!= "-1"':opV==4&&ct==ControlType.CheckBox?condition='"'+gridCellV+'"== "\'\'"':opV==5&&ct==ControlType.CheckBox&&(condition='"'+gridCellV+'"!= "\'\'"'),result=eval(condition)}return result},get_Type:function(){return ControlType.DataGrid},get_IsSortSelectRecords:function(){return this.m_IsSortSelectRecords==null&&(this.m_IsSortSelectRecords=!1),this.m_IsSortSelectRecords},set_IsSortSelectRecords:function(n){n=n==!0?!0:!1,this.m_IsSortSelectRecords=n},SortedSelectIDs_Add:function(n){return this.SortedSelectIDs_Remove(n),this.m_SortedSelectIDs.push(n),this.m_SortedSelectIDs.toString()},SortedSelectIDs_Remove:function(n){for(var t=0;t<this.m_SortedSelectIDs.length;t++)if(this.m_SortedSelectIDs[t]==n){this.m_SortedSelectIDs.splice(t,1);break}return this.m_SortedSelectIDs.toString()},UnSelectIDs_Add:function(n){return this.UnSelectIDs_Remove(n),this.m_UnSelectIDs.push(n),this.m_UnSelectIDs.toString()},UnSelectIDs_Remove:function(n){for(var t=0;t<this.m_UnSelectIDs.length;t++)if(this.m_UnSelectIDs[t]==n){this.m_UnSelectIDs.splice(t,1);break}return this.m_UnSelectIDs.toString()},getFootOriginalRow:function(){return this.D_Foot!==undefined&&this.D_Foot.rows[0]!==undefined&&this.D_Foot.rows[0].cusAttr(this.sumRowFlag)&&this.D_Foot.rows[0].cusAttr(this.sumRowFlag).toString().toLowerCase()==="true"?this.D_Foot.rows[0]:this.D_Foot!==undefined&&this.D_Foot.rows[1]!==undefined&&this.D_Foot.rows[1].cusAttr(this.sumRowFlag)&&this.D_Foot.rows[1].cusAttr(this.sumRowFlag).toString().toLowerCase()==="true"?this.D_Foot.rows[1]:void 0},getFootNewRow:function(){return this.D_Foot!==undefined&&this.D_Foot.rows[0]!==undefined&&this.D_Foot.rows[0].cusAttr(this.newSumRowFlag)&&this.D_Foot.rows[0].cusAttr(this.newSumRowFlag).toString().toLowerCase()==="true"?this.D_Foot.rows[0]:this.D_Foot!==undefined&&this.D_Foot.rows[1]!==undefined&&this.D_Foot.rows[1].cusAttr(this.newSumRowFlag)&&this.D_Foot.rows[1].cusAttr(this.newSumRowFlag).toString().toLowerCase()==="true"?this.D_Foot.rows[1]:void 0},GetNewTotalValue:function(n){var i,t;if(this.D_Foot!=this.UNDEFINED_VALUE){if((i=this.GetColumnIndex(n),i<0)||(t=this.getFootNewRow().cells[i],!t))return 0;if(t.cusAttr("Value"))return t.cusAttr("Value");if(t.innerText.replace(/[^-.\d]/g,"")!="")return parseFloat(t.innerText.replace(/[^-.\d]/g,""))}return 0},getFocusInfo:function(){return{rowIndex:this.m_currentRowIndex,colIndex:this.m_currentColumnIndex}},setFocusInfo:function(n){this.m_currentRowIndex=n.rowIndex,this.m_currentColumnIndex=n.colIndex},findDisplayNameByIndex:function(n){var t,r,u,i,f;if(n==-1)return"";try{t=this.MainCols[n].cusAttr("name")}catch(e){t=""}if(r=this.GetColumnFieldID(n),this.D_Head.children.length>1){if(!t)for(u=n;n>0&&!t;)try{t=this.MainCols[--u].cusAttr("name")}catch(e){t=""}for(t&&(t+=","),i=1;i<this.D_Head.children.length;i++)f=this.D_Head.children[i],$.each($(f).find("td"),function(n,i){i.cusAttr("fieldid")==r&&(t+=$(i).text()+",")});t&&t.lastIndexOf(",")==t.length-1&&(t=t.substring(0,t.length-1))}return t||""},to_Help:function(n,t){var i=this,o=!1,r=$(this.D_Body).find("tr").eq(0).find("td"),u,f,e;if(r.length==0&&this.D_Head.children.length==1&&(e=this.D_Head.children[0],r=$(e).find("td")),r.length>0)r=$(this.D_Head).find("td")||$(this.D_Head).find("th"),$.each(r,function(t,r){if($(r).css("display")!="none"){var u=i.findDisplayNameByIndex(t),f=$(r).width(),e=$(r).parents("table").height();u?$(r).append("<div class='fieldBg' forid='"+i._element.id+"' fieldname='"+u+"' z-index='"+n+"' style='width:"+f+"px;height:"+e+"px;'><\/div>"):$(r).append("<div  class='fieldBg' z-index='"+n+"' style='width:"+f+"px;height:"+e+"px;'><\/div>"),$(r).addClass("fieldBg_holder")}});else for(u={},f=this.D_Head.children.length-1;f>=0;f--)e=this.D_Head.children[f],$.each($(e).find("td"),function(n,t){if($(t).css("display")!="none"){var f=i.GetColumnIndex(t.cusAttr("fieldid")),r=i.findDisplayNameByIndex(f);$(t).text()!=""&&r.indexOf($(t).text())==-1&&(r=$(t).text()),t.cusAttr("fieldid")&&u[t.cusAttr("fieldid")]!==!0&&r?($(t).append("<div class='fieldBg' forid='"+i._element.id+"' fieldname='"+r+"' z-index='"+f+"' style='width:"+$(t).width()+"px'><\/div>"),u[t.cusAttr("fieldid")]=!0):u[t.cusAttr("fieldid")]!=!0&&$(t).append("<div  class='fieldBg' z-index='"+f+"' style='width:"+$(t).width()+"px'><\/div>")}});this.m_pageBreakManagerInstance.to_Help(n,t),t&&$("[forid='"+this._element.id+"']").click(function(n){t($(n.target).attr("fieldname"),$(n.target).attr("forid")),n.preventDefault(),n.stopPropagation()})},to_Translate:function(n,t){var r=this,u=!1,i=$(this.S_Body).find("tr").find("td");i.length>0&&$.each(i,function(i,r){if($(r).css("display")!="none"){var f=this,u=f.cusAttr("fieldid");if($(r).css({position:"relative"}),u&&u.indexOf("DescFlexField_")==-1)$(r).append("<div class='fieldTranslateBg' forid='"+u+"' fieldname='"+name+"' z-index='"+n+"'><\/div>");else{$(r).append("<div class='fieldTranslateBg disabled' z-index='"+n+"'><\/div>"),$(r).unbind("click dblclick");$(r).on("click dblclick",function(n){$(r).hasClass("fieldTranslateBg_holder")&&(n.preventDefault(),n.stopPropagation())})}$(r).addClass("fieldTranslateBg_holder"),t&&$("[forid='"+u+"']").unbind("click").bind("click",function(n){n.preventDefault(),n.stopPropagation(),t(u,u)})}}),this.m_pageBreakManagerInstance.to_Help(n,t)},set_translateName:function(n,t){var i=n.parent(".fieldTranslateBg_holder");$(i).each(function(){$($(this).find("nobr")[0]).html(t)})},to_Defualt:function(){var n;$(this._element).find(".fieldBg").length>0&&($(this._element).find(".fieldBg").remove(),n=$(this._element).find(".fieldBg_holder"),n&&n.removeClass("fieldBg_holder")),$(this._element).find(".fieldTranslateBg").length>0&&($(this._element).find(".fieldTranslateBg").remove(),n=$(this._element).find(".fieldTranslateBg_holder"),n&&n.removeClass("fieldTranslateBg_holder").css("position","static")),this.m_pageBreakManagerInstance.to_Defualt()}},UF.UI.DataGrid.registerClass("UF.UI.DataGrid",UF.UI.Control),DataGridEvent.OnBodyRowSelectedChange="OnBodyRowSelectedChange",DataGridEvent.OnBodyRowSelectedValueChange="OnBodyRowSelectedValueChange",DataGridEvent.OnBodyRowSelected="OnBodyRowSelected",DataGridEvent.OnBeforeRowInsert="OnBeforeRowInsert",DataGridEvent.OnBeforeRowDelete="OnBeforeRowDelete",DataGridEvent.OnAfterRowInserted="OnAfterRowInserted",DataGridEvent.OnAfterRowDeleted="OnAfterRowDeleted",DataGridEvent.OnCellFocusEnter="OnCellFocusEnter",DataGridEvent.OnCellFocusOut="OnCellFocusOut",DataGridEvent.OnCellClick="OnCellClick",DataGridEvent.OnCellDbClick="OnCellDbClick",DataGridEvent.OnRowChanged="OnRowChanged",DataGridEvent.OnRowClick="OnRowClick",DataGridEvent.OnMovePage="OnMovePage",DataGridEvent.OnSortData="OnSortData",DataGridEvent.Onkeypress="Onkeypress",DataGridEvent.OnBeforeOpenDialog="OnBeforeOpenDialog",DataGridEvent.OnAfterOpenDialog="OnAfterOpenDialog",DataGridEvent.OnBeforeCustomerPostBack="OnBeforeCustomerPostBack",DataGridEvent.OnAfterRowAdded="OnAfterRowAdded",DataGridEvent.OnBeforeCellFocusEnter="OnBeforeCellFocusEnter",DataGridEvent.OnCellDataChanged="OnCellDataChanged",DataGridEvent.OnCellDataValueChanged="OnCellDataValueChanged",DataGridEvent.OnAfterRowCopyed="OnAfterRowCopyed",DataGridEvent.OnBeforeRowCopy="OnBeforeRowCopy",DataGridEvent.OnRowContentChanged4P="OnRowContentChanged4P",DataGridEvent.OnBeforeRowAdd="OnBeforeRowAdd",DataGridEvent.OnSelectAllRecords="OnSelectAllRecords",DataGridEvent.OnControlValueChange="OnControlValueChange",DataGridEvent.OnSelecteAllPage="OnSelecteAllPage",DataGridEvent.OnBatchModify="OnBatchModify",DataGridEvent.OnAfterRowCopyed4Default="OnAfterRowCopyed4Default",DataGridEvent.OnImitateSwitchTabPage="OnImitateSwitchTabPage",$SetGridCellValue=function(grid,rowIndex,colIndex,key,value,text,needValidate,sender,type,loseFocus){var msgType,tmpJS,cell,grdItem,obj,oldCellValue,i;if(sender!="Run4P"&&!0&&(msgType=type,msgType!=0&&msgType!=2&&(msgType=1),$find(grid))){var gridCtrl=$find(grid),oldColIndex=gridCtrl.m_currentColumnIndex,oldRowIndex=gridCtrl.m_currentRowIndex;if(pRowIndex=rowIndex,isNaN(pRowIndex)==!0&&(rowIndex=eval(rowIndex)),rowIndex===undefined&&(rowIndex=oldRowIndex),value||(value=key),text||(text=key),gridCtrl.GetColumnType(colIndex)==ControlType.Numberic&&isNaN(key))return;if(gridCtrl.m_currentColumnIndex=colIndex,gridCtrl.m_currentRowIndex=rowIndex,gridCtrl.IsNeedSwitchTabPage(colIndex,rowIndex)){window.IsGridInImitateSwitchTabPage||_ClientCallBackManager.Runing||gridCtrl.ImitateSwitchTabPage(!0),tmpJS="$SetGridCellValue('"+grid+"','"+pRowIndex+"','"+colIndex+"','"+key+"','"+value+"','"+text+"',"+needValidate+",null,"+msgType+(loseFocus?",true":"")+");",_ClientJSExecQueueManager.AddToFirstQuery(tmpJS),_ClientJSExecQueueManager.Start();return}if(!gridCtrl.AllowEdit(colIndex))return;if(gridCtrl.MainCols[colIndex].cusAttr("ColEditCtrlClientID4P")){if(_ClientPostBackManager.Runing){tmpJS="$SetGridCellValue('"+grid+"','"+pRowIndex+"','"+colIndex+"','"+key+"','"+value+"','"+text+"',"+needValidate+",null,"+msgType+(loseFocus?",true":"")+");",Global_JSQueueEvalAfterPageLoadedManager.Add(tmpJS);return}if(_ClientCallBackManager.Runing){tmpJS="$SetGridCellValue('"+grid+"','"+pRowIndex+"','"+colIndex+"','"+key+"','"+value+"','"+text+"',"+needValidate+",null,"+msgType+(loseFocus?",true":"")+");",_ClientJSExecQueueManager.Push(tmpJS);return}}if(isMasks(value,gridCtrl.GetColumnMaskChars(colIndex)))return;cell=gridCtrl.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(rowIndex,colIndex),cell&&gridCtrl.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.StartCellEdit(cell),gridCtrl.ResetRowStates(rowIndex);var isNumber=!1,isSetControlValue=!1,isChanged=!1,jc;if(cell&&cell.children[0].tagName=="SPAN"){isSetControlValue=!0;var c=cell.children[0],jc=c.control,oldNeedValidate=jc._isNeedValidate;needValidate==!1&&(jc._isNeedValidate=!1),jc.get_Type()==ControlType.Numberic&&(isNumber=!0),jc.get_Type()==ControlType.Reference&&(key=="-1"||key==-1)&&(value=text=""),grdItem={},grdItem.id=grid,grdItem.rowIndex=rowIndex,grdItem.colIndex=colIndex,jc.get_Type()==ControlType.Reference&&(obj=new ZlayerCallBackItem("DoSetGridCellValueAfterSetControlValue",callBackFunc),window.ZlayerCallBackArray.push(obj)),$SetControlValue(c.id,jc.get_Type()==ControlType.Reference,value,key,text,null,msgType,grdItem),jc._isNeedValidate=oldNeedValidate}else oldCellValue=gridCtrl.GetCellValue(rowIndex,colIndex),oldCellValue!=null&&(oldCellValue=oldCellValue.Value),oldCellValue!=value&&(isChanged=!0),gridCtrl.SetReferenceCellValue(rowIndex,colIndex,key,value,text);if(jc&&jc.get_Type()==ControlType.Reference&&!jc._IsDialogOpenning){for(i=0;i<window.ZlayerCallBackArray.length;i++)if(window.ZlayerCallBackArray[i].key=="DoSetGridCellValueAfterSetControlValue"){window.ZlayerCallBackArray.splice(i,1);break}callBackFunc()}else jc&&jc.get_Type()==ControlType.Reference||callBackFunc();function callBackFunc(){cell?(isNumber&&gridCtrl.m_gridBodyEventsHandler.GridEditHelper.CalculateHelper.columnExpressionCalculater.Calculating(colIndex,cell.parentElement),gridCtrl.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.EndCellEdit(cell,colIndex),!isSetControlValue&&isChanged&&gridCtrl.FireCellChange(key,rowIndex,colIndex)):gridCtrl.EndEdit(),loseFocus||(gridCtrl.m_currentColumnIndex=oldColIndex,gridCtrl.m_currentRowIndex=oldRowIndex)}}},ColumnEditInfo=function(n,t){this.DisplayName=t,this.FieldID=n,this.Control=null,this.Enabled=!0,this.IsInit=!1},GridBatchModifyProcessManager=function(n,t){this._owner=n,this.rowIndexBefore=-1,this.columnIndexBefore=-1,this.rowCount=0,t&&t>0&&(this.rowCount=t),this.processedRow=0,this.isInProcessing=!1,this.sumInfo=[],this.sumInfo.Keys={}},GridBatchModifyProcessManager.prototype={dispose:function(){this.rowIndexBefore=-1,this.columnIndexBefore=-1,this.rowCount=0,this.processedRow=0,this.isInProcessing=!1,this.sumInfo=null,this._owner=null},initialize:function(){if(this.rowIndexBefore=this._owner.m_currentRowIndex,this.columnIndexBefore=this._owner.m_currentColumnIndex,this.rowCount<=0){var n=this._owner.D_Body.rows.length;n>0&&this._owner.GetRowStatus(n-1)==RowStatus.Empty&&n--,this.rowCount=n}this.isInProcessing=!0},resetAfterPost:function(){this.sumInfo=[],this.sumInfo.Keys={}},addSumInfor:function(n,t,i){var u,r;this.sumInfo.Keys[n]||(r={},r.column=n,r.oldValue=0,r.newValue=0,this.sumInfo.push(r),this.sumInfo.Keys[n]=this.sumInfo.length),u=this.sumInfo.Keys[n]-1,r=this.sumInfo[u],r.oldValue+=t*1,r.newValue+=i*1},getProcessPosition:function(){var t=$(this._owner.get_element()),i=t.offset(),n={};return n.left=i.left+t.width()/2-50,n.top=i.top+50,n},setElementPos:function(n,t,i){n.style.left=i+"px",n.style.top=t+"px"},createBaseProcessBar:function(n){var t=document.createElement("span"),i,r;return t.id=n,t.style.cssText="position:absolute;border:1px solid #625e61;padding:1px;width:280px;height:10px;text-align:center;font-weight:bold;color:black;cursor:wait;",i=$(this._owner.get_element()),r=i.offset(),t.style.fontSize="22",t},ShowProcess:function(){var r=document.createElement("div"),i,u,f,t,n;r.id="BatchModifyProcessPanel",r.style.cssText="position:absolute;margin:0px;left:0px;top:0px;opacity：0.1;filter:alpha(opacity=20);cursor:wait;",r.style.width=document.body.offsetWidth-15+"px",r.style.height=document.body.offsetHeight-15+"px",i=this.getProcessPosition(),u=this.createBaseProcessBar("BatchModifyProcessBar"),this.setElementPos(u,i.top,i.left),u.style.textAlign="left",f=document.createElement("span"),f.id="BatchModifyProcessBarProc",f.style.cssText="background-color:#68a100;margin:0px;padding:0px;width:0px;height:100%;filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#76b400',EndColorStr='#3f6d00');",u.appendChild(f),this.processedRow=0,t=this.createBaseProcessBar("BatchModifyProcessBarText"),t.style.backgroundColor="transparent",t.style.border="none",t.style.textAlign="left",t.style.height="30px",t.style.width="50px",this.setElementPos(t,i.top-25,i.left),t.innerText="0/"+this.rowCount,n=this.createBaseProcessBar("BatchModifyProcessBarTip"),n.style.backgroundColor="transparent",n.style.border="none",n.style.textAlign="left",n.style.fontSize="12",n.style.color="#333",n.style.height="25px",n.style.width="200px",this.setElementPos(n,i.top-15,i.left+85),n.innerText=Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_BatchModifyInProcessing,document.body.appendChild(r),document.body.appendChild(u),document.body.appendChild(t),document.body.appendChild(n)},FowardOneUnit:function(){var n,t;this.processedRow++,n=$get("BatchModifyProcessBar"),n&&(t=$get("BatchModifyProcessBarProc"),t.style.width=this.processedRow/this.rowCount*280+"px",$get("BatchModifyProcessBarText").innerText=this.processedRow+"/"+this.rowCount)},OnCompleted:function(){var n,t;if(this.sumInfo.length>0)for(t=0;t<this.sumInfo.length;t++)n=this.sumInfo[t],this._owner.m_gridBodyEventsHandler.GridEditHelper.CalculateHelper.aggregationCalculater.Aggregating(n.column,n.oldValue,n.newValue);this.CloseProcess()},CloseProcess:function(){var r=$get("BatchModifyProcessBarTip"),n,t,i,u;r&&r.parentNode.removeChild(r),n=$get("BatchModifyProcessBarProc"),n&&n.parentNode.removeChild(n),t=$get("BatchModifyProcessBarText"),t&&t.parentNode.removeChild(t),i=$get("BatchModifyProcessBar"),i&&i.parentNode.removeChild(i),u=$get("BatchModifyProcessPanel"),u&&document.body.removeChild(u)}},window.top.GridInfo||(window.top.GridInfo=[]),FullScreenGridHelper=function(){this.cssWrapMaximized="maximized-panel-wrap",this.cssMaximizedPanel="maximized-panel",this.cssBodyMaximized="maximized-model",this.cssZoomBig="y-icon-fullScreen",this.cssZoomSmall="y-icon-exit-fullScreen"},FullScreenGridHelper.prototype={init:function(){$("#out").hasClass("popLayer")||(this.processMaximized(),this.cssMaximized(),this.setReportHeight(),this.OnReportResize())},OnReportResize:function(){var t=this,n=0;$(window).resize(function(){clearTimeout(n),n=setTimeout(function(){t.setReportHeight()},110)})},setReportHeight:function(){var n=$(".report-table").eq(0).attr("id"),i,t;n&&($("#"+n+"_fixedTable").css("height",""),i=$("#"+n).closest("td"),t=i.attr("rowspan")>1?i.height()-26:$("#"+n).closest("tr").height()-26,$("#"+n).height(t),setTimeout(function(){$("#"+n+"_ctl14").height(t-52)},0))},settleMirror:function(){$(".zoomBig").parent().css("position","static");var n=0;clearTimeout(n),n=setTimeout(function(){$(".zoomBig").parent().css("position","")},0)},processMaximized:function(){this.addFullScreenMask(),$("."+this.cssWrapMaximized).closest(".TP").addClass("overflow-x-inherit")},addFullScreenMask:function(){var n="fullScreenMask";$("body").children("#"+n).length==0&&$("body").append('<div id="'+n+'" class="'+n+'"><\/div>'),$(".toolbar").length==0&&$(".uc-toolbar-wrap").length==0&&$("#"+n).css("top","0")},cssMaximized:function(){var t=this.getLink(),n=this.getGridInfo(t);n&&n.isFullScreen&&($("body").addClass(this.cssBodyMaximized),$("#"+n.GridID).closest("."+this.cssWrapMaximized).parent().addClass(this.cssMaximizedPanel))},getLink:function(){return"lnk"+window.location.href.split("lnk")[1].split("nid")[0]+"nid"},cssZoomElement:function(n,t){var i=this.getGridInfo(this.getLink());this.changeCssFullScreenElement(i&&i.isFullScreen&&i.GridID==n,t)},changeCssFullScreenElement:function(n,t){var t=$(t).get(0);t&&(n?(t.className="zoomBig iconfont "+this.cssZoomSmall,t.title="还原",this.settleMirror()):(t.className="zoomBig iconfont "+this.cssZoomBig,t.title="最大化",this.settleMirror()))},getGridInfo:function(n){var t=window.top.GridInfo,i;if(t&&t.length>0)for(i=0;i<t.length;i++){if(t[i].link==n)return t[i];if(i==t.length-1)return!1}else return!1},setGridInfo:function(n,t,i){var r=window.top.GridInfo,u;if(r&&r.length!=0)for(u=0;u<r.length;u++){if(r[u].link==n){r[u].link=n,r[u].isFullScreen=i,r[u].GridID=t;return}u==r.length-1&&this.pushGridInfo(n,t,i)}else this.pushGridInfo(n,t,i)},pushGridInfo:function(n,t,i){!window.top.GridInfo||window.top.GridInfo.push({link:n,isFullScreen:i,GridID:t})},setFullScreenClass:function(n,t,i){$("body").toggleClass(this.cssBodyMaximized),this.changeCssFullScreenElement(i,n),t?$(n).parent("."+this.cssWrapMaximized).parent().toggleClass(this.cssMaximizedPanel):$(n).siblings("."+this.cssWrapMaximized).parent().toggleClass(this.cssMaximizedPanel)},onZoomElementClick:function(n,t,i){var r=$(n).hasClass(this.cssZoomBig);this.setGridInfo(this.getLink(),t,r),this.setFullScreenClass(n,i,r),TdSetHeightHelper.GetInstance($(n).parent().parent()).afreshInit()}},FullScreenGridHelper.GetInstance=function(){return new FullScreenGridHelper},TdSetHeightHelper=function(n,t){this.cssInherit="inherit",this.cssAbsolute="absolute",this.cssAutoHeightRow="autoheight-row",this.autoFlag=".singlezone .autoheight-webpart",this.cssAutoHeightCell=".autoheight-cell:not(:hidden)",this.cssTableCell=".table-col:not(:hidden)",this.cssNavCon="navcon",this.selectTreeBorder=$(".TreeBorder"),this.selectGridNextTable=$(".dataGridMainBody > table"),this.cssTreeBorderParent="TreeBorderParent",this.selectPage=n,this.flagItem="setHeightYet",this.flagItemValue=t},TdSetHeightHelper.Tools={OnResize:function(){var t=this,n=0;$(window).resize(function(){clearTimeout(n),n=setTimeout(function(){TdSetHeightHelper.GetInstance().afreshInit()},90)})}},TdSetHeightHelper.prototype={init:function(){var n,t;$(window.frameElement).parent().css("display")!="none"&&$(window).height()!=0&&(n=navigator.userAgent,n.indexOf("Safari")>-1&&!(n.indexOf("Chrome")>-1)?(this.flagItemValue||(this.flagItemValue="yes"),this.addClassForNavCon(),this.addClassForTreeBorder(),this.uniteTdFlagForSafari(),this.forEachTd()):(this.flagItemValue||(this.flagItemValue="yes"),t=this.addPositon(),this.addClassForNavCon(),this.addClassForTreeBorder(),this.processTdHeight(),this.removePositon(t)))},afreshInit:function(){$(window.frameElement).parent().css("display")!="none"&&$(window).height()!=0&&(this.removeFlag(),this.trNeedBack(),this.init())},processTdHeight:function(){this.uniteTdFlag(),this.forEachTd()},addPositon:function(){var n=$(".dataGridMainBody").length>0?$(".dataGridMainBody").scrollTop():0;return $('[ick="DataGrid"]').addClass("inherit").parent("td").addClass("needSetHeight"),this.selectTreeBorder.addClass(this.cssAbsolute),this.selectGridNextTable.addClass(this.cssAbsolute),$(".treeBorder").addClass(this.cssAbsolute),$(".CDataGrid").addClass(this.cssAbsolute),n},removePositon:function(n){this.selectTreeBorder.removeClass(this.cssAbsolute),this.selectGridNextTable.removeClass(this.cssAbsolute),$(".treeBorder").removeClass(this.cssAbsolute),$(".CDataGrid").removeClass(this.cssAbsolute),$(".dataGridMainBody").length>0&&$(".dataGridMainBody").scrollTop(n),$(".TP .main_Span:not(:hidden)").scrollTop(0)},addClassForNavCon:function(){var n=this.autoFlag+" .autoheight-tPn > .autoheight,.tPn .tPnl,.toppanelCardCon";$(n).addClass(this.cssNavCon)},addClassForTreeBorder:function(){this.selectTreeBorder.parent().addClass(this.cssTreeBorderParent)},forEachTd:function(){for(var t=$(".needSetHeight",this.selectPage),n=0;n<t.length;n++)this.ProcessEachTdHeight(t[n]);t=null},uniteTdFlagForSafari:function(){var n=["."+this.cssTreeBorderParent,"."+this.cssNavCon,$(".Wizard").parent()];this.addClassNeedSetHeight(n),n=null},uniteTdFlag:function(){for(var r=$(this.getAutoheightCell(),this.selectPage),t,i,n=0;n<r.length;n++)t=$(r[n]),t.children("div").length==1&&t.addClass("needSetHeight");i=[this.cssTableCell,".grid-main-row>td:not(:hidden)","."+this.cssTreeBorderParent,"."+this.cssNavCon,"td:not('.thc')[rowspan]"],this.addClassNeedSetHeight(i),i=null,$(".CDataGrid").parent().addClass("needSetHeight")},addClassNeedSetHeight:function(n){for(var t=0;t<n.length;t++)this.selectPage?$(n[t],this.selectPage).addClass("needSetHeight"):$(n[t]).addClass("needSetHeight")},getAutoheightCell:function(){var n;return n=this.selectPage?this.cssAutoHeightCell:this.autoFlag+" "+this.cssAutoHeightCell},ProcessEachTdHeight:function(n){var t=this,i=$(n),r;t.isProcessYetfn(n,t.flagItem,t.flagItemValue)||(i.hasClass(t.cssNavCon)?t.setNavConHeight(i):(r=t.getRowspan(i),!i.is("td")&&r>1?t.rowspanForDivHack(i,r):(t.checkAutoRow(i,r),t.setHeight(i))),t.setFlag(n,t.flagItem,t.flagItemValue))},checkAutoRow:function(n,t){var r,e,o,i,u,f;$(".autoheight-webpart").length!=0&&(r=this,t>1&&(e=n.siblings("td:not(:empty)"),e.length>0&&(o=n.closest("table"),i=o.children().children("."+r.cssAutoHeightRow),i.length>0&&(u=0,i.each(function(n,t){u+=$(t).height()}),f=parseInt(u/i.length),f!=0&&(i.height(f).removeClass(r.cssAutoHeightRow),i.attr("trneedback","yes"))))))},setNavConHeight:function(n){var t=n.hasClass("autoheight");t||n.addClass("autoheight"),this.setHeight(n),n.removeClass("autoheight"),this.addClassInherit(n)},setFlag:function(n,t,i){n.cusAttr&&n.cusAttr(t,i)},removeFlag:function(){var n=this;$(".needSetHeight",this.selectPage).each(function(t,i){i.removeCusAttr("yesTab"),i.removeCusAttr(n.flagItem),$(i).css("height","")})},trNeedBack:function(){$('[trneedback="yes"]',this.selectPage).addClass(this.cssAutoHeightRow).css("height","")},isProcessYetfn:function(n,t,i){var r=!1;return n.cusAttr(t)==i&&(r=!0),r},setHeight:function(n){var t=this.getActualHeight(n);this.setItemHeight(n,t)},setItemHeight:function(n,t){t!=0&&(n.height(t),this.addClassInherit(n))},addClassInherit:function(n){var i=n.children();i.addClass(this.cssInherit)},rowspanForDivHack:function(n,t){var i=this.getRowTotalHeightAsDiv(n,t);this.setItemHeight(n,i)},getRowTotalHeightAsDiv:function(n,t){var r=this,u=n.parent().nextAll().slice(0,t-1),i;return u.height(0),i=0,i+=this.getActualHeight(n),u.each(function(n,t){var u=$(t);u.hasClass(r.cssAutoHeightRow)&&(i+=r.getActualHeight(u))}),i},getActualHeight:function(n){var t=n.height();return t==0?t=this.getHiddenTPHeight(n):t<30&&(t=this.getHiddenTPHeight(n)),t},getHiddenTPHeight:function(n){var t="",i=n.closest(".TP:hidden");return n.closest(".TP:hidden").length>0?(i.addClass("css-box-show"),t=n.height(),i.removeClass("css-box-show")):n.closest(":hidden").length>0&&(t=n.actual("height")),t},getRowspan:function(n){var t=n.attr("rowspan");return t=t?parseInt(t):1}},TdSetHeightHelper.GetInstance=function(n,t){return new TdSetHeightHelper(n,t)},ToggleColWidthForTreeHelper=function(n,t,i,r,u,f,e){this.toggleWidthCardIDCols=$(t+" .glColC:first > col"),this.resizeDataGridID=f,this.btnArrowID=n,this.isTreeShow=e,this.bigWidth=i,this.smallWidth=r,this.cssAutoWidth="autowidth",this.isCardSpread=u,this.hideTreeFlag=!1},ToggleColWidthForTreeHelper.prototype={init:function(){this.def(),this.WidthInit(),this.Events()},def:function(){this.treeCol=this.toggleWidthCardIDCols.eq(0),this.tableWidth=this.treeCol.closest("table").width(),this.isCardSpread||(this.isCardSpread=!1),this.selectBtnDisplayID=$(this.btnArrowID)},Events:function(){var n=this;this.hideTreeFlag=this.isCardSpread?!0:!1,this.selectBtnDisplayID.click(function(){n.btnDisplayOnClick(this)}),this.treeControlDrag()},btnDisplayOnClick:function(){var t=this;return this.hideTreeFlag?(t.shrink(),this.hideTreeFlag=!1):(t.spread(),this.hideTreeFlag=!0),!1},WidthInit:function(){this.isTreeShow===!1?(this.toggleWidthCardIDCols.eq(0).width("0"),this.toggleWidthCardIDCols.eq(1).width("0")):this.isCardSpread?this.spread():this.shrink()},spread:function(){this.toggleColWidth(this.bigWidth),this.selectBtnDisplayID.css("background-image","url(../images/BtnToLeft.gif)"),this.triggerResize()},shrink:function(){this.toggleColWidth(this.smallWidth),this.selectBtnDisplayID.css("background-image","url(../images/BtnToRight.gif)"),this.triggerResize()},toggleColWidth:function(n){var t=16;this.treeCol.width(n),this.toggleWidthCardIDCols.eq(2).width(this.tableWidth-n-t).removeClass("autowidth-col")},triggerResize:function(){var n=$(this.resizeDataGridID).get(0);this.bindFireEvent(n,"resize")},bindFireEvent:function(n,t){try{var i=document.createEvent("MouseEvents");i.initEvent(t,!0,!1),n.dispatchEvent(i)}catch(r){n.fireEvent(t)}},treeControlDrag:function(){var r=this,i=$("[id$='MoveTreeButton']"),t,n;i.length>0&&(i.hide(),t=i.closest("table").closest("td"),$(t).css("cursor"," w-resize"),n=t.get(0),n.onmousedown=function(i){var u=(i||event).clientX,f=$(t).offset().left;return document.onmousemove=function(n){var n=n||window.event,t=f+(n.clientX-u);return t<0&&(t=0),r.toggleColWidth(t),$("#BomMainUI_TreeContro_Width").val(t),!1},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,n.releaseCapture&&n.releaseCapture(),r.triggerResize()},n.setCapture&&n.setCapture(),!1})}},ToggleColWidthForTreeHelper.GetInstance=function(n,t,i,r,u,f,e){return new ToggleColWidthForTreeHelper(n,t,i,r,u,f,e)},popLayerTableSetWidthtHelper=function(){var n=$(".popLayer table:first"),t,i;n.length>0&&(t=n.find("td:eq(0)"),i=n.find("td:eq(1)"),t.width()>1e3&&(t.addClass("autowidth-col"),i.removeClass("autowidth-col")))},$(function(){popLayerTableSetWidthtHelper(),$(document).delegate(".report-table  table[role='presentation'] table tr","click",function(n){n.stopPropagation(),$(this).siblings().removeClass("report-tr-select"),$(this).addClass("report-tr-select")})}),Event.Dbclick="DBClick",Event.Click="Click",RowStatus.Empty="Empty",RowStatus.Added="Added",RowStatus.Modified="Modified",RowStatus.Deleted="Deleted",RowStatus.UnChanged="Unchanged",Col.ID="FieldID",Col.Formula="Formula",Col.ControlType="ControlType",Col.BeforeCellFocusEnable="BeforeCellFocusEnable",Col.Frozen="Frozen",Sort.StringUp="0",Sort.StringDown="1",Sort.IntUp="2",Sort.IntDown="3",DisplayStyle.Browser="Browse",DisplayStyle.Edit="Edit",DefaultSymbol.SelectedRowColor="#feae02",DefaultSymbol.SelectedCellColor="#F8F8F5",DefaultSymbol.BodyCellBackgroundcolor="#F8F8F5",DefaultSymbol.BodyCurrentCellBackgroundcolor="#FFE9A6",DefaultSymbol.borderColor="#E0E0E0",DefaultSymbol.DisabledColor="gray",DefaultSymbol.borderWidth=1,DefaultSymbol.True="true",DefaultSymbol.False="false",DefaultSymbol.cssthc="thc",DefaultSymbol.csstcc="tcc",DefaultSymbol.csstbc="tbc",DefaultSymbol.cssFixedDataRow="FixedDataRow",DefaultSymbol.cssFixedColumnTitleCell="FixedColumnTitleCell",DefaultSymbol.cssFixedColumnDataCell="FixedColumnDataCell",DefaultSymbol.cssFixedColumnSumCell="FixedColumnSumCell",InsertedRowNoType.Floor="0",InsertedRowNoType.LowAverage="1",InsertedRowNoType.HighAverage="2",InsertedRowNoType.Ceil="3",CellDataContent=function(n,t){this.OldValue=n,this.InputValue=t,this.ResultValue="",this.ResultText="",this.Cancel=!1,this.ColField="",this.CurrentRowIndex=0,this.CurrentColumnIndex=0,this.CellEditEnabled=!0,this.CancelAction=!1,this.QueryParameters=[],this.Result=null,this.CancelDefaultAction=!1,this.Flag=null},ClientUserControl=function(){this.ControlType="",this.Control=null,this.refParas=""},SelectRowArg=function(n,t){this.RowIndex=n,this.Selected=t},CellValue=function(n){this.Value=n,this.Code="",this.Text=""},NumberFormat=function(n,t,i,r){this.scale=parseInt(n,10),this.roundType=parseInt(t,10),this.roundValue=parseInt(i,10),this.currencySymbol=r,this.toStr=function(){return this.scale.toString()+","+this.roundType.toString()+","+this.roundValue.toString()+","+this.currencySymbol}},GridFaciesManager=function(n,t,i,r,u,f){this._owner=f,this.layoutContainer=n,this.tableHead=t,this.tableBody=i,this.tableFooter=r,this.toolbar=u,this.lastRowIndex=-1,this.lastColumnIndex=-1,this.lastBackColor=DefaultSymbol.BodyCellBackgroundcolor},GridFaciesManager.prototype={dispose:function(){this._owner=null,this.layoutContainer=null,this.tableHead=null,this.tableBody=null,this.tableFooter=null,this.toolbar=null},SetGridInitFacies:function(n,t){if(this._owner.get_element().cusAttr("Focus")=="true"){try{this._owner.S_Body.focus()}catch(i){}this.SetCurrentCellStyle(n,t)}},Focus:function(){var t,n;if(this.tableBody!=this._owner.UNDEFINED_VALUE)try{if(t=this.GetCurrentCell(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),t!=this._owner.UNDEFINED_VALUE)try{n=t.getElementsByTagName("input"),n&&n.length!=0||(n=t.getElementsByTagName("textarea")),n!=null&&n.length>0?n[0].focus():t.setActive()}catch(i){t.children[0].focus()}}catch(i){}},GetCurrentCell:function(n,t){if(n!=null&&n>=0&&n<this.tableBody.rows.length){var i=this.tableBody.rows[n];if(t<i.cells.length)return i.cells[t]}return null},OnStartGridColumnSort:function(){this.OutCurrentCellStyle()},OnEndGridColumnSort:function(){this.SetCurrentCellStyle(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex)},OnHeadCellClicked:function(){},OnHeadCellDBClicked:function(){},OnBodyCellClicked:function(n,t){if(this.SetCurrentCellStyle(n,t),n>=0&&n<this._owner.m_rows){var i=this.tableBody.rows[n];this._owner.IsEmptyRow(i)||(this._owner.OnCellClick(n,t),this._owner.OnRowClicked()),!this._owner.m_gridBodyEventsHandler.GridEditHelper||this._owner.m_isRelaySwitchTag&&this._owner.IsNeedSwitchTabPage(t,n)||this._owner.m_gridBodyEventsHandler.GridEditHelper.StartEdit()}},OnBodyCellDBClicked:function(n,t){if(n>=0&&n<this._owner.m_rows){var i=this.tableBody.rows[n];this._owner.IsEmptyRow(i)||(this._owner.OnCellDBClick(n,t),this._owner.IsNeedSwitchTabPage(this._owner.m_currentColumnIndex)&&this._owner.ImitateSwitchTabPage())}},OnBodyRowHeadClicked:function(n,t){var i=t.firstChild,r;i!=null&&(this.SetSelectedRow(n),i.type=="checkbox"?(event&&event.srcElement&&event.srcElement.tagName=="INPUT"&&event.srcElement.type=="checkbox"&&!event.srcElement.cusAttr("alreadySelected")?this._owner.OnBodyRowSelected(n,i.checked,!i.checked):(event&&event.srcElement&&event.srcElement.cusAttr("alreadySelected")&&event.srcElement.cusAttr("alreadySelected",null),r=this.IsMultiSelect(),this._owner.OnBodyRowSelected(n,i.checked,r?!i.checked:i.checked)),this._owner.OnBodyRowSelectedClick(n,i.checked),this._owner.OnRowClicked()):(this._owner.OnBodyRowSelected(n,!0,!1),this._owner.OnBodyRowSelectedClick(n,!0),this._owner.OnRowClicked(),this.OnBodyCellClicked(n,0),this.SetSelectedRow(n))),this._owner.m_currentRowIndex!=n&&this._owner.OnRowChanged()},SetSelectedRow:function(n){this.lastRowIndex>-1&&this.lastColumnIndex>-1&&this.SetSelectCellBorder(this.lastRowIndex,this.lastColumnIndex,!1),this._owner.m_lastSelectedRow>-1&&this._owner.m_lastSelectedRow!=n&&(this._owner.SetRowBackgroundColor(this._owner.m_lastSelectedRow,""),this._owner.SetRowBackgroundColor(n,DefaultSymbol.SelectedRowColor,!0)),this._owner.m_lastSelectedRow=n},SelectRow:function(n,t){var i=this._owner.IsRowSelected(n);n>=0&&n<this.tableBody.rows.length&&this.SelectRowOfTableBody(n,t,this.tableBody.rows[n])&&(this._owner.OnBodyRowSelected(n,t,i),this._owner.SetHeadCheckBoxState(t))},GetCellValue:function(n,t){var i=null,r;return n>=0&&n<this._owner.m_rows&&t>0&&t<this._owner.m_columns&&(r=this.tableBody.rows[n].cells[t],i=new CellValue(r.cusAttr("Value")),i.Text=r.innerText,i.Text==""&&(i.Text=this.GetRefNameAttribute(r.cusAttr("R"))),r.cusAttr("R")!=this._owner.UNDEFINED_VALUE&&(i.Code=this.GetRefCodeAttribute(r.cusAttr("R"))),i.Value==""&&i.Text==" "&&(i.Text=""),(i.Text==" "||i.Text==" ")&&(i.Text=""),this._owner.MainCols[t].cusAttr("ControlType")=="REF"&&(i.Value==""||i.Value==null)&&(i.Value=-1)),i},GetRefCodeAttribute:function(n){if(n==this._owner.UNDEFINED_VALUE||n.length==0)return"";var t=n.split(this._owner.RefSplitter2);return t.length==2?t[0]:""},GetRefNameAttribute:function(n){if(n==this._owner.UNDEFINED_VALUE||n.length==0)return"";var t=n.split(this._owner.RefSplitter2);return t.length==2?t[1]:""},SetCellValue:function(n,t,i){var r,f,e,u,o,s;if(n>=0&&n<this._owner.m_rows&&t>0&&t<this._owner.m_columns){r=this.tableBody.rows[n].cells[t],f=r.cusAttr("Value"),typeof i=="boolean"&&(i=i.toString()),r.cusAttr("Value",i),e=this._owner.MainCols[t].cusAttr("ControlType"),u=this._owner.MainCols[t].cusAttr("ReplaceColumn"),u&&u.length>0&&this._owner.GetColumnIndex(u)>-1&&(o=this._owner.GetColumnIndex(u),o>-1&&(e=this._owner.MainCols[o].cusAttr("ControlType"),t=o));switch(e){case ControlType.CheckBox:r.cusAttr("Value",i.toLowerCase()),this._owner.setCellListValue(r,this._owner.GetCheckBoxTextByValue(i.toLowerCase(),this._owner.MainCols[t].cusAttr("CheckBoxValueRef")),ControlType.CheckBox);break;case ControlType.Combox:this._owner.setCellListValue(r,this._owner.GetComboxTextbyID(t,i),ControlType.Combox);break;case ControlType.MultiInput:this.SetMultiLangAttribute(r,i),this._owner.setCellListValue(r,i,ControlType.MultiInput);break;case ControlType.Numberic:r.cusAttr("Value",this._owner.m_formatHelper.FormatCellNumber(t,n,i,f).Value),this._owner.m_gridBodyEventsHandler.GridEditHelper&&this._owner.m_gridBodyEventsHandler.GridEditHelper.CalculateHelper&&(n==this._owner.m_currentRowIndex?this._owner.m_gridBodyEventsHandler.GridEditHelper.CalculateHelper.columnExpressionCalculater.SetColumnValue(this.tableBody.rows[n],t,r.cusAttr("Value")):this._owner.m_gridBodyEventsHandler.GridEditHelper.CalculateHelper.columnExpressionCalculater.SetColumnValue(this.tableBody.rows[n],t,r.cusAttr("Value"),n)),this._owner.m_SumSelectedData&&!this._owner.IsRowSelected(n)||this._owner.m_gridBodyEventsHandler.GridEditHelper.CalculateHelper.aggregationCalculater.Aggregating(r.cellIndex,parseFloat(f),parseFloat(r.cusAttr("Value")));break;case ControlType.Date:case ControlType.DateTime:this._owner.setCellListValue(r,this._owner.GetDateFormatedValue(i,t),e);break;default:this._owner.setCellListValue(r,this._owner.GetFormatedValue(i,this._owner.MainCols[t].cusAttr("DataType"),this._owner.MainCols[t].cusAttr("DisplayFormat")))}i!=f&&(s=new CellDataContent("",i),this._owner.OnCellDataValueChanged(s,n,t))}},SetMultiLangAttribute:function(n,t){n.cusAttr("MultiLang",this._owner.GetMultiinputData(t,n.cellIndex))},SetRowChangeStates:function(n){n.cusAttr("Status")==RowStatus.UnChanged?n.cusAttr("Status",RowStatus.Modified):n.cusAttr("Status")==RowStatus.Empty&&(n.cusAttr("Status",RowStatus.Added),this._owner.set_TotalRows(this._owner.m_TotalRows+1))},ChangeRowState:function(n,t){if(n>=0&&n<this._owner.m_rows){t=t.substring(0,3);var i=this.tableBody.rows[n],r=i.cusAttr("Status");switch(t){case"Mod":i.cusAttr("Status",RowStatus.Modified);break;case"Add":r==RowStatus.Empty&&this._owner.set_TotalRows(this._owner.m_TotalRows+1),i.cusAttr("Status",RowStatus.Added);break;case"Unc":i.cusAttr("Status",RowStatus.UnChanged);break;case"Emp":r!=RowStatus.Empty&&this._owner.set_TotalRows(this._owner.m_TotalRows-1),i.cusAttr("Status",RowStatus.Empty)}}},GetRowState:function(n){if(n>=0&&n<this._owner.m_rows){var t=this.tableBody.rows[n];if(t)return t.cusAttr("Status")}return""},SetReferenceCellValue:function(n,t,i,r,u,f){var o;if(n>=0&&n<this._owner.m_rows&&t>0&&t<this._owner.m_columns){var h=this.tableBody.rows[n],e=h.cells[t],s=e.cusAttr("Value");e.cusAttr("Value",i);switch(this._owner.MainCols[t].cusAttr("ControlType")){case ControlType.CheckBox:e.cusAttr("Value",i.toString().toLowerCase()),this._owner.setCellListValue(e,this._owner.GetCheckBoxTextByValue(i.toString().toLowerCase(),this._owner.MainCols[t].cusAttr("CheckBoxValueRef")),ControlType.CheckBox);break;case ControlType.Combox:this._owner.setCellListValue(e,this._owner.GetComboxTextbyID(t,i),ControlType.Combox);break;case ControlType.MultiInput:this.SetMultiLangAttribute(e,i),this._owner.setCellListValue(e,i,ControlType.MultiInput);break;case ControlType.Numberic:o=this._owner.m_formatHelper.FormatCellNumber(t,n,i,s),e.cusAttr("Value",o.Value),this._owner.setCellListValue(e,o.Text,ControlType.Numberic),this._owner.m_SumSelectedData&&!this._owner.IsRowSelected(n)||this._owner.m_gridBodyEventsHandler.GridEditHelper.CalculateHelper.aggregationCalculater.Aggregating(e.cellIndex,parseFloat(s),parseFloat(e.cusAttr("Value")));break;case ControlType.RefControl:e.cusAttr("R",r+this._owner.RefSplitter2+u),e.title=r,this._owner.setCellListValue(e,u,ControlType.RefControl,r,f);break;case ControlType.Date:this._owner.setCellListValue(e,this._owner.GetDateFormatedValue(i,t),ControlType.Date);break;default:this._owner.setCellListValue(e,this._owner.GetFormatedValue(i,this._owner.MainCols[t].cusAttr("DataType"),this._owner.MainCols[t].cusAttr("DisplayFormat")),this._owner.MainCols[t].cusAttr("ControlType"))}}},SelectRowOfTableBody:function(n,t,i){var r=!1,f=i.cells[0],u=f.firstChild;return u.type=="checkbox"&&(typeof t=="string"&&(t=ToBoolean(t)),u.checked=t,r=!0),r},SelectAllRow:function(n){for(var i=this.tableBody.rows,r,t=0;t<i.length;t++)r=this._owner.IsRowSelected(t),this.SelectRowOfTableBody(t,n,i[t])&&this._owner.OnBodyRowSelected(t,n,r);this._owner.OnRowClicked()},InitSelectedRow:function(n){var i;if(n!=""){var t=0,u=this.tableBody.rows.length,r=n.split(",");for(i=0;i<r.length;i++){if(t=parseInt(r[i],10),t>=u)break;t>=0&&this.SelectRowOfTableBody(t,!0,this.tableBody.rows[t])}}},OnBodyRowHeadDBClicked:function(){},OnLayoutScroll:function(){},OnLayoutScrollStart:function(){},OnLayoutScrollStop:function(){},OutCurrentCellStyle:function(){this._owner.m_lastSelectedRow>-1&&this.SetRowBackgroundColor(this._owner.m_lastSelectedRow,""),this.lastRowIndex>-1&&this.lastColumnIndex>-1&&this.SetSelectCellBorder(this.lastRowIndex,this.lastColumnIndex,!1),this.lastRowIndex=-1,this.lastColumnIndex=-1,this._owner.m_lastSelectedRow=-1},SetCurrentCellStyle:function(n,t,i){this._owner.m_lastSelectedRow>-1&&this._owner.m_lastSelectedRow!=n&&this.SetRowBackgroundColor(this._owner.m_lastSelectedRow,""),this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser?(this._owner.m_lastRowBackColor=this.GetRowBackgroundColor(n),this._owner.m_lastSelectedRow!=n&&this.SetRowBackgroundColor(n,DefaultSymbol.SelectedRowColor,!0),this._owner.m_lastSelectedRow=n,i||this.ShowCellByScrollLayout(n,t)):(this._owner.m_lastRowBackColor=this.GetRowBackgroundColor(n),this._owner.m_lastSelectedRow!=n&&this.SetRowBackgroundColor(n,DefaultSymbol.SelectedRowColor,!0),this._owner.m_lastSelectedRow=n,this.lastRowIndex>-1&&this.lastColumnIndex>-1&&this.SetSelectCellBorder(this.lastRowIndex,this.lastColumnIndex,!1),t<this._owner.m_columns&&t>=0&&n<this._owner.m_rows&&n>=0&&(this.lastBackColor=this.GetCellBackgroundColor(n,t,"body"),this.SetSelectCellBorder(n,t,!0),i||this.ShowCellByScrollLayout(n,t),this.lastRowIndex=n,this.lastColumnIndex=t))},IsMultiSelect:function(){var n=!1,t=this.tableBody.rows[this._owner.m_currentRowIndex].cells[0].firstChild;return t!=this._owner.UNDEFINED_VALUE&&t.nodeName=="INPUT"&&(n=!0),n},SetSelectCellBorder:function(n,t,i){var u,r,f;this.tableBody!=null&&n>=0&&n<this.tableBody.rows.length&&(u=this.tableBody.rows[n].cells,t>0&&t<u.length&&(r=u[t],i?(r.oldStyle==null&&(r.oldStyle={}),r.oldStyle.borderStyle=$E(r).getCurrentStyle().borderStyle,r.oldStyle.borderColor=$E(r).getCurrentStyle().borderColor,r.oldStyle.borderWidth=$E(r).getCurrentStyle().borderWidth,r.style.borderStyle="solid",r.style.borderColor="#000000",r.style.borderWidth="1px",this._owner.m_InCellEditing=!0,this.IsMultiSelect()||(f=document.createElement("NOBR"),f.innerText=">",u[0].children[0]||u[0].appendChild(f))):(r.oldStyle!=null?(r.style.borderStyle=r.oldStyle.borderStyle,r.style.borderColor=r.oldStyle.borderColor,r.style.borderWidth=r.oldStyle.borderWidth,r.oldStyle=null):(r.style.borderColor="#FFFFFF #C1C8D2 lightgrey #FFFFFF",r.style.borderWidth="0px,1px,0px,1px"),r.bgColor!=null&&r.bgColor.length>0?r.style.backgroundColor=r.bgColor:this.IsMultiSelect()||u[0].children[0]&&u[0].removeChild(u[0].children[0]))))},OutSelectCellBorder:function(n,t,i){var u,r;this.tableBody!=null&&n>=0&&n<this.tableBody.rows.length&&(u=this.tableBody.rows[n].cells,t>0&&t<u.length&&(r=u[t],r.focus(),i?(r.style.borderStyle="solid",r.style.borderColor="#000000",r.style.borderWidth="2px",this._owner.m_InCellEditing=!0):(r.style.borderStyle="solid",r.style.borderColor="#000000",r.style.borderWidth="2px",this._owner.m_InCellEditing=!1)))},GetFixColumnRightPixcel:function(n){var i,r,u;if(this._owner._FixColumnRightPixcel||parseInt(this._owner._FixColumnRightPixcel)==0)return this._owner._FixColumnRightPixcel;if((i=this.tableBody.rows[n],this._owner._TccColumnWidth=i.cells[0].offsetWidth,!i||!i.cells||!i.cells.length)||(r=0,i.cells[0].className.indexOf(DefaultSymbol.cssFixedColumnDataCell)<0))return this._owner._FixColumnRightPixcel=0,0;for(r=this._owner._TccColumnWidth,u=1;u<i.cells.length;u++)i.cells[u].className.indexOf(DefaultSymbol.cssFixedColumnDataCell)>=0&&(r+=parseInt(i.cells[u].offsetWidth,10));return this._owner._FixColumnRightPixcel=r,r},ShowCellByScrollLayout:function(n,t){var u=this.layoutContainer.offsetWidth<this.layoutContainer.scrollWidth,f=this.layoutContainer.offsetHeight<this.layoutContainer.scrollHeight;if((u||f)&&t>=0&&t<this._owner.m_columns&&n>=0&&n<this._owner.m_rows){var e=this._owner.D_Head.offsetHeight,i=this.tableBody.rows[n].cells[t],o=i.className.indexOf(DefaultSymbol.cssFixedColumnDataCell)>=0,r=0;o||(r=this.GetFixColumnRightPixcel(n,t));var s=i.offsetLeft,h=i.offsetLeft+i.offsetWidth,c=i.offsetTop,l=i.offsetTop+i.offsetHeight,a=this.layoutContainer.scrollLeft+r,v=this.layoutContainer.scrollLeft+this.layoutContainer.clientWidth,y=this.layoutContainer.scrollTop+e,p=this.layoutContainer.scrollTop+this.layoutContainer.clientHeight;window.event&&(window.event.keyCode==KeyCode.up||window.event.keyCode==KeyCode.down||window.event.keyCode==KeyCode.left||window.event.keyCode==KeyCode.right)&&($Event(window.event).stopPropagation(),$Event(window.event).preventDefault())}},IsCellInHorizonViewArea:function(n,t){var u=this.layoutContainer.offsetWidth<this.layoutContainer.scrollWidth,f=this.layoutContainer.offsetHeight<this.layoutContainer.scrollHeight;if(!u&&!f)return!0;if(t>=0&&t<this._owner.m_columns&&n>=0&&n<this._owner.m_rows){var e=this._owner.D_Head.offsetHeight,i=this.tableBody.rows[n].cells[t],o=i.className.indexOf(DefaultSymbol.cssFixedColumnDataCell)>=0,r=0;o||(r=this.GetFixColumnRightPixcel(n,t));var s=i.offsetLeft,h=i.offsetLeft+i.offsetWidth,c=i.offsetTop,l=i.offsetTop+i.offsetHeight,a=this.layoutContainer.scrollLeft+r,v=this.layoutContainer.scrollLeft+this.layoutContainer.clientWidth,y=this.layoutContainer.scrollTop+e,p=this.layoutContainer.scrollTop+this.layoutContainer.clientHeight;return s<a||h>v||c<y||l>p?!1:!0}return!1},GetRowBackgroundColor:function(n){if(n>=0&&n<this._owner.m_rows){var t=this.tableBody.rows[n];return $(t).css("backgroundColor")}return""},SetRowBackgroundColor:function(n,t){if(n>=0&&n<this._owner.m_rows){var r=this.tableBody.rows[n];t==""||t==" "?$(r).removeClass("onSelectedRow"):$(r).addClass("onSelectedRow")}},GetRowFrontColor:function(n){if(n>=0&&n<this._owner.m_rows){var t=this.tableBody.rows[n];return t.style.color}return""},SetRowFrontColor:function(n,t){if(n>=0&&n<this._owner.m_rows){var i=this.tableBody.rows[n];i.style.color=t}},GetRowBackgroundColor:function(n){var t="",i;return n>=0&&n<this._owner.m_rows&&(i=this.tableBody.rows[n],t=i.style.backgroundColor),t},GetCellBackgroundColor:function(n,t,i){return i=="head"?this.GetCellBackgroundColorOfRegion(n,t,this.tableHead):i=="foot"?this.GetCellBackgroundColorOfRegion(n,t,this.tableFooter):this.GetCellBackgroundColorOfRegion(n,t,this.tableBody)},GetCellBackgroundColorOfRegion:function(n,t,i){var u="",r;return i!=this._owner.UNDEFINED_VALUE&&n>=0&&n<i.rows.length&&(r=i.rows[n],t>=0&&t<r.cells.length&&(u=r.cells[t].style.backgroundColor)),u},SetCellBackgroundColor:function(n,t,i,r){r=="head"?this.SetCellBackgroundColorofRegion(n,t,i,this.tableHead):r=="foot"?this.SetCellBackgroundColorofRegion(n,t,i,this.tableFooter):this.SetCellBackgroundColorofRegion(n,t,i,this.tableBody)},SetCellBackgroundColorofRegion:function(n,t,i,r){r!=this._owner.UNDEFINED_VALUE&&n>=0&&n<r.rows.length&&t>=0&&t<this._owner.m_columns&&(r.rows[n].cells[t].style.backgroundColor=i,r.rows[n].cells[t].bgColor=i)},GetCellFrontColor:function(n,t,i){return i=="head"?this.GetCellFrontColorofRegion(n,t,this.tableHead):i=="foot"?this.GetCellFrontColorofRegion(n,t,this.tableFooter):this.GetCellFrontColorofRegion(n,t,this.tableBody)},SetCellFrontColor:function(n,t,i,r){return r=="head"?this.SetCellFrontColorofRegion(n,t,i,this.tableHead):r=="foot"?this.SetCellFrontColorofRegion(n,t,i,this.tableFooter):this.SetCellFrontColorofRegion(n,t,i,this.tableBody)},SetCellFrontColorofRegion:function(n,t,i,r){r!=this._owner.UNDEFINED_VALUE&&n>=0&&n<r.rows.length&&t>=0&&t<this._owner.m_columns&&(r.rows[n].cells[t].style.color=i)},GetCellFrontOfRegion:function(n,t,i){var u="",r;return i!=this._owner.UNDEFINED_VALUE&&n>=0&&n<i.rows.length&&(r=i.rows[n],t>=0&&t<r.cells.length&&(u=r.cells[t].style.color)),u},SetOddEvenTrStyle:function(){var n={evenRowClass:"AlternatingRow"};_this=$("#"+this._owner.get_id()+"_MainBody"),_this.find("tbody tr").removeClass(n.evenRowClass),_this.find("tbody tr:odd").addClass(n.evenRowClass),_this.find("tbody tr td").removeClass(n.evenRowClass).removeClass("tcc"),_this.find("tbody tr."+n.evenRowClass).each(function(){$(this).children("td:first").addClass(n.evenRowClass)}),_this.find("tbody tr[class='']").each(function(){$(this).children("td:first").addClass("tcc")})},SetTableAutoSizeByColumns:function(){for(var u=this._owner.get_id()+"_MainBody",i=0,t,r,n=0;n<this._owner.MainCols.length;n++)t=this._owner.MainCols[n],$(t).css("display")!="none"&&(i+=parseInt($(t).css("width"),10));r=$("#"+u).children("table"),r.attr("width",i+"px")},getIehackWidth:function(){var n=0;return(!!window.ActiveXObject||"ActiveXObject"in window)&&(n=2),n}},GridFaciesManager.GetInstance=function(n,t,i,r,u,f){return new GridFaciesManager(n,t,i,r,u,f)},HeadGeneralBehaviorManager=function(n,t,i){this._owner=i,this.Body=n,this.Head=t,this.TableSortManager,this.HeadEventsManager},HeadGeneralBehaviorManager.prototype={dispose:function(){this.TableSortManager&&(this.TableSortManager.dispose(),this.TableSortManager=null),this.HeadEventsManager&&(this.HeadEventsManager.dispose(),this.HeadEventsManager=null),this._owner=null,this.Body=null,this.Head=null},Init:function(){this.HeadEventsManager=new HeadEventsManager(this.Head,this.Body,this._owner),this.HeadEventsManager.Init(),this._owner.get_element().cusAttr("AllowSort")==DefaultSymbol.True&&(this.TableSortManager=new TableSortManager(this.Head,this.Body,this._owner),this.TableSortManager.Init())}},HeadGeneralBehaviorManager.GetInstance=function(n,t,i){return i.m_behaviorManager==i.UNDEFINED_VALUE&&(i.m_behaviorManager=new HeadGeneralBehaviorManager(n,t,i)),i.m_behaviorManager},CellItem=function(n,t){this.Text=n,this.Parent=t},_SortObject=null,TableSortManager=function(n,t,i){this._owner=i,this.EventAfterSort=AfterSort,this.EventBeforeSort=BeforeResort,this.TableHead=n,this.TableBody=t,this.SortDiv,_SortObject=this,this._downX=0},TableSortManager.curInstance=null,TableSortManager.prototype={dispose:function(){this._owner=null,this.EventAfterSort=null,this.EventBeforeSort=null,this.TableHead=null,this.TableBody=null,this.SortDiv=null,_SortObject=null},StartSort:function(){this._owner.m_gridBodyEventsHandler!=null&&this._owner.m_gridBodyEventsHandler.OnStartGridColumnSort()},EndSort:function(){this._owner.m_gridBodyEventsHandler!=null&&this._owner.m_gridBodyEventsHandler.OnEndGridColumnSort()},Init:function(){var n,i,t;for(TableSortManager.curInstance=this,_SortObject=this,this.AttachEvents(),n=0;n<this._owner.MainCols.length;n++)this._owner.MainCols[n].cusAttr("Sorted")!=this.UNDEFINED_VALUE&&(i=this.GetSortStyle(n),t=this.getColumnHeadCell(n,this._owner.MainCols[n].cusAttr("FieldID")),t&&this.SetSortImage(i,t))},getColumnHeadCell:function(n,t){var u=this.TableHead.children.length-1,i,r;if(this.TableHead.children[u].cells[n]&&this.TableHead.children[u].cells[n].cusAttr("FieldID")==t)return this.TableHead.children[u].cells[n];for(i=u;i>=0;i--)for(r=0;r<this.TableHead.children[i].cells.length;r++)if(this.TableHead.children[i].cells[r].cusAttr("FieldID")==t)return this.TableHead.children[i].cells[r];return null},AttachEvents:function(){this.TableHead!=this.UNDEFINED_VALUE&&($(this.TableHead).bind("click",this.OnHeadClicked),$(this.TableHead).bind("contextmenu",this.OnHeadClicked),$(this.TableHead).bind("mousedown",this.onMouseDown))},onMouseDown:function(){this._downX=parseInt(window.event.x,10)},OnHeadClicked:function(){var e=null,s,n,t,i,o,r,f,u;if(event&&event.srcElement.tagName=="TD"&&event.srcElement.cusAttr("cmSort")!=undefined&&event.srcElement.cusAttr("cmSort")!=null)e=event.srcElement.cusAttr("cmSort"),event.srcElement.removeCustomAttribute("cmSort");else if(s=parseInt(window.event.x,10),Math.abs(s-this._downX)>1)return;for(n=null,t=null,i=event.srcElement,o=0;o<5;o++){if(i.tagName=="TD")break;i=i.parentElement}if(i.tagName=="TD")t=i,n=i.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.control;else return;if(n&&!n.get_element().cusAttr("disabled")&&(!(n.m_TotalRows<2)||!(n.m_rows<2))&&(!i.cusAttr("FieldID")||i.cusAttr("FieldID").indexOf("_DescFlexField_")!=0)&&n.IsColumnAllowSort(i.cusAttr("FieldID"))){if(n.get_element().cusAttr("PagingStrategy")&&n.get_element().cusAttr("PagingStrategy")=="DB"&&(n.Grid_IsDirtyData||n.ViewDirty)){showStatus(Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_GridCantSort);return}if(event&&event.type=="contextmenu"){$find(n.get_id()+"_SortMenu")&&($find(n.get_id()+"_SortMenu").attachDisplayControl=t,$find(n.get_id()+"_SortMenu").DropDown()),$Event(event).stopPropagation(),$Event(event).preventDefault();return}if(n.m_tableDimentionManager&&n.m_tableDimentionManager.ColWidthChanged)n.m_tableDimentionManager.ColWidthChanged=!1,$Event(event).stopPropagation();else{if(n.m_eventProcessLock)return;if(n.get_element().cusAttr("PagingStrategy")&&n.get_element().cusAttr("PagingStrategy")=="DB"&&(n.Grid_IsDirtyData||n.ViewDirty)){showStatus(Sys.CultureInfo[getCultureName().toLowerCase()].Resources.JSMsg_GridCantSort);return}if(n.m_gridBodyEventsHandler&&n.m_gridBodyEventsHandler.CanEndEdit(!1)){if(n.m_eventProcessLock=!0,r=n.m_behaviorManager.TableSortManager,t.offsetWidth-event.offsetX<=6){n.m_eventProcessLock=!1;return}r.StartSort();try{var h=n.GetColumnIndex(t.cusAttr("FieldID")),c=t.cellIndex,l=$(t.parentElement).index();if(h>0&&(l==r.TableHead.children.length-1||t.colSpan==1)){if(f=r.GetSortStyle(c),f||(f=""),u=null,u=e!=null?e:r.GetNextSortStyle(c),f==u)return;n.AddSortColumnToList(t.cusAttr("FieldID"),u,f),n.OnSort(h,u,t.cusAttr("FieldID"))}}catch(a){}r.EndSort(),n.m_eventProcessLock=!1}}}},GetSortStyle:function(n){var t=this._owner.MainCols[n];return t?t.cusAttr("Sorted"):""},GetNextSortStyle:function(n){var t=this._owner.MainCols[n];return t?(t.cusAttr("Sorted")==null||t.cusAttr("Sorted")==""?t.cusAttr("Sorted","UP"):t.cusAttr("Sorted")=="UP"?t.cusAttr("Sorted","DOWN"):t.cusAttr("Sorted",""),t.cusAttr("Sorted")):null},SetSortImage:function(n,t){t!=null&&t.sortDiv==null&&(t.sortDiv=document.createElement("span")),n=="UP"?t.sortDiv.className=this._owner.SortUPPattem:n=="DOWN"&&(t.sortDiv.className=this._owner.SortDownPattem),t.appendChild(t.sortDiv)},SortTableRows:function(n,t){var r=[],u=null,f,i;if(this.TableBody!=this._owner.UNDEFINED_VALUE){for(f=this.TableBody.rows.length,i=0;i<f;i++)u=this.TableBody.rows[i].cells[n],r.push(new CellItem(u.cusAttr("Value"),u.parentElement));for(r.sort(CompareAtomy(t)),i=r.length-1;i>=0;i--)this.TableBody.removeChild(r[i].Parent);for(i=0;i<r.length;i++)this.TableBody.appendChild(r[i].Parent)}}},HeadEventsManager=function(n,t,i){var r=this;this._owner=i,this.TableHead=n,this.tableBody=t,HeadEventsManager.Owner=i,this.OnKeyDownClick=function(n){this._owner.MainCols[n].cusAttr("HasEvent")!=r.UNDEFINED_VALUE&&r.FireDrowthroughEvent(r._owner.MainCols[n].cusAttr("FieldID"))},this.FireDrowthroughEvent=function(columnName){var colControlID=r._owner.MainCols[r._owner.GetColumnIndex(columnName)].cusAttr("ColEditCtrlClientID4P"),jsC,domC,jsLC,domLabel,formReference,result,callback;if(colControlID){if(this._owner.GetColumnIndex(columnName)!=this._owner.m_currentColumnIndex&&(this._owner.m_currentColumnIndex=this._owner.GetColumnIndex(columnName),this._owner.m_gridFaciesManager.SetCurrentCellStyle(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),this._owner.Focus()),this._owner.IsNeedSwitchTabPage(this._owner.m_currentColumnIndex)){this._owner.ImitateSwitchTabPage(),_ClientJSExecQueueManager.Push("$find('"+this._owner.get_id()+"').m_behaviorManager.HeadEventsManager.FireDrowthroughEvent(\""+columnName+'");');return}jsC=$find(colControlID),jsC&&(domC=jsC.get_element(),domC.cusAttr("LC")&&(jsLC=$find(domC.cusAttr("LC")),jsLC?jsLC.get_element().getAttribute("onclick")?jsLC.get_element().fireEvent("onclick"):jsLC.onMouseUp():(domLabel=$get(domC.cusAttr("LC")),domLabel.onclick&&domLabel.fireEvent("onclick"))));return}if(r._owner.m_gridBodyEventsHandler.CanEndEdit(!1)){if(_ClientPostBackManager.Runing==!0||Get_Global_WillDoPostBack()==!0||_ClientCallBackManager.Runing==!0){_ClientJSExecQueueManager.Push("$find('"+this._owner.get_id()+"').m_behaviorManager.HeadEventsManager.FireDrowthroughEvent(\""+columnName+'");');return}if(r.GetFormRef(r._owner.GetColumnIndex(columnName))=="")r._owner.eventNode=r._owner.dataDom.createElement("Event"),r._owner.eventNode.setAttribute("Style","GridHeadClick"),r._owner.eventNode.setAttribute("FieldID",columnName),eval(r._owner.get_element().cusAttr("onfireevents"));else{if(this._owner.GetColumnIndex(columnName)!=this._owner.m_currentColumnIndex&&(this._owner.m_currentColumnIndex=this._owner.GetColumnIndex(columnName),this._owner.m_gridFaciesManager.SetCurrentCellStyle(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),this._owner.StartEdit()),formReference=r.GetFormReference(r._owner.m_currentFormRef,columnName),result=r._owner.OnBeforeOpenDialog(r.BeforeContext(formReference,columnName)),result)return;formReference=r.GetFormReference(r._owner.m_currentFormRef,columnName),callback=r._owner.MainCols[this._owner.GetColumnIndex(columnName)].cusAttr("RefCallbackMethod"),callback!=null&&callback!=""&&(formReference.formUrl+="&"+encodeURI(callback)),r.ShowDialog(formReference,columnName)}}},this.TranslateInfor=function(n){var i=new ReferenceData,t,e,f,o;if(n==null||n=="")return i;var l=Encoder.htmlDecode(n),a=Basic._loadXML(l),s=a.getElementsByTagName("ReferenceReturn");for(t=0;t<s.length;t++){var h=[],c=s[t],u=c.getAttribute("IsSelected");for(u&&u=="Y"&&(r._selectIndex=t),e=c.getElementsByTagName("ReturnField"),f=0;f<e.length;f++)o=e[f],h[o.getAttribute("name")]=o.getAttribute("value");i.Rows[t]=h,u&&u=="Y"&&(i.Rows[t].Selected=!0)}return i},this.ShowDialog=function(n,t){var i,u,r,f;if(n!=null){if(n.GetParameterValues(),i="",event&&event.srcElement.innerText&&event.srcElement.children&&(i=event.srcElement.innerText,event.srcElement.children.length>0&&event.srcElement.children[0].tagName=="TABLE"&&(i=i.replace(/\*$/g,""))),t!=null){for(u=this._owner.D_Head.children.length-1,r=1;r<this._owner.D_Head.children[u].cells.length;r++)if(this._owner.D_Head.children[u].cells[r].cusAttr("FieldID")==t){i=this._owner.D_Head.children[u].cells[r].innerText;break}i=i.replace(/\*$/g,"")}n.Caption()!=""&&(i=n.Caption()),f=ShowModalDialogForAll(n.Url(t),i,n.height,n.width,n.hideStatusBar,!1,this,n)}},this.showDialogCallback=function(n,t){var r=this.TranslateInfor(n),u,f,i;this._owner.OnAfterOpenDialog(this.AfterContext(r))||(this._owner.m_gridFaciesManager!=null&&this._owner.m_gridBodyEventsHandler.CanEndEdit(!1),u=!0,this._owner.m_gridBodyEventsHandler.GridEditHelper&&(f=this._owner.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),u=this._owner.m_gridBodyEventsHandler.GridEditHelper.CellEditHelper.CellEditEnabled(this._owner.m_currentColumnIndex,f)),this._owner.MainCols[this._owner.m_currentColumnIndex]!=null&&this._owner.MainCols[this._owner.m_currentColumnIndex].cusAttr("Edit")!="false"&&u&&r.Rows.length>0&&(i=this._owner.D_Body.rows[this._owner.m_currentRowIndex],i&&(i.cusAttr("Status")==RowStatus.Empty?i.cusAttr("Status",RowStatus.Added):i.cusAttr("Status")==RowStatus.UnChanged&&i.cusAttr("Status",RowStatus.Modified),t.SetResult(r),window._GridWillPostBack&&(this._owner._isDataCollected=!1))))},this.BeforeContext=function(n,t){var i=new CellDataContent("","");return i.QueryParameters=n.parameters,i.FieldID=t,i},this.AfterContext=function(n){var t=new CellDataContent("","");return t.Result=n,t}},HeadEventsManager.Events=null,HeadEventsManager.Owner=null,HeadEventsManager.FireDrowthroughEventStatic=function(n,t){$find(t).m_behaviorManager.HeadEventsManager.FireDrowthroughEvent(n)},HeadEventsManager.prototype={dispose:function(){this._owner=null,this.TableHead=null,this.tableBody=null,HeadEventsManager.Events&&(Array.clear(HeadEventsManager.Events),HeadEventsManager.Events=null),HeadEventsManager.Owner=null},AttachCellEvents:function(cells,columnName,kp,hasEvent){var _this,i,index,name;for(HeadEventsManager.Owner=this._owner,_this=this,i=0;i<cells.length;i++)cells[i].cusAttr("FieldID")==columnName&&(hasEvent&&cells[i].children[0]&&cells[i].children[0].className=="underLine"&&(HeadEventsManager.Events.push(cells[i].children[0]),eval("HeadEventsManager.Events[HeadEventsManager.Events.length-1].onclick=function(){HeadEventsManager.FireDrowthroughEventStatic('"+columnName+"','"+this._owner.get_element().id+"');$Event(event).stopPropagation();};")),kp=="true"&&(index=_this._owner.GetColumnIndex(columnName),name=_this._owner.findDisplayNameByIndex(index),$(cells[i].children[0]).prepend("<i class='iconfont y-icon-help icon-help'><\/i>"),$(cells[i].children[0]).find("i").click(function(){window.top.helpTool.show(name,_this._owner._element.id,!0)})))},Init:function(){var n,t;if(HeadEventsManager.Events=[],this.TableHead!=this._owner.UNDEFINED_VALUE)for(n=0;n<this._owner.m_columns;n++)for(t=0;t<this.TableHead.children.length;t++)this.AttachCellEvents(this.TableHead.children[t].cells,this._owner.MainCols[n].cusAttr("FieldID"),this._owner.MainCols[n].cusAttr("kp"),this._owner.MainCols[n].cusAttr("HasEvent")!=this._owner.UNDEFINED_VALUE)},GetFormRef:function(n){return n>-1&&(this._owner.m_currentFormRef=this._owner.MainCols[n].cusAttr("FormRef"),this._owner.m_currentFormRef==this._owner.UNDEFINED_VALUE&&(this._owner.m_currentFormRef="")),this._owner.m_currentFormRef},GetFormReference:function(n,t){var i=new FormReferenceSchema(this._owner);return(i.Init(n),i.columnName=t,i.ok)?i:null}},FormReferenceSchema=function(n){var t=this;this._owner=n,this.formUrl="",this.formCaption="",this.width=600,this.height=400,this.hideStatusBar=!0,this.bindingCombox=!1,this.codeField="Code",this.nameField="Name",this.columnName="",this.parameters=[],this.result=[],this.ok=!1,this.GetParameterValues=function(){var e,n,o,s,l,h,f,r,c,u,i;if(t._owner.D_Body!=null)if(t.bindingCombox)for(n=0;n<t.parameters.length;n++)t.parameters[n].value=t.parameters[n].bindingName;else for(e=t._owner.D_Body.rows[t._owner.m_currentRowIndex],n=0;n<t.parameters.length;n++)t.parameters[n].bindingType=="context"?(o=$find(t.parameters[n].bindingName),o!=null&&(t.parameters[n].value=o.value)):t.parameters[n].bindingType=="value"?t.parameters[n].value=t.parameters[n].bindingName:(s=t.parameters[n].bindingName,l=t._owner.GetColumnIndex(s),l>=0?(h=t._owner.GetColumnIndex(t.parameters[n].bindingName),t._owner.GetColumnType(h)==ControlType.RefControl?(i=t.parameters[n].bindingProperty,f=t._owner.GetCellValue(t._owner.m_currentRowIndex,h),i=="value"?f!=null&&(t.parameters[n].value=f.Code):i=="text"?f!=null&&(t.parameters[n].value=f.Text):t.parameters[n].value=t.GetCellValue(e,t.parameters[n].bindingName)):t.parameters[n].value=t.GetCellValue(e,t.parameters[n].bindingName)):(r="",c=t._owner.GetControlByServerID(s),c&&(u=c.control,u.get_Type()==ControlType.Reference?(i=t.parameters[n].bindingProperty,i=="key"?r=u.get_Key():i=="value"&&(r=u.get_Value()),i=="text"&&(r=u.get_Text())):r=u.get_Value(),t.parameters[n].value=r)))}},FormReferenceSchema.prototype={Init:function(n){if(n&&n!=""){var t=n.split("#");this.SetBaseSchema(t[0]),this.SetParameterSchema(t[1]),this.SetResultSchema(t[2]),this.ok=!0}},SetBaseSchema:function(n){var t=n.split(",");this.formUrl=t[0],this.formCaption=t[1],this.width=parseInt(t[2],10),this.height=parseInt(t[3],10),this.hideStatusBar=t[4]==DefaultSymbol.True,this.bindingCombox=t[5]==DefaultSymbol.True,this.codeField=t[6],this.nameField=t[7]},SetParameterSchema:function(n){for(var r=n.split(";"),i,t=0;t<r.length;t++)i=new QueryParameter,i.Init(r[t]),this.parameters.push(i)},SetResultSchema:function(n){for(var r=n.split(";"),i,t=0;t<r.length;t++)i=new QueryParameter,i.Init(r[t]),this.result.push(i)},Url:function(n){var t=null,u=this._owner.GetColumnIndex(n),i,r;return this._owner.MainCols[u].cusAttr("ISMultiOrg")=="true"&&(t="&EntityFullName="+this._owner.MainCols[u].cusAttr("EntityFullName")),i="",i=this.GetQueryString(),this.formUrl.indexOf("?")==-1?(r=i==""?this.formUrl+"?"+i:this.formUrl,t&&(r+=t),r):i!=""?t?this.formUrl+"&"+i+t:this.formUrl+"&"+i:t?this.formUrl+t:this.formUrl},Caption:function(){return this.formCaption},GetQueryString:function(){for(var t=[],n=0;n<this.parameters.length;n++)this.parameters[n].value!=null&&this.parameters[n].value.toString()!=""&&t.push(this.parameters[n].name+"="+encodeURIComponent(this.parameters[n].value));return t.length>0?t.join("&"):""},GetCellValue:function(n,t){if(n&&n.cells){var i=this._owner.GetColumnIndex(t);if(i>=0)return n.cells[i].cusAttr("Value")}return""},SetResult:function(n){var u,f,r,t,i,o,e;if(this._owner.get_element().cusAttr("EditStatus")!=DisplayStyle.Browser&&n.Rows.length>0&&this._owner.m_gridFaciesManager!=null)if(this.bindingCombox)this.SetComboxItems(this.columnName,n);else{if(this._owner.GetColumnIndex(this.columnName)!=this._owner.m_currentColumnIndex)return;for(u=n.Rows[0],f="",r=0;r<this.result.length;r++)if(t=this.result[r],i=this._owner.GetColumnIndex(t.bindingName),i>-1)if(this._owner.MainCols[i].cusAttr("ControlType")==ControlType.RefControl){if(f==t.bindingName)continue;else f=t.bindingName;if(o=this.setRefData(t.bindingName,this.result,u,i,r),this._owner.m_currentColumnIndex==i&&!o)break;continue}else e=u[t.name],e!=this._owner.UNDEFINED_VALUE&&this._owner.m_gridFaciesManager.SetCellValue(this._owner.m_currentRowIndex,i,e);this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Edit&&this._owner.UpdateNumbericPrecision(this._owner.m_currentRowIndex)}},setRefData:function(n,t,i,r){for(var o="",h="",c="",v=0,p=[],y=!0,e,f,l,a,s=0;s<this.result.length;s++){if(e=this.result[s],e.bindingName==n)if(e.bindingProperty=="key"){if(o=i[e.name],o<=-1)return!1;continue}else if(e.bindingProperty=="value"){h=i[e.name];continue}else if(e.bindingProperty=="text"){c=i[e.name];continue}p[v]=e,v++}return f=this._owner.CreateReferenceControl(r),r==this._owner.m_currentColumnIndex?(f.control.set_NeedValidate(!0),f.control.get_IsLoadDefaultParams()&&this._owner.SetReferenceParameters(f.control,this._owner.m_currentColumnIndex,this._owner.m_currentRowIndex,f.cusAttr("RefPara"))):f.control.set_NeedValidate(!1),f.control.set_Key(o),f.control.set_Value(h),f.control.set_Text(c),f.control.set_NeedValidate(!0),(f.control.get_Key()==-1||f.control.get_Key()=="")&&o!=-1&&o!=""&&(y=!1),y?(l=!0,this._owner.GetCellValue(this._owner.m_currentRowIndex,r)&&this._owner.GetCellValue(this._owner.m_currentRowIndex,r).Value==f.control.get_Key()&&(l=!1),this._owner.m_gridFaciesManager.SetReferenceCellValue(this._owner.m_currentRowIndex,r,o,h,c),l==!0&&(a=new CellDataContent("",o),this._owner.OnCellDataChanged(a,this._owner.m_currentRowIndex,r),this._owner.OnCellDataValueChanged(a,this._owner.m_currentRowIndex,r)),!0):(this._owner.m_gridFaciesManager.SetReferenceCellValue(this._owner.m_currentRowIndex,r,"","",""),!1)},SetComboxItems:function(n,t){var i;if(t!=null&&t.Rows!=null&&(i=this._owner.GetColumnIndex(n),i>-1&&this._owner.MainCols[i].cusAttr("ControlType")==ControlType.Combox)){var f=this._owner.CreateComboxControl(i),u=f.control,r={};r[0]=this.codeField,r[1]=this.nameField,r[2]=t,u!=null&&u.set_DataSource(r),this._owner.SetCellValue(this._owner.m_currentRowIndex,i,u.get_Value())}}},QueryParameter=function(){this.name="",this.bindingName="",this.bindingType="",this.bindingProperty="",this.value=""},QueryParameter.prototype={Init:function(n){var t=n.split(",");this.name=t[0],this.bindingName=t[1],this.bindingType=t[2],this.bindingProperty=t[3],this.value=""}},TableDimentionManager=function(n,t,i,r,u){var f=this;this._owner=u,this.TableLayout=n,this.MainTable=t,this.TableHead=i,this.Cols=r,this.StartResizeColumnWidth=!1,this.StartOffsetX=0,this.StartColumnIndex=0,this.StartCell=null,this.ColWidthChanged=!1,this.OnLayoutScroll=function(){f._owner.m_eventProcessLock=!0,f._owner.m_tableDimentionManager.AdjustTableHeadPosition(),f._owner.m_eventProcessLock=!1},this.OnMouseMove=function(){var n=event.srcElement;f&&f._owner&&(n.tagName=="TD"?n.style.cursor=f._owner.m_tableDimentionManager.StartResizeColumnWidth?"col-resize":n.offsetWidth-event.offsetX<=6?"w-resize":"default":n.tagName=="DIV"&&(n.style.cursor=f._owner.m_tableDimentionManager.StartResizeColumnWidth?"col-resize":"default"))},this.OnMouseDown=function(){var n,i,u,e,t;if(f.ColWidthChanged=!1,n=event.srcElement,n.tagName=="TD"&&n.className.split(" ")[0]=="thc")if(n.offsetWidth-event.offsetX<=6){if(f._owner.m_gridBodyEventsHandler.CanEndEdit(!1)){if(f._owner.m_tableDimentionManager.StartResizeColumnWidth=!0,f._owner.m_tableDimentionManager.StartOffsetX=event.clientX,i=-1,n.parentElement.parentElement.rows.length==1||f.Cols.length==n.parentElement.cells.length)i=n.cellIndex;else for(u=0,e=parseInt(n.offsetLeft,10)+parseInt(n.offsetWidth,10),t=0;t<r.length;t++)if(r[t].style.display!="none"&&(u+=parseInt(r[t].width,10)),u==e){i=t;break}return f._owner.m_tableDimentionManager.StartColumnIndex=i,f._owner.m_tableDimentionManager.StartCell=n,f._owner.m_tableDimentionManager.StartCell.style.cursor="col-resize",!1}}else n.style.cursor="default"},this.OnMouseUp=function(){if(f._owner&&f._owner.m_tableDimentionManager&&f._owner.m_tableDimentionManager.StartResizeColumnWidth)return f._owner._FixColumnRightPixcel=null,f.ColWidthChanged=!0,f._owner.m_tableDimentionManager.StartResizeColumnWidth=!1,f._owner.m_tableDimentionManager.StartCell.style.cursor="default",f._owner.m_tableDimentionManager.SetColumnWidth(event.clientX-f._owner.m_tableDimentionManager.StartOffsetX),f._owner.m_gridFaciesManager.SetTableAutoSizeByColumns(),!1}},TableDimentionManager.prototype={dispose:function(){this.DetachEvents(),this._owner=null,this.TableLayout=null,this.MainTable=null,this.TableHead=null,this.Cols=null,this.StartCell=null},Init:function(){this.AttachEvents()},AttachEvents:function(){this.TableLayout!=this._owner.UNDEFINED_VALUE&&(this.TableLayout.onscroll=this.OnLayoutScroll,this.TableLayout.onmouseup=this.OnMouseUp,this.TableLayout.onmousemove=this.OnMouseMove,window.document.onmouseup=this.OnMouseUp,window.document.onmousemove=this.OnMouseMove),this.TableHead!=this._owner.UNDEFINED_VALUE&&(this.TableHead.onmousemove=this.OnMouseMove,this.TableHead.onmouseup=this.OnMouseUp,this.TableHead.onmousedown=this.OnMouseDown)},DetachEvents:function(){this.TableLayout&&(this.TableLayout.onscroll=null,this.TableLayout.onmouseup=null,this.TableLayout.onmousemove=null),this.TableHead&&(this.TableHead.onmousemove=null,this.TableHead.onmouseup=null,this.TableHead.onmousedown=null)},AdjustTableHeadPosition:function(){var r,i,n;return},SetColumnWidth:function(n){var t,i,e,r,u,f;if(this.StartColumnIndex<this._owner.m_columns&&this.StartColumnIndex>=0)try{for(t=parseInt(this.Cols[this.StartColumnIndex].width,10),t+=n,t<20&&(t=20),this.Cols[this.StartColumnIndex].width=t+"px",i=0;i<this.TableHead.children.length;i++)for(e=this.TableHead.children[i],r=0;r<e.children.length;r++)if(u=e.children[r],u.cusAttr("fieldId")==this.Cols[this.StartColumnIndex].cusAttr("fieldId")){f=parseInt(u.width,10)+n,f<20&&(f=20),u.width=f;break}this._owner.m_tableDimentionManager.AdjustTableHeadPosition()}catch(o){}}},TableDimentionManager.GetInstance=function(n,t,i,r,u){return u.m_tableDimentionManager==u.UNDEFINED_VALUE&&(u.m_tableDimentionManager=new TableDimentionManager(n,t,i,r,u)),u.m_tableDimentionManager},GridBodyEventsHandler=function(n,t,i,r,u){var f=this;this._owner=u,this.thisControl=n,this.tableContainer=t,this.tableBody=i,this.tableHead=r,this.GridEditHelper=null,this.GridFaciesHelper=null,this.LayoutScrollReceive=function(){f._owner.get_element().cusAttr("disabled")||f._owner.m_gridBodyEventsHandler.OnLayoutScroll(event)},this.LayoutScrollReceiveStart=function(n){f._owner.get_element().cusAttr("disabled")||f._owner.m_gridBodyEventsHandler.OnLayoutScrollStart(n)},this.LayoutScrollReceiveStop=function(n){f._owner.get_element().cusAttr("disabled")||f._owner.m_gridBodyEventsHandler.OnLayoutScrollStop(n)},this.CellClickReceive=function(n){if(f._owner!=null&&!f._owner.m_eventProcessLock){var t;if(t=f._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser?n:window.event,!f._owner.get_element().cusAttr("disabled")){if(f._owner.m_gridFocusEventProcessed=!0,f._owner.m_tableDimentionManager.StartResizeColumnWidth)f._owner.m_tableDimentionManager.StartResizeColumnWidth=!1;else{if(f._owner.m_SumAllData&&f._owner.m_SumSelectedData&&t&&t.srcElement&&t.srcElement.type=="checkbox"&&t.srcElement.parentElement.className=="tcc"&&f.GridEditHelper&&f.GridEditHelper.CellEditActive){t.srcElement.checked=!t.srcElement.checked,f._owner.EndEdit();return}if(f._owner.m_eventProcessLock)return;f._owner.m_eventProcessLock=!0,f._owner.m_gridBodyEventsHandler.OnCellClick(t),f._owner.m_eventProcessLock=!1}$Event(t).stopPropagation(),window.event&&$Event(window.event).stopPropagation()}}},this.CellDBClickReceive=function(n){if(!f._owner.m_eventProcessLock){var t;(t=f._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser?n:window.event,f._owner.get_element().cusAttr("disabled"))||(f._owner.m_gridFocusEventProcessed=!0,f._owner.m_gridBodyEventsHandler.OnCellDBClick(t),t&&$Event(t).stopPropagation(),window.event&&$Event(window.event).stopPropagation())}},this.CellKeyDownReceive=function(){if(event!=null&&event.type=="keydown"){if(event.keyCode==70&&event.ctrlKey==!0)return f._owner.m_pageBreakManagerInstance&&f._owner.m_pageBreakManagerInstance.OnBtnLocateClick&&f._owner.m_pageBreakManagerInstance.OnBtnLocateClick(),$Event(event).stopPropagation(),$Event(event).preventDefault(),!1;if(event.keyCode==KeyCode.tab)return event.keyCode=KeyCode.GridTab,!0;((event.altKey&&event.keyCode==188||event.altKey&&event.keyCode==190)&&$Event(event).stopPropagation(),f._owner.get_element().cusAttr("disabled"))||(f._owner.m_gridFocusEventProcessed=!0,f._owner.m_gridBodyEventsHandler.OnCellKeyDown(event),event.keyCode==89&&event.altKey==!0&&f._owner.m_CustomFilterManagerInstance.OnBtnSetFilterClick(),event.keyCode==74&&event.altKey==!0&&(f._owner.m_editMenuToolbar.Toggle(),event.keyCode=0,$Event(event).stopPropagation(),$Event(event).preventDefault()),event.ctrlKey||event.altKey||$Event(event).stopPropagation(),event.keyCode==13&&($Event(event).stopPropagation(),window.location.href.toLowerCase().indexOf("simple.aspx")>-1&&$(":submit").length>0?$(":submit").trigger("click"):$Event(event).preventDefault()),event.keyCode==KeyCode.tab&&($Event(event).stopPropagation(),$Event(event).preventDefault()))}},this.ControlFocusOutReceive=function(){f._owner!=null&&(f._owner.m_eventProcessLock||(f._owner.m_eventProcessLock=!0,f._owner.m_gridFocusEventProcessed||f._owner.m_gridBodyEventsHandler.GridEditHelper!=null&&f._owner.m_gridBodyEventsHandler.GridEditHelper.OnLayoutFocusOut(),f._owner.m_gridFocusEventProcessed=!1,f._owner.m_eventProcessLock=!1))},this.CellKeyDown=function(){event.keyCode==KeyCode.up||event.keyCode==KeyCode.down||event.keyCode==KeyCode.left||event.keyCode==KeyCode.right||event.keyCode==KeyCode.F2||event.keyCode==KeyCode.F12?f.CellKeyDownReceive():$Event(event).stopPropagation()},this.HeadSelectEventReceive=function(){f._owner.get_element().cusAttr("disabled")||(f._owner.m_gridFocusEventProcessed=!0,f._owner.m_gridBodyEventsHandler.OnHeadAllSelect(event.srcElement),f._owner.OnFireSelectAllEvent())}},GridBodyEventsHandler.prototype={dispose:function(){this.GridEditHelper&&(this.GridEditHelper.dispose(),this.GridEditHelper=null),this._owner=null,this.DetachEvents(),this.thisControl=null,this.tableContainer=null,this.tableBody=null,this.tableHead=null,this.GridFaciesHelper=null},ContainOf:function(n,t){var u=!1,f=this._owner.GetColumnIndex(n),r,i,e;if(f>=0&&this.tableBody!=null)for(r=this.tableBody.rows,i=0;i<r.length;i++)if(e=r[i].cells[f].cusAttr("Value"),t==e){u=!0;break}return u},MoveFirstRow:function(n){this.GridEditHelper!=null&&this.CanEndEdit(!0)&&this.GridEditHelper.MoveFirstRow(this.GetNotChangeFields(n))},MoveNextRow:function(n){this.GridEditHelper!=null&&this.CanEndEdit(!0)&&this.GridEditHelper.MoveNextRow(this.GetNotChangeFields(n))},MoveLastRow:function(n){this.GridEditHelper!=null&&this.CanEndEdit(!0)&&this.GridEditHelper.MoveLastRow(this.GetNotChangeFields(n))},MovePreviousRow:function(n){this.GridEditHelper!=null&&this.CanEndEdit(!0)&&this.GridEditHelper.MovePreviousRow(this.GetNotChangeFields(n))},ClearData:function(){this.GridEditHelper!=null&&this.CanEndEdit(!0)&&this.GridEditHelper.ClearData()},GetNotChangeFields:function(n){var u=[],r,t,i;if(n!="")for(r=n.split(","),t=-1,i=0;i<r.length;i++)t=this._owner.GetColumnIndex(r[i]),t>-1&&u.push(t);return u},GetEditMenuEnabled:function(){return this.GridEditHelper!=null?this.GridEditHelper.editMenuEnabled:!1},SetEditMenuEnabled:function(n){this.GridEditHelper!=null&&(this.GridEditHelper.editMenuEnabled=n)},GetAutoEditEnabled:function(){return this.GridEditHelper!=null?this.GridEditHelper.autoEditModel:!1},SetAutoEditEnabled:function(n){this.GridEditHelper!=null&&(this.GridEditHelper.autoEditModel=n)},GetAutoAddNewRowOnLastCellReturnEnabled:function(){return this.GridEditHelper!=null?this.GridEditHelper.autoAddNewRowOnLastCellReturn:!1},SetAutoAddNewRowOnLastCellReturnEnabled:function(n){this.GridEditHelper!=null&&(this.GridEditHelper.autoAddNewRowOnLastCellReturn=n)},AttachEvents:function(){var n=this;this.tableContainer!=this._owner.UNDEFINED_VALUE,this.tableBody!=this._owner.UNDEFINED_VALUE&&(this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser?(this.tableBody.onclick=function(){(n.tableBody!=null&&window.currentGridClickTimeout!=null&&(window.clearTimeout(window.currentGridClickTimeout),window.currentGridClickTimeout=null),n&&!n._owner.m_eventProcessLock)&&(this.tmpEvent={},this.tmpEvent.altKey=window.event.altKey,this.tmpEvent.ctrlKey=window.event.ctrlKey,this.tmpEvent.srcElement=window.event.srcElement,this.tmpEvent.keyCode=window.event.keyCode,this.tmpEvent.type=window.event.type,this.tmpEvent.shiftKey=window.event.shiftKey,this.tmpEvent.x=window.event.x,this.tmpEvent.y=window.event.y,window.currentGridClickTimeout=window.setTimeout(function(t){try{n.CellClickReceive(t.tmpEvent)}catch(i){}}(this),1e3),$Event(event).stopPropagation())},this.tableBody.ondblclick=function(){n._owner.m_eventProcessLock||(window.currentGridClickTimeout&&(window.clearTimeout(window.currentGridClickTimeout),window.currentGridClickTimeout=null),n.CellDBClickReceive(this.tmpEvent))}):(this.tableBody.ondblclick=this.CellDBClickReceive,this.tableBody.onclick=this.CellClickReceive),this.tableBody.onkeydown=this.CellKeyDownReceive),this.thisControl!=this._owner.UNDEFINED_VALUE&&(this.thisControl.onfocusout=this.ControlFocusOutReceive),this.tableHead!=this._owner.UNDEFINED_VALUE&&this.AttachHeadSelectEvent(this.tableHead)},DetachEvents:function(){this.tableContainer&&$(this.tableContainer).unbind("scroll",this.LayoutScrollReceive),this.tableBody&&($(this.tableBody).unbind("click",this.CellClickReceive),$(this.tableBody).unbind("dblclick",this.CellDBClickReceive),$(this.tableBody).unbind("keydown",this.CellKeyDownReceive)),this.thisControl&&$(this.tableBody).unbind("focusout",this.ControlFocusOutReceive),this.tableHead&&this.DetachHeadSelectEvent(this.tableHead)},AttachHeadSelectEvent:function(n){if(n.children.length>0){var i=n.children[0].cells[0],t=i.firstChild;t!=this._owner.UNDEFINED_VALUE&&t.type=="checkbox"&&$(t).bind("click",this.HeadSelectEventReceive)}},DetachHeadSelectEvent:function(n){if(n.children.length>0){var i=n.children[0].cells[0],t=i.firstChild;t&&t.type=="checkbox"&&$(t).unbind("click",this.HeadSelectEventReceive)}},AttachFaciesHelper:function(n){this.GridFaciesHelper=n},AttachEditHelper:function(n){this.GridEditHelper=n},OnHeadAllSelect:function(n){var i=n.checked,r=this._owner.D_Body.rows,t,u;for(this._owner.EndEdit(!1),t=0;t<r.length;t++)u=this._owner.IsRowSelected(t),this.SetRowHeadSelected(r[t].cells[0],i,t),this._owner.OnBodyRowSelected(t,i,u),this._owner.HeadSelectedCauseClick===!0&&this._owner.OnRowClicked()},SetRowHeadSelected:function(n,t){if(n!=this._owner.UNDEFINED_VALUE){var r=n.firstChild;r!=this._owner.UNDEFINED_VALUE&&(r.type="checkbox")&&(r.checked=t)}},OnLayoutScroll:function(n){this._owner.m_eventProcessLock||(this._owner.m_eventProcessLock=!0,this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnLayoutScroll(n),this.GridEditHelper!=null&&this.GridEditHelper.OnLayoutScroll(n),this._owner.m_eventProcessLock=!1)},OnLayoutScrollStart:function(n){this._owner.m_eventProcessLock||(this._owner.m_eventProcessLock=!0,this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnLayoutScrollStart(n),this.GridEditHelper!=null&&this.GridEditHelper.OnLayoutScrollStart(n),this._owner.m_eventProcessLock=!1)},OnLayoutScrollStop:function(n){this._owner.m_eventProcessLock||(this._owner.m_eventProcessLock=!0,this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnLayoutScrollStop(n),this.GridEditHelper!=null&&this.GridEditHelper.OnLayoutScrollStop(n),this._owner.m_eventProcessLock=!1)},OnCellKeyDown:function(n){if((!_ClientCallBackManager||!_ClientCallBackManager.Runing)&&!this._owner.m_eventProcessLock){if(this._owner.m_eventProcessLock=!0,!this.MoveCurrentCellKeyDown(n.keyCode)&&n.keyCode!=KeyCode.del){this.GridEditHelper!=null&&this._owner.fireEventOnkeypress();var t=this.GridFaciesHelper.GetCurrentCell(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex);t&&t.firstChild&&(t.firstChild.tagName=="INPUT"||t.firstChild.tagName=="SPAN"||t.firstChild.tagName=="TEXTAREA")||this.GridEditHelper&&this.GridEditHelper.CellEditActive&&(this.GridEditHelper.CellEditActive=!1),n.keyCode!=KeyCode.up&&n.keyCode!=KeyCode.down&&this.StartEditKeyDown(n.keyCode)}this._owner.m_eventProcessLock=!1}},DoCellKeyDown:function(n){if((!_ClientCallBackManager||!_ClientCallBackManager.Runing)&&!this._owner.m_eventProcessLock){if(this._owner.m_eventProcessLock=!0,!this.MoveCurrentCellKeyDown(n.keyCode)){this.GridEditHelper!=null&&this._owner.fireEventOnkeypress();var t=this.GridFaciesHelper.GetCurrentCell(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex);t&&t.firstChild&&(t.firstChild.tagName=="INPUT"||t.firstChild.tagName=="SPAN"||t.firstChild.tagName=="TEXTAREA")||this.GridEditHelper&&this.GridEditHelper.CellEditActive&&(this.GridEditHelper.CellEditActive=!1),n.keyCode!=KeyCode.up&&n.keyCode!=KeyCode.down&&this.StartEditKeyDown(n.keyCode)}this._owner.m_eventProcessLock=!1,this._owner.inRequestProcess=!1,n=null}},GetPoint:function(n){var i,r,t,u;if(n.focus(),i=0,document.selection){if(r=document.selection,r.type)try{t=r.createRange(),n.select(),u=r.createRange(),t.setEndPoint("StartToStart",u),i=t.text.length,t.collapse(!1),t.select()}catch(f){}}else try{i=n.selectionStart}catch(f){}return i},FireRowSelectEvent:function(n){this._owner.OnBodyRowSelected(this._owner.m_currentRowIndex,n.checked,!n.checked),this._owner.OnBodyRowSelectedClick(this._owner.m_currentRowIndex,n.checked),this._owner.OnRowClicked()},MoveCurrentCellKeyDown:function(n){var s,i,e,r,h,o,t,a,f,y,l,u,v,c;if(n==KeyCode.ESC&&this.GridFaciesHelper.OutSelectCellBorder(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex,!1),window.event.altKey)return!1;if(event.keyCode==KeyCode.space&&this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser&&(i=this._owner.D_Body.rows[this._owner.m_currentRowIndex].getElementsByTagName("input")[0],i)){if(i.type!="checkbox")return!0;i.checked=!i.checked,this.FireRowSelectEvent(i),this._owner.SetHeadCheckBoxState(!0),$Event(event).stopPropagation(),$Event(event).preventDefault()}if(event.keyCode==KeyCode.space&&event.shiftKey&&this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Edit&&(i=this._owner.D_Body.rows[this._owner.m_currentRowIndex].getElementsByTagName("input")[0],i)){if(i.type!="checkbox")return!0;i.checked=!i.checked,this.FireRowSelectEvent(i),$Event(event).stopPropagation(),$Event(event).preventDefault()}if(window.event.ctrlKey&&(this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser?n==KeyCode.enter?this._owner.m_gridFaciesManager.OnBodyCellDBClicked(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex):n==KeyCode.s?(s=this._owner.m_gridBodyEventsHandler.tableHead,s&&(e=s.children[0].cells[0],i=e.firstChild,i&&(i.checked=!i.checked,this._owner.SelectAllRow(i.checked),this.FireRowSelectEvent(i)))):n==67&&(r="",document.selection&&(r=document.selection.createRange().text),!r&&window.getSelection()&&(r=window.getSelection().toString()),r&&(r=r.replace(/^[\s\n\t]+/g,"")),r&&(Clipboard.setData(r),$Event(event).preventDefault())):this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Edit&&n==KeyCode.s?this._owner.m_gridBodyEventsHandler&&(s=this._owner.m_gridBodyEventsHandler.tableHead,s&&(e=s.children[0].cells[0],i=e.firstChild,i&&(i.checked=!i.checked,this._owner.SelectAllRow(i.checked),this.FireRowSelectEvent(i)))):n==KeyCode.M?this._owner.m_gridBodyEventsHandler.GridEditHelper.ShowMenu(this._owner.m_currentRowIndex):n==67&&(e=this.GridEditHelper.GetCurrentCell(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),e&&(r="",document.selection&&(r=document.selection.createRange().text),!r&&window.getSelection()&&(r=window.getSelection().toString()),r?(r=r.replace(/^[\s\n\t]+/g,""),Clipboard.setData(r),$Event(event).preventDefault()):(h=e.getElementsByTagName("input"),h&&h.length!=0||(h=e.getElementsByTagName("textarea")),h&&h.length!=0||(r=e.innerText),r&&Clipboard.setData(r)))),n!=KeyCode.insert))return!1;o=!1;switch(n){case 123:HeadEventsManager.Owner=this._owner,HeadEventsManager.Owner.m_behaviorManager.HeadEventsManager.OnKeyDownClick(this._owner.m_currentColumnIndex);break;case KeyCode.left:if(event.shiftKey)return;this._owner.GridIsInFocus=!0,t=event.srcElement,f=0,t&&(t.tagName=="INPUT"||t.tagName=="TEXTAREA")&&(f=this.GetPoint(t)),f==0&&this.CanEndEdit(!1)&&(u=this._owner.m_currentRowIndex,this._owner.m_lastRowIndex=u,this.GetNextCellPosition(n)&&this.CanRowChanged(u)&&(this.GridFaciesHelper.SetCurrentCellStyle(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),this._owner.m_currentRowIndex!=u&&this._owner.OnRowChanged()),o=!0);break;case KeyCode.right:if(event.shiftKey)return;if(this._owner.GridIsInFocus=!0,t=event.srcElement,t&&(t.tagName=="INPUT"||t.tagName=="TEXTAREA"))a=!1,t.type=="checkbox"?a=!0:(f=this.GetPoint(t),t.parentElement.control&&(t.parentElement.control.get_Type()==ControlType.DropDownList?f=t.value.length:f!=0&&f==t.value.length&&(t.cusAttr("notfirstIn")||(y=t.parentElement.control.get_Type(),l=!1,l=y==ControlType.DateTime?$find(t.parentNode.id).get_Text()!=t.value:$find(t.parentNode.id).get_Value()!=t.value,t.cusAttr("notfirstIn",l?"N":"Y")),t.cusAttr("notfirstIn")=="Y"?(f=f-1,t.cusAttr("notfirstIn","N")):t.cusAttr("notfirstIn","Y")))),(f==t.value.length||a)&&this.CanEndEdit(!1)&&(t.cusAttr("notfirstIn")&&t.cusAttr("notfirstIn",null),u=this._owner.m_currentRowIndex,this._owner.m_lastRowIndex=u,this.GetNextCellPosition(n)&&this.CanRowChanged(u)&&(this.GridFaciesHelper.SetCurrentCellStyle(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),this._owner.m_currentRowIndex!=u&&this._owner.OnRowChanged()),o=!0);else if(this.CanEndEdit(!1)){if(u=this._owner.m_currentRowIndex,this._owner.m_lastRowIndex=u,this.GetNextCellPosition(n)&&this.CanRowChanged(u)){if(this._owner.m_currentColumnIndex==0){for(v=0,c=1;c<this._owner.m_columns;c++)if(this._owner.MainCols[c].style.display=="none")continue;else{v=c;break}this._owner.m_currentColumnIndex=v}this.GridFaciesHelper.SetCurrentCellStyle(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),this._owner.m_currentRowIndex!=u&&this._owner.OnRowChanged()}o=!0}break;case KeyCode.up:case KeyCode.down:case KeyCode.enter:o=this.DoKeyEvent(n);break;case KeyCode.home:if(event.shiftKey)return;this._owner.m_pageBreakManagerInstance!=null&&this._owner.m_pageBreakManagerInstance.OnFirstPageReceive(),this._owner.StoreState("Y"),this._owner.GridIsInFocus=!0;break;case KeyCode.end:if(event.shiftKey)return;this._owner.m_pageBreakManagerInstance!=null&&this._owner.m_pageBreakManagerInstance.OnLastPageReceive(),this._owner.StoreState("Y"),this._owner.GridIsInFocus=!0;break;case KeyCode.pup:this._owner.m_pageBreakManagerInstance!=null&&this._owner.m_pageBreakManagerInstance.OnPreviousPageReceive(),this._owner.StoreState("Y"),this._owner.GridIsInFocus=!0;break;case KeyCode.pdn:this._owner.m_pageBreakManagerInstance!=null&&this._owner.m_pageBreakManagerInstance.OnNextPageReceive(),this._owner.StoreState("Y"),this._owner.GridIsInFocus=!0;break;case KeyCode.del:this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser||this._owner.m_InCellEditing||this.CanEndEdit(!1)&&this._owner.m_editMenuToolbar&&(this._owner.m_editMenuToolbar.OnDeleteClicked(),$Event(event).stopPropagation(),$Event(event).preventDefault());break;case KeyCode.insert:this._owner.get_element().cusAttr("EditStatus")!=DisplayStyle.Browser&&this.CanEndEdit(!1)&&(event.shiftKey||event.ctrlKey?this._owner.m_editMenuToolbar&&this._owner.m_editMenuToolbar.OnAddClicked():this._owner.m_editMenuToolbar&&this._owner.m_editMenuToolbar.OnInsertClicked(),this._owner.Focus())}return o==!0&&this.GridEditHelper&&(this._owner.m_isRelaySwitchTag&&this._owner.IsNeedSwitchTabPage(this._owner.m_currentColumnIndex)||this.GridEditHelper.StartEdit()),o},DoKeyEvent:function(n,t){var i,r,u,f,e;if(this._owner.GridIsInFocus=!0,i=this._owner.m_currentRowIndex,t||(t=window.event),i>=0&&i<this._owner.m_rows&&this._owner.IsPersonalColumnByMoved(this._owner.m_currentColumnIndex)&&event&&(event.keyCode==KeyCode.up||event.keyCode==KeyCode.down)&&this.CanEndEdit(!1))return r="var tmpEvent = new Object();tmpEvent.shiftKey = "+(t.shiftKey?"true":"false")+";tmpEvent.keyCode = "+n+";$find('"+this._owner.get_id()+"').MoveToNextPosition("+n+",tmpEvent);$find('"+this._owner.get_id()+"').Focus(true);",u="if(_ClientCallBackManager.Runing == true || _ClientPostBackManager.Runing == true || $find('"+this._owner.get_id()+"').IsThisGirdPosting) { _ClientJSExecQueueManager.Push(\""+r+'"); } ',u+='else { eval("'+r+'");}',window.setTimeout(u,0),$Event(event).stopPropagation(),$Event(event).preventDefault(),!1;if(n==KeyCode.down?i++:n==KeyCode.up&&i>0&&i--,result=!1,i<0||i>=this._owner.m_rows)result=!0;else if(this.CanEndEdit(!1)){if(f=!1,t&&t.isSecond&&(f=!0),this._owner.IsThisGirdPosting||_ClientCallBackManager.Runing==!0){_ClientJSExecQueueManager.Push("var tmpEvent = new Object();tmpEvent.isSecond=true;tmpEvent.shiftKey = "+(t.shiftKey?"true":"false")+";tmpEvent.keyCode = "+n+';$find("'+this._owner.get_id()+'").m_gridBodyEventsHandler.DoKeyEvent('+n+",tmpEvent);$find('"+this._owner.get_id()+"').Focus(true);");return}if(!f&&this._owner.IsPersonalColumnByMoved(this._owner.m_currentColumnIndex)){_ClientJSExecQueueManager.Add("var tmpEvent = new Object();tmpEvent.isSecond=true;tmpEvent.shiftKey = "+(t.shiftKey?"true":"false")+";tmpEvent.keyCode = "+n+';$find("'+this._owner.get_id()+'").m_gridBodyEventsHandler.DoKeyEvent('+n+",tmpEvent);$find('"+this._owner.get_id()+"').Focus(true);");return}e=this._owner.m_currentRowIndex,this._owner.m_lastRowIndex=e,this.GetNextCellPosition(n,t)&&(this.GridFaciesHelper.SetCurrentCellStyle(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),this._owner.m_currentRowIndex!=e&&this._owner.OnRowChanged(),setTimeout(new Function("if($find('"+this._owner.get_id()+"')) { $find('"+this._owner.get_id()+"').Focus(false); }"),30)),result=!0}return event&&(event.keyCode==KeyCode.up||event.keyCode==KeyCode.down)&&($Event(event).stopPropagation(),$Event(event).preventDefault()),result},CanRowChanged:function(n){return n!=this._owner.m_currentRowIndex&&!this._owner.m_gridReadOnly&&this.GridEditHelper!=null&&!this.GridEditHelper.OnBeforeRowChange(n)?(this._owner.m_currentRowIndex=n,!1):!0},GetNextCellPosition:function(n,t){var e=!0,f,i,r,u;switch(n){case KeyCode.left:this._owner.m_currentColumnIndex=this._owner.m_currentColumnIndex==1?this._owner.GetPreviousColumn(this._owner.m_columns-1):this._owner.GetPreviousColumn(this._owner.m_currentColumnIndex-1);break;case KeyCode.right:this._owner.m_currentColumnIndex=this._owner.IsEndColumn(this._owner.m_currentColumnIndex+1)?this._owner.GetNextColumn(1):this._owner.GetNextColumn(this._owner.m_currentColumnIndex+1);break;case KeyCode.up:this._owner.m_currentRowIndex>0&&(this._owner.m_currentRowIndex-=1);break;case KeyCode.down:this._owner.m_currentRowIndex<this._owner.m_rows-1&&(this._owner.m_currentRowIndex+=1);break;case KeyCode.enter:if(window.event&&(t=window.event),t.shiftKey)return t.keyCode=KeyCode.left,this.GetNextCellPosition(t.keyCode);if(this._owner.get_element().cusAttr("EditStatus")!=DisplayStyle.Browser)if(f=this._owner.m_currentColumnIndex,this._owner.IsEndColumn(this._owner.m_currentColumnIndex+1)){if(this._owner.m_currentRowIndex==this._owner.m_rows-1)this._owner.m_currentColumnIndex=this._owner.GetNextColumn(1),this._owner&&this._owner.m_gridBodyEventsHandler&&this._owner.m_gridBodyEventsHandler.GridEditHelper&&(i=this._owner.m_gridBodyEventsHandler.GridEditHelper,i.autoAddNewRowOnLastCellReturn&&i.autoEditModel&&this._owner.m_currentRowIndex==this._owner.m_rows-1&&i.GridCRUDHelper!=null&&(this._owner.OnBeforeRowAdd()||(this._owner.ResetRowStates(this._owner.m_currentRowIndex),r=i.GridCRUDHelper.AddNewEmptyRow(),r!=-100&&(i.GridCRUDHelper.InitEmptyRow(r),this._owner.OnAfterRowAdded(r),this._owner.m_currentRowIndex=r))));else if(u=0,this._owner.m_currentRowIndex+1<this._owner.m_rows&&(this._owner.m_currentRowIndex+=1,u=this._owner.GetNextColumn(1,f),u!=0)){this._owner.m_currentColumnIndex=u;break}}else this._owner.m_currentColumnIndex=this._owner.GetNextColumn(this._owner.m_currentColumnIndex+1)}return e},CanEndEdit:function(n){var t=!0;return this.GridEditHelper!=null&&this.GridEditHelper.CellEditActive&&(t=this.GridEditHelper.EndEdit(n)),t},StartEditKeyDown:function(n){this.GridEditHelper!=null&&(this.GridEditHelper.CellEditActive?this.GridEditHelper.AcceptEdit():this.IsEditKeyCode(n)&&this.GridEditHelper.StartEdit())},IsEditKeyCode:function(n){var t=!0;if(n==27)return!1;switch(n){case 33:case 34:case 35:case 36:case 45:case 46:case 91:case 92:case 93:case 144:case 145:t=!1}return(n==KeyCode.F2||event.altKey)&&(t=!0),t==!0&&event.ctrlKey&&(t=!1),t},StartEditDBClick:function(){this.GridEditHelper==null||this.GridEditHelper.CellEditActive||this.GridEditHelper.StartEdit()},OnFormPostBack:function(){this.GridEditHelper!=null&&this.GridEditHelper.CellEditActive&&(result=this.CanEndEdit(!1))},OnStartGridColumnSort:function(){this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnStartGridColumnSort(),this._owner.m_eventProcessLock=!1},OnEndGridColumnSort:function(){this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnEndGridColumnSort()},OnCellClick:function(n){var u,t,r,i,f,e,o;if(!this.m_eventProcessLock&&(u=this._owner.m_currentRowIndex,this._owner.m_lastRowIndex=u,t=this.GetClickedCellElement(n.srcElement),t!=null&&this.CanEndEdit(!0)))switch(t.className.split(" ")[0]){case"thc":case"thcMulti":if(t&&t.cellIndex==0)break;this.GridEditHelper!=null&&this.GridEditHelper.OnHeadCellClicked(),this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnHeadCellClicked($(t.parentElement).index(),t.cellIndex);break;case"tbc":if(t.parentElement.sectionRowIndex!=this._owner.m_currentRowIndex&&(_ClientCallBackManager.Runing==!0&&_ClientCallBackManager.Args!="TotalPage"||_ClientPostBackManager.Runing==!0||this._owner.IsThisGirdPosting)){r="var oldRowIndex=$find('"+this._owner.get_id()+"').m_currentRowIndex;",r+="$find('"+this._owner.get_id()+"').m_currentRowIndex="+t.parentElement.sectionRowIndex+";",r+="$find('"+this._owner.get_id()+"').m_currentColumnIndex="+t.cellIndex+";",r+="$find('"+this._owner.get_id()+"').Focus(true);",r+="if($find('"+this._owner.get_id()+"').m_gridBodyEventsHandler.CanRowChanged(oldRowIndex))",r+="$find('"+this._owner.get_id()+"').OnRowChanged();",Global_JSQueueEvalAfterPageLoadedManager.AddLast(r);break}if(this._owner.m_currentRowIndex=t.parentElement.sectionRowIndex,this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser&&(i=this._owner.D_Body.rows[this._owner.m_currentRowIndex].getElementsByTagName("input")[0],i)){if(i.type!="checkbox")return!0;!i.checked&&n.srcElement!=i&&this._owner.m_isCheckedByClick&&(f=i.checked,i.checked=!0,this._owner.OnBodyRowSelected(this._owner.m_currentRowIndex,i.checked,f),this._owner.OnBodyRowSelectedClick(this._owner.m_currentRowIndex,i.checked),f!=i.checked&&this._owner.SetHeadCheckBoxState(i.checked))}this.CanRowChanged(u)&&(e=this._owner.m_currentColumnIndex==t.cellIndex,this._owner.m_currentColumnIndex=t.cellIndex,this.GridEditHelper!=null&&this.GridEditHelper.OnBodyCellClicked(this._owner.m_currentRowIndex),u!=this._owner.m_currentRowIndex&&this._owner.OnRowChanged(),this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnBodyCellClicked(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),o=u==this._owner.m_currentRowIndex,e&&o&&this._owner.IsNeedSwitchTabPage(this._owner.m_currentColumnIndex,this._owner.m_currentRowIndex));break;case"tcc":n.srcElement.nodeName=="TD"&&t.firstChild&&t.firstChild.nodeName=="INPUT"&&(t.firstChild.checked=!t.firstChild.checked),this._owner.m_currentRowIndex=t.parentElement.sectionRowIndex,this.CanRowChanged(this._owner.m_currentRowIndex)&&(this.GridEditHelper!=null&&this.GridEditHelper.GridEditMenu!=null&&this.GridEditHelper.GridEditMenu.InitMenu(),this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnBodyRowHeadClicked(this._owner.m_currentRowIndex,t),this.GridEditHelper!=null&&this.GridEditHelper.OnRowHeadClicked(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),u!=this._owner.m_currentRowIndex&&this._owner.OnRowChanged()),this._owner.SetHeadCheckBoxState(!0);break;case"tfc":this.GridEditHelper!=null&&this.GridEditHelper.OnFootCellClicked()}},OnCellDBClick:function(n){var i,t;if(!this.m_eventProcessLock&&n&&(i=this._owner.m_currentRowIndex,this._owner.m_lastRowIndex=i,t=this.GetClickedCellElement(n.srcElement),t!=null))switch(t.className.split(" ")[0]){case"thc":case"thcMulti":this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnHeadCellDBClicked(t.parentElement.sectionRowIndex,t.cellIndex);break;case"tbc":this.GridFaciesHelper!=null?(this._owner.m_currentRowIndex=t.parentElement.sectionRowIndex,this.GridFaciesHelper.OnBodyCellDBClicked(t.parentElement.sectionRowIndex,t.cellIndex)):this._owner.OnBodyCellDBClicked(t.parentElement.sectionRowIndex,t.cellIndex),this.StartEditDBClick();break;case"tcc":this.GridFaciesHelper!=null&&this.GridFaciesHelper.OnBodyRowHeadDBClicked(t.parentElement.sectionRowIndex)}},GetClickedCellElement:function(n){if(n.tagName=="TD")return n;if(n.tagName=="NOBR"||n.className=="FixedInner"||n.tagName=="INPUT"&&n.type=="checkbox"){for(var t=n.parentElement;t!=null&&t.tagName!="TD";)t=t.parentElement;return t}return null}},GridBodyEventsHandler.GetInstance=function(n,t,i,r,u){return u.m_gridBodyEventsHandler==null&&(u.m_gridBodyEventsHandler=new GridBodyEventsHandler(n,t,i,r,u)),u.m_gridBodyEventsHandler},GridEditManager=function(n,t,i,r,u){this._owner=u,this.tableLayout=n,this.tableBody=t,this.tableFoot=i,this.thisControl=r,this.editMenuEnabled=!0,this.autoEditModel=!1,this.CellEditActive=!1,this.GridFaciesHelper=null,this.CellEditHelper=null,this.CalculateHelper=null,this.GridCRUDHelper=null,this.GridEditMenu=null,this.autoAddNewRowOnLastCellReturn=!1},GridEditManager.prototype={dispose:function(){this.CellEditHelper&&(this.CellEditHelper.dispose(),this.CellEditHelper=null),this.CalculateHelper&&(this.CalculateHelper.dispose(),this.CalculateHelper=null),this.GridCRUDHelper&&(this.GridCRUDHelper.dispose(),this.GridCRUDHelper=null),this.GridEditMenu&&(this.GridEditMenu.dispose(),this.GridEditMenu=null),this.GridFaciesHelper=null,this._owner=null,this.tableLayout=null,this.tableBody=null,this.tableFoot=null,this.thisControl=null},MoveFirstRow:function(n){var t=this.GetTargetRowIndex(this._owner.m_currentRowIndex,"first"),i;if(t>=0&&t<this._owner.m_rows){if(this._owner.m_currentRowIndex>t)for(i=this._owner.m_currentRowIndex;i>=t;i--)this.RowChange(i,i-1,n);this._owner.m_currentRowIndex=t,this._owner.FocusCurrentCell()}},MoveLastRow:function(n){var t=this.GetTargetRowIndex(this._owner.m_currentRowIndex,"last"),i;if(t>=0&&t<this._owner.m_rows){if(t>this._owner.m_currentRowIndex)for(i=this._owner.m_currentRowIndex;i<t;i++)this.RowChange(i,i+1,n);this._owner.m_currentRowIndex=t,this._owner.FocusCurrentCell()}},MoveNextRow:function(n){var t=this.GetTargetRowIndex(this._owner.m_currentRowIndex,"next");t>=0&&t<this._owner.m_rows&&(this.RowChange(this._owner.m_currentRowIndex,t,n),this._owner.m_currentRowIndex=t,this._owner.FocusCurrentCell())},MovePreviousRow:function(n){var t=this.GetTargetRowIndex(this._owner.m_currentRowIndex,"previous");t>=0&&t<this._owner.m_rows&&(this.RowChange(this._owner.m_currentRowIndex,t,n),this._owner.m_currentRowIndex=t,this._owner.FocusCurrentCell())},RowChange:function(n,t,i){var u,f,r;if(t>-1&&n!=t&&(u=this.tableBody.rows[n],f=this.tableBody.rows[t],u.cusAttr("Status")!=RowStatus.Empty&&f.cusAttr("Status")!=RowStatus.Empty)){for(r=0;r<this._owner.m_columns;r++)this.Contain(r,i)||this.CopyCellContent(u.cells[r],f.cells[r]);this.ChangeRowState(u,f,i)}},ChangeRowState:function(n,t,i){var r,u;i.length>0?(r=n.cusAttr("Status"),u=t.cusAttr("Status"),n.cusAttr("Status",u),t.cusAttr("Status",r),t.cusAttr("Status")==RowStatus.UnChanged&&t.cusAttr("Status",RowStatus.Modified),n.cusAttr("Status")==RowStatus.UnChanged&&n.cusAttr("Status",RowStatus.Modified)):(r=n.cusAttr("Status"),u=t.cusAttr("Status"),n.cusAttr("Status",u),t.cusAttr("Status",r))},CopyCellContent:function(n,t){var r=["Value","MultiLang","R"],f=n.innerHTML,i,u;for(n.innerHTML=t.innerHTML,t.innerHTML=f,i=0;i<r.length;i++)u=t.cusAttr(r[i]),u!=this._owner.UNDEFINED_VALUE&&(t.cusAttr(r[i],n.cusAttr(r[i])),n.cusAttr(r[i],u))},Contain:function(n,t){for(var r=!1,i=0;i<t.length;i++)if(n==t[i]){r=!0;break}return r},GetTargetRowIndex:function(n,t){var i=-1;switch(t){case"first":i=0;break;case"next":n<this._owner.m_rows-1&&(i=n+1);break;case"previous":n>0&&(i=n-1);break;case"last":i=this._owner.m_rows-1}return i},Init:function(n){this.SetControlPropertys(this.thisControl),this.GridFaciesHelper=n,this.CellEditHelper=new CellEditHelper(this.tableBody,this,this._owner),this.CalculateHelper=new CalculateHelper(this.tableBody,this.tableFoot,this.thisControl,this._owner),this.CalculateHelper.Init(),this.CellEditHelper.AttachCalculate(this.CalculateHelper),this.editMenuEnabled&&(this.GridEditMenu=new GridMenuManager(this.thisControl,this.tableLayout,this.tableBody,this,this._owner),this.GridEditMenu.Init()),this.GridCRUDHelper=new GridCRUDHelper(this.thisControl,this.tableBody,this,this._owner),this.GridCRUDHelper.Init()},SetControlPropertys:function(n){n.cusAttr("AutoEditModel")==DefaultSymbol.True&&(this.autoEditModel=!0),this.editMenuEnabled=n.cusAttr("ShowFloatMenu")==DefaultSymbol.False?!1:!0},OnRowHeadClicked:function(n){this.ShowMenu(n)},OnHeadCellClicked:function(){this.ShowMenu(0)},OnFootCellClicked:function(){},OnBodyCellClicked:function(n){this.ShowMenu(n)},HideMenu:function(){this.GridEditMenu!=null&&this.GridEditMenu.HideMenu()},ShowMenu:function(n){this.GridEditMenu!=null&&this.editMenuEnabled&&this.GridEditMenu.ShowMenu(n)},GetMenuVisible:function(){return this.GridEditMenu!=null?this.GridEditMenu.GetMenuVisible():!1},OnRowHeadDBClicked:function(){},OnLayoutScroll:function(){},OnLayoutScrollStart:function(){},OnLayoutScrollStop:function(){},OnAddRow:function(n){var r,i,t,u;if(this.GridCRUDHelper!=null&&!this._owner.m_gridReadOnly){if(this._owner.get_IsPaging()&&this._owner.m_PageCount>1&&this._owner.m_PageIndex<this._owner.m_PageCount-1)return this._owner.StoreState("Y"),this._owner.GridIsInFocus=!0,this._owner.OnMovePage("LastPage"),n?(r='var xml="'+this.GridCRUDHelper.GetRowDataXmlStr(this._owner.m_currentRowIndex)+'";',r+="$find('"+this._owner.get_id()+"').CopyRow(xml);",Global_JSQueueEvalAfterPageLoadedManager.Add(r)):Global_JSQueueEvalAfterPageLoadedManager.Add("$find('"+this._owner.get_id()+"').AddNewRow();"),Global_JSQueueEvalAfterPageLoadedManager.Add("$find('"+this._owner.get_id()+"').Focus();"),!1;if(this._owner.m_MaxRows>0&&this.tableBody.rows.length==this._owner.m_MaxRows)return!1;if(i=!0,i=n?!this._owner.OnBeforeRowCopy():!this._owner.OnBeforeRowAdd(),i)return this._owner.m_gridBodyEventsHandler.CanEndEdit(!1),this.tableBody.rows.length>0&&this.tableBody.rows[this.tableBody.rows.length-1]&&this.tableBody.rows[this.tableBody.rows.length-1].cusAttr("Status")==RowStatus.Empty&&(this.tableBody.deleteRow(this.tableBody.rows.length-1),this._owner.m_rows-=1),this._owner.m_lastRowIndex=this._owner.m_currentRowIndex,this._owner.m_gridFaciesManager.lastRowIndex=this._owner.m_currentRowIndex,this._owner.m_gridFaciesManager.lastColumnIndex=this._owner.m_currentColumnIndex,this._owner.m_gridFaciesManager.OutCurrentCellStyle(),t=this.GridCRUDHelper.AddNewRow(),this.GridCRUDHelper.UpdateRowDefaultData(t,!0),this._owner.m_currentRowIndex=t,this._owner.m_currentColumnIndex=this._owner.GetFirstColumn(),this._owner.m_gridFaciesManager.Focus(),this._owner.m_IsStartEdit?this._owner.m_IsStartEdit=!1:this._owner.StartEdit(),n||(this._owner.OnAfterRowAdded(t),this._owner.OnRowChanged()),u=this.GetSumColumnsDataList(),this.CalculateHelper.ResetAggForNewRow(u),this._owner.SetDefaultValue4P(t),this._owner.Grid_IsDirtyData=!0,this._owner.m_gridFaciesManager.SetOddEvenTrStyle(),t}return-1},OnCopyRow:function(){var t=this._owner.m_currentRowIndex,n=this.OnAddRow(!0),i;n!==!1&&n>=0&&(this.GridCRUDHelper.CopyRowData(n,t),i=this._owner.m_lastRowIndex,this._owner.m_lastRowIndex=t,this._owner.OnAfterRowCopyedDefaultAction(n,t),this._owner.OnAfterRowCopyed(n,t),this._owner.m_lastRowIndex=i,this._owner.OnRowChanged())},ClearData:function(){if(this.GridCRUDHelper!=null){while(this._owner.m_rows>1)this.GridCRUDHelper.DeleteRow(this._owner.m_rows-1);this._owner.m_rows==1&&this.GridCRUDHelper.DeleteRow(0)}},RemoveData:function(){if(this.GridCRUDHelper!=null){while(this._owner.m_rows>1)this.GridCRUDHelper.RemoveRow(this._owner.m_rows-1);this._owner.m_rows==1&&this.GridCRUDHelper.RemoveRow(0)}},OnRemoveRow:function(){var t,n;if(this.GridCRUDHelper!=null&&!this._owner.m_gridReadOnly){if(this._owner.inDeleting)return;if(_ClientCallBackManager.Runing==!0){t="$find('"+this._owner.get_id()+"').m_editMenuToolbar.OnDeleteClicked();",Global_JSQueueEvalAfterPageLoadedManager.Add(t),this._owner.m_gridFocusEventProcessed=!1;return}if(this._owner.m_rows<1)return;this._owner.OnBeforeRowDelete()||(this._owner.inDeleting=!0,_ClientJSExecQueueManager.Add("$find('"+this._owner.get_id()+"').inDeleting=false;"),this._owner.m_gridBodyEventsHandler.CanEndEdit(!1),n=this.GetSumColumnsDataList(),this._owner.m_rows==1?(this.tableBody.rows[0].cusAttr("Status")==RowStatus.Empty&&(n=null),this._owner.m_gridBodyEventsHandler!=null&&this._owner.m_gridBodyEventsHandler.ClearData()):(this.tableBody.rows[this._owner.m_currentRowIndex].cusAttr("Status")==RowStatus.Empty&&(n=null),this.GridCRUDHelper.DeleteRow(this._owner.m_currentRowIndex)),this._owner.m_tableDimentionManager.AdjustTableHeadPosition(),this._owner.m_currentColumnIndex=this._owner.GetFirstColumn(),this._owner.StartEdit(),n&&this.CalculateHelper.ResetCalculateAggregations(n),this._owner.OnAfterRowDeleted(),this._owner.OnRowChanged(null,!0),this._owner.Grid_IsDirtyData=!0,this._owner.m_gridFaciesManager.SetOddEvenTrStyle())}},OnRemoveRowDirect:function(){if(this.GridCRUDHelper!=null&&!this._owner.m_gridReadOnly){if(!this._owner.m_gridBodyEventsHandler.GridEditHelper.editMenuEnabled)return;if(this._owner.m_rows<1)return;this._owner.m_gridBodyEventsHandler.CanEndEdit(!1);var n=this.GetSumColumnsDataList();this._owner.m_rows==1?this._owner.m_gridBodyEventsHandler!=null&&this._owner.m_gridBodyEventsHandler.ClearData():this.GridCRUDHelper.DeleteRow(this._owner.m_currentRowIndex),this._owner.m_tableDimentionManager.AdjustTableHeadPosition(),this._owner.m_currentColumnIndex=this._owner.GetFirstColumn(),this._owner.StartEdit(),this.CalculateHelper.ResetCalculateAggregations(n),this._owner.OnAfterRowDeleted(),this._owner.OnRowChanged(null,!0),this._owner.Grid_IsDirtyData=!0}},OnRemoveRowAlways:function(){if(this.GridCRUDHelper!=null&&!this._owner.m_gridReadOnly){if(this._owner.m_rows<1)return;if(!this._owner.OnBeforeRowDelete()){var n=this.GetSumColumnsDataList();this._owner.m_rows==1?this._owner.m_gridBodyEventsHandler!=null&&this._owner.m_gridBodyEventsHandler.ClearData():this.GridCRUDHelper.DeleteRow(this._owner.m_currentRowIndex),this._owner.m_tableDimentionManager.AdjustTableHeadPosition(),this.CalculateHelper.ResetCalculateAggregations(n),this._owner.OnAfterRowDeleted(),this._owner.Grid_IsDirtyData=!0}}},GetSumColumnsDataList:function(){for(var t={},n=1;n<this._owner.m_columns;n++)this._owner.MainCols[n].cusAttr("HasSum")&&(t[this._owner.MainCols[n].cusAttr("FieldID")]=this._owner.GetCellValue(this._owner.m_currentRowIndex,n).Value);return t},ResetNumberValue:function(n){for(var t=0;t<this._owner.MainCols.length;t++)this._owner.ControlArray[this._owner.MainCols[t].cusAttr("FieldID")]&&this._owner.ControlArray[this._owner.MainCols[t].cusAttr("FieldID")].control&&this._owner.ControlArray[this._owner.MainCols[t].cusAttr("FieldID")].control.get_Type()==ControlType.Numberic&&this._owner.MainCols[t].cusAttr("sf")!=this.UNDEFINED_VALUE&&(this._owner.SetDynamicScaleAndRoundType(t,this._owner.ControlArray[this._owner.MainCols[t].cusAttr("FieldID")]),this._owner.SetCellValue(n,t,this._owner.MainCols[t].cusAttr("DefaultValue")))},OnInsertRow:function(){var t,n,i;if(this.GridCRUDHelper!=null&&!this._owner.m_gridReadOnly){if(!this._owner.m_gridBodyEventsHandler.GridEditHelper.editMenuEnabled)return;if(this._owner.m_editMenuToolbar&&!this._owner.m_editMenuToolbar.editMenuManager.insertEnabled)return;if(this._owner.m_MaxRows>0&&this.tableBody.rows.length==this._owner.m_MaxRows)return!1;if(this.GridCRUDHelper.CanInsertRow(this._owner.m_currentRowIndex)){if(_ClientCallBackManager.Runing==!0){t="$find('"+this._owner.get_id()+"').m_editMenuToolbar.OnInsertClicked();",Global_JSQueueEvalAfterPageLoadedManager.Add(t),this._owner.m_gridFocusEventProcessed=!1;return}if(!this._owner.OnBeforeRowInsert())return this._owner.m_gridBodyEventsHandler.CanEndEdit(!1),this._owner.m_lastRowIndex=this._owner.m_currentRowIndex,this._owner.m_gridFaciesManager.lastRowIndex=this._owner.m_currentRowIndex,this._owner.m_gridFaciesManager.lastColumnIndex=this._owner.m_currentColumnIndex,this._owner.m_gridFaciesManager.OutCurrentCellStyle(),n=this.GridCRUDHelper.InsertRow(this._owner.m_currentRowIndex),this.GridCRUDHelper.UpdateRowDefaultData(n),this.ResetNumberValue(n),this._owner.m_currentRowIndex=n,this._owner.m_currentColumnIndex=this._owner.GetFirstColumn(),this._owner.m_gridFaciesManager.Focus(),this._owner.StartEdit(),this._owner.OnAfterRowInserted(n),this._owner.OnRowChanged(),i=this.GetSumColumnsDataList(),this.CalculateHelper.ResetAggForNewRow(i),this._owner.SetDefaultValue4P(n),this._owner.Grid_IsDirtyData=!0,this._owner.m_gridFaciesManager.SetOddEvenTrStyle(),n}}return-1},OnLayoutFocusOut:function(){this.GridEditMenu!=null},OnRowContentChanged:function(n,t,i){var r=!0,s=t.cusAttr("Status")===RowStatus.Empty,e,f,h,o,u;if(s){if(e=this.GetSumColumnsDataList(),f=this._owner.getCaculator(),!f)return;f.ResetAggForNewRow(e)}return i!=null?(r=this._owner.OnCellDataChanged(n,this._owner.m_currentRowIndex,i),this._owner.OnCellDataValueChanged(n,this._owner.m_currentRowIndex,i)):(r=this._owner.OnCellDataChanged(n,this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),this._owner.OnCellDataValueChanged(n,this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex)),this._owner.IsEmptyRow(t)&&(t.cusAttr("Status",RowStatus.Added),this._owner.set_TotalRows(this._owner.m_TotalRows+1),h=this._owner.SetDefaultValue4P(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),o=_ClientPostBackManager.Runing||_this.IsThisGirdPosting,o&&_ClientJSExecQueueManager.Push("$find('"+_this.get_id()+"').Focus(true);")),r&&(!this.autoAddNewRowOnLastCellReturn&&this.autoEditModel&&this._owner.m_currentRowIndex==this._owner.m_rows-1&&this.GridCRUDHelper!=null&&(this._owner.OnBeforeRowAdd()||(u=this.GridCRUDHelper.AddNewEmptyRow(),u!=-100&&(this.GridCRUDHelper.InitEmptyRow(u),this._owner.OnAfterRowAdded(u)))),t.cusAttr("Status")==RowStatus.UnChanged&&t.cusAttr("Status",RowStatus.Modified)),this._owner.OnRowContentChanged4P(n,this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex),r},OnBeforeRowChange:function(){return!0},RowInhibitChecked:function(n){var u=!0,f="",i,t,r;if(n>=0&&n<this.tableBody.rows.length&&(i=this.tableBody.rows[n],!this._owner.IsEmptyRow(i)))for(t=1;t<i.cells.length;t++)if(r=i.cells[t],(r.cusAttr("Value")==""||r.cusAttr("Value")==this._owner.UNDEFINED_VALUE)&&this._owner.MainCols[t].cusAttr("visible")&&this._owner.MainCols[t].cusAttr("IsNull")==DefaultSymbol.False){f=this._owner.MainCols[t].cusAttr("Name")+": "+MenuText.NotNullErrorMessage,u=!1;break}return!0},StartEdit:function(){if(this.CellEditHelper!=null&&!this._owner.m_gridReadOnly){var n=Get_Global_IsDirtyData_TheForm();this.CellEditActive=this.CellEditHelper.StartCellEdit(this.GetCurrentCell(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex)),Set_Global_IsDirtyData_TheForm(n),this._owner.StoreState("Y")}},AcceptEdit:function(){if(this.CellEditActive&&!this._owner.m_gridReadOnly&&this.CellEditHelper!=null){var n=this.GetCurrentCell(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex);if(this.CellEditHelper.AcceptCellEdit(n))try{this._owner.S_Body.focus(),n.focus(),this.CellEditActive=!1}catch(t){}}},EndEdit:function(n){if(this.CellEditHelper!=null&&!this._owner.m_gridReadOnly){var t=this.GetCurrentCell(this._owner.m_currentRowIndex,this._owner.m_currentColumnIndex);if(t==null)return;if(this.CellEditHelper.EndCellEdit(t)){try{!n,this.CellEditActive=!1}catch(i){}return!0}}return!1},GetCurrentCell:function(n,t){return n>=0&&n<this._owner.m_rows&&t>0&&t<this._owner.m_columns?this.tableBody.rows[n].cells[t]:null}},GridMenuManager=function(n,t,i,r,u){this._owner=u,this.thisControl=n,this.tableLayout=t,this.editHandler=r,this.tableBody=i,this.addEnabled=!1,this.deleteEnabled=!1,this.insertEnabled=!1,this.copyEnabled=!1,this.editEnabled=!1,this.menuInstance=null,this.ShowAllMenuButton=!0,this.canShowMenu=!0},GridMenuManager.prototype={dispose:function(){this.menuInstance&&(this.menuInstance.dispose(),this.menuInstance=null),this.quickMenuInstance&&(this.quickMenuInstance.dispose(),this.quickMenuInstance=null),this._owner=null,this.thisControl=null,this.tableLayout=null,this.editHandler=null,this.tableBody=null},Init:function(){this.thisControl.cusAttr("ShowAllMenuButton")=="false"&&(this.ShowAllMenuButton=!1),this.thisControl.cusAttr("AllowAddRow")!=this._owner.UNDEFINED_VALUE&&(this.addEnabled=!0),this.thisControl.cusAttr("AllowDelRow")!=this._owner.UNDEFINED_VALUE&&(this.deleteEnabled=!0),this.thisControl.cusAttr("AllowInsertRow")!=this._owner.UNDEFINED_VALUE&&(this.insertEnabled=!0),this.thisControl.cusAttr("AllowEditRow")!=this._owner.UNDEFINED_VALUE&&(this.editEnabled=!0),this.thisControl.cusAttr("AllowCopyRow")!=this._owner.UNDEFINED_VALUE&&(this.copyEnabled=!0),this.InitMenu(),this.displayFloatingMenu=this.thisControl.cusAttr("ShowFloatingMenu")==="False"?!1:!0,this.displayFloatingMenu===!1&&this.menuInstance.Hidden()},CreateMenu:function(){this.menuInstance=new EditMenuToolbar(this,this._owner),this.menuInstance.InitMenuToolbar(this.addEnabled,this.insertEnabled,this.deleteEnabled,this.editEnabled,this.copyEnabled,this.ShowAllMenuButton),this.menuInstance.AttachButtonEvents(),this.CreateQuickMenu(this.menuInstance)},CreateQuickMenu:function(n){this.quickMenuInstance=new QuickEditMenuToolbar(this,this._owner,n),this.quickMenuInstance.InitMenuToolbar(this.addEnabled,this.insertEnabled,this.deleteEnabled,this.editEnabled,this.copyEnabled,this.ShowAllMenuButton),this.quickMenuInstance.AttachButtonEvents()},InitMenu:function(){this._owner.m_gridReadOnly||this.menuInstance==null&&(this.CreateMenu(),this.thisControl.appendChild(this.menuInstance.GetMenuToolbar()))},ShowMenu:function(n){if(this.displayFloatingMenu!==!1&&!this._owner.GetIsBatchModifyRunning()&&!this._owner.m_gridReadOnly){this.menuInstance==null&&(this.CreateMenu(),this.thisControl.appendChild(this.menuInstance.GetMenuToolbar())),this.menuInstance.Display();var t=0;t=this._owner.D_Body.rows.length>0?this.GetRowTopPosition(n):20,this.menuInstance.Binding(this.thisControl,t)}},GetRowTopPosition:function(n){var i=this.tableBody.rows[n],t=i.offsetTop-this.tableLayout.scrollTop+i.offsetHeight;return this._owner.m_currentRowIndex==this.tableBody.rows.length-1&&i.offsetHeight+i.offsetTop+10>=this.tableLayout.offsetHeight&&(t=t-40),this._owner.get_element().offsetHeight-25<t&&(t=this._owner.get_element().offsetHeight-25),t},GetMenuVisible:function(){return this.menuInstance!=null&&this.menuInstance.menuLayout?this.menuInstance.menuLayout.style.display!="none":!1},HideMenu:function(){this.menuInstance!=null&&this.menuInstance.Hidden()},OnAddEvent:function(){this.addEnabled&&this.editHandler.OnAddRow()},OnInsertEvent:function(){this.insertEnabled&&this.editHandler.OnInsertRow()},OnDeleteEvent:function(){this.deleteEnabled&&this.editHandler.OnRemoveRow()},OnCopyRowEvent:function(){this.copyEnabled&&_ClientCallBackManager.Runing!=!0&&this.editHandler.OnCopyRow()},CanShowMenu:function(n){if(n==undefined)return this.canShowMenu;this.canShowMenu=n}},QuickEditMenuToolbar=function(n,t,i){var r=this;this._owner=t,this.editMenuManager=n,this.addButton=null,this.insertButton=null,this.deleteButton=null,this.copyButton=null,this.menuLayout=null,this._owner.m_toolbarDiv!=null&&(this.menuLayout=this._owner.m_toolbarDiv.rows[0].cells[0]),this.editMenuToolbar=i,this.OnAddClicked=this.editMenuToolbar.OnAddClicked,this.OnDeleteClicked=this.editMenuToolbar.OnDeleteClicked,this.OnInsertClicked=this.editMenuToolbar.OnInsertClicked,this.OnEditAllClicked=this.editMenuToolbar.OnEditAllClicked,this.OnCopyClicked=this.editMenuToolbar.OnCopyClicked},QuickEditMenuToolbar.prototype={dispose:function(){this._owner=null,this.DetachButtonEvents(),this.editMenuManager=null,this.closeButton=null,this.addButton=null,this.insertButton=null,this.deleteButton=null,this.menuLayout=null,this.editAllButton=null,this.copyButton=null,this.editMenuToolbar=null},AttachButtonEvents:function(){this.closeButton!=null&&(this.closeButton.onclick=this.OnCloseClicked),this.addButton!=null&&(this.addButton.onclick=this.OnAddClicked),this.insertButton!=null&&(this.insertButton.onclick=this.OnInsertClicked),this.deleteButton!=null&&(this.deleteButton.onclick=this.OnDeleteClicked),this.editAllButton!=null&&(this.editAllButton.onclick=this.OnEditAllClicked),this.copyButton!=null&&(this.copyButton.onclick=this.OnCopyClicked)},DetachButtonEvents:function(){this.closeButton!=null&&$(this.closeButton).unbind("click",this.OnCloseClicked),this.addButton!=null&&$(this.addButton).unbind("click",this.OnAddClicked),this.insertButton!=null&&$(this.insertButton).unbind("click",this.OnInsertClicked),this.deleteButton!=null&&$(this.deleteButton).unbind("click",this.OnDeleteClicked),this.editAllButton!=null&&$(this.editAllButton).unbind("click",this.OnEditAllClicked),this.copyButton!=null&&$(this.copyButton).unbind("click",this.OnCopyClicked)},InitMenuToolbar:function(){var o,e;if(this.menuLayout==null)return this;for(o=0;o<this.menuLayout.children.length;o++)e=this.menuLayout.children[o],e.id=="add"&&(this.addButton=e),e.id=="insert"&&(this.insertButton=e),e.id=="del"&&(this.deleteButton=e),e.id=="editall"&&(this.editAllButton=e),e.id=="copy"&&(this.copyButton=e);return this._owner.m_quickEditMenuToolbar=this,this},ResetMenuStatus:function(n,t){this.editMenuManager&&(n=="AddButton"&&this.addButton&&(this.addButton.className=t?"add":"add_disabled",this.addButton.disabled=!t),n=="InsertButton"&&this.insertButton&&(this.insertButton.className=t?"insert":"insert_disabled",this.insertButton.disabled=!t),n=="DelButton"&&this.deleteButton&&(this.deleteButton.className=t?"del":"del_disabled",this.deleteButton.disabled=!t))},GetMenuToolbar:function(){return this.menuLayout}},EditMenuToolbar=function(n,t){var i=this;this._owner=t,this.id=t.get_id()+"_editMenu",this.editMenuManager=n,this.closeButton=null,this.addButton=null,this.insertButton=null,this.deleteButton=null,this.menuLayout=null,this.copyButton=null,this.OnCloseClicked=function(){i.Hidden()},this.OnAddClicked=function(){i._owner.m_gridFocusEventProcessed=!0,i._owner.m_editMenuToolbar.editMenuManager!=null&&i._owner.m_editMenuToolbar.editMenuManager.OnAddEvent()},this.OnDeleteClicked=function(){i._owner.m_gridFocusEventProcessed=!0,i._owner.m_editMenuToolbar.editMenuManager!=null&&i._owner.m_editMenuToolbar.editMenuManager.OnDeleteEvent()},this.OnInsertClicked=function(){i._owner.m_gridFocusEventProcessed=!0,i._owner.m_editMenuToolbar.editMenuManager!=null&&i._owner.m_editMenuToolbar.editMenuManager.OnInsertEvent()},this.OnEditAllClicked=function(){var t,f,u,r;if(n.editEnabled&&i._owner.D_Body.rows.length>1){if(this.m_currentRowIndex<0)return;if(i._owner.GetRowStatus(this.m_currentRowIndex)==RowStatus.Empty)return;if(i._owner.GetCurrentColumnsInfor(),i._owner._columnsInforForEdit!==null&&i._owner._columnsInforForEdit.length===0)return;UF.UI.Reference.DisableShowForm=!0,i._owner.m_gridBodyEventsHandler.CanEndEdit(!1),i._owner.m_gridFaciesManager.SetSelectCellBorder(i._owner.m_currentRowIndex,i._owner.m_currentColumnIndex,!1),t="../ufsoft/GridEdit.aspx",t=AppendPopupUrl(t),t+=i._owner.get_element().cusAttr("IsCondtionBatch")==="True"?"&IsCondtionBatch=true":"&IsCondtionBatch=false",f="status:off;dialogWidth:640px;dialogHeight:400px",i._owner.window=window,window.retvShowGridEdit?window.retvShowGridEdit.window||(window.retvShowGridEdit=null):i._owner.IsThisGirdPosting?(u="var gObj={}; gObj.win=window; gObj.gridId='"+i._owner.get_id()+"';",u+='window.retvShowGridEdit = window.showModelessDialog("'+t.replace(/"/g,'\\"')+'",gObj,"'+f+'");',_ClientJSExecQueueManager.Push(u)):(r={},r.win=window,r.gridId=i._owner.get_id(),zlayer.open({title:"批量修改",area:["660px","400px"],argument:r,content:t,endHandle:function(n){window.retvShowGridEdit=n,window.retvShowGridEdit=null}}))}},this.OnCopyClicked=function(){i._owner.m_gridFocusEventProcessed=!0,i._owner.m_editMenuToolbar.editMenuManager!=null&&i._owner.m_editMenuToolbar.editMenuManager.OnCopyRowEvent()}},EditMenuToolbar.prototype={dispose:function(){this._owner=null,this.DetachButtonEvents(),this.editMenuManager=null,this.closeButton=null,this.addButton=null,this.insertButton=null,this.deleteButton=null,this.menuLayout=null,this.editAllButton=null,this.copyButton=null},AttachButtonEvents:function(){this.closeButton!=null&&(this.closeButton.onclick=this.OnCloseClicked),this.addButton!=null&&(this.addButton.onclick=this.OnAddClicked),this.insertButton!=null&&(this.insertButton.onclick=this.OnInsertClicked),this.deleteButton!=null&&(this.deleteButton.onclick=this.OnDeleteClicked),this.editAllButton!=null&&(this.editAllButton.onclick=this.OnEditAllClicked),this.copyButton!=null&&(this.copyButton.onclick=this.OnCopyClicked)},DetachButtonEvents:function(){this.closeButton!=null&&$(this.closeButton).unbind("click",this.OnCloseClicked),this.addButton!=null&&$(this.addButton).unbind("click",this.OnAddClicked),this.insertButton!=null&&$(this.insertButton).unbind("click",this.OnInsertClicked),this.deleteButton!=null&&$(this.deleteButton).unbind("click",this.OnDeleteClicked),this.editAllButton!=null&&$(this.editAllButton).unbind("click",this.OnEditAllClicked),this.copyButton!=null&&$(this.copyButton).unbind("click",this.OnCopyClicked)},InitMenuToolbar:function(n,t,i,r,u,f){this.Create(n,t,i,r,u,f),this._owner.m_editMenuToolbar=this},GetMenuToolbar:function(){return this.menuLayout},Toggle:function(){this.menuLayout.style.display=="none"?(this.editMenuManager.CanShowMenu(!0),this.editMenuManager.ShowMenu(this._owner.m_currentRowIndex)):(this.editMenuManager.CanShowMenu(!1),this.Hidden())},Hidden:function(){this.menuLayout.style.display="none"},Display:function(){this.editMenuManager.CanShowMenu()&&(this.menuLayout.style.display="")},Binding:function(n,t){var r=n.getBoundingClientRect(),o=t,u=this.GetColumnWidths(),f=r.right-r.left,e=this.menuLayout.offsetWidth,i=0;i=u+e>f?f-e:u,this.menuLayout.style.top=o+"px",this.menuLayout.style.left=i+"px"},GetColumnWidths:function(){for(var t=15,n=1;n<this._owner.m_columns;n++)this._owner.MainCols[n].cusAttr("visible")&&(t=t+parseInt(this._owner.MainCols[n].width,10));return t},ResetMenuStatus:function(n,t){var i,r;this.editMenuManager&&(i=null,n=="AddButton"&&(this.editMenuManager.addEnabled=t,i=this.addButton),n=="InsertButton"&&(this.editMenuManager.insertEnabled=t,i=this.insertButton),n=="DelButton"&&(this.editMenuManager.deleteEnabled=t,i=this.deleteButton),i!=null&&(r=t?"":DefaultSymbol.DisabledColor,i.style.color=r),this.editMenuManager.quickMenuInstance&&this.editMenuManager.quickMenuInstance.ResetMenuStatus(n,t))},Create:function(n,t,i,r,u,f){var h,a={id:this.id,style:"table-layout:fixed;z-index:99;font-size:9pt;position:absolute;left:-1999px;",cellpadding:0,cellspacing:0},s,c,l,o,e;h=$E(document).createElement("table",a),s=h.insertRow(-1),$(s).attr("height",23),c=$E(window.document).createElement("td",{width:"27px"}),l=document.createElement("img"),l.src="../App_Themes/default/images/Listleft.gif",c.appendChild(l),s.appendChild(c),(n||f)&&(o=document.createElement("td"),o.className="GridMenuItem",o.align="center",o.vAlign="middle",e=document.createElement("div"),e.className="GridMenuButton",e.style.cursor="hand",e.innerText=MenuText.Add,e.title="Ctrl+Insert",n||(e.style.color=DefaultSymbol.DisabledColor),this.addButton=e,o.appendChild(e),s.appendChild(o)),(t||f)&&(o=document.createElement("td"),o.className="GridMenuItem",o.align="center",o.vAlign="middle",e=document.createElement("div"),e.style.cursor="hand",e.className="GridMenuButton",e.innerText=MenuText.Insert,e.title="Insert",t||(e.style.color=DefaultSymbol.DisabledColor),this.insertButton=e,o.appendChild(e),s.appendChild(o)),(i||f)&&(o=document.createElement("td"),o.className="GridMenuItem",o.align="center",o.vAlign="middle",e=document.createElement("div"),e.className="GridMenuButton",e.style.cursor="hand",e.innerText=MenuText.Del,e.title="ESC+Del",i||(e.style.color=DefaultSymbol.DisabledColor),this.deleteButton=e,o.appendChild(e),s.appendChild(o)),(r||f)&&(o=document.createElement("td"),o.className="GridMenuItemEnd",o.align="center",o.vAlign="middle",e=document.createElement("div"),e.className="GridMenuButton",e.style.width="60px",e.style.cursor="hand",e.innerText=MenuText.EditAll,e.title="Edit",r||(e.style.color=DefaultSymbol.DisabledColor),this.editAllButton=e,o.appendChild(e),s.appendChild(o)),u&&(o=document.createElement("td"),o.className="GridMenuItem",o.align="center",o.vAlign="middle",e=document.createElement("div"),e.className="GridMenuButton",e.style.cursor="hand",e.innerText=MenuText.Copy,u||(e.style.color=DefaultSymbol.DisabledColor),this.copyButton=e,o.appendChild(e),s.appendChild(o)),f&&(o=document.createElement("td"),o.className="GridMenuItem",o.align="center",o.vAlign="middle",e=document.createElement("div"),e.className="GridMenuButton",e.style.cursor="hand",e.innerText=MenuText.Close,e.title="Ctrl+Close",this.closeButton=e,o.appendChild(e),s.appendChild(o)),r||i||t||n||f||(h.rows[0].cells[0].style.display="none"),h.style.display="none",this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Edit&&this._owner.GetSelectedRows().length>0&&(h.style.display=""),this.menuLayout=h}},GridCRUDHelper=function(n,t,i,r){this._owner=r,this.thisControl=n,this.tableBody=t,this.editHandler=i,this.defaultRowHeight="20"},GridCRUDHelper.prototype={dispose:function(){this._owner=null,this.thisControl=null,this.tableBody=null,this.editHandler=null},Init:function(){this.defaultRowHeight=this.thisControl.cusAttr("DefaultRowHeight")},CreateNewRow:function(){var n=null,i=document.createElement("tr"),t;for(i.setAttribute("height",this.defaultRowHeight),n=document.createElement("td"),n.className=this._owner.m_FrozenControlColumn?DefaultSymbol.csstcc+" "+DefaultSymbol.cssFixedColumnDataCell:DefaultSymbol.csstcc,this._owner.get_element().cusAttr("SelectModel")=="mulitline"?n.appendChild($E(window.document).createElement("input",{type:"checkbox"})):this._owner.setCellListValue(n,""),$(n).attr("align","center"),i.appendChild(n),t=1;t<this._owner.m_columns;t++)n=document.createElement("td"),this._owner.MainCols[t].cusAttr("visible")&&this._owner.MainCols[t].cusAttr("visibleEx")?n.className=DefaultSymbol.csstbc:n.style.display="none",$(n).attr("align",this._owner.MainCols[t].getAttribute("align")),this._owner.MainCols[t].cusAttr("Frozen").toLowerCase()==DefaultSymbol.True&&(n.className+=" "+DefaultSymbol.cssFixedColumnDataCell),this._owner.MainCols[t].cusAttr("DefaultBgColor")!=null&&(n.bgColor=n.style.backgroundColor=this._owner.MainCols[t].cusAttr("DefaultBgColor")),this._owner.MainCols[t].cusAttr("DefaultFontColor")!=null&&(n.style.color=this._owner.MainCols[t].cusAttr("DefaultFontColor")),n.cusAttr("Value",""),this._owner.setCellListValue(n,""),i.appendChild(n);return i},AddNewRow:function(){var n=this.CreateNewRow();return n.cusAttr("Status",RowStatus.Added),this.tableBody.appendChild(n),this.SetPreviousEmptyRowToAdd(this._owner.m_rows-1),this._owner.m_rows=this._owner.m_rows+1,this._owner.set_TotalRows(this._owner.m_TotalRows+1),this._owner.m_rows-1},SetPreviousEmptyRowToAdd:function(n){if(n>=0){var t=this.tableBody.rows[n];t.cusAttr("Status")==RowStatus.Empty&&t.cusAttr("Status",RowStatus.Added)}},AddNewEmptyRow:function(){if(top.DataGridAutoAddNewEmptyRow||(top.DataGridAutoAddNewEmptyRow=[]),top.DataGridAutoAddNewEmptyRow[this._owner.get_id()]=!0,this._owner.m_MaxRows>0&&this.tableBody.rows.length==this._owner.m_MaxRows)return-100;var n=this.CreateNewRow();return n.cusAttr("Status",RowStatus.Empty),this.tableBody.appendChild(n),this._owner.m_rows=this._owner.m_rows+1,this._owner.m_rows-1},InsertRow:function(){var t=this.CreateNewRow(),i;return t.cusAttr("Status",RowStatus.Added),i=this.tableBody.rows[this._owner.m_currentRowIndex],i==this._owner.UNDEFINED_VALUE?this.tableBody.appendChild(t):this.tableBody.insertBefore(t,i),this._owner.m_rows=this._owner.m_rows+1,this._owner.set_TotalRows(this._owner.m_TotalRows+1),this._owner.m_currentRowIndex},DeleteRow:function(n){var i,f,u,t,r;n>=0&&n<this._owner.m_rows&&this.tableBody.rows.length>0&&(this._owner.m_rows==1?(i=this.tableBody.rows[n],i.cusAttr("Status")!=RowStatus.Empty&&(i.cusAttr("Status",RowStatus.Deleted),this._owner.m_deletedRows.push(this._owner.GetRowXml(this._owner.dataDom,i,n)),this.editHandler.autoEditModel?(this.ClearRow(i),this.UpdateRowDefaultData(n),i.cusAttr("Status",RowStatus.Empty)):(this.tableBody.deleteRow(n),this._owner.m_rows=0),this._owner.m_currentRowIndex=0,this._owner.set_TotalRows(this._owner.m_TotalRows-1),f=this._owner.get_element().cusAttr("_autoturn"),f!==undefined&&this._owner.get_IsPaging()&&(u=0,u=this._owner.m_PageIndex==0?0:this._owner.m_PageIndex==this._owner.m_PageCount-1?this._owner.m_PageIndex-1:this._owner.m_PageIndex,this._owner.OnMovePage("GotoPage",u)))):(t=this.tableBody.rows[n],t.cusAttr("Status")==RowStatus.Modified||t.cusAttr("Status")==RowStatus.UnChanged?(t.cusAttr("Status",RowStatus.Deleted),this._owner.m_deletedRows.push(this._owner.GetRowXml(this._owner.dataDom,t,n))):t.cusAttr("Status")==RowStatus.Empty&&top.DataGridAutoAddNewEmptyRow&&(top.DataGridAutoAddNewEmptyRow[this._owner.get_id()]=!1),t.cusAttr("Status")!=RowStatus.Empty&&this._owner.set_TotalRows(this._owner.m_TotalRows-1),this.tableBody.deleteRow(n),this._owner.m_rows=this._owner.m_rows-1,this._owner.m_rows==1?this._owner.m_currentRowIndex=0:(r=this._owner.m_rows,this.tableBody.rows[r-1].cusAttr("Status")==RowStatus.Empty&&(r=r-1),this._owner.m_currentRowIndex==r&&(this._owner.m_currentRowIndex=r-1))))},RemoveRow:function(n){var t,i;n>=0&&n<this._owner.m_rows&&this.tableBody.rows.length>0&&(this._owner.m_rows==1?(t=this.tableBody.rows[n],t.cusAttr("Status")!=RowStatus.Empty&&(this.editHandler.autoEditModel?(this.ClearRow(t),this.UpdateRowDefaultData(n),t.cusAttr("Status",RowStatus.Empty)):(this.tableBody.deleteRow(n),this._owner.m_rows=0),this._owner.m_currentRowIndex=0,this._owner.set_TotalRows(this._owner.m_TotalRows-1))):(i=this.tableBody.rows[n],i.cusAttr("Status")!=RowStatus.Empty&&this._owner.set_TotalRows(this._owner.m_TotalRows-1),this.tableBody.deleteRow(n),this._owner.m_rows=this._owner.m_rows-1,this._owner.m_rows==1?this._owner.m_currentRowIndex=0:this._owner.m_currentRowIndex==this._owner.m_rows&&(this._owner.m_currentRowIndex=this._owner.m_currentRowIndex-1)))},InitEmptyRow:function(n){this.UpdateRowDefaultData(n);var t=this.tableBody.rows[n];t&&t.cusAttr("Status",RowStatus.Empty)},UpdateRowDefaultData:function(n,t){var e,u,i,r,f;if(n>=0&&n<this._owner.m_rows)for(e=this.tableBody.rows[n],u=1;u<this._owner.m_columns;u++)if(i=this.GetCellDefaultValue(this._owner.MainCols[u],n,u),r=e.cells[u],r.cusAttr("Value")=="")if(this._owner.MainCols[u].cusAttr("ControlType")==ControlType.CheckBox&&(i=="true"||(i="false")),i!=this._owner.UNDEFINED_VALUE&&i!="")switch(this._owner.MainCols[u].cusAttr("ControlType")){case ControlType.CheckBox:r.cusAttr("Value",i),this._owner.setCellListValue(r,this._owner.GetCheckBoxTextByValue(i,this._owner.MainCols[u].cusAttr("CheckBoxValueRef")));break;case ControlType.Combox:r.cusAttr("Value",i),this._owner.setCellListValue(r,this._owner.GetComboxTextbyID(u,i));break;case ControlType.Date:r.cusAttr("Value",i),this._owner.setCellListValue(r,this._owner.GetDateFormatedValue(i,u));break;case ControlType.RefControl:this.SetReferenceDefaultValue(r,i);break;case ControlType.Numberic:f=this._owner.m_formatHelper.FormatCellNumber(u,n,i,r.cusAttr("Value"),t),r.cusAttr("Value",f.Value),this._owner.setCellListValue(r,f.Text);break;case ControlType.MultiInput:r.cusAttr("Value",i),r.cusAttr("MultiLang",this._owner.GetMultiinputData(i,u)),this._owner.setCellListValue(r,i);break;default:r.cusAttr("Value",i),this._owner.setCellListValue(r,this._owner.GetFormatedValue(i,this._owner.MainCols[u].cusAttr("DataType"),this._owner.MainCols[u].cusAttr("DisplayFormat")))}else this._owner.setCellListValue(r,"")},CopyRowData:function(n,t){var i,e,r;if(n>=0&&n<this._owner.m_rows&&t>=0&&t<this._owner.m_rows){var s=this.tableBody.rows[t],o=this.tableBody.rows[n],u=null,f=[];for(i=1;i<this._owner.m_columns;i++)u=this._owner.MainCols[i],u.cusAttr("FieldID")!="ID"&&u.cusAttr("IsSequence")==this._owner.UNDEFINED_VALUE?(r=this._owner.GetCellValue(t,i),this._owner.SetReferenceCellValue(n,i,r.Value,r.Code,r.Text),this._owner.GetColumnType(i)==ControlType.Numberic&&f.push(i)):u.cusAttr("FieldID")=="ID"&&o.cusAttr("CopyRowArg",this._owner.GetCellValue(t,i).Value);for(i=0;i<f.length;i++)e=f[i],r=this._owner.GetCellValue(t,e),this._owner.SetReferenceCellValue(n,e,r.Value,r.Code,r.Text)}},SetRowData:function(n,t){var i,e,r;if(n>=0&&n<this._owner.m_rows&&t){var o=this.tableBody.rows[n],u=null,f=[];for(i=1;i<this._owner.m_columns;i++)u=this._owner.MainCols[i],u.cusAttr("FieldID")!="ID"&&u.cusAttr("IsSequence")==this._owner.UNDEFINED_VALUE?(r=t[u.cusAttr("FieldID")],this._owner.SetReferenceCellValue(n,i,r.Value,r.Code,r.Text),this._owner.GetColumnType(i)==ControlType.Numberic&&f.push(i)):u.cusAttr("FieldID")=="ID"&&o.cusAttr("CopyRowArg",t[u.cusAttr("FieldID")].Value);for(i=0;i<f.length;i++)e=f[i],r=t[this._owner.MainCols[e].cusAttr("FieldID")],this._owner.SetReferenceCellValue(n,e,r.Value,r.Code,r.Text)}},GetRowDataXmlStr:function(n){var t=Basic.GetXmlDom(),i=this._owner.GetRowXml(t,this._owner.D_Body.rows[n],n);return encodeURIComponent(XMLHelper.serializeXMLNodeToString(i))},GetRowDataFromXml:function(n){var t,i,u;if(n){var n=decodeURIComponent(n),o=Basic._loadXML(n),f={},e=null,r=null;for(t=1;t<this._owner.m_columns;t++)e=this._owner.MainCols[t],r=o.documentElement.childNodes[t-1],i=new CellValue(r.getAttribute("V")),u=r.getAttribute("R"),i.Text=this._owner.m_gridFaciesManager.GetRefNameAttribute(u),i.Code=this._owner.m_gridFaciesManager.GetRefCodeAttribute(u),f[e.cusAttr("FieldID")]=i;return f}return null},SetReferenceDefaultValue:function(n,t){var i=t.split(this._owner.RefSplitter2);i.length==3&&(this._owner.setCellListValue(n,i[2]),n.cusAttr("Value",i[0]),i.shift(),n.cusAttr("R",i.join(this._owner.RefSplitter2)),n.title=i[1])},CanInsertRow:function(n){var i;if(n>=0&&n<this._owner.m_rows)for(i=1;i<this._owner.m_columns;i++){var t=this._owner.MainCols[i],f=!0,r=t.cusAttr("DefaultValue");if(t.cusAttr("IsSequence")!=this._owner.UNDEFINED_VALUE){if(t.cusAttr("FieldID")=="ID")continue;var e=parseInt(t.cusAttr("SequenceStart"),10),o=parseInt(t.cusAttr("SequenceStep"),10),u=0;if(u=t.cusAttr("AutoStart")==this._owner.UNDEFINED_VALUE?e:parseInt(t.cusAttr("AutoStart"),10),r=this.GetInsertedRowNo(n,i,u,o,e),r==0&&(r=""),r==""){f=!1;break}}}return f},GetInsertedRowNo:function(n,t,i,r,u){var e=-1,f,o;if(n<this._owner.m_rows&&n>=0){if(f=u-r,o=this.GetRowAutoIndex(n,t),n>0&&(f=this.GetRowAutoIndex(n-1,t)),f<0)return"";o-f>r?e=f+r:o-f>1?e=f+1:o-f==1&&n==0&&(e=f)}return e==-1?"":(e!="",e.toString())},GetCellDefaultValue:function(n,t,i){var r=n.cusAttr("DefaultValue"),o;if(n.cusAttr("IsSequence")!=this._owner.UNDEFINED_VALUE){var u=parseInt(n.cusAttr("SequenceStart"),10),f=parseInt(n.cusAttr("SequenceStep"),10),e=0;if(e=n.cusAttr("AutoStart")==this._owner.UNDEFINED_VALUE?u:parseInt(n.cusAttr("AutoStart"),10),n.cusAttr("FieldID")=="ID")return r=u.toString()+100,u.toString().length>=16&&(r="-"+u.toString()),n.cusAttr("SequenceStart",(u+f).toString()),r;o=this._owner.D_Body.rows[t],r=o.cusAttr("Status")==RowStatus.Deleted?u-f:o.cusAttr("Status")==RowStatus.Added&&t==0?u-f:this.GetInsertedRowID(t,i,e,f,u),r==0&&(r=""),r==""&&(e=e+f,n.cusAttr("AutoStart",e.toString())),this._owner.m_ArrNos[0]=u-f,this._owner.m_ArrNos[t]=r}return r},DefaultValueReset:function(n,t,i){var u,r;return t==-1?"":(u="",this._owner.m_gridFaciesManager!=null&&i>=0&&(r=this._owner.m_gridFaciesManager.GetCellValue(t,i),r!=null&&(u=r.Code?r.Value+this._owner.RefSplitter2+r.Code+this._owner.RefSplitter2+r.Text:r.Value)),u)},NeedGetID:function(n,t){var r=!0,i=n,u;return t?i++:i--,this._owner.D_Body.rows.length>i&&(u=this._owner.D_Body.rows[i],u.cusAttr("Status")==RowStatus.UnChanged&&(r=!1)),r},GetInsertedRowID:function(n,t,i,r,u){var e=-1,f,o;if(n<this._owner.m_rows&&n>=0){if(n+1==this._owner.m_rows&&this.GetRowAutoIndex(n-1,t)<u)return u;if(f=u,o=this.GetRowAutoIndex(n+1,t),n>0&&(f=this.GetRowAutoIndex(n-1,t)),f<0)return"";o==-1&&f!=-1?e=f+r:o-f>r?e=f+r:o-f>1&&(e=this.GetInsertedRowNnumber(f,o))}return e==-1?"":e.toString()},GetInsertedRowNnumber:function(n,t,i){i!=null&&(i=i.toString());var r=i?i:this._owner.GetInsertedRowNoType();switch(r){case InsertedRowNoType.Floor:return n+1;case InsertedRowNoType.LowAverage:return Math.floor((n+t)/2);case InsertedRowNoType.HighAverage:return Math.ceil((n+t)/2);case InsertedRowNoType.Ceil:return t-1;default:return Math.ceil((n+t)/2)}},GetRowAutoIndex:function(n,t){var i=-1,r,u,f;return this.tableBody!=null&&(r=this.tableBody.rows,n<r.length&&(u=this.tableBody.rows[n],f=u.cells[t],i=parseInt(f.cusAttr("Value"),10),isNaN(i)&&(i=-1))),i},ClearRow:function(n){if(n!=this._owner.UNDEFINED_VALUE)for(var t=1;t<this._owner.m_columns;t++)this.ClearCell(n.cells[t])},ClearCell:function(n){n.cusAttr("Value")!=this._owner.UNDEFINED_VALUE&&n.cusAttr("Value",""),n.cusAttr("MultiLang")!=this._owner.UNDEFINED_VALUE&&n.cusAttr("MultiLang",""),n.cusAttr("R")!=this._owner.UNDEFINED_VALUE&&(n.cusAttr("R",""),n.title=""),this._owner.setCellListValue(n,"")}},CellEditHelper=function(n,t,i){this._owner=i,this.tableBody=n,this.editManager=t,this.calculate=null},CellEditHelper.prototype={dispose:function(){this._owner=null,this.tableBody=null,this.editManager=null,this.calculate=null},AttachCalculate:function(n){this.calculate=n},AcceptCellEdit:function(n){switch(this._owner.GetColumnType(this._owner.m_currentColumnIndex)){case ControlType.CheckBox:this.SelectCheckBox(n)}return!1},StartCellEdit:function(n){var h=Get_Global_IsDirtyData_TheForm(),r=!1,t,i,e,o,u,s,f;if(this.CellEditEnabled(this._owner.m_currentColumnIndex,n)){if(t=this._owner.m_currentColumnIndex,i=null,this._owner.MainCols[t].cusAttr("ColEditCtrlClientID4P")&&(i=this._owner.MainCols[t].cusAttr("ColEditCtrlClientID4P")),this._owner.MainCols[t].cusAttr("ReplaceColumn")&&(e=this._owner.MainCols[t].cusAttr("ReplaceColumn"),e!==""&&(t=this._owner.GetColumnIndex(e),o=this._owner.D_Body.rows[this._owner.m_currentRowIndex],o&&o.cusAttr("Status")==RowStatus.UnChanged&&this._owner.m_gridFaciesManager&&n.cusAttr("Value",this._owner.m_gridFaciesManager.GetCellValue(this._owner.m_currentRowIndex,t).Value))),n.children.length==1&&(n.children[0].tagName=="SPAN"||n.children[0].tagName=="INPUT")){n.children[0].tagName=="INPUT"&&(n.children[0].focus(),r=!0),u=n.children[0],s=u.control;switch(this._owner.GetColumnType(t)){case ControlType.Numberic:u.children[0].focus(),s.input_onfocus();break;default:try{u.children[0].focus()}catch(c){}}r=!0}else{$find(i)?($find(i).set_IsRaiseEvent(!1),$find(i).set_IsPersonalProcess(!1)):i=null;switch(this._owner.GetColumnType(t)){case ControlType.TextBox:r=this.CreateTextBox(n,t,i);break;case ControlType.CheckBox:r=this.CreateCheckBox(n,t,i);break;case ControlType.Date:r=this.CreateDatePicker(n,t,i);break;case ControlType.Combox:r=this.CreateCombox(n,t,i);break;case ControlType.TextArea:r=this.CreateTextArea(n,t,i);break;case ControlType.RefControl:r=this.CreateReference(n,t,i);break;case ControlType.MultiInput:(n.cusAttr("MultiLang")==this._owner.UNDEFINED_VALUE||n.cusAttr("Value")!=""&&n.cusAttr("MultiLang")=="")&&n.cusAttr("MultiLang",this._owner.GetMultiinputData(n.cusAttr("Value"),t)),r=this.CreateMultiInput(n,t,null);break;case ControlType.Numberic:r=this.CreateNumbericInput(n,t,this._owner.m_currentRowIndex,i)}$find(i)&&(r?($find(i).set_IsRaiseEvent(!0),$find(i).set_IsPersonalProcess(!1)):($find(i).set_IsRaiseEvent(!0),$find(i).set_IsPersonalProcess(!0)))}r&&this._owner.OnCellFocusEnter()}else{if(this._owner.MainCols[this._owner.m_currentColumnIndex].cusAttr("ControlType")==ControlType.TextBox&&n&&(n.title=n.innerText),window.document.selection&&window.document.selection.createRange().text.length>0)return;if(window.document.getSelection()&&window.document.getSelection().isCollapsed==!1)return;if(f=document.getElementById(this._owner.get_element().id+"_GB"),f)try{f.focus(),f.onkeydown=this.aaEvent}catch(c){}this._owner.StoreState("Y"),this._owner.GridIsInFocus=!0}return this._owner.Grid_IsDirtyData==!0?Set_Global_IsDirtyData_TheForm(this._owner.Grid_IsDirtyData):Set_Global_IsDirtyData_TheForm(h),r},aaEvent:function(){event.srcElement.parentElement.parentElement.control.Focus(),event.srcElement.parentElement.parentElement.control.m_gridBodyEventsHandler.CellKeyDownReceive()},inhibitCheck:function(n,t){var c=!0,r="",i=null,l,f,e,o,s,h,u;if(this._owner.MainCols[t].cusAttr("IsNull")==DefaultSymbol.False){switch(this._owner.GetColumnType(t)){case ControlType.TextBox:c=!1,l=n.getElementsByTagName("input"),l!=null&&(i=l[0],i=$find(i.id),r=i.get_Value());break;case ControlType.Date:f=n.children[0],f!=null&&f.tagName!="NOBR"&&f.className!="FixedInner"&&(f=$find(f.id),i=f,r=f.get_Value());break;case ControlType.Combox:e=n.children[0],e!=null&&e.tagName!="NOBR"&&e.className!="FixedInner"&&(e=$find(e.id),i=e,r=e.get_Value());break;case ControlType.TextArea:o=n.children[0],o!=null&&o.tagName!="NOBR"&&o.className!="FixedInner"&&(o=$find(o.id),i=o,r=o.get_Value(),c=!1);break;case ControlType.RefControl:s=n.children[0],s!=null&&s.tagName!="NOBR"&&s.className!="FixedInner"&&(s=$find(s.id),i=s,r=s.get_Key());break;case ControlType.MultiInput:h=n.children[0],(h!=null||h.tagName!="NOBR"&&h.className!="FixedInner")&&(h=$find(h.id),i=h,r=h.get_Value());break;case ControlType.Numberic:u=n.children[0],u!=null&&u.tagName!="NOBR"&&u.className!="FixedInner"&&(u=$find(u.id),i=u,u.get_Value()!=null&&(r=u.get_Value().toString()));break;default:return!0}if(r==""||r==null){if(window.alert(this._owner.MainCols[t].cusAttr("Name")+": "+MenuText.NotNullErrorMessage),i!=null)try{c?i.SetFocus():i.focus()}catch(a){}return!1}}return!0},EndCellEdit:function(n,t){var u=!1,i=-1,o,r,f,e,s,h;i=t==undefined?this._owner.m_currentColumnIndex:t,o=i,r=null,this._owner.MainCols[i].cusAttr("ColEditCtrlClientID4P")&&(r=this._owner.MainCols[i].cusAttr("ColEditCtrlClientID4P")),this._owner.MainCols[i].cusAttr("ReplaceColumn")&&(f=this._owner.MainCols[i].cusAttr("ReplaceColumn"),f!==""&&(i=this._owner.GetColumnIndex(f))),r&&$find(r)&&($find(r).set_IsRaiseEvent(!1),$find(r).set_IsPersonalProcess(!0));switch(this._owner.GetColumnType(i)){case ControlType.TextBox:r&&$find(r)&&$find(r).set_IsRaiseEvent(!0),u=this.EndTextBoxInput(n,i);break;case ControlType.CheckBox:u=this.EndCheckBoxInput(n,i);break;case ControlType.Date:u=this.EndDatePickerInput(n,i);break;case ControlType.Combox:u=this.EndComboxInput(n,i);break;case ControlType.TextArea:u=this.EndTextAreaInput(n,i);break;case ControlType.RefControl:u=this.EndReferenceInput(n,i);break;case ControlType.MultiInput:r=null,u=this.EndMultiInput(n,i);break;case ControlType.Numberic:r&&$find(r)&&$find(r).set_IsRaiseEvent(!0),u=this.EndNumbericInput(n,i)}return u&&r&&$find(r)&&($find(r).set_IsRaiseEvent(!0),$find(r).set_IsPersonalProcess(!0)),i=o,this._owner.MainCols[i].cusAttr("ReplaceColumn")&&(f=this._owner.MainCols[i].cusAttr("ReplaceColumn"),f!==""&&(i=this._owner.GetColumnIndex(f),e=this._owner.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this._owner.m_currentRowIndex,i),e.cusAttr("Value",n.cusAttr("Value")),e.cusAttr("R",n.cusAttr("R")),e.title=n.title,s=this.tableBody.rows[this._owner.m_currentRowIndex],h=s.cells[i],h.cusAttr("Value",n.cusAttr("Value")))),u&&this._owner.OnCellFocusOut(this._owner.m_currentRowIndex,i),u},CreateTextBox:function(n,t,i){var r=null;if(i!=null?(r=$get(i),r.style.border="0",r.style.width="100%"):r=this._owner.CreateTextBoxControl(t),r==null)return!1;if(r.cusAttr("oldText",n.innerText),i!=null?r.control.set_Value(n.cusAttr("Value")):r.value=this._owner.GetColumnType(this._owner.m_currentColumnIndex)==ControlType.RefControl?n.innerText:n.cusAttr("Value"),this.SetCellOldValue(n),r.value=this._owner.GetColumnType(this._owner.m_currentColumnIndex)==ControlType.RefControl?r.cusAttr("oldText"):n.cusAttr("Value"),n.innerHTML="",this.RemovePadding(n),r.style.display="",n.appendChild(r),r.control)try{r.control._textbox.focus(),r.control._textbox.select()}catch(u){}else r.focus(),r.select();return!0},EndTextBoxInput:function(n,t){var o,r,u,h;if(n.getElementsByTagName("Span").length>0){if((o=n.getElementsByTagName("Span")[0],r=o.children[0],r.type!="text")||n.getElementsByTagName("input").length==0)return!0;var r=n.getElementsByTagName("input"),f=G_SplitLongString(G_Trim(r[0].value),r[0].maxLength),c=o.cusAttr("oldText"),i=r[0].cusAttr("dataType"),s=r[0].cusAttr("displayFormat"),e=n.cusAttr("oldValue");if(o.style.display="none",this._owner.get_element().appendChild(o),e==f)return n.cusAttr("Value",e),this._owner.setCellListValue(n,c),!0;if(n.cusAttr("Value",f),n.title=f,this._owner.setCellListValue(n,this._owner.GetFormatedValue(f,i,s)),u=new CellDataContent(e,f),h=this._owner.IsRowSelected(n.parentElement),this.editManager.OnRowContentChanged(u,n.parentElement,t))return u.ResultValue!=""&&(n.cusAttr("Value",u.ResultValue),u.ResultText!=""?this._owner.setCellListValue(n,u.ResultText):this._owner.setCellListValue(n,this._owner.GetFormatedValue(u.ResultValue,i,s))),(i==DataType.Float||i==DataType.INT||i==DataType.Int16||i==DataType.Int64||i==DataType.Decimal||i==DataType.Single||i==DataType.Double)&&(this.calculate.CalculateColumnExpression(t,this._owner.m_currentRowIndex),this._owner.m_SumSelectedData&&!h||this.calculate.CalculateAggregations(t,e,f)),!0;try{o.style.display="",r[0].focus}catch(l){}return!1}if(n.getElementsByTagName("input").length==0)return!0;var r=n.getElementsByTagName("input"),f=G_SplitLongString(G_Trim(r[0].value),r[0].maxLength),c=r[0].cusAttr("oldText"),i=r[0].cusAttr("dataType"),s=r[0].cusAttr("displayFormat"),e=n.cusAttr("oldValue");if(r[0].style.display="none",this._owner.get_element().appendChild(r[0]),e==f)return n.cusAttr("Value",e),this._owner.setCellListValue(n,c),!0;if(n.cusAttr("Value",f),n.title=f,this._owner.setCellListValue(n,this._owner.GetFormatedValue(f,i,s)),u=new CellDataContent(e,f),h=this._owner.IsRowSelected(n.parentElement),this.editManager.OnRowContentChanged(u,n.parentElement,t))return u.ResultValue!=""&&(n.cusAttr("Value",u.ResultValue),u.ResultText!=""?this._owner.setCellListValue(n,u.ResultText):this._owner.setCellListValue(n,this._owner.GetFormatedValue(u.ResultValue,i,s))),(i==DataType.Float||i==DataType.INT||i==DataType.Int16||i==DataType.Int64||i==DataType.Decimal||i==DataType.Single||i==DataType.Double)&&(this.calculate.CalculateColumnExpression(t,this._owner.m_currentRowIndex),this._owner.m_SumSelectedData&&!h||this.calculate.CalculateAggregations(t,e,f)),!0;try{r[0].style.display="",r[0].focus}catch(l){}return!1},CreateCheckBox:function(n,t,i){var r=null,u;if(i!=null?(r=$get(i),r.style.border="0",n.align="center"):r=this._owner.CreateCheckBoxControl(t),r==null)return!1;this.SetCellOldValue(n),n.innerHTML="",r.style.display="",n.appendChild(r),this.RemovePadding(n),r.style.width="17px",u=this._owner.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this._owner.m_currentRowIndex,t).cusAttr("value"),r.checked=this._owner.HasSwitchColumn(this._owner.m_currentColumnIndex)?this._owner.SetCheckBoxValue(u,t):this._owner.SetCheckBoxValue(n.cusAttr("Value"),t);try{Basic.SetFocus(r),r.focus()}catch(f){}return!0},EndCheckBoxInput:function(n,t){var r,i,u,f,e;if(n.getElementsByTagName("Span").length>0){if(r=n.getElementsByTagName("Span")[0],i=r.children[0],i.type!="checkbox")return!0;if(u=this._owner.MainCols[t].cusAttr("CheckBoxValueRef"),f=this._owner.GetCheckBoxValue(i.checked.toString(),u),n.cusAttr("Value")==f)return r.style.display="none",this._owner.get_element().appendChild(r),this._owner.setCellListValue(n,this._owner.GetCheckBoxText(i.checked.toString(),u)),!0;if(e=new CellDataContent(n.cusAttr("Value"),f),r.style.display="none",this._owner.get_element().appendChild(r),n.cusAttr("Value",f),this._owner.setCellListValue(n,this._owner.GetCheckBoxText(i.checked.toString(),u)),this.editManager.OnRowContentChanged(e,n.parentElement,t))return!0;n.innerHTML="",n.appendChild(r),r.style.display="";try{i.focus}catch(o){}return!1}if(n.getElementsByTagName("input").length==0||(i=n.getElementsByTagName("input")[0],i.type!="checkbox"))return!0;if(u=this._owner.MainCols[t].cusAttr("CheckBoxValueRef"),f=this._owner.GetCheckBoxValue(i.checked.toString(),u),n.cusAttr("Value")==f)return i.style.display="none",this._owner.get_element().appendChild(i),this._owner.setCellListValue(n,this._owner.GetCheckBoxText(i.checked.toString(),u)),!0;if(e=new CellDataContent(n.cusAttr("Value"),f),i.style.display="none",this._owner.get_element().appendChild(i),n.cusAttr("Value",f),this._owner.setCellListValue(n,this._owner.GetCheckBoxText(i.checked.toString(),u)),this.editManager.OnRowContentChanged(e,n.parentElement,t))return!0;n.innerHTML="",n.appendChild(i),i.style.display="";try{i.focus}catch(o){}return!1},SelectCheckBox:function(n){if(n.getElementsByTagName("input").length==0)return!0;var t=n.getElementsByTagName("input")[0];if(t.type!="checkbox")return!0;t.focus()},CreateCombox:function(n,t,i){var r=null,u;return(i!=null?(r=$get(i),r.style.border="0"):r=this._owner.CreateComboxControl(t),r==null)?!1:(u=r.control,this.RemovePadding(n),u.set_Value(n.cusAttr("Value")),u.set_Text(unescapeHTML($(n).text())),this.SetCellOldValue(n),n.innerHTML="",r.style.display="",n.appendChild(r),u.set_Width(n.clientWidth),Basic.SetFocus(u._textbox),u._textbox.focus(),u._textbox.select(),!0)},RemovePadding:function(n){n.style.padding="0px 0px 0px 0px"},EndComboxInput:function(n,t){var i=n.children[0],u,o;if(i==this._owner.UNDEFINED_VALUE||i.tagName=="NOBR"||i.className=="FixedInner")return!0;var f=i.control,r=f.get_Value(),e=f.get_Text();return i.style.display="none",(r==null||r.toString()=="")&&(r=-1),u=n.cusAttr("Value"),(u==null||u.toString()=="")&&(u=-1),r==u?(this._owner.get_element().appendChild(i),this._owner.setCellListValue(n,e),!0):(o=new CellDataContent(n.cusAttr("Value"),r),this._owner.get_element().appendChild(i),n.cusAttr("Value",r),this._owner.setCellListValue(n,e),this.editManager.OnRowContentChanged(o,n.parentElement,t)?!0:(n.innerHTML="",n.appendChild(i),i.style.display="",f.SetFocus(),!1))},SetCellOldValue:function(n){n.cusAttr("oldValue",n.cusAttr("Value")),n.cusAttr("oldText",n.innerHTML)},RestoreCellOldValue:function(n){var t=n.children[0];t!=this._owner.UNDEFINED_VALUE&&t.tagName!="NOBR"&&t.className!="FixedInner"&&(n.removeChild(t),n.cusAttr("Value",n.cusAttr("oldValue")),n.innerHTML=n.cusAttr("oldText"))},CreateDatePicker:function(n,t,i){var r=null,u;return(i!=null?(r=$get(i),r.style.border="0"):r=this._owner.CreateDatePickerControl(t),r==null)?!1:(u=r.control,n.cusAttr("Value")==""?u.set_Value(null):u.set_Value(n.cusAttr("Value")),this.SetCellOldValue(n),n.innerHTML="",this.RemovePadding(n),r.style.display="",n.appendChild(r),u.set_Width(n.clientWidth),Basic.SetFocus(u._textbox),!0)},EndDatePickerInput:function(n,t){var r=n.children[0],i,u,f;return r==this._owner.UNDEFINED_VALUE||r.tagName=="NOBR"||r.className=="FixedInner"?!0:(i=r.control,!i)?void 0:(r.style.display="none",i.get_Text()!=$(r.children[0]).val()&&i.inputChange(),u=i.get_Value(),i.set_Value(n.cusAttr("Value")),u==i.get_Value()&&n.cusAttr("Value",i.get_Value()),i.set_Value(u),n.cusAttr("Value")==u?(this._owner.get_element().appendChild(r),this._owner.setCellListValue(n,i.get_Text()),!0):(f=new CellDataContent(n.cusAttr("Value"),u),this._owner.get_element().appendChild(r),n.cusAttr("Value",u),this._owner.setCellListValue(n,i.get_Text()),this.editManager.OnRowContentChanged(f,n.parentElement,t)?!0:(n.innerHTML="",n.appendChild(r),r.style.display="",i.SetFocus(),!1)))},CreateNumbericInput:function(n,t,i,r){var u=null,f,e,o;return(r!=null?(u=$get(r),u.style.border="0"):u=this._owner.CreateNumbericControl(t,i),u==null)?!1:(f=u.control,this.SetCellOldValue(n),e=Get_Global_IsDirtyData_TheForm(),u.cusAttr("V",n.cusAttr("Value")),o=f._showInvalidMessage,f._showInvalidMessage="false",f.set_Value(""),f.set_Value(n.cusAttr("Value")),f._showInvalidMessage=o,n.innerHTML="",this.RemovePadding(n),n.appendChild(u),u.style.display="",f.set_Width(n.clientWidth),f.SetFocus(),this._owner.Grid_IsDirtyData==!0?Set_Global_IsDirtyData_TheForm(this._owner.Grid_IsDirtyData):Set_Global_IsDirtyData_TheForm(e),!0)},IsRepeat:function(n,t,i){var u=this._owner.MainCols[n],f=null,r,e;if(u&&u.cusAttr("IsSequence")!=this._owner.UNDEFINED_VALUE)for(r=0;r<this._owner.m_ArrNos.length;r++)if(e=this._owner.m_ArrNos[r],e==i&&r!=t){f=this._owner.m_ArrNos[t];break}return f},EndNumbericInput:function(n,t){var r=n.children[0],u,i,h,c,s,e,f,o,l,a,v;return r==this._owner.UNDEFINED_VALUE||r.tagName=="NOBR"||r.className=="FixedInner"?!0:(r.style.display="none",u=r.control,event&&(event.keyCode==KeyCode.up||event.keyCode==KeyCode.down||event.keyCode==KeyCode.left||event.keyCode==KeyCode.right||event.keyCode==KeyCode.enter)&&u.set_Value(u._textbox.value),u.mschangeFired=!0,u.FireChange(),i=u.get_Value(),h=$(n.parentElement).index(),n.cusAttr("Value",this._owner.m_formatHelper.FormatCellNumber(t,h,n.cusAttr("Value"),n.cusAttr("Value")).Value),c=u.GetTextBoxValue(),i==null&&(i=""),s=this.IsRepeat(t,this._owner.m_currentRowIndex,i),s)?(n.cusAttr("Value",s),this._owner.get_element().appendChild(r),this._owner.setCellListValue(n,s),!0):(e=i,i==""&&(i=0),f=n.cusAttr("oldValue"),n.cusAttr("Value")==""&&n.cusAttr("Value",0),o=!1,l=this.tableBody.rows[h].cusAttr("Status")===RowStatus.Empty,parseFloat(e)==parseFloat(f)||e==f?(i=e,n.cusAttr("Value",f),this._owner.get_element().appendChild(r),this._owner.setCellListValue(n,c),o=!0):(i=e,n.cusAttr("Value",f),a=new CellDataContent(n.cusAttr("Value"),i),this._owner.get_element().appendChild(r),n.cusAttr("Value",i),this._owner.setCellListValue(n,c),v=this._owner.IsRowSelected(n.parentElement),this.editManager.OnRowContentChanged(a,n.parentElement,t)?(this.calculate.CalculateColumnExpression(t,this._owner.m_currentRowIndex),this._owner.m_SumSelectedData&&!v||(event&&event.srcElement&&event.srcElement.type=="checkbox"&&event.srcElement.parentElement.parentElement==n.parentElement&&event.srcElement.cusAttr("alreadySelected",!0),l||this.calculate.CalculateAggregations(t,f,i)),o=!0):(n.innerHTML="",n.appendChild(r),r.style.display="",u.SetFocus(),o=!1)),o)},CreateTextArea:function(n,t,i){var r=null;if(i!=null?(r=$get(i),r.style.border="0"):r=this._owner.CreateTextAreaControl(t),r==null)return!1;if(r.value=n.cusAttr("Value"),r.style.width=n.clientWidth+"px",this.SetCellOldValue(n),n.innerHTML="",this.RemovePadding(n),n.appendChild(r),r.style.display="",r.control)try{r.control._textbox.focus(),r.control._textbox.select()}catch(u){}else r.focus(),r.select();return!0},EndTextAreaInput:function(n,t){var i=n.children[0],r;return i==this._owner.UNDEFINED_VALUE||i.tagName=="NOBR"||i.className=="FixedInner"?!0:(i.value==""&&(i.value=i.innerText),i.value=G_SplitLongString(G_Trim(i.value),i.maxLength),i.style.display="none",n.cusAttr("Value")==i.value?(this._owner.get_element().appendChild(i),this._owner.setCellListValue(n,i.value),!0):(r=new CellDataContent(n.cusAttr("Value"),i.value),this._owner.get_element().appendChild(i),n.cusAttr("Value",i.value),this._owner.setCellListValue(n,i.value),this.editManager.OnRowContentChanged(r,n.parentElement,t)?(r.ResultValue!=""&&(n.cusAttr("Value",r.ResultValue),r.ResultText==""?this._owner.setCellListValue(n,n.cusAttr("Value")):this._owner.setCellListValue(n,r.ResultValue)),!0):(i.style.display="",i.focus(),!1)))},CreateMultiInput:function(n,t,i){var u=null,r;return(i!=null?(u=$get(i),u.style.border="0"):u=this._owner.CreateMultiInputControl(t),u==null)?!1:(r=u.control,!r)?!1:(this.SetCellOldValue(n),n.innerHTML="",r.ClearData(),n.cusAttr("MultiLang")==this._owner.UNDEFINED_VALUE?r.SetMultiinputData(""):r.SetMultiinputData(n.cusAttr("MultiLang")),r.set_Value(n.cusAttr("Value")),this.RemovePadding(n),u.style.display="",n.appendChild(u),r.set_Width(n.clientWidth),Basic.SetFocus(r._textbox),!0)},IsEqueMultiValue:function(n,t){var i=!1,e,p,s,w,l,o,a,c,v,u,y,r;if(n==t)return!0;if(e=Basic._loadXML(t),n){var d=Basic._loadXML(n),f=d.getElementsByTagName("Item"),u=e.getElementsByTagName("Item");if(f.length==1){for(p=f[0].getAttribute("ID"),s=f[0].getAttribute("Text"),r=0;r<u.length;r++)if(w=u[r].getAttribute("ID"),o=u[r].getAttribute("Text"),p==w){l=s;try{l=decodeURIComponent(s)}catch(g){}if(s!=o&&l!=decodeURIComponent(o))return i=!1;if(u.length==1)return i=!0}else if(o)return i=!1}else if(f.length==0){if(u.length==0||u.length==1&&(o=u[0].getAttribute("Text"),!o))return i=!0}else if(f.length>1)for(r=0;r<f.length;r++){a=f[r];var b=a.getAttribute("ID"),h=a.getAttribute("Text"),k=e.selectSingleNode("Items/Item[@ID='"+b+"']");if(k){if(c=k.getAttribute("Text"),b==getCultureName()){v=h;try{v=decodeURIComponent(h)}catch(g){}if(h!=c&&v!=decodeURIComponent(c))return i=!1}else if(decodeURIComponent(c)!=decodeURIComponent(h))return i=!1;i=!0}else return i=!1}}else{if(e=Basic.loadXML(e,t),u=e.getElementsByTagName("Item"),y=!0,u.length>0)for(r=0;r<u.length;r++)if(u[r].getAttribute("Text")){y=!1;break}y&&(i=!0)}return i},EndMultiInput:function(n,t){var i=n.children[0],r,e,f,u,o;return i==this._owner.UNDEFINED_VALUE||i.tagName=="NOBR"||i.className=="FixedInner"?!0:(r=$find(i.id),!r)?!0:(e=Get_Global_IsDirtyData_TheForm(),r.InputChange(),this._owner.Grid_IsDirtyData==!0?Set_Global_IsDirtyData_TheForm(this._owner.Grid_IsDirtyData):Set_Global_IsDirtyData_TheForm(e),f=r.GetMultiinputData(),u=r.get_Value(),i.style.display="none",this.IsEqueMultiValue(n.cusAttr("MultiLang"),f)?(this._owner.get_element().appendChild(i),this._owner.setCellListValue(n,u),!0):(o=new CellDataContent(n.cusAttr("Value"),i.value),this._owner.get_element().appendChild(i),n.cusAttr("MultiLang",f),n.cusAttr("Value",u),this._owner.setCellListValue(n,u),this.editManager.OnRowContentChanged(o,n.parentElement,t)?!0:(i.style.display="",n.innerHTML="",n.appendChild(i),r.SetFocus(),!1)))},CreateReference:function(n,t,i){var e=Get_Global_IsDirtyData_TheForm(),r=null,u,f;return(i!=null&&this._owner.MainCols[t].cusAttr("ColEditCtrlClientID4P")==null?(r=$get(i),r.style.border="0"):(r=this._owner.CreateReferenceControl(t),this._owner.MainCols[t].cusAttr("ColEditCtrlClientID4P")!=null&&(r.style.border="0")),r==null)?!1:(u=r.control,f=u.get_NeedValidate(),u.set_NeedValidate(!1),this._owner.HasSwitchColumn(this._owner.m_currentColumnIndex)?this._owner.SetReferenceValues(u,this._owner.m_gridBodyEventsHandler.GridEditHelper.GetCurrentCell(this._owner.m_currentRowIndex,t)):this._owner.SetReferenceValues(u,n),u.set_NeedValidate(f),this._owner.SetReferenceParameters(u,this._owner.m_currentColumnIndex,this._owner.m_currentRowIndex,r.cusAttr("RefPara")),this.SetCellOldValue(n),$E(n).document.childNodes[r.id]?r.style.display="":(n.innerHTML="",n.appendChild(r),this.RemovePadding(n),r.style.display="",u.set_Width(n.clientWidth)),Basic.SetFocus(u._textbox),i!=null&&this._owner.MainCols[t].cusAttr("ColEditCtrlClientID4P")!=null&&u.SetFocus(),this._owner.Grid_IsDirtyData==!0?Set_Global_IsDirtyData_TheForm(this._owner.Grid_IsDirtyData):Set_Global_IsDirtyData_TheForm(e),!0)},EndReferenceInput:function(n,t){var i=n.children[0],f;if(i==this._owner.UNDEFINED_VALUE||i.tagName=="NOBR"||i.className=="FixedInner")return!0;var r=$find(i.id),u=r.get_Key(),e=i.IsChange;return i.style.display="none",n.cusAttr("Value")==""&&n.cusAttr("Value",-1),u==n.cusAttr("Value")?(this._owner.get_element().appendChild(i),n.cusAttr("Value",u),n.cusAttr("R",r.get_Value()+this._owner.RefSplitter2+r.get_Text()),n.title=r.get_Value(),this._owner.setCellListValue(n,r.get_Text()),!0):(i.IsChange=!1,this._owner.get_element().appendChild(i),n.cusAttr("Value",u),n.cusAttr("R",r.get_Value()+this._owner.RefSplitter2+r.get_Text()),n.title=r.get_Value(),this._owner.setCellListValue(n,r.get_Text()),f=new CellDataContent(n.cusAttr("Value"),u),this.editManager.OnRowContentChanged(f,n.parentElement,t)?!0:(n.innerHTML="",n.appendChild(i),i.style.display="",r.SetFocus(),!1))},CellEditEnabled:function(n,t){var i,r,u;return t?this._owner.get_element().cusAttr("EditStatus")==DisplayStyle.Browser||this._owner.m_gridReadOnly==!0?!1:this._owner.m_AllowEditSingleRow?t.cusAttr("Enabled")=="false"||t.cusAttr("Enabled")==!1?!1:this._owner.MainCols[n].cusAttr("ColEditCtrlClientID4P")&&(i=$find(this._owner.MainCols[n].cusAttr("ColEditCtrlClientID4P")),i)?(this._owner.MainCols[n].cusAttr("Edit")!="true"&&this._owner.MainCols[n].cusAttr("Edit","true"),this._owner.m_currentColumnIndex=n,r=i.get_ReadOnly(),this._owner.OnBeforeCellFocusEnter(this.CreateContext(n)),this._owner.IsNeedSwitchTabPage(n)?!1:!r):this._owner.MainCols[n].cusAttr("Edit")==DefaultSymbol.True&&t.clientWidth>0?(this._owner.m_currentColumnIndex=n,u=this._owner.OnBeforeCellFocusEnter(this.CreateContext(n))):!1:!1:!1},CreateContext:function(){var t=new CellDataContent("","");return this._owner.SetCurrentCellInfo(t),t.CellEditEnabled=!0,t}},CalculateHelper=function(n,t,i,r){this._owner=r,this.tableBody=n,this.tableFooter=t,this.thisControl=i,this.columnExpressionCalculater=null,this.aggregationCalculater=null},CalculateHelper.prototype={dispose:function(){this.columnExpressionCalculater&&(this.columnExpressionCalculater.dispose(),this.columnExpressionCalculater=null),this.aggregationCalculater&&(this.aggregationCalculater.dispose(),this.aggregationCalculater=null),this._owner=null,this.tableBody=null,this.tableFooter=null,this.thisControl=null},Init:function(){this.aggregationCalculater=new AggregationCalculateHelper(this.tableBody,this.tableFooter,this._owner),this.columnExpressionCalculater=new ColumnExpressionCalculateHelper(this._owner),this.columnExpressionCalculater.InitExpressions(this._owner.MainCols,this.aggregationCalculater)},CalculateColumnExpression:function(n,t){if(this.columnExpressionCalculater!=null&&t>=0&&t<this._owner.m_rows){var i=this.tableBody.rows[t];this._owner.IsEmptyRow(i)||this.columnExpressionCalculater.Calculating(n,i)}},ResetCalculateAggregations:function(n){if(this.aggregationCalculater!=null)for(var t=0;t<this._owner.MainCols.length;t++)this._owner.MainCols[t].cusAttr("HasSum")=="true"&&(n&&n[this._owner.MainCols[t].cusAttr("FieldID")]!=null?this.aggregationCalculater.Aggregating(t,n[this._owner.MainCols[t].cusAttr("FieldID")],0):this.aggregationCalculater.Aggregating(t,0,0))},ResetAggForNewRow:function(n){if(n&&this.aggregationCalculater)for(var t=0;t<this._owner.MainCols.length;t++)this._owner.MainCols[t].cusAttr("HasSum")=="true"&&n&&n[this._owner.MainCols[t].cusAttr("FieldID")]!=null&&this.aggregationCalculater.Aggregating(t,0,n[this._owner.MainCols[t].cusAttr("FieldID")])},CalculateAggregations:function(n,t,i){this.aggregationCalculater!=null&&this._owner.MainCols[n].cusAttr("HasSum")=="true"&&this.aggregationCalculater.Aggregating(n,t,i)}},ColumnExpressionCalculateHelper=function(n){this._owner=n,this.expressions=[],this.aggregater=null},ColumnExpressionCalculateHelper.prototype={dispose:function(){if(this._owner=null,this.expressions){for(var n=0;n<this.expressions.length;n++)this.expressions[n].dispose();Array.clear(this.expressions),this.expressions=null}this.aggregater=null},InitExpressions:function(n,t){this.CollectExpressions(n),this.aggregater=t},CollectExpressions:function(n){for(var t=1;t<n.length;t++)n[t].cusAttr("Formula")!=this._owner.UNDEFINED_VALUE&&this.ExplainFormula(t,n[t],n);this.expressions.length>0&&SortFormulas(this.expressions)},ExplainFormula:function(n,t,i){var u=t.cusAttr("Formula"),r;u!=""&&(r=new ExpressionItem(this._owner),r.line="var result="+u,r.columnIndex=n,r.hasSum=t.cusAttr("HasSum")!=this._owner.UNDEFINED_VALUE,r.fields=this.GetFieldsOfExpression(u),r.indexs=this.GetColumnIDList(r.fields,i),this.expressions.push(r))},GetColumnIDList:function(n,t){var r=[],i;if(n!=null)for(i=0;i<n.length;i++)for(j=0;j<t.length;j++)if(t[j].cusAttr("FieldID")==n[i]){r.push(j);break}return r},GetFieldsOfExpression:function(n){var t=/([a-z]{1}\w+)/gi;return n.match(t)},Calculating:function(n,t){var i=this.GetFormula(n);i!=null&&(this.CalculateFormula(i,t),i.hasSum&&this.aggregater!=null&&(this._owner.m_SumSelectedData&&!this._owner.IsRowSelected(t)||this.aggregater.Aggregating(i.columnIndex,i.oldValue,i.newValue)),this.Calculating(i.columnIndex,t))},CalculateFormula:function(formula,row){for(var expression=formula.line,value,i=0;i<formula.fields.length;i++)value=this.GetColumnValue(row,formula.indexs[i]),value.substring(0,1)==="-"&&(value=" "+value),expression=expression.replace(formula.fields[i],value);eval(expression),(result==Number.POSITIVE_INFINITY||result==Number.NEGATIVE_INFINITY)&&(result=0),formula.hasSum&&this._owner.m_SumAllData&&(formula.oldValue=this.GetColumnValue(row,formula.columnIndex),formula.newValue=result),this.SetColumnValue(row,formula.columnIndex,result)},SetColumnValue:function(n,t,i,r){if(r==null&&(r=this._owner.m_currentRowIndex),t>=0&&t<n.cells.length){var u=n.cells[t],f=this._owner.m_formatHelper.FormatCellNumber(t,r,i,u.cusAttr("Value"));u.cusAttr("Value",f.Value),this._owner.setCellListValue(u,f.Text,ControlType.Numberic)}},GetColumnValue:function(n,t){var i="0";return t>=0&&t<n.cells.length&&(i=n.cells[t].cusAttr("Value"),isNaN(parseFloat(i))&&(i="0")),i},GetFormula:function(n){if(this.expressions.length>0)for(var t=0;t<this.expressions.length;t++)if(IsOperationColumn(n,this.expressions[t].indexs))return this.expressions[t];return null}},ExpressionItem=function(n){this._owner=n,this.columnIndex=0,this.indexs=[],this.hasSum=!1,this.fields=[],this.line="",this.deep=0,this.checked=!1},ExpressionItem.prototype={dispose:function(){this._owner=null,this.indexs&&(Array.clear(this.indexs),this.indexs=null),this.fields&&(Array.clear(this.fields),this.fields=null)}},ExpressionItem.Create=function(){return new ExpressionItem},AggregationCalculateHelper=function(n,t,i){this._owner=i,this.tableBody=n,this.tableFoot=t},AggregationCalculateHelper.prototype={dispose:function(){this._owner=null,this.tableBody=null,this.tableFoot=null},Aggregating:function(column,oldValue,newValue){var oldTotalValue,newTotalValue,totalValue,aggregateColumnName,index,cFieldName,val,i;if(this.CanCalculate(column)&&this.NeedCalculate(column)){if(this._owner.m_SumAllData||this._owner.m_SumSelectedData){oldTotalValue=parseFloat(this._owner.GetTotalValue(this._owner.MainCols[column].cusAttr("FieldID")),10),(isNaN(oldValue)||oldValue=="")&&(oldValue=0),(isNaN(newValue)||newValue=="")&&(newValue=0),newTotalValue=FloatCalFun.floatAdd(FloatCalFun.floatSubtract(oldTotalValue,parseFloat(oldValue)),parseFloat(newValue)),this.SetTotalValue(column,newTotalValue);return}if(totalValue=0,this._owner.m_aggregateColumnFieldNameValues.length>0){for(aggregateColumnName=this._owner.GetColumnFieldID(column),index=-1,i=0;i<this._owner.m_aggregateColumnFieldNameValues.length;i++)if(this._owner.m_aggregateColumnFieldNameValues[i].aggregateColumnName==aggregateColumnName){index=i;break}if(index>=0)for(i=0;i<this.tableBody.rows.length;i++)cFieldName=this._owner.m_aggregateColumnFieldNameValues[index].conditionFieldName,cFieldName=="CustomerConditon"?eval(this._owner.m_aggregateColumnFieldNameValues[index].conditionFieldValue)&&(totalValue+=this.GetCellValue(this.tableBody.rows[i],column)):(val=this._owner.GetCellValueByFieldAndRow(this._owner.m_aggregateColumnFieldNameValues[index].conditionFieldName,i),val.Value==this._owner.m_aggregateColumnFieldNameValues[index].conditionFieldValue&&(totalValue+=this.GetCellValue(this.tableBody.rows[i],column)));else for(i=0;i<this.tableBody.rows.length;i++)totalValue+=this.GetCellValue(this.tableBody.rows[i],column)}else for(i=0;i<this.tableBody.rows.length;i++)totalValue+=this.GetCellValue(this.tableBody.rows[i],column);this.SetTotalValue(column,totalValue)}},SetTotalValue:function(n,t){if(this.tableFoot!=this._owner.UNDEFINED_VALUE){var i=this._owner.getFootOriginalRow().cells[n],r=this._owner.m_formatHelper.FormatTotalNumber(n,t);i.cusAttr("Value",r.Value),this._owner.setCellListValue(i,r.Text)}},SetNewTotalValue:function(n,t){if(this.tableFoot!=this._owner.UNDEFINED_VALUE){var i=this._owner.getFootNewRow().cells[n],r=this._owner.m_formatHelper.FormatTotalNumber(n,t);i.cusAttr("Value",r.Value),this._owner.setCellListValue(i,r.Text)}},AggregatingNewSum:function(n,t,i){var u=parseFloat(this._owner.GetNewTotalValue(this._owner.MainCols[n].cusAttr("FieldID")),10),r;(isNaN(t)||t=="")&&(t=0),(isNaN(i)||i=="")&&(i=0),r=u-parseFloat(t)+parseFloat(i),this.SetNewTotalValue(n,r);return},GetCellValue:function(n,t){var i=parseFloat(n.cells[t].cusAttr("Value"));return isNaN(i)?0:i},CanCalculate:function(n){if(this.tableFoot!=this._owner.UNDEFINED_VALUE&&n>0&&n<this._owner.MainCols.length){if(!this._owner.MainCols[n].cusAttr("HasSum")||this._owner.MainCols[n].cusAttr("HasSum")=="false")return!1;var t=this._owner.MainCols[n].cusAttr("DataType");return t==DataType.Float||t==DataType.INT||t==DataType.Int16||t==DataType.Int64||t==DataType.Decimal||t==DataType.Single||t==DataType.Double}return!1},NeedCalculate:function(n){return this._owner.MainCols[n].cusAttr("SumValueFrom")&&this._owner.MainCols[n].cusAttr("SumValueFrom").toLowerCase()=="custom"?!1:!0}},GridPageBreakManager=function(n,t,i,r){var u=this;this._owner=r,this.toolBar=n,this.tableBody=i,this.firstHandle=null,this.lastHandle=null,this.previousHandle=null,this.nextHandle=null,this.txtGo=null,this.btnGo=null,this.chk=null,this.OnFirstPageReceive=function(){u._owner.get_element().cusAttr("disabled")||u._owner.OnMovePage("FirstPage")},this.OnPreviousPageReceive=function(){u._owner.get_element().cusAttr("disabled")||u._owner.OnMovePage("PreviousPage")},this.OnNextPageReceive=function(){u._owner.get_element().cusAttr("disabled")||u._owner.OnMovePage("NextPage")},this.OnLastPageReceive=function(){u._owner.get_element().cusAttr("disabled")||u._owner.OnMovePage("LastPage")},this.OnTxtGoKeyDown=function(){var n,t;if(!u._owner.get_element().cusAttr("disabled"))if(event.keyCode==KeyCode.enter){if(n=event.srcElement,!n||n.value=="")return;try{t=parseInt(n.value,10),--t<0&&(t=0)}catch(i){return}u._owner.OnMovePage("GotoPage",t),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault()}else event.keyCode==KeyCode.ESC&&u._owner.Focus()},this.OnChangePageSizeClick=function(){var n=$(this).html();$(this).addClass("active"),$(this).siblings().removeClass("active"),u._owner.OnChangePageSize(n)},this.OnBtnGoClick=function(){var t,n,i;if(!u._owner.get_element().cusAttr("disabled")&&(t=event.srcElement,n=null,t.offsetParent&&t.offsetParent.parentElement&&t.offsetParent.parentElement.cells[6]&&(n=t.offsetParent.parentElement.cells[6].children[0]),n!=null)){if(!n||n.value==""){try{n.focus()}catch(r){}return}try{i=parseInt(n.value,10),--i<0&&(i=0),n.focus()}catch(r){return}u._owner.OnMovePage("GotoPage",i)}},this.OnCheckBoxClick=function(){u._owner.get_element().cusAttr("disabled")||u._owner.OnSelectAllPage(u.chk.checked)}},GridPageBreakManager.prototype={dispose:function(){this._owner=null,this.DetachEvents(),this.toolBar=null,this.tableBody=null,this.firstHandle=null,this.lastHandle=null,this.previousHandle=null,this.nextHandle=null,this.txtGo=null,this.btnGo=null,this.chk=null,this.pageSize=null},Initialize:function(){if(this.toolBar!=null){var n=this.toolBar.rows[0].cells;n[0].children[0]&&n[0].children[0].type=="checkbox"&&(this.chk=n[0].children[0]),n[5]&&(this.firstHandle=n[2].firstChild,this.previousHandle=n[3].firstChild,this.nextHandle=n[4].firstChild,this.lastHandle=n[5].firstChild),n[6]&&(this.txtGo=n[6].children[0]),n[7]&&(this.btnGo=n[7].children[0]),this.AttachEvents()}},AttachEvents:function(){this.chk&&$(this.chk).bind("click",this.OnCheckBoxClick),this.firstHandle&&($(this.firstHandle).bind("click",this.OnFirstPageReceive),$(this.previousHandle).bind("click",this.OnPreviousPageReceive),$(this.nextHandle).bind("click",this.OnNextPageReceive),$(this.lastHandle).bind("click",this.OnLastPageReceive)),this.txtGo&&$(this.txtGo).bind("keydown",this.OnTxtGoKeyDown),this.btnGo&&$(this.btnGo).bind("click",this.OnBtnGoClick),this.pageSize=$(".pageBar .page-size"),this.pageSize&&$(this.pageSize).bind("click",this.OnChangePageSizeClick)},DetachEvents:function(){this.chk&&$(this.chk).unbind("click",this.OnCheckBoxClick),this.firstHandle&&($(this.firstHandle).unbind("click",this.OnFirstPageReceive),$(this.previousHandle).unbind("click",this.OnPreviousPageReceive),$(this.nextHandle).unbind("click",this.OnNextPageReceive),$(this.lastHandle).unbind("click",this.OnLastPageReceive)),this.txtGo&&$(this.txtGo).unbind("keydown",this.OnTxtGoKeyDown),this.btnGo&&$(this.btnGo).unbind("click",this.OnBtnGoClick),this.pageSize&&$(this.pageSize).unbind("click",this.OnChangePageSizeClick)},to_Help:function(n){$(this.toolBar).parent().css("position","relative"),$(this.toolBar).after("<div class='controlBg1' z-index='"+n+"'><\/div>")},to_Translate:function(){$(this.toolBar).parent().css("position","relative"),$(this.toolBar).after("<div class='translateBg1' z-index='"+index+"'><\/div>")},set_translateName:function(){},to_Defualt:function(){$(this.toolBar).parent().css("position","static"),$(this.toolBar).next(".controlBg1").length>0&&$(this.toolBar).next(".controlBg1").remove(),$(this.toolBar).next(".translateBg1").length>0&&$(this.toolBar).next(".translateBg1").remove()}},GridPageBreakManager.GetInstance=function(n,t,i,r){return new GridPageBreakManager(n,t,i,r)},GridMessageToolbarManager=function(n){var t=this;this._owner=n,this.toolBar=null,this.div=null,this.btn=null,this.msg=""},GridMessageToolbarManager.prototype={dispose:function(){_this=null,this._owner=null,this.toolbar=null,this.div=null,this.btn=null,this.msg=null},Initialize:function(){if(this.toolBar==null){var n={"class":"GridMessageToolBar",onclick:"this.style.display='none'"};this.toolBar=$E(window.document).createElement("div",n),this.toolBar.innerHTML="<div class='msg'><div><div class='btn'><\/div>",this.div=this.toolBar.children[0],this.btn=this.toolBar.children[1],this._owner.get_element().appendChild(this.toolBar),this.toolBar.clientWidth>this._owner.get_element().clientWidth-30&&(this.toolBar.style.width=this._owner.get_element().clientWidth-30+"px")}},ShowMessage:function(n){this.div==null&&this.Initialize(),this.div.innerHTML="<nobr>"+n+"<\/nobr>",this.toolBar.title=n,this.toolBar.style.display=""}},GridMessageToolbarManager.GetInstance=function(n){return new GridMessageToolbarManager(n)},GridDataFormatHelper=function(n){this._owner=n,this.num=null,this.jsNum=null,this.div=null},GridDataFormatHelper.prototype={dispose:function(){this._owner=null,this.jsNum=null,this.num=null,this.div=null},Initialize:function(){if(this.div!=null){this.num.setAttribute("ZN",null);return}this.div=document.createElement("div"),this.num=$E(document).createElement("span",{id:"u_"}),this.num.cusAttr({R:"n",CS:"",ZN:"false",TP:"Currency",RV:"5",RT:"2",DT:"8",FS:"c0",V:"0",Scale:"0"}),this.num.innerHTML="<INPUT  id=u__textbox class='textbox number' value=0 maxLength=16  SourceValue='CNY0.0000'><INPUT id=u__HD>' type=hidden><INPUT id=u__HF type=hidden><INPUT id=u__HV type=hidden>",this._owner.get_element().appendChild(this.div),this.div.appendChild(this.num),$create(UF.UI.Number,null,null,null,this.num),this.jsNum=this.num.control,this.jsNum.set_Visible(!1)},_FormatNumberEx:function(value,scale,rt,rv,cs){var nf=Sys.CultureInfo[getCultureName().toLowerCase()].NumberFormat,nds=".",valueSubFormat;nf!=null&&(nds=nf.NumberDecimalSeparator);var valueStr=value.toString(),valueInt=valueStr.split(nds)[0],valueSub="0";return(valueStr.split(nds).length>1&&(valueSub="0"+nds+valueStr.split(".")[1]),scale==0)?cs+vlaueInt:(valueSubFormat=this._FormatNumber(valueSub,0,scale,rt,rv,cs,9,-9,!0).Text,value=eval("'"+valueSubFormat+"'.match(/0"+nds+"/) != null")?eval("'"+valueSubFormat+"'.replace(/0"+nds+"/,'"+valueInt+".')"):eval("'"+valueSubFormat+"'.match(/1"+nds+"/g) != null")?eval("'"+valueSubFormat+"'.replace(/1"+nds+"/,'"+parseInt(valueInt,10)+1+".')"):cs+valueInt)},_FormatNumber:function(n,t,i,r,u,f,e,o,s){var l=n,c=n,h={},a,v,y;return(h.Value=n,h.Text=n,n>999999999999999)?h:(a=Get_Global_IsDirtyData_TheForm(),this.jsNum.set_MaxValue(e),this.jsNum.set_MinValue(o),v=this.jsNum.get_FormatString(),v.substring(0,1).toLowerCase()=="p"&&(i=parseInt(i,10)+2),this.jsNum.set_Scale(i,!0),this.jsNum.set_RoundType(r,!0),this.jsNum.set_RoundValue(u,!0),this.jsNum.set_CurrencySymbol(f,!0),y=n.toString().split(".")[0],this.jsNum.filtrateChars(y,"-").length>this.jsNum._allowIntegerLength)?(l=n,c=s!=null?f+n:this._FormatNumberEx(n,i,r,u,f),h.Value=l,h.Text=c,h):(this.jsNum.set_Value(t),this.jsNum.set_Value(n),this._owner.Grid_IsDirtyData==!0?Set_Global_IsDirtyData_TheForm(this._owner.Grid_IsDirtyData):Set_Global_IsDirtyData_TheForm(a),h.Value=this.jsNum.get_Value().toString(),h.Text=this.jsNum.GetTextBoxValue().toString(),h)},FormatCellNumber:function(n,t,i,r,u){var s,e,w,h,c,l,a,v,y,o,f,p;if((this.Initialize(),s={},s.Value=i.toString(),s.Text=i.toString(),this._owner.MainCols[n].cusAttr("FieldID")=="ID")||(e=this._owner.MainCols[n],e==null))return s;if(w=this._owner.GetColumnFieldID(n),o=this._owner.GetColumnControl(n,t),o&&this.num.cusAttr("ZN",o.cusAttr("ZN")),o&&o.control&&(f=o.control,h=f.get_Scale(),c=f.get_RoundType(),l=f.get_RoundValue(),a=f.get_CurrencySymbol(),v=f.get_MaxValue(),y=f.get_MinValue(),p=Get_Global_IsDirtyData_TheForm(),this.jsNum.set_FormatString(f.get_FormatString(),!0),this._owner.Grid_IsDirtyData==!0?Set_Global_IsDirtyData_TheForm(this._owner.Grid_IsDirtyData):Set_Global_IsDirtyData_TheForm(p),o.parentElement.className=="tbc"))try{f._textbox.select()}catch(nt){}if(e.cusAttr("sf")!=this.UNDEFINED_VALUE){var b=this._owner.GetColumnIndex(e.cusAttr("sf")),k=this._owner.GetColumnIndex(e.cusAttr("tf")),d=this._owner.GetColumnIndex(e.cusAttr("vf")),g=this._owner.GetColumnIndex(e.cusAttr("CS"));this._owner.SetDynamicScaleAndRoundType(n,this.num,t,b,k,d,g,u),h=this.jsNum.get_Scale(),c=this.jsNum.get_RoundType(),l=this.jsNum.get_RoundValue(),a=this.jsNum.get_CurrencySymbol()}return this._FormatNumber(i,r,h,c,l,a,v,y)},FormatTotalNumber:function(n,t){var u,i,c,e,o,s,h,l,a,f,r;if((this.Initialize(),u={},u.Value=t.toString(),u.Text=t.toString(),this._owner.MainCols[n].cusAttr("FieldID")=="ID")||(i=this._owner.MainCols[n],i==null))return u;if(c=this._owner.GetColumnFieldID(n),f=this._owner.GetColumnControl(n),f&&f.control&&(r=f.control,e=r.get_Scale(),o=r.get_RoundType(),s=r.get_RoundValue(),h=r.get_CurrencySymbol(),this.jsNum.set_FormatString(r.get_FormatString()),f.parentElement.className=="tbc"))try{r._textbox.select()}catch(v){}return i.cusAttr("sf")!=this.UNDEFINED_VALUE&&i.SumDataFormat!=null&&(e=i.SumDataFormat.scale,o=i.SumDataFormat.roundType,s=i.SumDataFormat.roundValue,h=i.SumDataFormat.currencySymbol),this._FormatNumber(t,t,e,o,s,h,999999999999999,-999999999999999)}},GridDataFormatHelper.GetInstance=function(n){return new GridDataFormatHelper(n)},GridFrozenColumnsHelper=function(n,t,i,r,u,f){this.layoutContainer=$(n),this.scrollLeft=u,this.scrollTop=f,this.table=t,this.thead=i,this.fixedLength=r,this.afreshCloneFlag=!1,this.cellsWidth=0},GridFrozenColumnsHelper.prototype={constructor:GridFrozenColumnsHelper,classes:{cssFrozenClone:"frozen-clone",cssTheadWrapper:"thead-wrapper",cssTheadFixed:"thead-fixed",cssTbodyFixedWrapper:"tbody-fixed-wrapper",cssParent:"frozen-container",cssFixedColumn:"fixedColumn"},"default":function(){},init:function(){var n=this.getVScroll(),t=this.getLScroll();this.fixedLength==0?this.planB():this.planA()},planA:function(){if(this.layoutContainer.siblings("."+this.classes.cssFrozenClone).length==1)return!1;this.FrozenColumns(),this.Events()},planB:function(){var t=this,n=$(this.table);n.attr("yetClone")!="yes"&&(this.planBCloneThead(),this.planBCssThead(),n.attr("yetClone","yes")),this.planBEvents()},planBCloneThead:function(){var n=$(this.thead).clone();$("tr",n).addClass("thead-tr"),n=this.ColumnsFilterForCloneThead(n),$(this.thead).before(n[0].innerHTML)},ColumnsFilterForCloneThead:function(n){return $("tr td",n).removeAttr("data-custom-attr").removeAttr("width"),n},planBCssThead:function(){var i=$(this.thead),t,n;if(i.addClass("positionThead"),i.children().length>1)for(i.parent().addClass("moreHeader"),t=i.children().children(),n=0;n<t.length;n++)t[n].colSpan>1&&(t[n].width=t[n].width*t[n].colSpan)},addHorizontalScrolling:function(){$(this.table).css("position","relative")},removeHorizontalScrolling:function(){$(this.table).css("position","")},planBEvents:function(){var n=this;n.addHorizontalScrolling();$(this.layoutContainer).each(function(){$(this).data("slot",{sLevel:this.scrollLeft,st:this.scrollTop})}).on("scrollstart scrollstop",{latency:100},function(t){var r=this.scrollLeft,u=this.scrollTop,i=$(this).data("slot"),f,e;(t.type=="scrollstart"||t.type=="scrollstop")&&(u!=i.sVertical&&r==i.sLevel?(n.removeHorizontalScrolling(),$(n.thead).css("top",""),f=$(this).scrollLeft(),$(n.thead).css("left",-1*f)):r!=i.sLevel&&u==i.sVertical&&(n.addHorizontalScrolling(),$(n.thead).css("left",""),e=$(this).scrollTop(),$(n.thead).css("top",e))),$(this).data("slot",{sLevel:r,sVertical:u})})},getIehackWidth:function(){var n=0;return this.isIE()&&(n=2),n},getLScroll:function(){var n=this.layoutContainer.get(0);return n.offsetWidth<n.scrollWidth},getVScroll:function(){var n=this.layoutContainer.get(0);return n.offsetHeight<n.scrollHeight},FrozenColumns:function(){this.fixedLength>0&&(this.addFixedClass(),this.initFixedCss()),this.setCellWidth(),this.GetCellsWidth(),this.CreateTables(),this.frozenCloneDefault(),this.CloneThead(),this.fixedLength>0&&(this.CloneTbodyFixed(),this.CloneTheadFixed()),this.SetTableSize()},frozenCloneDefault:function(){this.frozenClone=this.layoutContainer.siblings("."+this.classes.cssFrozenClone),this.theadFixed=this.frozenClone.children("."+this.classes.cssTheadFixed),this.tbodyFixedWrapper=this.frozenClone.children("."+this.classes.cssTbodyFixedWrapper),this.theadWrapper=this.frozenClone.children("."+this.classes.cssTheadWrapper)},addFixedClass:function(){var n=this;$(n.table).find("."+n.classes.cssFixedColumn).length==0&&$("tr",n.table).each(function(t,i){$(i).children("td:not(:hidden)").slice(0,n.fixedLength).addClass(n.classes.cssFixedColumn)})},initFixedCss:function(){$(this.layoutContainer).find("."+this.classes.cssFixedColumn).css("left",""),$(this.layoutContainer).find("thead  td").css("top","")},setCellWidth:function(){var t=this,n=$(this.thead).find("tr");n.find("td").each(function(n,t){var i=$(t);i.css("display")!="none"&&i.width(i.width())}),n.height(n.height())},GetCellsWidth:function(){var n=this,t;n.cellsWidth=0,t=$(this.thead).find("."+this.classes.cssFixedColumn).slice(0,this.fixedLength),t.each(function(t,i){n.cellsWidth+=$(i).outerWidth(!0)})},CreateTables:function(){var t=this.classes,n,i;this.layoutContainer.addClass("dataGridMainBody"),n=this.layoutContainer.parent().addClass(t.cssParent),n.width(n.width()),this.layoutContainer.siblings("."+t.cssFrozenClone).length==0&&(i=this.getFrozenCloneHtml(),this.layoutContainer.after(i))},getFrozenCloneHtml:function(){var n=this.classes;return'<div class="'+n.cssFrozenClone+'"><div class="'+n.cssTheadWrapper+'"><\/div><table class="'+n.cssTheadFixed+'"><\/table><div class="'+n.cssTbodyFixedWrapper+'"><\/div><\/div>'},CloneThead:function(){var n=$(this.thead).clone();this.theadWrapper.html("<table>"+n[0].outerHTML+"<\/table>")},CloneTbodyFixed:function(){var n=$(this.table).clone();n=this.ColumnsFilterASClass(n),this.tbodyFixedWrapper.html("<table>"+n[0].innerHTML+"<\/table>")},CloneTheadFixed:function(){var n=this.frozenClone.children("."+this.classes.cssTbodyFixedWrapper).find("thead").clone();this.theadFixed.html(n)},ColumnsFilterASClass:function(n){return $("colgroup",n).remove(),$("tr td",n).not("."+this.classes.cssFixedColumn).remove(),$("tr",n).removeAttr("data-ca"),$("tr td",n).removeAttr("data-ca").removeAttr("title"),n},SetTableSize:function(){var n=this.layoutContainer.get(0).offsetHeight-17,t=this.layoutContainer.get(0).offsetWidth-17,i=$(this.table).get(0).offsetWidth;this.frozenClone.width(this.cellsWidth).height(n),this.theadWrapper.width(t),this.theadWrapper.children("table").width(i),this.theadFixed.width(this.cellsWidth),this.tbodyFixedWrapper.width(this.cellsWidth).height(n)},Events:function(){var n=this,t,i;this.setScrollPosition();this.layoutContainer.on("scroll",function(){n.FrozenTableDisplayShow(),n.Scroll(this)});this.layoutContainer.on("scrollstart scrollstop",{latency:400},function(t){t.type=="scrollstart"||t.type=="scrollstop"&&(n.GetInstance(this).ScrollStop(),n.FrozenTableDisplayHidden())});this.layoutContainer.find("tbody").on("click",function(){n.afreshCloneFlag=!0});this.layoutContainer.find("thead").on("mouseup",function(){n.afreshCloneFlag=!0});this.ieHack(),(this.scrollLeft!=0||this.scrollTop!=0)&&(n.GetInstance(this.layoutContainer).ScrollStop(),n.FrozenTableDisplayHidden()),n.FrozenTableDisplayHidden()},Scroll:function(n){var t=this,i=$(n),r=i.siblings("."+t.classes.cssFrozenClone),u=r.children("."+t.classes.cssTbodyFixedWrapper).children("table"),f=r.children("."+t.classes.cssTheadWrapper).children("table");u.css("top",-1*i.scrollTop()),f.css("left",-1*i.scrollLeft())},GetscrollXY:function(){var t,n=$(this.layoutContainer),i=n.data("scrollPosition"),r=n.scrollLeft(),u=n.scrollTop();return r!=i.scrollLeft?t="X":u!=i.scrollTop&&(t="Y"),n.data("scrollPosition",{scrollLeft:r,scrollTop:u}),t},ieHack:function(){var n=this;this.isIE()&&this.layoutContainer.bind("mousedown mouseup",function(t){var i=$(this),o=i.siblings(".frozen-clone");scrollLeft=i.scrollLeft(),scrollTop=i.scrollTop();var r=t.pageX,u=t.pageY,f=i.width()+i.offset().left-17,e=i.height()+i.offset().top-17;(r>f||u>e)&&(t.type=="mousedown"?n.FrozenTableDisplayShow():t.type=="mouseup"&&scrollLeft==i.scrollLeft()&&scrollTop==i.scrollTop()&&n.FrozenTableDisplayHidden())})},isIE:function(){return!!window.ActiveXObject||"ActiveXObject"in window?!0:!1},FrozenTableDisplayHidden:function(){this.FrozenTableDisplay("none"),$(this.layoutContainer).attr("yetPrecess","")},FrozenTableDisplayShow:function(){this.afreshClone(),this.rePosition()},FrozenTableDisplay:function(n){var i=this.classes,t=this.layoutContainer.siblings("."+i.cssFrozenClone);t.length!=0&&t.css("display",n)},rePosition:function(){var n=$(this.layoutContainer),t=n.attr("yetPrecess");t!="yes"&&(n.find(".thc").css("top",""),n.find(".FixedColumnDataCell").css("left",""),n.find(".FixedColumnSumCell").css("left",""),this.FrozenTableDisplay("block"),n.attr("yetPrecess","yes"))},afreshClone:function(){this.afreshCloneFlag==!0&&(this.afreshCloneFlag=!1,this.FrozenColumns())},setScrollPosition:function(){$(this.layoutContainer).each(function(){var n=$(this).scrollLeft(),t=$(this).scrollTop();$(this).data("scrollPosition",{scrollLeft:n,scrollTop:t})})},GetInstance:function(n){var t=$(n),i=t.find("thead"),r=this.classes.cssFixedColumn,u=t.scrollLeft(),f=t.scrollTop();return GridFrozenEventsManager.GetInstance(t,this.table,i,r,u,f)}},GridFrozenColumnsHelper.GetInstance=function(n,t,i,r,u,f){return new GridFrozenColumnsHelper(n,t,i,r,u,f)},GridFrozenEventsManager=function(n,t,i,r,u,f){this.layoutContainer=n,this.table=t,this.fixedThead=i,this.fixedClass=r,this.scrollLeft=u,this.scrollTop=f},GridFrozenEventsManager.prototype={constructor:GridFrozenEventsManager,init:function(){},ScrollStop:function(){this.positionTheadTop(),this.positionFixedLeft()},positionTheadTop:function(){var n=this.fixedThead.find("td");n.css("top",this.scrollTop)},positionFixedLeft:function(){$(this.table).find("."+this.fixedClass).css("left",this.scrollLeft)}},GridFrozenEventsManager.GetInstance=function(n,t,i,r,u,f){return new GridFrozenEventsManager(n,t,i,r,u,f)},Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.RichImage=function(n){UF.UI.RichImage.initializeBase(this,[n]),this._img,this._file,this._btnFakeFile,this._btnDelete,this._hidden,this._div,this._ReadOnly=!1,this._AlertMsg1="请选择图片文件(jpg|jpeg|gif|bmp|png)",this._mouseEnterHandler,this._mouseLeaveHandler,this._btnDelete_mouseEnterHandler,this._btnDelete_mouseLeaveHandler,this._btnDelete_clickHandler,this._btnFakeFile_mouseEnterHandler,this._btnFakeFile_mouseLeaveHandler,this._file_mouseEnterHandler,this._file_mouseLeaveHandler,this._fileChangeHandler,this._willHidFile},UF.UI.RichImage.prototype={initialize:function(){if(UF.UI.RichImage.callBaseMethod(this,"initialize"),this._ReadOnly=this._element.cusAttr("ReadOnly"),this._ReadOnly){this.initControl();return}this._mouseEnterHandler=Function.createDelegate(this,this.onMouseEnter),$addHandler(this._element,"mouseenter",this._mouseEnterHandler),this._mouseLeaveHandler=Function.createDelegate(this,this.onMouseLeave),$addHandler(this._element,"mouseleave",this._mouseLeaveHandler),this._btnDelete_mouseEnterHandler=Function.createDelegate(this,this.onMouseEnter_btnDelete),$addHandler(this.get_btnDelete(),"mouseenter",this._btnDelete_mouseEnterHandler),this._btnDelete_mouseLeaveHandler=Function.createDelegate(this,this.onMouseLeave_btnDelete),$addHandler(this.get_btnDelete(),"mouseleave",this._btnDelete_mouseLeaveHandler),this._btnDelete_clickHandler=Function.createDelegate(this,this.onClick_btnDelete),$addHandler(this.get_btnDelete(),"click",this._btnDelete_clickHandler),this._btnFakeFile_mouseEnterHandler=Function.createDelegate(this,this.onMouseEnter_btnFakeFile),$addHandler(this.get_btnFakeFile(),"mouseenter",this._btnFakeFile_mouseEnterHandler),this._btnFakeFile_mouseLeaveHandler=Function.createDelegate(this,this.onMouseLeave_btnFakeFile),$addHandler(this.get_btnFakeFile(),"mouseleave",this._btnFakeFile_mouseLeaveHandler),this._file_mouseEnterHandler=Function.createDelegate(this,this.onMouseEnter_file),$addHandler(this.get_file(),"mouseenter",this._file_mouseEnterHandler),this._file_mouseLeaveHandler=Function.createDelegate(this,this.onMouseLeave_file),$addHandler(this.get_file(),"mouseleave",this._file_mouseLeaveHandler),this._fileChangeHandler=Function.createDelegate(this,this.onFileChange),$addHandler(this.get_file(),"change",this._fileChangeHandler),this.initControl()},dispose:function(){this._mouseEnterHandler&&(this._mouseEnterHandler=null,$(this._element).unbind("mouseenter")),this._mouseLeaveHandler&&(this._mouseLeaveHandler=null,$(this._element).unbind("mouseleave")),this._btnDelete_mouseEnterHandler&&(this._btnDelete_mouseEnterHandler=null,$(this.get_btnDelete()).unbind("mouseenter")),this._btnDelete_mouseLeaveHandler&&(this._btnDelete_mouseLeaveHandler=null,$(this.get_btnDelete()).unbind("mouseleave")),this._btnDelete_clickHandler&&(this._btnDelete_clickHandler=null,$(this.get_btnDelete()).unbind("click")),this._btnFakeFile_mouseEnterHandler&&(this._btnFakeFile_mouseEnterHandler=null,$(this.get_btnFakeFile()).unbind("mouseenter")),this._btnFakeFile_mouseLeaveHandler&&(this._btnFakeFile_mouseLeaveHandler=null,$(this.get_btnFakeFile()).unbind("mouseleave")),this._file_mouseEnterHandler&&(this._file_mouseEnterHandler=null,$(this.get_file()).unbind("mouseenter")),this._file_mouseLeaveHandler&&(this._file_mouseLeaveHandler=null,$(this.get_file()).unbind("mouseleave")),this._fileChangeHandler&&(this._fileChangeHandler=null,$(this.get_file()).unbind("mouseleave")),this._btnDelete=null,this._btnFakeFile=null,this._file=null,this._img=null,this._willHidFile=null,UF.UI.RichImage.callBaseMethod(this,"dispose")},initControl:function(){this.get_div(),this.get_btnFakeFile()!=null&&(this._btnFakeFile.style.display="none"),this.get_file()!=null&&(this._file.style.display="none"),this.get_btnDelete()!=null&&(this._btnDelete.style.display="none"),this.get_div()!=null&&(this._div.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale);width:"+this.get_element().clientWidth+";height:"+this.get_element().clientHeight+";",this._div.text=this._div.innerText,this._div.innerText=""),this._element.cusAttr("haspic")&&this._element.cusAttr("haspic")=="1"?(this._div.style.background="transparent",this._div.style.border="transparent 1px solid"):(this.get_btnFakeFile()!=null&&(this._btnFakeFile.style.display=""),this.get_file()!=null&&(this._file.style.display=""),this.get_btnDelete()!=null&&(this._btnDelete.style.display=""),this.get_div()!=null&&(this._div.innerText=this._div.text)),this.get_img()&&(this.onLoadImage(),this.get_img().oldSrc=this.get_img().src,this.get_img().style.position="absolute"),this.get_img()&&this.get_file()&&(this.get_img().filePath=this.get_file().value),this._element.cusAttr("Msg1")&&this._element.cusAttr("Msg1").length>0&&(this._AlertMsg1=this._element.cusAttr("Msg1")),this.get_img()&&(this._img.ondblclick=function(){if(!(this.parentElement.control._div.innerText.length>0)&&this.src&&this.src.length>0&&this.src.substring(0,4)!="file")try{window.open(this.src)}catch(n){}})},onLoadImage:function(){var n=this.get_img(),t=this._element.clientHeight,i=this._element.clientWidth;this.drawImage(n,i,t)},drawImage:function(n,t,i){var r=new Image;(r.src=n.src,t===undefined&&(t=n.width,i=n.height),r.width<=0||r.height<=0)||t<=0||i<=0||(flag=!0,r.width/r.height>=t/i?r.width>t?(n.style.width=t+"px",n.style.height=r.height*t/r.width+"px"):(n.style.width=r.width+"px",n.style.height=r.height+"px"):r.height>i?(n.style.height=i+"px",n.style.width=r.width*i/r.height+"px"):(n.style.width=r.width+"px",n.style.height=r.height+"px"))},onMouseEnter:function(){this._willHidFile=!1,this.get_file(),this.get_btnFakeFile(),this.get_btnDelete(),this._file?this._file.style.display="":"",this._btnFakeFile?this._btnFakeFile.style.display="":"",this._btnDelete?this._btnDelete.style.display="":""},onMouseLeave:function(){this._element.cusAttr("haspic")&&this._element.cusAttr("haspic")=="1"&&(this._willHidFile=!0,window.setTimeout("$find('"+this._element.id+"').hidFakeFile()",800))},hidFakeFile:function(){this._willHidFile!=!1&&(this.get_file(),this.get_btnFakeFile(),this.get_btnDelete(),this._file?this._file.style.display="none":"",this._btnFakeFile?this._btnFakeFile.style.display="none":"",this._btnDelete?this._btnDelete.style.display="none":"")},onMouseEnter_btnDelete:function(){this.get_btnDelete().className="btnDelete_over"},onMouseLeave_btnDelete:function(){this.get_btnDelete().className="btnDelete"},onMouseEnter_btnFakeFile:function(){this.get_btnFakeFile().className="btnFakeFile_over"},onMouseLeave_btnFakeFile:function(){this.get_btnFakeFile().className="btnFakeFile"},onClick_btnDelete:function(){this.get_img().filePath&&this.get_img().filePath.length>0?(this.get_img().filePath="",this.reset_file(),this.get_img().src=this.get_img().oldSrc,this._element.cusAttr("haspic")&&this._element.cusAttr("haspic")=="1"?this._element.cusAttr("haspic")&&this._element.cusAttr("haspic")=="1"&&(this.get_img().style.display="none",this.get_div().style.display="none"):this._div.innerText=this._div.text):this._element.cusAttr("haspic")&&this._element.cusAttr("haspic")=="1"&&(this.get_hidden().value="true",this.get_img().style.display="none",this._div.innerText="点击确定按钮删除图片成功")},onMouseEnter_file:function(){this.get_btnFakeFile().className="btnFakeFile_over"},onMouseLeave_file:function(){this.get_btnFakeFile().className="btnFakeFile"},onFileChange:function(){var t=this.get_file().value.toLowerCase();if(t.length!=0){if(t.match(/(jpg|jpeg|gif|bmp|png)$/g)==null)alert(this._AlertMsg1),this.reset_file();else if(this.get_hidden().value="false",this.get_img().className="",this.get_img().filePath=this.get_file().value,this.get_img().src="file:///"+t.replace(/\\/g,"/"),this.get_div()!=null)if(this._div.text=this._div.innerText,this._div.innerText="",this._div.filters)this._div.filters.item(0).src=this.get_file().value;else{var i=window.URL||window.webkitURL,r=i.createObjectURL($(this.get_file())[0].files[0]),n=new Image;n.style.width=this._element.offsetWidth+"px",n.style.height=this._element.offsetHeight+"px",n.className=" previewPic",n.src=r,this._div.style.display="",this._div.innerHTML==""?!0:this._div.removeChild(),this._div.appendChild(n)}Set_Global_IsDirtyData_TheForm(!0)}},get_Type:function(){return ControlType.RichImage},reset_file:function(){this.get_file(),this._file_mouseEnterHandler&&($removeHandler(this.get_file(),"mouseenter",this._file_mouseEnterHandler),this._file_mouseEnterHandler=null),this._file_mouseLeaveHandler&&($removeHandler(this.get_file(),"mouseleave",this._file_mouseLeaveHandler),this._file_mouseLeaveHandler=null),this._fileChangeHandler&&($removeHandler(this.get_file(),"change",this._fileChangeHandler),this._fileChangeHandler=null),this._file.parentNode.removeChild(this._file);var n=document.createElement("input");n.type="file",n.id=this._element.id+"_file",n.name=n.id.replace(/_/g,"$"),n.className="file",this._element.insertAdjacentElement("BeforeEnd",n),this._file=n,this._file_mouseEnterHandler=Function.createDelegate(this,this.onMouseEnter_file),$addHandler(this.get_file(),"mouseenter",this._file_mouseEnterHandler),this._file_mouseLeaveHandler=Function.createDelegate(this,this.onMouseLeave_file),$addHandler(this.get_file(),"mouseleave",this._file_mouseLeaveHandler),this._fileChangeHandler=Function.createDelegate(this,this.onFileChange),$addHandler(this.get_file(),"change",this._fileChangeHandler)},get_div:function(){return this._div==null&&(this._div=document.getElementById(this._element.id+"_divNoPic")),this._div},get_file:function(){return this._file==null&&(this._file=document.getElementById(this._element.id+"_file")),this._file},get_img:function(){return this._img==null&&(this._img=document.getElementById(this._element.id+"_img")),this._img},get_btnFakeFile:function(){return this._btnFakeFile==null&&(this._btnFakeFile=document.getElementById(this._element.id+"_btnFakeFile")),this._btnFakeFile},get_btnDelete:function(){return this._btnDelete==null&&(this._btnDelete=document.getElementById(this._element.id+"_btnDelete")),this._btnDelete},get_hidden:function(){return this._hidden==null&&(this._hidden=document.getElementById(this._element.id+"_Hidden")),this._hidden},get_Enabled:function(){return!this._element.cusAttr("disabled")},set_Enabled:function(n){n=ToBoolean(n),this._element.cusAttr("disabled",!n);for(var t=0,i=this._element.children.length;t<i;t++)$(this._element.children[t]).attr("disabled",!n)},get_ReadOnly:function(){if(this.get_textbox()){if(!$(this.get_textbox()).attr("readOnly"))return!1;var n=$(this.get_textbox()).attr("readOnly").toString().toLowerCase();return n=="true"||n=="readonly"||n==""}return!1},set_ReadOnly:function(n){n=ToBoolean(n),this.get_textbox()&&$(this.get_textbox()).attr("readOnly",n),this.get_btnFakeFile()&&(n?$(this.get_btnFakeFile()).attr("disabled",!0):this.get_Enabled()&&$(this.get_btnFakeFile()).attr("disabled",!1))},get_Visible:function(){return this._element.style.visibility!="hidden"},set_Visible:function(n){this._element.style.visibility=n?"visible":"hidden"}},UF.UI.RichImage.registerClass("UF.UI.RichImage",UF.UI.Control),Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.RadioButtonList=function(n){UF.UI.RadioButtonList.initializeBase(this,[n])},UF.UI.RadioButtonList.prototype={initialize:function(){UF.UI.RadioButtonList.callBaseMethod(this,"initialize"),this._firstChild=null,this._focusHandler=null,this._clickHandler=null,this.get_element().rows[0]&&this.get_element().rows[0].cells[0]&&this.get_element().rows[0].cells[0].children[0]&&this.get_element().rows[0].cells[0].children[0].type=="radio"&&(this._firstChild=this.get_element().rows[0].cells[0].children[0],this._focusHandler=Function.createDelegate(this,this.RadioButtonListFocus),$addHandler(this._firstChild,"focus",this._focusHandler),this._clickHandler=Function.createDelegate(this,this.raiseOnClick),$addHandler(this.get_element(),"click",this._clickHandler))},dispose:function(){this._focusHandler&&($removeHandler(this._firstChild,"focus",this._focusHandler),this._focusHandler=null),this._clickHandler&&($removeHandler(this.get_element(),"click",this._clickHandler),this._clickHandler=null),UF.UI.RadioButtonList.callBaseMethod(this,"dispose")},RadioButtonListFocus:function(){var t=this.get_element(),n;if(t.tagName=="TABLE"&&t.className==ControlClass.RadioList){if(t.disabled)return!1;if(t.rows.length==1)for(n=0;n<t.rows[0].cells.length;n++)n==0?t.rows[0].cells[n].children[0].focus():t.rows[0].cells[n].children[0].checked&&t.rows[0].cells[n].children[0].focus();else for(n=0;n<t.rows.length;n++)n==0?t.rows[n].cells[0].children[0].focus():t.rows[n].cells[0].children[0].checked&&t.rows[n].cells[0].children[0].focus();return!0}},raiseOnClick:function(n){var t=this.get_events().getHandler("onclick");t&&t(this,n)},MouseOver:function(){this.get_element().className=this.mouseOutClass},get_Type:function(){return ControlType.RadioButtonList}},UF.UI.RadioButtonList.registerClass("UF.UI.RadioButtonList",UF.UI.InputControl),Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.Button=function(n){UF.UI.Button.initializeBase(this,[n]),this._datas,this._enabled=!0,this._partID="",this._onclickHandler=null,this._DDB=null,this._MI=null,this._ToDDB=null,this._ToMI=null,this._isCancelButtonClick=!1,this.$element},UF.UI.Button.prototype={initialize:function(){if(UF.UI.Button.callBaseMethod(this,"initialize"),this.$element=$(this._element),this.initControl(),this.RemoveMouseHandler(),this.$element.find("input").length!=0){var n=this.$element.find("input")[0];n.title===""&&(this._element.title=n.value)}},dispose:function(){this.cleanupEvent(),this._datas&&(this._datas.dispose(),this._datas=null),this._enabled=!0,this._isCancelButtonClick=!1,UF.UI.Button.callBaseMethod(this,"dispose")},add_BeforeButtonClick:function(n){this.get_events().addHandler("BeforeLoadData",n)},remove_BeforeButtonClick:function(n){this.get_events().removeHandler("BeforeLoadData",n)},raiseBeforeButtonClick:function(n){var t=this.get_events().getHandler("BeforeButtonClick");t&&t(this,n)},cleanupEvent:function(){this._onclickHandler&&($removeHandler(this._element,"click",this._onclickHandler),this._onclickHandler=null)},get_Type:function(){return ControlType.Button},initControl:function(){if(this._enabled=!this._element.cusAttr("disabled"),this._partID=this._element.cusAttr("PartID"),this._button=this._element.children[0],this._DDB=this._element.cusAttr("DDB"),this._MI=this._element.cusAttr("MI"),this._ToDDB=this._element.cusAttr("ToDDB"),this._ToMI=this._element.cusAttr("ToMI"),this._partID||this._DDB){this._onclickHandler=Function.createDelegate(this,this.onButtonClick);var n=this;$addHandler(this._element,"click",this._onclickHandler)}},set_PartID:function(n){this._partID=n,this._element.cusAttr("PartID",n)},get_PartID:function(){return this._partID},onButtonClick:function(){var t,n;if(_ClientCallBackManager&&_ClientCallBackManager.Runing)return!1;if(this._DDB)t=$find(this._DDB),t.fireItemClick(this._MI);else if(this._partID){if(this.get_IsCancelButtonClick()==!1&&(n=new UF.UI.ChangeEventArgs,n.EventSource=this.get_id(),this.raiseBeforeButtonClick(n),this.get_IsCancelButtonClick()==!0))return;this.ShowButtonForm(),this.get_IsCancelButtonClick()==!0&&this.set_IsCancelButtonClick(!1)}},ShowButtonForm:function(){var n=this.ShowRefForm();this.OnAfterWindowClose(n)},ShowRefForm:function(){var i=this.GetUrl(this._element.cusAttr("PartID"),"TitleLink"),n=this._element.cusAttr("WinTitle");n||(n="");var r=this._element.cusAttr("WinWidth"),u=this._element.cusAttr("WinHeight"),t=!1;return this._element.cusAttr("HideStatusBar")&&this._element.cusAttr("HideStatusBar")=="y"&&(t=!0),ShowModalDialog(i,n,u,r,t)},OnAfterWindowClose:function(n){if(n){this._datas=PopupFormHelper.TranslateInfor(n);var t=new UF.UI.ChangeEventArgs;t.result=this._datas,this.raiseContentChanged(t)}},get_Enabled:function(){return!this._element.cusAttr("disabled")},set_Enabled:function(n){if(n&&n.toString().toLowerCase()=="true"){if(this.visibleAuthority!=null&&this.visibleAuthority.toString().toLowerCase()=="false")return;if(this.enableAuthority!=null&&this.enableAuthority.toString().toLowerCase()=="false")return;this._enabled=!0,this.$element.addClass("disabled")}else this._enabled=!1,this.$element.removeClass("disabled");n=ToBoolean(n),$(this._button).attr("disabled",!n),this._element.cusAttr("disabled",!n),this._ToDDB&&$find(this._ToDDB).SetMenuItemEnableByItemID(this._ToMI,this._enabled),this.set_HDValue("Enabled",n.toString().toLowerCase())},get_Visible:function(){return!(this._element.style.display=="none")},set_Visible:function(n){n===!1?this._element.style.display="none":n===!0&&(this._button.style.display="",this._element.style.display="")},set_Text:function(n){this._button.value=n},get_Text:function(){return this._button.value},get_IsCancelButtonClick:function(){return this._isCancelButtonClick},set_IsCancelButtonClick:function(n){this._isCancelButtonClick=n!=null&&n.toString().toLowerCase()=="true"?!0:!1},fireClick:function(){this._button.fireEvent("onclick")},get_displayName:function(){return this.get_Text()}},UF.UI.Button.registerClass("UF.UI.Button",UF.UI.PopupForm),Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.FilterAdvCtrl=function(n){UF.UI.FilterAdvCtrl.initializeBase(this,[n]),this._Controls,this._keydownHandler},UF.UI.FilterAdvCtrl.prototype={initialize:function(){UF.UI.FilterAdvCtrl.callBaseMethod(this,"initialize"),this.GetInputElements(),this._keydownHandler=Function.createDelegate(this,this.onkeyDown),$addHandler(this.get_element(),"keydown",this._keydownHandler),this._focusinHandler=Function.createDelegate(this,this.onMouseDown),$addHandler(this.get_element(),"focusin",this._focusinHandler),this._clickHandler=Function.createDelegate(this,this.onMouseDown),$addHandler(this.get_element(),"click",this._clickHandler)},dispose:function(){this.cleanupEvent(),this._Controls=null,UF.UI.FilterAdvCtrl.callBaseMethod(this,"dispose")},cleanupEvent:function(){this._keydownHandler&&($removeHandler(this.get_element(),"keydown",this._keydownHandler),this._keydownHandler=null)},GetInputElements:function(){var t,i,r,n;for(this._Controls=[],t=[],t=this.get_element().getElementsByTagName("input"),i=0,r=t.length;i<r;i++)n=t[i],n.style.display=="none"||n.type=="hidden"||n.type=="button"||n.disabled||n.type!="image"&&this._Controls.push(n)},onkeyDown:function(){if(this.get_element().document.readyState=="complete")switch(window.event.keyCode){case KeyCode.Zero:case 96:case KeyCode.G_B:case KeyCode.g_s:case KeyCode.left:case KeyCode.right:if(window.event.altKey||window.event.ctrlKey){this.callParentMethod();return}break;case KeyCode.F2:this.processF2Button(),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault();break;case KeyCode.enter:case KeyCode.tab:if(window.event.ctrlKey)return;this.Jump2Element(event,event.srcElement,window.event.shiftKey)}},onMouseDown:function(){var t=event.srcElement.tagName,n=event.srcElement;t=="INPUT"&&(n.className=="DDBO"||n.className=="TBI")||(t=="TD"&&event.srcElement.className?BaseTop.__UFCurrentFocusControl=null:t=="INPUT"&&n.parentElement&&n.parentElement&&n.parentElement.parentElement.tagName=="TD"&&n.parentElement.parentElement.className=="tbc"||(t=="INPUT"||t=="TEXTAREA")&&(BaseTop.__UFCurrentFocusControl=event.srcElement.id))},Jump2Element:function(n,t,i){var u=this._Controls,r=null;if(u.length>0&&(r=this.getCurrentControl(t,u,i)),r==null){this.callParentMethod();return}if(r!=null&&r.disabled){this.Jump2Element(n,r,i);return}if(r!=null&&!r.disabled&&r)try{r.focus(),$Event(n).stopPropagation(),$Event(n).preventDefault()}catch(f){}},callParentMethod:function(){var n=this._element.document.parentWindow.parent.pageID,t=$("#"+n+"_TabPage9").length>0?$("#"+n+"_TabPage9")[0]:null;t!=null&&(t.control.subIframeOnkeyDown(window.event,n),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault())},processF2Button:function(){var n=window.event.srcElement.id,i="_txtFilterItem_textbox",r="_imgBtnOpenItem",u="_txtFilterValue1_textbox",f="_txtFilterValue2_textbox",e="ReadOnlyValue_textbox",o="_ddlEnumCtrl1_textbox",s="_ddlEnumCtrl2_textbox",h="_datePicker1_textbox",c="_datePicker2_textbox",l="ddlBoolCtrl1_textbox",t="_imgBtnOpenValue";this.processCase(n,i,r)||this.processCase(n,u,t)||this.processCase(n,f,t)||this.processCase(n,e,t)||this.processCase(n,o,t)||this.processCase(n,s,t)||this.processCase(n,h,t)||this.processCase(n,c,t)||this.processCase(n,l,t)},processCase:function(n,t,i){var f=n.length-t.length,r,u;return n.substr(f,t.length)==t?(r=n.replace(t,i),u=this._element.document.all(r),u.click(),!0):!1},getCurrentControl:function(n,t,r){var u=t.length;for(i=0;i<u;i++)if(t[i]==n)return r?i==0?null:t[i-1]:i<u-1?t[i+1]:null}},UF.UI.FilterAdvCtrl.registerClass("UF.UI.FilterAdvCtrl",UF.UI.Control),Type.registerNamespace("UF"),Type.registerNamespace("UF.UI"),UF.UI.FilterBasicCtrl=function(n){UF.UI.FilterBasicCtrl.initializeBase(this,[n]),this._Controls,this._keydownHandler},UF.UI.FilterBasicCtrl.prototype={initialize:function(){UF.UI.FilterBasicCtrl.callBaseMethod(this,"initialize"),this.GetInputElements(),this._keydownHandler=Function.createDelegate(this,this.onkeyDown),$addHandler(this.get_element(),"keydown",this._keydownHandler),this._focusinHandler=Function.createDelegate(this,this.onMouseDown),$addHandler(this.get_element(),"focusin",this._focusinHandler),this._clickHandler=Function.createDelegate(this,this.onMouseDown),$addHandler(this.get_element(),"click",this._clickHandler)},dispose:function(){this.cleanupEvent(),this._Controls=null,UF.UI.FilterBasicCtrl.callBaseMethod(this,"dispose")},cleanupEvent:function(){this._keydownHandler&&($removeHandler(this.get_element(),"keydown",this._keydownHandler),this._keydownHandler=null)},GetInputElements:function(){var t,i,r,n;for(this._Controls=[],t=[],t=this.get_element().getElementsByTagName("input"),i=0,r=t.length;i<r;i++)n=t[i],n.style.display=="none"||n.type=="hidden"||n.type=="button"||n.disabled||n.readOnly||n.type!="image"&&this._Controls.push(n)},onkeyDown:function(){if(this.get_element().document.readyState=="complete")switch(window.event.keyCode){case KeyCode.Zero:case 96:case KeyCode.G_B:case KeyCode.g_s:case KeyCode.left:case KeyCode.right:if(window.event.altKey||window.event.ctrlKey){this.callParentMethod();return}break;case KeyCode.F2:this.processF2Button(),$Event(window.event).stopPropagation(),$Event(window.event).preventDefault();break;case KeyCode.enter:case KeyCode.tab:if(window.event.ctrlKey)return;this.Jump2Element(event,event.srcElement,window.event.shiftKey)}},onMouseDown:function(){var t=event.srcElement.tagName,n=event.srcElement;t=="INPUT"&&(n.className=="DDBO"||n.className=="TBI")||(t=="TD"&&event.srcElement.className?BaseTop.__UFCurrentFocusControl=null:t=="INPUT"&&n.parentElement&&n.parentElement&&n.parentElement.parentElement.tagName=="TD"&&n.parentElement.parentElement.className=="tbc"||(t=="INPUT"||t=="TEXTAREA")&&(BaseTop.__UFCurrentFocusControl=event.srcElement.id))},Jump2Element:function(n,t,i){var u=this._Controls,r=null;if(u.length>0&&(r=this.getCurrentControl(t,u,i)),r==null){this.callParentMethod();return}if(r!=null&&r.disabled){this.Jump2Element(n,r,i);return}if(r!=null&&!r.disabled&&r)try{r.focus(),n.cancelBubble=!0,n.returnValue=!1}catch(f){}},callParentMethod:function(){var n=this._element.document.parentWindow.parent.pageID,t=$("#"+n+"_TabPage9").length>0?$("#"+n+"_TabPage9")[0]:null;t!=null&&(t.control.subIframeOnkeyDown(window.event,n),$Event(event).stopPropagation(),$Event(event).preventDefault())},processF2Button:function(){var n=window.event.srcElement.id,i="_txtFilterValue1_textbox",r="_txtFilterValue2_textbox",u="ReadOnlyValue_textbox",f="_ddlEnumCtrl1_textbox",e="_ddlEnumCtrl2_textbox",o="_datePicker1_textbox",s="_datePicker2_textbox",h="ddlBoolCtrl1_textbox",t="_imgBtnOpen";this.processCase(n,i,t)||this.processCase(n,r,t)||this.processCase(n,u,t)||this.processCase(n,f,t)||this.processCase(n,e,t)||this.processCase(n,o,t)||this.processCase(n,s,t)||this.processCase(n,h,t)},processCase:function(n,t,i){var f=n.length-t.length,r,u;return n.substr(f,t.length)==t?(r=n.replace(t,i),u=this._element.document.children(r),u.click(),!0):!1},getCurrentControl:function(n,t,r){var u=t.length;for(i=0;i<u;i++)if(t[i]==n)return r?i==0?null:t[i-1]:i<u-1?t[i+1]:null}},UF.UI.FilterBasicCtrl.registerClass("UF.UI.FilterBasicCtrl",UF.UI.Control),Advertisement=function(){},Advertisement.prototype={init:function(){this.adserverInit(),window.U9HubTool&&this.getPrefers()},createAd:function(n){var i=this,r=22,u,f,t;$.ajax({url:"../../Scripts/NewPortal/AD/TestEnvironment.js",type:"GET",async:!1,success:function(){r=16},error:function(){}}),u="<ins data-revive-zoneid='"+r+"'  data-revive-id='c595e139effc3eddd4610588db2c7606' data-revive-withtext='1'  data-revive-tags="+n+"><\/ins>",$("#adserver").prepend(u),i.isInclude("asyncjs")||(f=document.getElementsByTagName("head").item(0),t=document.createElement("script"),t.setAttribute("type","text/javascript"),t.setAttribute("src","//u9ad.u9hub.com/www/delivery/asyncjs.php"),t.setAttribute("async","true"),f.appendChild(t)),$("#adserver").bind("DOMNodeInserted",function(){$("#adserver>ins>img").load(function(){$("#adserver").animate({bottom:"20px"},1e3)}),$("#adserver>ins>a>img").load(function(){$("#adserver").animate({bottom:"20px"},1e3)});var n=$("#adserver ins .tags").attr("tags");i.getDislikes(n),$(".adserver-mark").click(function(){i.postDislikes(n,function(){i.delAd()})})})},delAd:function(){$("#adserver").slideUp(1e3,function(){$(this).closest("#adserver").remove()})},adserverInit:function(){var n=this;$(".adserver-close").click(function(){n.delAd()}),$("#adserver").draggable({cursor:"move",start:function(){},stop:function(){}})},getPrefers:function(){var t=this;U9HubTool.get({url:"api/feed/prefers",data:{causer:"ad",type:"tag"},success:function(n){t.createAd(n.data)},error:function(){console.log("getPrefers fail")}})},getDislikes:function(n){var t=this;U9HubTool.get({url:"api/feed/dislikes",data:{causer:"ad",type:"tag"},success:function(i){var r=[],f,u;for(f in i.data)u=i.data[f].title,u.indexOf(",")>-1?r=r.concat(u.split(",")):r.push(u);r=t.arrUnique(r),t.showOrHideDislike(n,r)},error:function(){console.log("getPrefers fail")}})},showOrHideDislike:function(n,t){var f=this,i,u,r;if(n||$(".adserver-mark").hide(),n&&n.toLowerCase()=="u9"&&$(".adserver-mark").hide(),n&&n.indexOf(",")>-1){for(i=n.split(","),u=[],r=0;r<i.length;r++)i[r]=i[r].trim().toLowerCase(),t.indexOf(i[r])!=-1&&i.splice(r,1);i.length==1&&i[0].trim().toLowerCase()=="u9"&&$(".adserver-mark").hide()}},postDislikes:function(n,t){var r,u,i;if(n){if(n.indexOf(",")!=-1){for(r=n.split(","),u=[],i=0;i<r.length;i++)r[i].trim().toLowerCase()!="u9"&&u.push(r[i]);n=u.join(",")}n.trim().toLowerCase()=="u9"&&(n="")}U9HubTool.post({url:"api/feed/dislikes",data:{causer:"ad",type:"tag",title:n},success:function(){console.log("getDislikes sucess"),t()},error:function(){console.log("getPrefers fail")}})},isInclude:function(n){for(var i=document.getElementsByTagName("script"),t=0;t<i.length;t++)if(i[t].src.indexOf(n)!=-1)return!0;return!1},arrUnique:function(n){for(var i=[],t=0;t<n.length;t++)n[t]=n[t].trim().toLowerCase(),i.indexOf(n[t])==-1&&i.push(n[t]);return i}},Advertisement.GetInstance=function(){return new Advertisement},$(function(){Advertisement.GetInstance().init()})